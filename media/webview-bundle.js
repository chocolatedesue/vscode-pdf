/*! For license information please see webview-bundle.js.LICENSE.txt */
(()=>{"use strict";var e={62(e,t,n){e.exports=n.p+"pdfium.wasm"},138(e,t,n){n.r(t),n.d(t,{createPdfiumEngine:()=>m});var o=n(580),r=n(754);const a="RemoteExecutor",i="Worker",s=class e{constructor(t,n){this.worker=t,this.pendingRequests=new Map,this.requestCounter=0,this.handleMessage=e=>{const t=e.data;if("ready"===t.type)return this.logger.debug(a,i,"Worker is ready"),void this.readyTask.resolve(!0);const n=this.pendingRequests.get(t.id);if(n)switch(t.type){case"result":this.logger.debug(a,i,`Received result for ${t.id}`),n.resolve(t.data),this.pendingRequests.delete(t.id);break;case"error":this.logger.debug(a,i,`Received error for ${t.id}:`,t.error),t.error?n.fail(t.error):n.reject({code:r.P.Unknown,message:"Unknown error"}),this.pendingRequests.delete(t.id);break;case"progress":this.logger.debug(a,i,`Received progress for ${t.id}`),n.progress(t.progress)}else this.logger.warn(a,i,`Received response for unknown request: ${t.id}`)},this.logger=n.logger??new r.N,this.worker.addEventListener("message",this.handleMessage),this.readyTask=new r.T,this.pendingRequests.set(e.READY_TASK_ID,this.readyTask),this.worker.postMessage({id:e.READY_TASK_ID,type:"wasmInit",wasmUrl:n.wasmUrl,logger:n.logger?(0,r.s)(n.logger):void 0,fontFallback:n.fontFallback}),this.logger.debug(a,i,"RemoteExecutor created")}generateId(){return`req-${Date.now()}-${this.requestCounter++}`}send(e,t){const n=this.generateId(),o=new r.T,s={id:n,type:"execute",method:e,args:t};return this.readyTask.wait(()=>{this.pendingRequests.set(n,o),this.logger.debug(a,i,`Sending ${e} request:`,n),this.worker.postMessage(s)},t=>{this.logger.error(a,i,`Worker init failed, rejecting ${e}:`,t),o.reject({code:r.P.Initialization,message:"Worker initialization failed"})}),o}destroy(){this.worker.removeEventListener("message",this.handleMessage),this.pendingRequests.forEach((t,n)=>{n!==e.READY_TASK_ID&&(t.abort("Worker destroyed"),this.logger.debug(a,i,`Aborted pending request: ${n}`))}),this.pendingRequests.clear(),this.worker.terminate(),this.logger.debug(a,i,"RemoteExecutor destroyed")}openDocumentBuffer(e,t){return this.send("openDocumentBuffer",[e,t])}getMetadata(e){return this.send("getMetadata",[e])}setMetadata(e,t){return this.send("setMetadata",[e,t])}getDocPermissions(e){return this.send("getDocPermissions",[e])}getDocUserPermissions(e){return this.send("getDocUserPermissions",[e])}getSignatures(e){return this.send("getSignatures",[e])}getBookmarks(e){return this.send("getBookmarks",[e])}setBookmarks(e,t){return this.send("setBookmarks",[e,t])}deleteBookmarks(e){return this.send("deleteBookmarks",[e])}renderPageRaw(e,t,n){return this.send("renderPageRaw",[e,t,n])}renderPageRect(e,t,n,o){return this.send("renderPageRect",[e,t,n,o])}renderThumbnailRaw(e,t,n){return this.send("renderThumbnailRaw",[e,t,n])}renderPageAnnotationRaw(e,t,n,o){return this.send("renderPageAnnotationRaw",[e,t,n,o])}getPageAnnotationsRaw(e,t){return this.send("getPageAnnotationsRaw",[e,t])}getPageAnnotations(e,t){return this.send("getPageAnnotations",[e,t])}createPageAnnotation(e,t,n,o){return this.send("createPageAnnotation",[e,t,n,o])}updatePageAnnotation(e,t,n){return this.send("updatePageAnnotation",[e,t,n])}removePageAnnotation(e,t,n){return this.send("removePageAnnotation",[e,t,n])}getPageTextRects(e,t){return this.send("getPageTextRects",[e,t])}searchInPage(e,t,n,o){return this.send("searchInPage",[e,t,n,o])}getAnnotationsBatch(e,t){return this.send("getAnnotationsBatch",[e,t])}searchBatch(e,t,n,o){return this.send("searchBatch",[e,t,n,o])}getAttachments(e){return this.send("getAttachments",[e])}addAttachment(e,t){return this.send("addAttachment",[e,t])}removeAttachment(e,t){return this.send("removeAttachment",[e,t])}readAttachmentContent(e,t){return this.send("readAttachmentContent",[e,t])}setFormFieldValue(e,t,n,o){return this.send("setFormFieldValue",[e,t,n,o])}flattenPage(e,t,n){return this.send("flattenPage",[e,t,n])}extractPages(e,t){return this.send("extractPages",[e,t])}extractText(e,t){return this.send("extractText",[e,t])}redactTextInRects(e,t,n,o){return this.send("redactTextInRects",[e,t,n,o])}getTextSlices(e,t){return this.send("getTextSlices",[e,t])}getPageGlyphs(e,t){return this.send("getPageGlyphs",[e,t])}getPageGeometry(e,t){return this.send("getPageGeometry",[e,t])}merge(e){return this.send("merge",[e])}mergePages(e){return this.send("mergePages",[e])}preparePrintDocument(e,t){return this.send("preparePrintDocument",[e,t])}saveAsCopy(e){return this.send("saveAsCopy",[e])}closeDocument(e){return this.send("closeDocument",[e])}closeAllDocuments(){return this.send("closeAllDocuments",[])}};s.READY_TASK_ID="0";let l=s;const d="ImageEncoderPool",c="Encoder";class u{constructor(e=2,t,n){this.poolSize=e,this.workerUrl=t,this.workers=[],this.pendingTasks=new Map,this.nextWorkerId=0,this.requestCounter=0,this.logger=n??new r.N,this.initialize()}initialize(){this.logger.debug(d,c,`Creating worker pool with ${this.poolSize} workers`);for(let e=0;e<this.poolSize;e++)try{const t=new Worker(this.workerUrl,{type:"module"});t.onmessage=this.handleWorkerMessage.bind(this),t.onerror=this.handleWorkerError.bind(this),this.workers.push(t),this.logger.debug(d,c,`Worker ${e} created successfully`)}catch(t){this.logger.error(d,c,`Failed to create worker ${e}:`,t)}}handleWorkerMessage(e){const t=e.data,n=this.pendingTasks.get(t.id);if(n)if(this.pendingTasks.delete(t.id),"result"===t.type)n.resolve(t.data);else{const e=t.data;n.reject(new Error(e.message))}else this.logger.warn(d,c,`Received response for unknown task: ${t.id}`)}handleWorkerError(e){this.logger.error(d,c,"Worker error:",e.message)}getNextWorker(){if(0===this.workers.length)return null;const e=this.workers[this.nextWorkerId];return this.nextWorkerId=(this.nextWorkerId+1)%this.workers.length,e}encode(e,t="image/webp",n){return new Promise((o,r)=>{const a=this.getNextWorker();if(!a)return void r(new Error("No workers available in the pool"));const i=`encode-${Date.now()}-${this.requestCounter++}`;this.pendingTasks.set(i,{resolve:o,reject:r});const s={id:i,type:"encode",data:{imageData:{data:e.data,width:e.width,height:e.height},imageType:t,quality:n}};this.logger.debug(d,c,`Sending encoding request ${i} (${e.width}x${e.height})`),a.postMessage(s,[e.data.buffer])})}destroy(){this.logger.debug(d,c,"Destroying worker pool"),this.pendingTasks.forEach((e,t)=>{e.reject(new Error("Worker pool destroyed")),this.logger.debug(d,c,`Rejected pending task: ${t}`)}),this.pendingTasks.clear(),this.workers.forEach((e,t)=>{e.terminate(),this.logger.debug(d,c,`Worker ${t} terminated`)}),this.workers=[]}get activeWorkers(){return this.workers.length}get pendingTasksCount(){return this.pendingTasks.size}}function m(e,t){const n=t instanceof Object&&"debug"in t?{logger:t}:t||{},{logger:r,encoderPoolSize:a,fontFallback:i}=n,s=new Worker(URL.createObjectURL(new Blob(['var Rotation = /* @__PURE__ */ ((Rotation2) => {\n  Rotation2[Rotation2["Degree0"] = 0] = "Degree0";\n  Rotation2[Rotation2["Degree90"] = 1] = "Degree90";\n  Rotation2[Rotation2["Degree180"] = 2] = "Degree180";\n  Rotation2[Rotation2["Degree270"] = 3] = "Degree270";\n  return Rotation2;\n})(Rotation || {});\nfunction toIntPos(p) {\n  return { x: Math.floor(p.x), y: Math.floor(p.y) };\n}\nfunction toIntSize(s) {\n  return { width: Math.ceil(s.width), height: Math.ceil(s.height) };\n}\nfunction toIntRect(r) {\n  return {\n    origin: toIntPos(r.origin),\n    size: toIntSize(r.size)\n  };\n}\nfunction swap(size) {\n  const { width, height } = size;\n  return {\n    width: height,\n    height: width\n  };\n}\nfunction quadToRect(q) {\n  const xs = [q.p1.x, q.p2.x, q.p3.x, q.p4.x];\n  const ys = [q.p1.y, q.p2.y, q.p3.y, q.p4.y];\n  return {\n    origin: { x: Math.min(...xs), y: Math.min(...ys) },\n    size: {\n      width: Math.max(...xs) - Math.min(...xs),\n      height: Math.max(...ys) - Math.min(...ys)\n    }\n  };\n}\nfunction rectToQuad(r) {\n  return {\n    p1: { x: r.origin.x, y: r.origin.y },\n    p2: { x: r.origin.x + r.size.width, y: r.origin.y },\n    p3: { x: r.origin.x + r.size.width, y: r.origin.y + r.size.height },\n    p4: { x: r.origin.x, y: r.origin.y + r.size.height }\n  };\n}\nfunction rotateRect(containerSize, rect, rotation) {\n  let x = rect.origin.x;\n  let y = rect.origin.y;\n  let size = rect.size;\n  switch (rotation) {\n    case 0:\n      break;\n    case 1:\n      x = containerSize.height - rect.origin.y - rect.size.height;\n      y = rect.origin.x;\n      size = swap(rect.size);\n      break;\n    case 2:\n      x = containerSize.width - rect.origin.x - rect.size.width;\n      y = containerSize.height - rect.origin.y - rect.size.height;\n      break;\n    case 3:\n      x = rect.origin.y;\n      y = containerSize.width - rect.origin.x - rect.size.width;\n      size = swap(rect.size);\n      break;\n  }\n  return {\n    origin: {\n      x,\n      y\n    },\n    size: {\n      width: size.width,\n      height: size.height\n    }\n  };\n}\nfunction scaleRect(rect, scaleFactor) {\n  return {\n    origin: {\n      x: rect.origin.x * scaleFactor,\n      y: rect.origin.y * scaleFactor\n    },\n    size: {\n      width: rect.size.width * scaleFactor,\n      height: rect.size.height * scaleFactor\n    }\n  };\n}\nfunction transformRect(containerSize, rect, rotation, scaleFactor) {\n  return scaleRect(rotateRect(containerSize, rect, rotation), scaleFactor);\n}\nfunction buildUserToDeviceMatrix(rect, rotation, outW, outH) {\n  const L = rect.origin.x;\n  const B = rect.origin.y;\n  const W = rect.size.width;\n  const H = rect.size.height;\n  const sx0 = outW / W;\n  const sy0 = outH / H;\n  const sx90 = outW / H;\n  const sy90 = outH / W;\n  switch (rotation) {\n    case 0:\n      return { a: sx0, b: 0, c: 0, d: sy0, e: -sx0 * L, f: -sy0 * B };\n    case 3:\n      return { a: 0, b: -sy90, c: sx90, d: 0, e: -sx90 * B, f: sy90 * (L + W) };\n    case 2:\n      return { a: -sx0, b: 0, c: 0, d: -sy0, e: sx0 * (L + W), f: sy0 * (B + H) };\n    case 1:\n      return { a: 0, b: sy90, c: -sx90, d: 0, e: sx90 * (B + H), f: -sy90 * L };\n  }\n}\nclass NoopLogger {\n  /** {@inheritDoc Logger.isEnabled} */\n  isEnabled() {\n    return false;\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug() {\n  }\n  /** {@inheritDoc Logger.info} */\n  info() {\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn() {\n  }\n  /** {@inheritDoc Logger.error} */\n  error() {\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf() {\n  }\n}\nclass ConsoleLogger {\n  /** {@inheritDoc Logger.isEnabled} */\n  isEnabled() {\n    return true;\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n    console.debug(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n    console.info(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n    console.warn(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n    console.error(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, ...args) {\n    console.info(`${source}.${category}.${event}.${phase}`, ...args);\n  }\n}\nclass LevelLogger {\n  /**\n   * create new LevelLogger\n   * @param logger - the original logger\n   * @param level - log level that used for filtering, all logs lower than this level will be filtered out\n   */\n  constructor(logger, level) {\n    this.logger = logger;\n    this.level = level;\n  }\n  /** {@inheritDoc Logger.isEnabled} */\n  isEnabled(level) {\n    const levelMap = {\n      debug: 0,\n      info: 1,\n      warn: 2,\n      error: 3\n      /* Error */\n    };\n    return this.level <= levelMap[level];\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n    if (this.level <= 0) {\n      this.logger.debug(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n    if (this.level <= 1) {\n      this.logger.info(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n    if (this.level <= 2) {\n      this.logger.warn(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n    if (this.level <= 3) {\n      this.logger.error(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, ...args) {\n    this.logger.perf(source, category, event, phase, ...args);\n  }\n}\nclass PerfLogger {\n  /**\n   * create new PerfLogger\n   */\n  constructor() {\n    this.marks = /* @__PURE__ */ new Map();\n  }\n  /** {@inheritDoc Logger.isEnabled} */\n  isEnabled() {\n    return false;\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, identifier, ...args) {\n    const markName = `${source}.${category}.${event}.${phase}.${identifier}`;\n    switch (phase) {\n      case "Begin":\n        globalThis.performance.mark(markName, { detail: args });\n        this.marks.set(`${source}.${category}.${event}.${identifier}`, Date.now());\n        break;\n      case "End":\n        globalThis.performance.mark(markName, { detail: args });\n        const measureName = `${source}.${category}.${event}.Measure.${identifier}`;\n        const beginMark = `${source}.${category}.${event}.Begin.${identifier}`;\n        globalThis.performance.measure(measureName, beginMark, markName);\n        const startTime = this.marks.get(`${source}.${category}.${event}.${identifier}`);\n        if (startTime) {\n          const duration = Date.now() - startTime;\n          console.info(`⏱️ ${source}.${category}.${event}.${identifier}: ${duration}ms`);\n          this.marks.delete(`${source}.${category}.${event}.${identifier}`);\n        }\n        break;\n    }\n  }\n}\nclass AllLogger {\n  /**\n   * create new PerfLogger\n   */\n  constructor(loggers) {\n    this.loggers = loggers;\n  }\n  /** {@inheritDoc Logger.isEnabled} */\n  isEnabled(level) {\n    return this.loggers.some((logger) => logger.isEnabled(level));\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.debug(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.info(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.warn(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.error(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, ...args) {\n    for (const logger of this.loggers) {\n      logger.perf(source, category, event, phase, ...args);\n    }\n  }\n}\nclass TaskAbortedError extends Error {\n  constructor(reason) {\n    super(`Task aborted: ${JSON.stringify(reason)}`);\n    this.name = "TaskAbortedError";\n    this.reason = reason;\n  }\n}\nclass TaskRejectedError extends Error {\n  constructor(reason) {\n    super(`Task rejected: ${JSON.stringify(reason)}`);\n    this.name = "TaskRejectedError";\n    this.reason = reason;\n  }\n}\nclass Task {\n  constructor() {\n    this.state = {\n      stage: 0\n      /* Pending */\n    };\n    this.resolvedCallbacks = [];\n    this.rejectedCallbacks = [];\n    this._promise = null;\n    this.progressCbs = [];\n  }\n  /**\n   * Convert task to promise\n   * @returns promise that will be resolved when task is settled\n   */\n  toPromise() {\n    if (!this._promise) {\n      this._promise = new Promise((resolve, reject) => {\n        this.wait(\n          (result) => resolve(result),\n          (error) => {\n            if (error.type === "abort") {\n              reject(new TaskAbortedError(error.reason));\n            } else {\n              reject(new TaskRejectedError(error.reason));\n            }\n          }\n        );\n      });\n    }\n    return this._promise;\n  }\n  /**\n   * wait for task to be settled\n   * @param resolvedCallback - callback for resolved value\n   * @param rejectedCallback - callback for rejected value\n   */\n  wait(resolvedCallback, rejectedCallback) {\n    switch (this.state.stage) {\n      case 0:\n        this.resolvedCallbacks.push(resolvedCallback);\n        this.rejectedCallbacks.push(rejectedCallback);\n        break;\n      case 1:\n        resolvedCallback(this.state.result);\n        break;\n      case 2:\n        rejectedCallback({\n          type: "reject",\n          reason: this.state.reason\n        });\n        break;\n      case 3:\n        rejectedCallback({\n          type: "abort",\n          reason: this.state.reason\n        });\n        break;\n    }\n  }\n  /**\n   * resolve task with specific result\n   * @param result - result value\n   */\n  resolve(result) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 1,\n        result\n      };\n      for (const resolvedCallback of this.resolvedCallbacks) {\n        try {\n          resolvedCallback(result);\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * reject task with specific reason\n   * @param reason - abort reason\n   *\n   */\n  reject(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 2,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: "reject",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * abort task with specific reason\n   * @param reason - abort reason\n   */\n  abort(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 3,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: "abort",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * fail task with a TaskError from another task\n   * This is a convenience method for error propagation between tasks\n   * @param error - TaskError from another task\n   */\n  fail(error) {\n    if (error.type === "abort") {\n      this.abort(error.reason);\n    } else {\n      this.reject(error.reason);\n    }\n  }\n  /**\n   * add a progress callback\n   * @param cb - progress callback\n   */\n  onProgress(cb) {\n    this.progressCbs.push(cb);\n  }\n  /**\n   * call progress callback\n   * @param p - progress value\n   */\n  progress(p) {\n    for (const cb of this.progressCbs) cb(p);\n  }\n  /**\n   * Static method to wait for all tasks to resolve\n   * Returns a new task that resolves with an array of all results\n   * Rejects immediately if any task fails\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static all(tasks) {\n    const combinedTask = new Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let resolvedCount = 0;\n    let isSettled = false;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          results[index] = result;\n          resolvedCount++;\n          if (resolvedCount === tasks.length) {\n            isSettled = true;\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === "abort") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method to wait for all tasks to settle (resolve, reject, or abort)\n   * Always resolves with an array of settlement results\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks settle\n   * @public\n   */\n  static allSettled(tasks) {\n    const combinedTask = new Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let settledCount = 0;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          results[index] = { status: "resolved", value: result };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          results[index] = {\n            status: error.type === "abort" ? "aborted" : "rejected",\n            reason: error.reason\n          };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method that resolves/rejects with the first task that settles\n   *\n   * @param tasks - array of tasks to race\n   * @returns new task that settles with the first input task that settles\n   * @public\n   */\n  static race(tasks) {\n    const combinedTask = new Task();\n    if (tasks.length === 0) {\n      combinedTask.reject("No tasks provided");\n      return combinedTask;\n    }\n    let isSettled = false;\n    tasks.forEach((task) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          isSettled = true;\n          combinedTask.resolve(result);\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === "abort") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Utility to track progress of multiple tasks\n   *\n   * @param tasks - array of tasks to track\n   * @param onProgress - callback called when any task completes\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static withProgress(tasks, onProgress) {\n    const combinedTask = Task.all(tasks);\n    if (onProgress) {\n      let completedCount = 0;\n      tasks.forEach((task) => {\n        task.wait(\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          },\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          }\n        );\n      });\n    }\n    return combinedTask;\n  }\n}\nconst PdfSoftHyphenMarker = "­";\nconst PdfZeroWidthSpace = "​";\nconst PdfWordJoiner = "⁠";\nconst PdfBomOrZwnbsp = "\\uFEFF";\nconst PdfNonCharacterFFFE = "￾";\nconst PdfNonCharacterFFFF = "￿";\nconst PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nconst PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join("")}]`, "g");\nfunction stripPdfUnwantedMarkers(text) {\n  return text.replace(PdfUnwantedTextRegex, "");\n}\nvar PdfZoomMode = /* @__PURE__ */ ((PdfZoomMode2) => {\n  PdfZoomMode2[PdfZoomMode2["Unknown"] = 0] = "Unknown";\n  PdfZoomMode2[PdfZoomMode2["XYZ"] = 1] = "XYZ";\n  PdfZoomMode2[PdfZoomMode2["FitPage"] = 2] = "FitPage";\n  PdfZoomMode2[PdfZoomMode2["FitHorizontal"] = 3] = "FitHorizontal";\n  PdfZoomMode2[PdfZoomMode2["FitVertical"] = 4] = "FitVertical";\n  PdfZoomMode2[PdfZoomMode2["FitRectangle"] = 5] = "FitRectangle";\n  PdfZoomMode2[PdfZoomMode2["FitBoundingBox"] = 6] = "FitBoundingBox";\n  PdfZoomMode2[PdfZoomMode2["FitBoundingBoxHorizontal"] = 7] = "FitBoundingBoxHorizontal";\n  PdfZoomMode2[PdfZoomMode2["FitBoundingBoxVertical"] = 8] = "FitBoundingBoxVertical";\n  return PdfZoomMode2;\n})(PdfZoomMode || {});\nvar PdfTrappedStatus = /* @__PURE__ */ ((PdfTrappedStatus2) => {\n  PdfTrappedStatus2[PdfTrappedStatus2["NotSet"] = 0] = "NotSet";\n  PdfTrappedStatus2[PdfTrappedStatus2["True"] = 1] = "True";\n  PdfTrappedStatus2[PdfTrappedStatus2["False"] = 2] = "False";\n  PdfTrappedStatus2[PdfTrappedStatus2["Unknown"] = 3] = "Unknown";\n  return PdfTrappedStatus2;\n})(PdfTrappedStatus || {});\nvar PdfStandardFont = /* @__PURE__ */ ((PdfStandardFont2) => {\n  PdfStandardFont2[PdfStandardFont2["Unknown"] = -1] = "Unknown";\n  PdfStandardFont2[PdfStandardFont2["Courier"] = 0] = "Courier";\n  PdfStandardFont2[PdfStandardFont2["Courier_Bold"] = 1] = "Courier_Bold";\n  PdfStandardFont2[PdfStandardFont2["Courier_BoldOblique"] = 2] = "Courier_BoldOblique";\n  PdfStandardFont2[PdfStandardFont2["Courier_Oblique"] = 3] = "Courier_Oblique";\n  PdfStandardFont2[PdfStandardFont2["Helvetica"] = 4] = "Helvetica";\n  PdfStandardFont2[PdfStandardFont2["Helvetica_Bold"] = 5] = "Helvetica_Bold";\n  PdfStandardFont2[PdfStandardFont2["Helvetica_BoldOblique"] = 6] = "Helvetica_BoldOblique";\n  PdfStandardFont2[PdfStandardFont2["Helvetica_Oblique"] = 7] = "Helvetica_Oblique";\n  PdfStandardFont2[PdfStandardFont2["Times_Roman"] = 8] = "Times_Roman";\n  PdfStandardFont2[PdfStandardFont2["Times_Bold"] = 9] = "Times_Bold";\n  PdfStandardFont2[PdfStandardFont2["Times_BoldItalic"] = 10] = "Times_BoldItalic";\n  PdfStandardFont2[PdfStandardFont2["Times_Italic"] = 11] = "Times_Italic";\n  PdfStandardFont2[PdfStandardFont2["Symbol"] = 12] = "Symbol";\n  PdfStandardFont2[PdfStandardFont2["ZapfDingbats"] = 13] = "ZapfDingbats";\n  return PdfStandardFont2;\n})(PdfStandardFont || {});\nvar PdfTextAlignment = /* @__PURE__ */ ((PdfTextAlignment2) => {\n  PdfTextAlignment2[PdfTextAlignment2["Left"] = 0] = "Left";\n  PdfTextAlignment2[PdfTextAlignment2["Center"] = 1] = "Center";\n  PdfTextAlignment2[PdfTextAlignment2["Right"] = 2] = "Right";\n  return PdfTextAlignment2;\n})(PdfTextAlignment || {});\nvar PdfBlendMode = /* @__PURE__ */ ((PdfBlendMode2) => {\n  PdfBlendMode2[PdfBlendMode2["Normal"] = 0] = "Normal";\n  PdfBlendMode2[PdfBlendMode2["Multiply"] = 1] = "Multiply";\n  PdfBlendMode2[PdfBlendMode2["Screen"] = 2] = "Screen";\n  PdfBlendMode2[PdfBlendMode2["Overlay"] = 3] = "Overlay";\n  PdfBlendMode2[PdfBlendMode2["Darken"] = 4] = "Darken";\n  PdfBlendMode2[PdfBlendMode2["Lighten"] = 5] = "Lighten";\n  PdfBlendMode2[PdfBlendMode2["ColorDodge"] = 6] = "ColorDodge";\n  PdfBlendMode2[PdfBlendMode2["ColorBurn"] = 7] = "ColorBurn";\n  PdfBlendMode2[PdfBlendMode2["HardLight"] = 8] = "HardLight";\n  PdfBlendMode2[PdfBlendMode2["SoftLight"] = 9] = "SoftLight";\n  PdfBlendMode2[PdfBlendMode2["Difference"] = 10] = "Difference";\n  PdfBlendMode2[PdfBlendMode2["Exclusion"] = 11] = "Exclusion";\n  PdfBlendMode2[PdfBlendMode2["Hue"] = 12] = "Hue";\n  PdfBlendMode2[PdfBlendMode2["Saturation"] = 13] = "Saturation";\n  PdfBlendMode2[PdfBlendMode2["Color"] = 14] = "Color";\n  PdfBlendMode2[PdfBlendMode2["Luminosity"] = 15] = "Luminosity";\n  return PdfBlendMode2;\n})(PdfBlendMode || {});\nvar PdfStampFit = /* @__PURE__ */ ((PdfStampFit2) => {\n  PdfStampFit2[PdfStampFit2["Contain"] = 0] = "Contain";\n  PdfStampFit2[PdfStampFit2["Cover"] = 1] = "Cover";\n  PdfStampFit2[PdfStampFit2["Stretch"] = 2] = "Stretch";\n  return PdfStampFit2;\n})(PdfStampFit || {});\nvar PdfActionType = /* @__PURE__ */ ((PdfActionType2) => {\n  PdfActionType2[PdfActionType2["Unsupported"] = 0] = "Unsupported";\n  PdfActionType2[PdfActionType2["Goto"] = 1] = "Goto";\n  PdfActionType2[PdfActionType2["RemoteGoto"] = 2] = "RemoteGoto";\n  PdfActionType2[PdfActionType2["URI"] = 3] = "URI";\n  PdfActionType2[PdfActionType2["LaunchAppOrOpenFile"] = 4] = "LaunchAppOrOpenFile";\n  return PdfActionType2;\n})(PdfActionType || {});\nvar PdfAnnotationSubtype = /* @__PURE__ */ ((PdfAnnotationSubtype2) => {\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["UNKNOWN"] = 0] = "UNKNOWN";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["TEXT"] = 1] = "TEXT";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["LINK"] = 2] = "LINK";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["FREETEXT"] = 3] = "FREETEXT";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["LINE"] = 4] = "LINE";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["SQUARE"] = 5] = "SQUARE";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["CIRCLE"] = 6] = "CIRCLE";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["POLYGON"] = 7] = "POLYGON";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["POLYLINE"] = 8] = "POLYLINE";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["HIGHLIGHT"] = 9] = "HIGHLIGHT";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["UNDERLINE"] = 10] = "UNDERLINE";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["SQUIGGLY"] = 11] = "SQUIGGLY";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["STRIKEOUT"] = 12] = "STRIKEOUT";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["STAMP"] = 13] = "STAMP";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["CARET"] = 14] = "CARET";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["INK"] = 15] = "INK";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["POPUP"] = 16] = "POPUP";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["FILEATTACHMENT"] = 17] = "FILEATTACHMENT";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["SOUND"] = 18] = "SOUND";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["MOVIE"] = 19] = "MOVIE";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["WIDGET"] = 20] = "WIDGET";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["SCREEN"] = 21] = "SCREEN";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["PRINTERMARK"] = 22] = "PRINTERMARK";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["TRAPNET"] = 23] = "TRAPNET";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["WATERMARK"] = 24] = "WATERMARK";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["THREED"] = 25] = "THREED";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["RICHMEDIA"] = 26] = "RICHMEDIA";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["XFAWIDGET"] = 27] = "XFAWIDGET";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2["REDACT"] = 28] = "REDACT";\n  return PdfAnnotationSubtype2;\n})(PdfAnnotationSubtype || {});\nvar AppearanceMode = /* @__PURE__ */ ((AppearanceMode2) => {\n  AppearanceMode2[AppearanceMode2["Normal"] = 0] = "Normal";\n  AppearanceMode2[AppearanceMode2["Rollover"] = 1] = "Rollover";\n  AppearanceMode2[AppearanceMode2["Down"] = 2] = "Down";\n  return AppearanceMode2;\n})(AppearanceMode || {});\nvar PdfAnnotationIcon = /* @__PURE__ */ ((PdfAnnotationIcon2) => {\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Unknown"] = -1] = "Unknown";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Comment"] = 0] = "Comment";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Key"] = 1] = "Key";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Note"] = 2] = "Note";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Help"] = 3] = "Help";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["NewParagraph"] = 4] = "NewParagraph";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Paragraph"] = 5] = "Paragraph";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Insert"] = 6] = "Insert";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Graph"] = 7] = "Graph";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["PushPin"] = 8] = "PushPin";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Paperclip"] = 9] = "Paperclip";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Tag"] = 10] = "Tag";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Speaker"] = 11] = "Speaker";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Mic"] = 12] = "Mic";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Approved"] = 13] = "Approved";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Experimental"] = 14] = "Experimental";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["NotApproved"] = 15] = "NotApproved";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["AsIs"] = 16] = "AsIs";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Expired"] = 17] = "Expired";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["NotForPublicRelease"] = 18] = "NotForPublicRelease";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Confidential"] = 19] = "Confidential";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Final"] = 20] = "Final";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Sold"] = 21] = "Sold";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Departmental"] = 22] = "Departmental";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["ForComment"] = 23] = "ForComment";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["TopSecret"] = 24] = "TopSecret";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["Draft"] = 25] = "Draft";\n  PdfAnnotationIcon2[PdfAnnotationIcon2["ForPublicRelease"] = 26] = "ForPublicRelease";\n  return PdfAnnotationIcon2;\n})(PdfAnnotationIcon || {});\nvar PdfAnnotationLineEnding = /* @__PURE__ */ ((PdfAnnotationLineEnding2) => {\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["None"] = 0] = "None";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["Square"] = 1] = "Square";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["Circle"] = 2] = "Circle";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["Diamond"] = 3] = "Diamond";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["OpenArrow"] = 4] = "OpenArrow";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["ClosedArrow"] = 5] = "ClosedArrow";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["Butt"] = 6] = "Butt";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["ROpenArrow"] = 7] = "ROpenArrow";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["RClosedArrow"] = 8] = "RClosedArrow";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["Slash"] = 9] = "Slash";\n  PdfAnnotationLineEnding2[PdfAnnotationLineEnding2["Unknown"] = 10] = "Unknown";\n  return PdfAnnotationLineEnding2;\n})(PdfAnnotationLineEnding || {});\nvar PDF_FORM_FIELD_TYPE = /* @__PURE__ */ ((PDF_FORM_FIELD_TYPE2) => {\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["UNKNOWN"] = 0] = "UNKNOWN";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["PUSHBUTTON"] = 1] = "PUSHBUTTON";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["CHECKBOX"] = 2] = "CHECKBOX";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["RADIOBUTTON"] = 3] = "RADIOBUTTON";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["COMBOBOX"] = 4] = "COMBOBOX";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["LISTBOX"] = 5] = "LISTBOX";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["TEXTFIELD"] = 6] = "TEXTFIELD";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["SIGNATURE"] = 7] = "SIGNATURE";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA"] = 8] = "XFA";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_CHECKBOX"] = 9] = "XFA_CHECKBOX";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_COMBOBOX"] = 10] = "XFA_COMBOBOX";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_IMAGEFIELD"] = 11] = "XFA_IMAGEFIELD";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_LISTBOX"] = 12] = "XFA_LISTBOX";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_PUSHBUTTON"] = 13] = "XFA_PUSHBUTTON";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_SIGNATURE"] = 14] = "XFA_SIGNATURE";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2["XFA_TEXTFIELD"] = 15] = "XFA_TEXTFIELD";\n  return PDF_FORM_FIELD_TYPE2;\n})(PDF_FORM_FIELD_TYPE || {});\nvar PdfAnnotationColorType = /* @__PURE__ */ ((PdfAnnotationColorType2) => {\n  PdfAnnotationColorType2[PdfAnnotationColorType2["Color"] = 0] = "Color";\n  PdfAnnotationColorType2[PdfAnnotationColorType2["InteriorColor"] = 1] = "InteriorColor";\n  return PdfAnnotationColorType2;\n})(PdfAnnotationColorType || {});\nvar PdfAnnotationBorderStyle = /* @__PURE__ */ ((PdfAnnotationBorderStyle2) => {\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["UNKNOWN"] = 0] = "UNKNOWN";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["SOLID"] = 1] = "SOLID";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["DASHED"] = 2] = "DASHED";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["BEVELED"] = 3] = "BEVELED";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["INSET"] = 4] = "INSET";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["UNDERLINE"] = 5] = "UNDERLINE";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2["CLOUDY"] = 6] = "CLOUDY";\n  return PdfAnnotationBorderStyle2;\n})(PdfAnnotationBorderStyle || {});\nvar PdfPageObjectType = /* @__PURE__ */ ((PdfPageObjectType2) => {\n  PdfPageObjectType2[PdfPageObjectType2["UNKNOWN"] = 0] = "UNKNOWN";\n  PdfPageObjectType2[PdfPageObjectType2["TEXT"] = 1] = "TEXT";\n  PdfPageObjectType2[PdfPageObjectType2["PATH"] = 2] = "PATH";\n  PdfPageObjectType2[PdfPageObjectType2["IMAGE"] = 3] = "IMAGE";\n  PdfPageObjectType2[PdfPageObjectType2["SHADING"] = 4] = "SHADING";\n  PdfPageObjectType2[PdfPageObjectType2["FORM"] = 5] = "FORM";\n  return PdfPageObjectType2;\n})(PdfPageObjectType || {});\nconst PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: "invisible",\n  [\n    2\n    /* HIDDEN */\n  ]: "hidden",\n  [\n    4\n    /* PRINT */\n  ]: "print",\n  [\n    8\n    /* NO_ZOOM */\n  ]: "noZoom",\n  [\n    16\n    /* NO_ROTATE */\n  ]: "noRotate",\n  [\n    32\n    /* NO_VIEW */\n  ]: "noView",\n  [\n    64\n    /* READ_ONLY */\n  ]: "readOnly",\n  [\n    128\n    /* LOCKED */\n  ]: "locked",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: "toggleNoView"\n});\nconst PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nfunction flagsToNames(raw) {\n  return Object.keys(PdfAnnotationFlagName).filter((flag) => (raw & flag) !== 0).map((flag) => PdfAnnotationFlagName[flag]);\n}\nfunction namesToFlags(names) {\n  return names.reduce(\n    (mask, name) => mask | PdfAnnotationFlagValue[name],\n    0\n    /* NONE */\n  );\n}\nvar FontCharset = /* @__PURE__ */ ((FontCharset2) => {\n  FontCharset2[FontCharset2["ANSI"] = 0] = "ANSI";\n  FontCharset2[FontCharset2["DEFAULT"] = 1] = "DEFAULT";\n  FontCharset2[FontCharset2["SYMBOL"] = 2] = "SYMBOL";\n  FontCharset2[FontCharset2["SHIFTJIS"] = 128] = "SHIFTJIS";\n  FontCharset2[FontCharset2["HANGEUL"] = 129] = "HANGEUL";\n  FontCharset2[FontCharset2["GB2312"] = 134] = "GB2312";\n  FontCharset2[FontCharset2["CHINESEBIG5"] = 136] = "CHINESEBIG5";\n  FontCharset2[FontCharset2["GREEK"] = 161] = "GREEK";\n  FontCharset2[FontCharset2["VIETNAMESE"] = 163] = "VIETNAMESE";\n  FontCharset2[FontCharset2["HEBREW"] = 177] = "HEBREW";\n  FontCharset2[FontCharset2["ARABIC"] = 178] = "ARABIC";\n  FontCharset2[FontCharset2["CYRILLIC"] = 204] = "CYRILLIC";\n  FontCharset2[FontCharset2["THAI"] = 222] = "THAI";\n  FontCharset2[FontCharset2["EASTERNEUROPEAN"] = 238] = "EASTERNEUROPEAN";\n  return FontCharset2;\n})(FontCharset || {});\nvar PdfPageFlattenFlag = /* @__PURE__ */ ((PdfPageFlattenFlag2) => {\n  PdfPageFlattenFlag2[PdfPageFlattenFlag2["Display"] = 0] = "Display";\n  PdfPageFlattenFlag2[PdfPageFlattenFlag2["Print"] = 1] = "Print";\n  return PdfPageFlattenFlag2;\n})(PdfPageFlattenFlag || {});\nvar PdfErrorCode = /* @__PURE__ */ ((PdfErrorCode2) => {\n  PdfErrorCode2[PdfErrorCode2["Ok"] = 0] = "Ok";\n  PdfErrorCode2[PdfErrorCode2["Unknown"] = 1] = "Unknown";\n  PdfErrorCode2[PdfErrorCode2["NotFound"] = 2] = "NotFound";\n  PdfErrorCode2[PdfErrorCode2["WrongFormat"] = 3] = "WrongFormat";\n  PdfErrorCode2[PdfErrorCode2["Password"] = 4] = "Password";\n  PdfErrorCode2[PdfErrorCode2["Security"] = 5] = "Security";\n  PdfErrorCode2[PdfErrorCode2["PageError"] = 6] = "PageError";\n  PdfErrorCode2[PdfErrorCode2["XFALoad"] = 7] = "XFALoad";\n  PdfErrorCode2[PdfErrorCode2["XFALayout"] = 8] = "XFALayout";\n  PdfErrorCode2[PdfErrorCode2["Cancelled"] = 9] = "Cancelled";\n  PdfErrorCode2[PdfErrorCode2["Initialization"] = 10] = "Initialization";\n  PdfErrorCode2[PdfErrorCode2["NotReady"] = 11] = "NotReady";\n  PdfErrorCode2[PdfErrorCode2["NotSupport"] = 12] = "NotSupport";\n  PdfErrorCode2[PdfErrorCode2["LoadDoc"] = 13] = "LoadDoc";\n  PdfErrorCode2[PdfErrorCode2["DocNotOpen"] = 14] = "DocNotOpen";\n  PdfErrorCode2[PdfErrorCode2["CantCloseDoc"] = 15] = "CantCloseDoc";\n  PdfErrorCode2[PdfErrorCode2["CantCreateNewDoc"] = 16] = "CantCreateNewDoc";\n  PdfErrorCode2[PdfErrorCode2["CantImportPages"] = 17] = "CantImportPages";\n  PdfErrorCode2[PdfErrorCode2["CantCreateAnnot"] = 18] = "CantCreateAnnot";\n  PdfErrorCode2[PdfErrorCode2["CantSetAnnotRect"] = 19] = "CantSetAnnotRect";\n  PdfErrorCode2[PdfErrorCode2["CantSetAnnotContent"] = 20] = "CantSetAnnotContent";\n  PdfErrorCode2[PdfErrorCode2["CantRemoveInkList"] = 21] = "CantRemoveInkList";\n  PdfErrorCode2[PdfErrorCode2["CantAddInkStoke"] = 22] = "CantAddInkStoke";\n  PdfErrorCode2[PdfErrorCode2["CantReadAttachmentSize"] = 23] = "CantReadAttachmentSize";\n  PdfErrorCode2[PdfErrorCode2["CantReadAttachmentContent"] = 24] = "CantReadAttachmentContent";\n  PdfErrorCode2[PdfErrorCode2["CantFocusAnnot"] = 25] = "CantFocusAnnot";\n  PdfErrorCode2[PdfErrorCode2["CantSelectText"] = 26] = "CantSelectText";\n  PdfErrorCode2[PdfErrorCode2["CantSelectOption"] = 27] = "CantSelectOption";\n  PdfErrorCode2[PdfErrorCode2["CantCheckField"] = 28] = "CantCheckField";\n  PdfErrorCode2[PdfErrorCode2["CantSetAnnotString"] = 29] = "CantSetAnnotString";\n  return PdfErrorCode2;\n})(PdfErrorCode || {});\nclass PdfTaskHelper {\n  /**\n   * Create a task\n   * @returns new task\n   */\n  static create() {\n    return new Task();\n  }\n  /**\n   * Create a task that has been resolved with value\n   * @param result - resolved value\n   * @returns resolved task\n   */\n  static resolve(result) {\n    const task = new Task();\n    task.resolve(result);\n    return task;\n  }\n  /**\n   * Create a task that has been rejected with error\n   * @param reason - rejected error\n   * @returns rejected task\n   */\n  static reject(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n  /**\n   * Create a task that has been aborted with error\n   * @param reason - aborted error\n   * @returns aborted task\n   */\n  static abort(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n}\nfunction pdfColorToWebColor(c) {\n  const clamp = (n) => Math.max(0, Math.min(255, n));\n  const toHex = (n) => clamp(n).toString(16).padStart(2, "0");\n  return `#${toHex(c.red)}${toHex(c.green)}${toHex(c.blue)}`;\n}\nfunction webColorToPdfColor(color) {\n  if (/^#?[0-9a-f]{3}$/i.test(color)) {\n    color = color.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i, "#$1$1$2$2$3$3").toLowerCase();\n  }\n  const [, r, g, b] = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color) ?? (() => {\n    throw new Error(`Invalid hex colour: "${color}"`);\n  })();\n  return {\n    red: parseInt(r, 16),\n    green: parseInt(g, 16),\n    blue: parseInt(b, 16)\n  };\n}\nfunction pdfAlphaToWebOpacity(alpha) {\n  const clamp = (n) => Math.max(0, Math.min(255, n));\n  return clamp(alpha) / 255;\n}\nfunction webOpacityToPdfAlpha(opacity) {\n  const clamp = (n, hi = 255) => Math.max(0, Math.min(hi, n));\n  return clamp(Math.round(opacity * 255));\n}\nfunction pdfDateToDate(pdf) {\n  if (!(pdf == null ? void 0 : pdf.startsWith("D:")) || pdf.length < 16) return;\n  const y = +pdf.slice(2, 6);\n  const mo = +pdf.slice(6, 8) - 1;\n  const d = +pdf.slice(8, 10);\n  const H = +pdf.slice(10, 12);\n  const M = +pdf.slice(12, 14);\n  const S = +pdf.slice(14, 16);\n  return new Date(Date.UTC(y, mo, d, H, M, S));\n}\nfunction dateToPdfDate(date = /* @__PURE__ */ new Date()) {\n  const z = (n, len = 2) => n.toString().padStart(len, "0");\n  const YYYY = date.getUTCFullYear();\n  const MM = z(date.getUTCMonth() + 1);\n  const DD = z(date.getUTCDate());\n  const HH = z(date.getUTCHours());\n  const mm = z(date.getUTCMinutes());\n  const SS = z(date.getUTCSeconds());\n  return `D:${YYYY}${MM}${DD}${HH}${mm}${SS}`;\n}\nconst TEXT_ALIGNMENT_INFOS = Object.freeze([\n  { id: PdfTextAlignment.Left, label: "Left", css: "left" },\n  { id: PdfTextAlignment.Center, label: "Center", css: "center" },\n  { id: PdfTextAlignment.Right, label: "Right", css: "right" }\n]);\nTEXT_ALIGNMENT_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nTEXT_ALIGNMENT_INFOS.reduce(\n  (m, info) => {\n    m[info.css] = info.id;\n    return m;\n  },\n  {}\n);\nTEXT_ALIGNMENT_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfStandardFontFamily = /* @__PURE__ */ ((PdfStandardFontFamily2) => {\n  PdfStandardFontFamily2["Courier"] = "Courier";\n  PdfStandardFontFamily2["Helvetica"] = "Helvetica";\n  PdfStandardFontFamily2["Times"] = "Times";\n  PdfStandardFontFamily2["Symbol"] = "Symbol";\n  PdfStandardFontFamily2["ZapfDingbats"] = "ZapfDingbats";\n  PdfStandardFontFamily2["Unknown"] = "Unknown";\n  return PdfStandardFontFamily2;\n})(PdfStandardFontFamily || {});\nPdfStandardFont.Helvetica;\nconst HELVETICA_DESC = {\n  id: PdfStandardFont.Helvetica,\n  family: "Helvetica",\n  bold: false,\n  italic: false,\n  label: "Helvetica",\n  css: "Helvetica, Arial, sans-serif"\n};\nconst STANDARD_FONT_DESCRIPTORS = Object.freeze([\n  {\n    id: PdfStandardFont.Courier,\n    family: "Courier",\n    bold: false,\n    italic: false,\n    label: "Courier",\n    css: "Courier, monospace"\n  },\n  {\n    id: PdfStandardFont.Courier_Bold,\n    family: "Courier",\n    bold: true,\n    italic: false,\n    label: "Courier Bold",\n    css: \'"Courier-Bold", Courier, monospace\'\n  },\n  {\n    id: PdfStandardFont.Courier_BoldOblique,\n    family: "Courier",\n    bold: true,\n    italic: true,\n    label: "Courier Bold Oblique",\n    css: \'"Courier-BoldOblique", Courier, monospace\'\n  },\n  {\n    id: PdfStandardFont.Courier_Oblique,\n    family: "Courier",\n    bold: false,\n    italic: true,\n    label: "Courier Oblique",\n    css: \'"Courier-Oblique", Courier, monospace\'\n  },\n  HELVETICA_DESC,\n  {\n    id: PdfStandardFont.Helvetica_Bold,\n    family: "Helvetica",\n    bold: true,\n    italic: false,\n    label: "Helvetica Bold",\n    css: \'"Helvetica-Bold", Arial, sans-serif\'\n  },\n  {\n    id: PdfStandardFont.Helvetica_BoldOblique,\n    family: "Helvetica",\n    bold: true,\n    italic: true,\n    label: "Helvetica Bold Oblique",\n    css: \'"Helvetica-BoldOblique", Arial, sans-serif\'\n  },\n  {\n    id: PdfStandardFont.Helvetica_Oblique,\n    family: "Helvetica",\n    bold: false,\n    italic: true,\n    label: "Helvetica Oblique",\n    css: \'"Helvetica-Oblique", Arial, sans-serif\'\n  },\n  {\n    id: PdfStandardFont.Times_Roman,\n    family: "Times",\n    bold: false,\n    italic: false,\n    label: "Times Roman",\n    css: \'"Times New Roman", Times, serif\'\n  },\n  {\n    id: PdfStandardFont.Times_Bold,\n    family: "Times",\n    bold: true,\n    italic: false,\n    label: "Times Bold",\n    css: \'"Times New Roman Bold", Times, serif\'\n  },\n  {\n    id: PdfStandardFont.Times_BoldItalic,\n    family: "Times",\n    bold: true,\n    italic: true,\n    label: "Times Bold Italic",\n    css: \'"Times New Roman Bold Italic", Times, serif\'\n  },\n  {\n    id: PdfStandardFont.Times_Italic,\n    family: "Times",\n    bold: false,\n    italic: true,\n    label: "Times Italic",\n    css: \'"Times New Roman Italic", Times, serif\'\n  },\n  {\n    id: PdfStandardFont.Symbol,\n    family: "Symbol",\n    bold: false,\n    italic: false,\n    label: "Symbol",\n    css: "Symbol"\n  },\n  {\n    id: PdfStandardFont.ZapfDingbats,\n    family: "ZapfDingbats",\n    bold: false,\n    italic: false,\n    label: "Zapf Dingbats",\n    css: "ZapfDingbats"\n  }\n]);\nSTANDARD_FONT_DESCRIPTORS.reduce((m, d) => (m[d.id] = d, m), {});\nconst familyStyleToId = /* @__PURE__ */ new Map();\nfor (const d of STANDARD_FONT_DESCRIPTORS) {\n  familyStyleToId.set(`${d.family}_${d.bold}_${d.italic}`, d.id);\n}\nObject.values(PdfStandardFontFamily).filter(\n  (f) => f !== "Unknown"\n  /* Unknown */\n).map((family) => ({ value: family, label: family }));\n[\n  ...new Set(STANDARD_FONT_DESCRIPTORS.map((d) => d.family))\n];\nconst BLEND_MODE_INFOS = Object.freeze([\n  { id: PdfBlendMode.Normal, label: "Normal", css: "normal" },\n  { id: PdfBlendMode.Multiply, label: "Multiply", css: "multiply" },\n  { id: PdfBlendMode.Screen, label: "Screen", css: "screen" },\n  { id: PdfBlendMode.Overlay, label: "Overlay", css: "overlay" },\n  { id: PdfBlendMode.Darken, label: "Darken", css: "darken" },\n  { id: PdfBlendMode.Lighten, label: "Lighten", css: "lighten" },\n  { id: PdfBlendMode.ColorDodge, label: "Color Dodge", css: "color-dodge" },\n  { id: PdfBlendMode.ColorBurn, label: "Color Burn", css: "color-burn" },\n  { id: PdfBlendMode.HardLight, label: "Hard Light", css: "hard-light" },\n  { id: PdfBlendMode.SoftLight, label: "Soft Light", css: "soft-light" },\n  { id: PdfBlendMode.Difference, label: "Difference", css: "difference" },\n  { id: PdfBlendMode.Exclusion, label: "Exclusion", css: "exclusion" },\n  { id: PdfBlendMode.Hue, label: "Hue", css: "hue" },\n  { id: PdfBlendMode.Saturation, label: "Saturation", css: "saturation" },\n  { id: PdfBlendMode.Color, label: "Color", css: "color" },\n  { id: PdfBlendMode.Luminosity, label: "Luminosity", css: "luminosity" }\n]);\nBLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nBLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.css] = info.id;\n    return m;\n  },\n  {}\n);\nBLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nBLEND_MODE_INFOS.map((info) => info.id);\nfunction deserializeLogger(serialized) {\n  var _a, _b, _c;\n  switch (serialized.type) {\n    case "noop":\n      return new NoopLogger();\n    case "console":\n      return new ConsoleLogger();\n    case "perf":\n      return new PerfLogger();\n    case "level":\n      if (!((_a = serialized.config) == null ? void 0 : _a.logger) || ((_b = serialized.config) == null ? void 0 : _b.level) === void 0) {\n        throw new Error("LevelLogger requires logger and level in config");\n      }\n      return new LevelLogger(deserializeLogger(serialized.config.logger), serialized.config.level);\n    case "all":\n      if (!((_c = serialized.config) == null ? void 0 : _c.loggers)) {\n        throw new Error("AllLogger requires loggers array in config");\n      }\n      return new AllLogger(serialized.config.loggers.map(deserializeLogger));\n    default:\n      return new NoopLogger();\n  }\n}\nconst V4_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\nfunction isUuidV4(str) {\n  return V4_REGEX.test(str);\n}\nfunction getRandomBytes(len) {\n  var _a;\n  if (typeof ((_a = globalThis.crypto) == null ? void 0 : _a.getRandomValues) === "function") {\n    return globalThis.crypto.getRandomValues(new Uint8Array(len));\n  }\n  if (typeof require === "function") {\n    try {\n      const { randomBytes } = require("crypto");\n      return randomBytes(len);\n    } catch {\n    }\n  }\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) bytes[i] = Math.floor(Math.random() * 256);\n  return bytes;\n}\nfunction uuidV4() {\n  var _a;\n  if (typeof ((_a = globalThis.crypto) == null ? void 0 : _a.randomUUID) === "function") {\n    return globalThis.crypto.randomUUID();\n  }\n  const bytes = getRandomBytes(16);\n  bytes[6] = bytes[6] & 15 | 64;\n  bytes[8] = bytes[8] & 63 | 128;\n  const hex = Array.from(bytes, (b) => b.toString(16).padStart(2, "0")).join("");\n  return `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-${hex.slice(16, 20)}-${hex.slice(20)}`;\n}\nvar createPdfium = (() => {\n  var _scriptName = import.meta.url;\n  return async function(moduleArg = {}) {\n    var moduleRtn;\n    var Module = moduleArg;\n    var readyPromiseResolve, readyPromiseReject;\n    var readyPromise = new Promise((resolve, reject) => {\n      readyPromiseResolve = resolve;\n      readyPromiseReject = reject;\n    });\n    [\n      "_EPDF_GetMetaKeyCount",\n      "_EPDF_GetMetaKeyName",\n      "_EPDF_GetMetaTrapped",\n      "_EPDF_GetPageRotationByIndex",\n      "_EPDF_HasMetaText",\n      "_EPDF_PNG_EncodeRGBA",\n      "_EPDF_RenderAnnotBitmap",\n      "_EPDF_SetMetaText",\n      "_EPDF_SetMetaTrapped",\n      "_EPDFAction_CreateGoTo",\n      "_EPDFAction_CreateGoToNamed",\n      "_EPDFAction_CreateLaunch",\n      "_EPDFAction_CreateRemoteGoToByName",\n      "_EPDFAction_CreateRemoteGoToDest",\n      "_EPDFAction_CreateURI",\n      "_EPDFAnnot_ClearColor",\n      "_EPDFAnnot_GenerateAppearance",\n      "_EPDFAnnot_GenerateAppearanceWithBlend",\n      "_EPDFAnnot_GetBlendMode",\n      "_EPDFAnnot_GetBorderDashPattern",\n      "_EPDFAnnot_GetBorderDashPatternCount",\n      "_EPDFAnnot_GetBorderEffect",\n      "_EPDFAnnot_GetBorderStyle",\n      "_EPDFAnnot_GetColor",\n      "_EPDFAnnot_GetDefaultAppearance",\n      "_EPDFAnnot_GetIcon",\n      "_EPDFAnnot_GetIntent",\n      "_EPDFAnnot_GetLineEndings",\n      "_EPDFAnnot_GetOpacity",\n      "_EPDFAnnot_GetRectangleDifferences",\n      "_EPDFAnnot_GetRichContent",\n      "_EPDFAnnot_GetTextAlignment",\n      "_EPDFAnnot_GetVerticalAlignment",\n      "_EPDFAnnot_SetBorderDashPattern",\n      "_EPDFAnnot_SetBorderStyle",\n      "_EPDFAnnot_SetColor",\n      "_EPDFAnnot_SetDefaultAppearance",\n      "_EPDFAnnot_SetIcon",\n      "_EPDFAnnot_SetIntent",\n      "_EPDFAnnot_SetLine",\n      "_EPDFAnnot_SetLineEndings",\n      "_EPDFAnnot_SetLinkedAnnot",\n      "_EPDFAnnot_SetOpacity",\n      "_EPDFAnnot_SetTextAlignment",\n      "_EPDFAnnot_SetVerticalAlignment",\n      "_EPDFAnnot_SetVertices",\n      "_EPDFAnnot_UpdateAppearanceToRect",\n      "_EPDFAttachment_GetDescription",\n      "_EPDFAttachment_GetIntegerValue",\n      "_EPDFAttachment_SetDescription",\n      "_EPDFAttachment_SetSubtype",\n      "_EPDFBookmark_AppendChild",\n      "_EPDFBookmark_Clear",\n      "_EPDFBookmark_ClearTarget",\n      "_EPDFBookmark_Create",\n      "_EPDFBookmark_Delete",\n      "_EPDFBookmark_InsertAfter",\n      "_EPDFBookmark_SetAction",\n      "_EPDFBookmark_SetDest",\n      "_EPDFBookmark_SetTitle",\n      "_EPDFCatalog_GetLanguage",\n      "_EPDFDest_CreateRemoteView",\n      "_EPDFDest_CreateRemoteXYZ",\n      "_EPDFDest_CreateView",\n      "_EPDFDest_CreateXYZ",\n      "_EPDFNamedDest_Remove",\n      "_EPDFNamedDest_SetDest",\n      "_EPDFPage_CreateAnnot",\n      "_EPDFPage_GetAnnotByName",\n      "_EPDFPage_GetAnnotCountRaw",\n      "_EPDFPage_GetAnnotRaw",\n      "_EPDFPage_RemoveAnnotByName",\n      "_EPDFPage_RemoveAnnotRaw",\n      "_EPDFText_RedactInQuads",\n      "_EPDFText_RedactInRect",\n      "_FORM_CanRedo",\n      "_FORM_CanUndo",\n      "_FORM_DoDocumentAAction",\n      "_FORM_DoDocumentJSAction",\n      "_FORM_DoDocumentOpenAction",\n      "_FORM_DoPageAAction",\n      "_FORM_ForceToKillFocus",\n      "_FORM_GetFocusedAnnot",\n      "_FORM_GetFocusedText",\n      "_FORM_GetSelectedText",\n      "_FORM_IsIndexSelected",\n      "_FORM_OnAfterLoadPage",\n      "_FORM_OnBeforeClosePage",\n      "_FORM_OnChar",\n      "_FORM_OnFocus",\n      "_FORM_OnKeyDown",\n      "_FORM_OnKeyUp",\n      "_FORM_OnLButtonDoubleClick",\n      "_FORM_OnLButtonDown",\n      "_FORM_OnLButtonUp",\n      "_FORM_OnMouseMove",\n      "_FORM_OnMouseWheel",\n      "_FORM_OnRButtonDown",\n      "_FORM_OnRButtonUp",\n      "_FORM_Redo",\n      "_FORM_ReplaceAndKeepSelection",\n      "_FORM_ReplaceSelection",\n      "_FORM_SelectAllText",\n      "_FORM_SetFocusedAnnot",\n      "_FORM_SetIndexSelected",\n      "_FORM_Undo",\n      "_FPDF_AddInstalledFont",\n      "_FPDF_CloseDocument",\n      "_FPDF_ClosePage",\n      "_FPDF_CloseXObject",\n      "_FPDF_CopyViewerPreferences",\n      "_FPDF_CountNamedDests",\n      "_FPDF_CreateClipPath",\n      "_FPDF_CreateNewDocument",\n      "_FPDF_DestroyClipPath",\n      "_FPDF_DestroyLibrary",\n      "_FPDF_DeviceToPage",\n      "_FPDF_DocumentHasValidCrossReferenceTable",\n      "_FPDF_FFLDraw",\n      "_FPDF_FreeDefaultSystemFontInfo",\n      "_FPDF_GetDefaultSystemFontInfo",\n      "_FPDF_GetDefaultTTFMap",\n      "_FPDF_GetDefaultTTFMapCount",\n      "_FPDF_GetDefaultTTFMapEntry",\n      "_FPDF_GetDocPermissions",\n      "_FPDF_GetDocUserPermissions",\n      "_FPDF_GetFileIdentifier",\n      "_FPDF_GetFileVersion",\n      "_FPDF_GetFormType",\n      "_FPDF_GetLastError",\n      "_FPDF_GetMetaText",\n      "_FPDF_GetNamedDest",\n      "_FPDF_GetNamedDestByName",\n      "_FPDF_GetPageAAction",\n      "_FPDF_GetPageBoundingBox",\n      "_FPDF_GetPageCount",\n      "_FPDF_GetPageHeight",\n      "_FPDF_GetPageHeightF",\n      "_FPDF_GetPageLabel",\n      "_FPDF_GetPageSizeByIndex",\n      "_FPDF_GetPageSizeByIndexF",\n      "_FPDF_GetPageWidth",\n      "_FPDF_GetPageWidthF",\n      "_FPDF_GetSecurityHandlerRevision",\n      "_FPDF_GetSignatureCount",\n      "_FPDF_GetSignatureObject",\n      "_FPDF_GetTrailerEnds",\n      "_FPDF_GetXFAPacketContent",\n      "_FPDF_GetXFAPacketCount",\n      "_FPDF_GetXFAPacketName",\n      "_FPDF_ImportNPagesToOne",\n      "_FPDF_ImportPages",\n      "_FPDF_ImportPagesByIndex",\n      "_FPDF_InitLibrary",\n      "_FPDF_InitLibraryWithConfig",\n      "_FPDF_LoadCustomDocument",\n      "_FPDF_LoadDocument",\n      "_FPDF_LoadMemDocument",\n      "_FPDF_LoadMemDocument64",\n      "_FPDF_LoadPage",\n      "_FPDF_LoadXFA",\n      "_FPDF_MovePages",\n      "_FPDF_NewFormObjectFromXObject",\n      "_FPDF_NewXObjectFromPage",\n      "_FPDF_PageToDevice",\n      "_FPDF_RemoveFormFieldHighlight",\n      "_FPDF_RenderPage_Close",\n      "_FPDF_RenderPage_Continue",\n      "_FPDF_RenderPageBitmap",\n      "_FPDF_RenderPageBitmap_Start",\n      "_FPDF_RenderPageBitmapWithColorScheme_Start",\n      "_FPDF_RenderPageBitmapWithMatrix",\n      "_FPDF_SaveAsCopy",\n      "_FPDF_SaveWithVersion",\n      "_FPDF_SetFormFieldHighlightAlpha",\n      "_FPDF_SetFormFieldHighlightColor",\n      "_FPDF_SetSandBoxPolicy",\n      "_FPDF_SetSystemFontInfo",\n      "_FPDF_StructElement_Attr_CountChildren",\n      "_FPDF_StructElement_Attr_GetBlobValue",\n      "_FPDF_StructElement_Attr_GetBooleanValue",\n      "_FPDF_StructElement_Attr_GetChildAtIndex",\n      "_FPDF_StructElement_Attr_GetCount",\n      "_FPDF_StructElement_Attr_GetName",\n      "_FPDF_StructElement_Attr_GetNumberValue",\n      "_FPDF_StructElement_Attr_GetStringValue",\n      "_FPDF_StructElement_Attr_GetType",\n      "_FPDF_StructElement_Attr_GetValue",\n      "_FPDF_StructElement_CountChildren",\n      "_FPDF_StructElement_GetActualText",\n      "_FPDF_StructElement_GetAltText",\n      "_FPDF_StructElement_GetAttributeAtIndex",\n      "_FPDF_StructElement_GetAttributeCount",\n      "_FPDF_StructElement_GetChildAtIndex",\n      "_FPDF_StructElement_GetChildMarkedContentID",\n      "_FPDF_StructElement_GetID",\n      "_FPDF_StructElement_GetLang",\n      "_FPDF_StructElement_GetMarkedContentID",\n      "_FPDF_StructElement_GetMarkedContentIdAtIndex",\n      "_FPDF_StructElement_GetMarkedContentIdCount",\n      "_FPDF_StructElement_GetObjType",\n      "_FPDF_StructElement_GetParent",\n      "_FPDF_StructElement_GetStringAttribute",\n      "_FPDF_StructElement_GetTitle",\n      "_FPDF_StructElement_GetType",\n      "_FPDF_StructTree_Close",\n      "_FPDF_StructTree_CountChildren",\n      "_FPDF_StructTree_GetChildAtIndex",\n      "_FPDF_StructTree_GetForPage",\n      "_FPDF_VIEWERREF_GetDuplex",\n      "_FPDF_VIEWERREF_GetName",\n      "_FPDF_VIEWERREF_GetNumCopies",\n      "_FPDF_VIEWERREF_GetPrintPageRange",\n      "_FPDF_VIEWERREF_GetPrintPageRangeCount",\n      "_FPDF_VIEWERREF_GetPrintPageRangeElement",\n      "_FPDF_VIEWERREF_GetPrintScaling",\n      "_FPDFAction_GetDest",\n      "_FPDFAction_GetFilePath",\n      "_FPDFAction_GetType",\n      "_FPDFAction_GetURIPath",\n      "_FPDFAnnot_AddFileAttachment",\n      "_FPDFAnnot_AddInkStroke",\n      "_FPDFAnnot_AppendAttachmentPoints",\n      "_FPDFAnnot_AppendObject",\n      "_FPDFAnnot_CountAttachmentPoints",\n      "_FPDFAnnot_GetAP",\n      "_FPDFAnnot_GetAttachmentPoints",\n      "_FPDFAnnot_GetBorder",\n      "_FPDFAnnot_GetColor",\n      "_FPDFAnnot_GetFileAttachment",\n      "_FPDFAnnot_GetFlags",\n      "_FPDFAnnot_GetFocusableSubtypes",\n      "_FPDFAnnot_GetFocusableSubtypesCount",\n      "_FPDFAnnot_GetFontColor",\n      "_FPDFAnnot_GetFontSize",\n      "_FPDFAnnot_GetFormAdditionalActionJavaScript",\n      "_FPDFAnnot_GetFormControlCount",\n      "_FPDFAnnot_GetFormControlIndex",\n      "_FPDFAnnot_GetFormFieldAlternateName",\n      "_FPDFAnnot_GetFormFieldAtPoint",\n      "_FPDFAnnot_GetFormFieldExportValue",\n      "_FPDFAnnot_GetFormFieldFlags",\n      "_FPDFAnnot_GetFormFieldName",\n      "_FPDFAnnot_GetFormFieldType",\n      "_FPDFAnnot_GetFormFieldValue",\n      "_FPDFAnnot_GetInkListCount",\n      "_FPDFAnnot_GetInkListPath",\n      "_FPDFAnnot_GetLine",\n      "_FPDFAnnot_GetLink",\n      "_FPDFAnnot_GetLinkedAnnot",\n      "_FPDFAnnot_GetNumberValue",\n      "_FPDFAnnot_GetObject",\n      "_FPDFAnnot_GetObjectCount",\n      "_FPDFAnnot_GetOptionCount",\n      "_FPDFAnnot_GetOptionLabel",\n      "_FPDFAnnot_GetRect",\n      "_FPDFAnnot_GetStringValue",\n      "_FPDFAnnot_GetSubtype",\n      "_FPDFAnnot_GetValueType",\n      "_FPDFAnnot_GetVertices",\n      "_FPDFAnnot_HasAttachmentPoints",\n      "_FPDFAnnot_HasKey",\n      "_FPDFAnnot_IsChecked",\n      "_FPDFAnnot_IsObjectSupportedSubtype",\n      "_FPDFAnnot_IsOptionSelected",\n      "_FPDFAnnot_IsSupportedSubtype",\n      "_FPDFAnnot_RemoveInkList",\n      "_FPDFAnnot_RemoveObject",\n      "_FPDFAnnot_SetAP",\n      "_FPDFAnnot_SetAttachmentPoints",\n      "_FPDFAnnot_SetBorder",\n      "_FPDFAnnot_SetColor",\n      "_FPDFAnnot_SetFlags",\n      "_FPDFAnnot_SetFocusableSubtypes",\n      "_FPDFAnnot_SetFontColor",\n      "_FPDFAnnot_SetFormFieldFlags",\n      "_FPDFAnnot_SetRect",\n      "_FPDFAnnot_SetStringValue",\n      "_FPDFAnnot_SetURI",\n      "_FPDFAnnot_UpdateObject",\n      "_FPDFAttachment_GetFile",\n      "_FPDFAttachment_GetName",\n      "_FPDFAttachment_GetStringValue",\n      "_FPDFAttachment_GetSubtype",\n      "_FPDFAttachment_GetValueType",\n      "_FPDFAttachment_HasKey",\n      "_FPDFAttachment_SetFile",\n      "_FPDFAttachment_SetStringValue",\n      "_FPDFAvail_Create",\n      "_FPDFAvail_Destroy",\n      "_FPDFAvail_GetDocument",\n      "_FPDFAvail_GetFirstPageNum",\n      "_FPDFAvail_IsDocAvail",\n      "_FPDFAvail_IsFormAvail",\n      "_FPDFAvail_IsLinearized",\n      "_FPDFAvail_IsPageAvail",\n      "_FPDFBitmap_Create",\n      "_FPDFBitmap_CreateEx",\n      "_FPDFBitmap_Destroy",\n      "_FPDFBitmap_FillRect",\n      "_FPDFBitmap_GetBuffer",\n      "_FPDFBitmap_GetFormat",\n      "_FPDFBitmap_GetHeight",\n      "_FPDFBitmap_GetStride",\n      "_FPDFBitmap_GetWidth",\n      "_FPDFBookmark_Find",\n      "_FPDFBookmark_GetAction",\n      "_FPDFBookmark_GetCount",\n      "_FPDFBookmark_GetDest",\n      "_FPDFBookmark_GetFirstChild",\n      "_FPDFBookmark_GetNextSibling",\n      "_FPDFBookmark_GetTitle",\n      "_FPDFCatalog_IsTagged",\n      "_FPDFCatalog_SetLanguage",\n      "_FPDFClipPath_CountPaths",\n      "_FPDFClipPath_CountPathSegments",\n      "_FPDFClipPath_GetPathSegment",\n      "_FPDFDest_GetDestPageIndex",\n      "_FPDFDest_GetLocationInPage",\n      "_FPDFDest_GetView",\n      "_FPDFDoc_AddAttachment",\n      "_FPDFDoc_CloseJavaScriptAction",\n      "_FPDFDoc_DeleteAttachment",\n      "_FPDFDOC_ExitFormFillEnvironment",\n      "_FPDFDoc_GetAttachment",\n      "_FPDFDoc_GetAttachmentCount",\n      "_FPDFDoc_GetJavaScriptAction",\n      "_FPDFDoc_GetJavaScriptActionCount",\n      "_FPDFDoc_GetPageMode",\n      "_FPDFDOC_InitFormFillEnvironment",\n      "_FPDFFont_Close",\n      "_FPDFFont_GetAscent",\n      "_FPDFFont_GetBaseFontName",\n      "_FPDFFont_GetDescent",\n      "_FPDFFont_GetFamilyName",\n      "_FPDFFont_GetFlags",\n      "_FPDFFont_GetFontData",\n      "_FPDFFont_GetGlyphPath",\n      "_FPDFFont_GetGlyphWidth",\n      "_FPDFFont_GetIsEmbedded",\n      "_FPDFFont_GetItalicAngle",\n      "_FPDFFont_GetWeight",\n      "_FPDFFormObj_CountObjects",\n      "_FPDFFormObj_GetObject",\n      "_FPDFFormObj_RemoveObject",\n      "_FPDFGlyphPath_CountGlyphSegments",\n      "_FPDFGlyphPath_GetGlyphPathSegment",\n      "_FPDFImageObj_GetBitmap",\n      "_FPDFImageObj_GetIccProfileDataDecoded",\n      "_FPDFImageObj_GetImageDataDecoded",\n      "_FPDFImageObj_GetImageDataRaw",\n      "_FPDFImageObj_GetImageFilter",\n      "_FPDFImageObj_GetImageFilterCount",\n      "_FPDFImageObj_GetImageMetadata",\n      "_FPDFImageObj_GetImagePixelSize",\n      "_FPDFImageObj_GetRenderedBitmap",\n      "_FPDFImageObj_LoadJpegFile",\n      "_FPDFImageObj_LoadJpegFileInline",\n      "_FPDFImageObj_SetBitmap",\n      "_FPDFImageObj_SetMatrix",\n      "_FPDFJavaScriptAction_GetName",\n      "_FPDFJavaScriptAction_GetScript",\n      "_FPDFLink_CloseWebLinks",\n      "_FPDFLink_CountQuadPoints",\n      "_FPDFLink_CountRects",\n      "_FPDFLink_CountWebLinks",\n      "_FPDFLink_Enumerate",\n      "_FPDFLink_GetAction",\n      "_FPDFLink_GetAnnot",\n      "_FPDFLink_GetAnnotRect",\n      "_FPDFLink_GetDest",\n      "_FPDFLink_GetLinkAtPoint",\n      "_FPDFLink_GetLinkZOrderAtPoint",\n      "_FPDFLink_GetQuadPoints",\n      "_FPDFLink_GetRect",\n      "_FPDFLink_GetTextRange",\n      "_FPDFLink_GetURL",\n      "_FPDFLink_LoadWebLinks",\n      "_FPDFPage_CloseAnnot",\n      "_FPDFPage_CountObjects",\n      "_FPDFPage_CreateAnnot",\n      "_FPDFPage_Delete",\n      "_FPDFPage_Flatten",\n      "_FPDFPage_FormFieldZOrderAtPoint",\n      "_FPDFPage_GenerateContent",\n      "_FPDFPage_GetAnnot",\n      "_FPDFPage_GetAnnotCount",\n      "_FPDFPage_GetAnnotIndex",\n      "_FPDFPage_GetArtBox",\n      "_FPDFPage_GetBleedBox",\n      "_FPDFPage_GetCropBox",\n      "_FPDFPage_GetDecodedThumbnailData",\n      "_FPDFPage_GetMediaBox",\n      "_FPDFPage_GetObject",\n      "_FPDFPage_GetRawThumbnailData",\n      "_FPDFPage_GetRotation",\n      "_FPDFPage_GetThumbnailAsBitmap",\n      "_FPDFPage_GetTrimBox",\n      "_FPDFPage_HasFormFieldAtPoint",\n      "_FPDFPage_HasTransparency",\n      "_FPDFPage_InsertClipPath",\n      "_FPDFPage_InsertObject",\n      "_FPDFPage_InsertObjectAtIndex",\n      "_FPDFPage_New",\n      "_FPDFPage_RemoveAnnot",\n      "_FPDFPage_RemoveObject",\n      "_FPDFPage_SetArtBox",\n      "_FPDFPage_SetBleedBox",\n      "_FPDFPage_SetCropBox",\n      "_FPDFPage_SetMediaBox",\n      "_FPDFPage_SetRotation",\n      "_FPDFPage_SetTrimBox",\n      "_FPDFPage_TransformAnnots",\n      "_FPDFPage_TransFormWithClip",\n      "_FPDFPageObj_AddMark",\n      "_FPDFPageObj_CountMarks",\n      "_FPDFPageObj_CreateNewPath",\n      "_FPDFPageObj_CreateNewRect",\n      "_FPDFPageObj_CreateTextObj",\n      "_FPDFPageObj_Destroy",\n      "_FPDFPageObj_GetBounds",\n      "_FPDFPageObj_GetClipPath",\n      "_FPDFPageObj_GetDashArray",\n      "_FPDFPageObj_GetDashCount",\n      "_FPDFPageObj_GetDashPhase",\n      "_FPDFPageObj_GetFillColor",\n      "_FPDFPageObj_GetIsActive",\n      "_FPDFPageObj_GetLineCap",\n      "_FPDFPageObj_GetLineJoin",\n      "_FPDFPageObj_GetMark",\n      "_FPDFPageObj_GetMarkedContentID",\n      "_FPDFPageObj_GetMatrix",\n      "_FPDFPageObj_GetRotatedBounds",\n      "_FPDFPageObj_GetStrokeColor",\n      "_FPDFPageObj_GetStrokeWidth",\n      "_FPDFPageObj_GetType",\n      "_FPDFPageObj_HasTransparency",\n      "_FPDFPageObj_NewImageObj",\n      "_FPDFPageObj_NewTextObj",\n      "_FPDFPageObj_RemoveMark",\n      "_FPDFPageObj_SetBlendMode",\n      "_FPDFPageObj_SetDashArray",\n      "_FPDFPageObj_SetDashPhase",\n      "_FPDFPageObj_SetFillColor",\n      "_FPDFPageObj_SetIsActive",\n      "_FPDFPageObj_SetLineCap",\n      "_FPDFPageObj_SetLineJoin",\n      "_FPDFPageObj_SetMatrix",\n      "_FPDFPageObj_SetStrokeColor",\n      "_FPDFPageObj_SetStrokeWidth",\n      "_FPDFPageObj_Transform",\n      "_FPDFPageObj_TransformClipPath",\n      "_FPDFPageObj_TransformF",\n      "_FPDFPageObjMark_CountParams",\n      "_FPDFPageObjMark_GetName",\n      "_FPDFPageObjMark_GetParamBlobValue",\n      "_FPDFPageObjMark_GetParamIntValue",\n      "_FPDFPageObjMark_GetParamKey",\n      "_FPDFPageObjMark_GetParamStringValue",\n      "_FPDFPageObjMark_GetParamValueType",\n      "_FPDFPageObjMark_RemoveParam",\n      "_FPDFPageObjMark_SetBlobParam",\n      "_FPDFPageObjMark_SetIntParam",\n      "_FPDFPageObjMark_SetStringParam",\n      "_FPDFPath_BezierTo",\n      "_FPDFPath_Close",\n      "_FPDFPath_CountSegments",\n      "_FPDFPath_GetDrawMode",\n      "_FPDFPath_GetPathSegment",\n      "_FPDFPath_LineTo",\n      "_FPDFPath_MoveTo",\n      "_FPDFPath_SetDrawMode",\n      "_FPDFPathSegment_GetClose",\n      "_FPDFPathSegment_GetPoint",\n      "_FPDFPathSegment_GetType",\n      "_FPDFSignatureObj_GetByteRange",\n      "_FPDFSignatureObj_GetContents",\n      "_FPDFSignatureObj_GetDocMDPPermission",\n      "_FPDFSignatureObj_GetReason",\n      "_FPDFSignatureObj_GetSubFilter",\n      "_FPDFSignatureObj_GetTime",\n      "_FPDFText_ClosePage",\n      "_FPDFText_CountChars",\n      "_FPDFText_CountRects",\n      "_FPDFText_FindClose",\n      "_FPDFText_FindNext",\n      "_FPDFText_FindPrev",\n      "_FPDFText_FindStart",\n      "_FPDFText_GetBoundedText",\n      "_FPDFText_GetCharAngle",\n      "_FPDFText_GetCharBox",\n      "_FPDFText_GetCharIndexAtPos",\n      "_FPDFText_GetCharIndexFromTextIndex",\n      "_FPDFText_GetCharOrigin",\n      "_FPDFText_GetFillColor",\n      "_FPDFText_GetFontInfo",\n      "_FPDFText_GetFontSize",\n      "_FPDFText_GetFontWeight",\n      "_FPDFText_GetLooseCharBox",\n      "_FPDFText_GetMatrix",\n      "_FPDFText_GetRect",\n      "_FPDFText_GetSchCount",\n      "_FPDFText_GetSchResultIndex",\n      "_FPDFText_GetStrokeColor",\n      "_FPDFText_GetText",\n      "_FPDFText_GetTextIndexFromCharIndex",\n      "_FPDFText_GetTextObject",\n      "_FPDFText_GetUnicode",\n      "_FPDFText_HasUnicodeMapError",\n      "_FPDFText_IsGenerated",\n      "_FPDFText_IsHyphen",\n      "_FPDFText_LoadCidType2Font",\n      "_FPDFText_LoadFont",\n      "_FPDFText_LoadPage",\n      "_FPDFText_LoadStandardFont",\n      "_FPDFText_SetCharcodes",\n      "_FPDFText_SetText",\n      "_FPDFTextObj_GetFont",\n      "_FPDFTextObj_GetFontSize",\n      "_FPDFTextObj_GetRenderedBitmap",\n      "_FPDFTextObj_GetText",\n      "_FPDFTextObj_GetTextRenderMode",\n      "_FPDFTextObj_SetTextRenderMode",\n      "_PDFiumExt_CloseFileWriter",\n      "_PDFiumExt_CloseFormFillInfo",\n      "_PDFiumExt_ExitFormFillEnvironment",\n      "_PDFiumExt_GetFileWriterData",\n      "_PDFiumExt_GetFileWriterSize",\n      "_PDFiumExt_Init",\n      "_PDFiumExt_InitFormFillEnvironment",\n      "_PDFiumExt_OpenFileWriter",\n      "_PDFiumExt_OpenFormFillInfo",\n      "_PDFiumExt_SaveAsCopy",\n      "_malloc",\n      "_free",\n      "_memory",\n      "___indirect_function_table",\n      "onRuntimeInitialized"\n    ].forEach((prop) => {\n      if (!Object.getOwnPropertyDescriptor(readyPromise, prop)) {\n        Object.defineProperty(readyPromise, prop, {\n          get: () => abort(\n            "You are getting " + prop + " on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"\n          ),\n          set: () => abort(\n            "You are setting " + prop + " on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"\n          )\n        });\n      }\n    });\n    var ENVIRONMENT_IS_WEB = typeof window == "object";\n    var ENVIRONMENT_IS_WORKER = typeof importScripts == "function";\n    typeof process == "object" && typeof process.versions == "object" && typeof process.versions.node == "string" && process.type != "renderer";\n    var ENVIRONMENT_IS_SHELL = !ENVIRONMENT_IS_WEB && true && !ENVIRONMENT_IS_WORKER;\n    var moduleOverrides = Object.assign({}, Module);\n    var thisProgram = "./this.program";\n    var scriptDirectory = "";\n    function locateFile(path) {\n      if (Module["locateFile"]) {\n        return Module["locateFile"](path, scriptDirectory);\n      }\n      return scriptDirectory + path;\n    }\n    var readAsync, readBinary;\n    if (ENVIRONMENT_IS_SHELL) {\n      if (typeof window == "object" || typeof importScripts == "function")\n        throw new Error(\n          "not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)"\n        );\n      readBinary = (f) => {\n        if (typeof readbuffer == "function") {\n          return new Uint8Array(readbuffer(f));\n        }\n        let data = read(f, "binary");\n        assert(typeof data == "object");\n        return data;\n      };\n      readAsync = (f) => {\n        return new Promise((resolve, reject) => {\n          setTimeout(() => resolve(readBinary(f)));\n        });\n      };\n      globalThis.clearTimeout ?? (globalThis.clearTimeout = (id) => {\n      });\n      globalThis.setTimeout ?? (globalThis.setTimeout = (f) => typeof f == "function" ? f() : abort());\n      if (typeof print != "undefined") {\n        globalThis.console ?? (globalThis.console = /** @type{!Console} */\n        {});\n        console.log = /** @type{!function(this:Console, ...*): undefined} */\n        print;\n        console.warn = console.error = /** @type{!function(this:Console, ...*): undefined} */\n        globalThis.printErr ?? print;\n      }\n    } else if (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) {\n      if (ENVIRONMENT_IS_WORKER) {\n        scriptDirectory = self.location.href;\n      } else if (typeof document != "undefined" && document.currentScript) {\n        scriptDirectory = document.currentScript.src;\n      }\n      if (_scriptName) {\n        scriptDirectory = _scriptName;\n      }\n      if (scriptDirectory.startsWith("blob:")) {\n        scriptDirectory = "";\n      } else {\n        scriptDirectory = scriptDirectory.substr(\n          0,\n          scriptDirectory.replace(/[?#].*/, "").lastIndexOf("/") + 1\n        );\n      }\n      if (!(typeof window == "object" || typeof importScripts == "function"))\n        throw new Error(\n          "not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)"\n        );\n      {\n        if (ENVIRONMENT_IS_WORKER) {\n          readBinary = (url) => {\n            var xhr = new XMLHttpRequest();\n            xhr.open("GET", url, false);\n            xhr.responseType = "arraybuffer";\n            xhr.send(null);\n            return new Uint8Array(\n              /** @type{!ArrayBuffer} */\n              xhr.response\n            );\n          };\n        }\n        readAsync = (url) => {\n          assert(!isFileURI(url), "readAsync does not work with file:// URLs");\n          return fetch(url, { credentials: "same-origin" }).then((response) => {\n            if (response.ok) {\n              return response.arrayBuffer();\n            }\n            return Promise.reject(new Error(response.status + " : " + response.url));\n          });\n        };\n      }\n    } else {\n      throw new Error("environment detection error");\n    }\n    var out = Module["print"] || console.log.bind(console);\n    var err = Module["printErr"] || console.error.bind(console);\n    Object.assign(Module, moduleOverrides);\n    moduleOverrides = null;\n    checkIncomingModuleAPI();\n    if (Module["arguments"]) Module["arguments"];\n    legacyModuleProp("arguments", "arguments_");\n    if (Module["thisProgram"]) thisProgram = Module["thisProgram"];\n    legacyModuleProp("thisProgram", "thisProgram");\n    assert(\n      typeof Module["memoryInitializerPrefixURL"] == "undefined",\n      "Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"\n    );\n    assert(\n      typeof Module["pthreadMainPrefixURL"] == "undefined",\n      "Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"\n    );\n    assert(\n      typeof Module["cdInitializerPrefixURL"] == "undefined",\n      "Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"\n    );\n    assert(\n      typeof Module["filePackagePrefixURL"] == "undefined",\n      "Module.filePackagePrefixURL option was removed, use Module.locateFile instead"\n    );\n    assert(typeof Module["read"] == "undefined", "Module.read option was removed");\n    assert(\n      typeof Module["readAsync"] == "undefined",\n      "Module.readAsync option was removed (modify readAsync in JS)"\n    );\n    assert(\n      typeof Module["readBinary"] == "undefined",\n      "Module.readBinary option was removed (modify readBinary in JS)"\n    );\n    assert(\n      typeof Module["setWindowTitle"] == "undefined",\n      "Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"\n    );\n    assert(\n      typeof Module["TOTAL_MEMORY"] == "undefined",\n      "Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"\n    );\n    legacyModuleProp("asm", "wasmExports");\n    legacyModuleProp("readAsync", "readAsync");\n    legacyModuleProp("readBinary", "readBinary");\n    legacyModuleProp("setWindowTitle", "setWindowTitle");\n    var wasmBinary = Module["wasmBinary"];\n    legacyModuleProp("wasmBinary", "wasmBinary");\n    if (typeof WebAssembly != "object") {\n      err("no native wasm support detected");\n    }\n    var wasmMemory;\n    var ABORT = false;\n    function assert(condition, text) {\n      if (!condition) {\n        abort("Assertion failed" + (text ? ": " + text : ""));\n      }\n    }\n    var HEAP8, HEAPU8, HEAP16, HEAPU16, HEAP32, HEAPU32, HEAPF32, HEAPF64;\n    function updateMemoryViews() {\n      var b = wasmMemory.buffer;\n      Module["HEAP8"] = HEAP8 = new Int8Array(b);\n      Module["HEAP16"] = HEAP16 = new Int16Array(b);\n      Module["HEAPU8"] = HEAPU8 = new Uint8Array(b);\n      Module["HEAPU16"] = HEAPU16 = new Uint16Array(b);\n      Module["HEAP32"] = HEAP32 = new Int32Array(b);\n      Module["HEAPU32"] = HEAPU32 = new Uint32Array(b);\n      Module["HEAPF32"] = HEAPF32 = new Float32Array(b);\n      Module["HEAPF64"] = HEAPF64 = new Float64Array(b);\n    }\n    assert(\n      !Module["STACK_SIZE"],\n      "STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"\n    );\n    assert(\n      typeof Int32Array != "undefined" && typeof Float64Array !== "undefined" && Int32Array.prototype.subarray != void 0 && Int32Array.prototype.set != void 0,\n      "JS engine does not provide full typed array support"\n    );\n    assert(\n      !Module["wasmMemory"],\n      "Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"\n    );\n    assert(\n      !Module["INITIAL_MEMORY"],\n      "Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically"\n    );\n    function writeStackCookie() {\n      var max = _emscripten_stack_get_end();\n      assert((max & 3) == 0);\n      if (max == 0) {\n        max += 4;\n      }\n      HEAPU32[max >> 2] = 34821223;\n      HEAPU32[max + 4 >> 2] = 2310721022;\n      HEAPU32[0 >> 2] = 1668509029;\n    }\n    function checkStackCookie() {\n      if (ABORT) return;\n      var max = _emscripten_stack_get_end();\n      if (max == 0) {\n        max += 4;\n      }\n      var cookie1 = HEAPU32[max >> 2];\n      var cookie2 = HEAPU32[max + 4 >> 2];\n      if (cookie1 != 34821223 || cookie2 != 2310721022) {\n        abort(\n          `Stack overflow! Stack cookie has been overwritten at ${ptrToString(max)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${ptrToString(cookie2)} ${ptrToString(cookie1)}`\n        );\n      }\n      if (HEAPU32[0 >> 2] != 1668509029) {\n        abort("Runtime error: The application has corrupted its heap memory area (address zero)!");\n      }\n    }\n    var __ATPRERUN__ = [];\n    var __ATINIT__ = [];\n    var __ATPOSTRUN__ = [];\n    var runtimeInitialized = false;\n    function preRun() {\n      var preRuns = Module["preRun"];\n      if (preRuns) {\n        if (typeof preRuns == "function") preRuns = [preRuns];\n        preRuns.forEach(addOnPreRun);\n      }\n      callRuntimeCallbacks(__ATPRERUN__);\n    }\n    function initRuntime() {\n      assert(!runtimeInitialized);\n      runtimeInitialized = true;\n      checkStackCookie();\n      if (!Module["noFSInit"] && !FS.initialized) FS.init();\n      FS.ignorePermissions = false;\n      callRuntimeCallbacks(__ATINIT__);\n    }\n    function postRun() {\n      checkStackCookie();\n      var postRuns = Module["postRun"];\n      if (postRuns) {\n        if (typeof postRuns == "function") postRuns = [postRuns];\n        postRuns.forEach(addOnPostRun);\n      }\n      callRuntimeCallbacks(__ATPOSTRUN__);\n    }\n    function addOnPreRun(cb) {\n      __ATPRERUN__.unshift(cb);\n    }\n    function addOnInit(cb) {\n      __ATINIT__.unshift(cb);\n    }\n    function addOnPostRun(cb) {\n      __ATPOSTRUN__.unshift(cb);\n    }\n    assert(\n      Math.imul,\n      "This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"\n    );\n    assert(\n      Math.fround,\n      "This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"\n    );\n    assert(\n      Math.clz32,\n      "This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"\n    );\n    assert(\n      Math.trunc,\n      "This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"\n    );\n    var runDependencies = 0;\n    var runDependencyWatcher = null;\n    var dependenciesFulfilled = null;\n    var runDependencyTracking = {};\n    function getUniqueRunDependency(id) {\n      var orig = id;\n      while (1) {\n        if (!runDependencyTracking[id]) return id;\n        id = orig + Math.random();\n      }\n    }\n    function addRunDependency(id) {\n      var _a;\n      runDependencies++;\n      (_a = Module["monitorRunDependencies"]) == null ? void 0 : _a.call(Module, runDependencies);\n      if (id) {\n        assert(!runDependencyTracking[id]);\n        runDependencyTracking[id] = 1;\n        if (runDependencyWatcher === null && typeof setInterval != "undefined") {\n          runDependencyWatcher = setInterval(() => {\n            if (ABORT) {\n              clearInterval(runDependencyWatcher);\n              runDependencyWatcher = null;\n              return;\n            }\n            var shown = false;\n            for (var dep in runDependencyTracking) {\n              if (!shown) {\n                shown = true;\n                err("still waiting on run dependencies:");\n              }\n              err(`dependency: ${dep}`);\n            }\n            if (shown) {\n              err("(end of list)");\n            }\n          }, 1e4);\n        }\n      } else {\n        err("warning: run dependency added without ID");\n      }\n    }\n    function removeRunDependency(id) {\n      var _a;\n      runDependencies--;\n      (_a = Module["monitorRunDependencies"]) == null ? void 0 : _a.call(Module, runDependencies);\n      if (id) {\n        assert(runDependencyTracking[id]);\n        delete runDependencyTracking[id];\n      } else {\n        err("warning: run dependency removed without ID");\n      }\n      if (runDependencies == 0) {\n        if (runDependencyWatcher !== null) {\n          clearInterval(runDependencyWatcher);\n          runDependencyWatcher = null;\n        }\n        if (dependenciesFulfilled) {\n          var callback = dependenciesFulfilled;\n          dependenciesFulfilled = null;\n          callback();\n        }\n      }\n    }\n    function abort(what) {\n      var _a;\n      (_a = Module["onAbort"]) == null ? void 0 : _a.call(Module, what);\n      what = "Aborted(" + what + ")";\n      err(what);\n      ABORT = true;\n      var e = new WebAssembly.RuntimeError(what);\n      readyPromiseReject(e);\n      throw e;\n    }\n    var dataURIPrefix = "data:application/octet-stream;base64,";\n    var isDataURI = (filename) => filename.startsWith(dataURIPrefix);\n    var isFileURI = (filename) => filename.startsWith("file://");\n    function createExportWrapper(name, nargs) {\n      return (...args) => {\n        assert(\n          runtimeInitialized,\n          `native function \\`${name}\\` called before runtime initialization`\n        );\n        var f = wasmExports[name];\n        assert(f, `exported native function \\`${name}\\` not found`);\n        assert(\n          args.length <= nargs,\n          `native function \\`${name}\\` called with ${args.length} args but expects ${nargs}`\n        );\n        return f(...args);\n      };\n    }\n    function findWasmBinary() {\n      if (Module["locateFile"]) {\n        var f = "pdfium.wasm";\n        if (!isDataURI(f)) {\n          return locateFile(f);\n        }\n        return f;\n      }\n      if (ENVIRONMENT_IS_SHELL) return "pdfium.wasm";\n      return "pdfium.wasm";\n    }\n    var wasmBinaryFile;\n    function getBinarySync(file) {\n      if (file == wasmBinaryFile && wasmBinary) {\n        return new Uint8Array(wasmBinary);\n      }\n      if (readBinary) {\n        return readBinary(file);\n      }\n      throw "both async and sync fetching of the wasm failed";\n    }\n    function getBinaryPromise(binaryFile) {\n      if (!wasmBinary) {\n        return readAsync(binaryFile).then(\n          (response) => new Uint8Array(\n            /** @type{!ArrayBuffer} */\n            response\n          ),\n          // Fall back to getBinarySync if readAsync fails\n          () => getBinarySync(binaryFile)\n        );\n      }\n      return Promise.resolve().then(() => getBinarySync(binaryFile));\n    }\n    function instantiateArrayBuffer(binaryFile, imports, receiver) {\n      return getBinaryPromise(binaryFile).then((binary) => {\n        return WebAssembly.instantiate(binary, imports);\n      }).then(receiver, (reason) => {\n        err(`failed to asynchronously prepare wasm: ${reason}`);\n        if (isFileURI(wasmBinaryFile)) {\n          err(\n            `warning: Loading from a file URI (${wasmBinaryFile}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`\n          );\n        }\n        abort(reason);\n      });\n    }\n    function instantiateAsync(binary, binaryFile, imports, callback) {\n      if (!binary && typeof WebAssembly.instantiateStreaming == "function" && !isDataURI(binaryFile) && // Avoid instantiateStreaming() on Node.js environment for now, as while\n      // Node.js v18.1.0 implements it, it does not have a full fetch()\n      // implementation yet.\n      //\n      // Reference:\n      //   https://github.com/emscripten-core/emscripten/pull/16917\n      true && typeof fetch == "function") {\n        return fetch(binaryFile, { credentials: "same-origin" }).then((response) => {\n          var result = WebAssembly.instantiateStreaming(response, imports);\n          return result.then(callback, function(reason) {\n            err(`wasm streaming compile failed: ${reason}`);\n            err("falling back to ArrayBuffer instantiation");\n            return instantiateArrayBuffer(binaryFile, imports, callback);\n          });\n        });\n      }\n      return instantiateArrayBuffer(binaryFile, imports, callback);\n    }\n    function getWasmImports() {\n      return {\n        env: wasmImports,\n        wasi_snapshot_preview1: wasmImports\n      };\n    }\n    function createWasm() {\n      var info = getWasmImports();\n      function receiveInstance(instance, module) {\n        wasmExports = instance.exports;\n        Module["wasmExports"] = wasmExports;\n        wasmMemory = wasmExports["memory"];\n        assert(wasmMemory, "memory not found in wasm exports");\n        updateMemoryViews();\n        wasmTable = wasmExports["__indirect_function_table"];\n        assert(wasmTable, "table not found in wasm exports");\n        addOnInit(wasmExports["__wasm_call_ctors"]);\n        removeRunDependency("wasm-instantiate");\n        return wasmExports;\n      }\n      addRunDependency("wasm-instantiate");\n      var trueModule = Module;\n      function receiveInstantiationResult(result) {\n        assert(\n          Module === trueModule,\n          "the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"\n        );\n        trueModule = null;\n        receiveInstance(result["instance"]);\n      }\n      if (Module["instantiateWasm"]) {\n        try {\n          return Module["instantiateWasm"](info, receiveInstance);\n        } catch (e) {\n          err(`Module.instantiateWasm callback failed with error: ${e}`);\n          readyPromiseReject(e);\n        }\n      }\n      wasmBinaryFile ?? (wasmBinaryFile = findWasmBinary());\n      instantiateAsync(wasmBinary, wasmBinaryFile, info, receiveInstantiationResult).catch(\n        readyPromiseReject\n      );\n      return {};\n    }\n    var tempDouble;\n    var tempI64;\n    (() => {\n      var h16 = new Int16Array(1);\n      var h8 = new Int8Array(h16.buffer);\n      h16[0] = 25459;\n      if (h8[0] !== 115 || h8[1] !== 99)\n        throw "Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)";\n    })();\n    if (Module["ENVIRONMENT"]) {\n      throw new Error(\n        "Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)"\n      );\n    }\n    function legacyModuleProp(prop, newName, incoming = true) {\n      if (!Object.getOwnPropertyDescriptor(Module, prop)) {\n        Object.defineProperty(Module, prop, {\n          configurable: true,\n          get() {\n            let extra = incoming ? " (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)" : "";\n            abort(`\\`Module.${prop}\\` has been replaced by \\`${newName}\\`` + extra);\n          }\n        });\n      }\n    }\n    function ignoredModuleProp(prop) {\n      if (Object.getOwnPropertyDescriptor(Module, prop)) {\n        abort(\n          `\\`Module.${prop}\\` was supplied but \\`${prop}\\` not included in INCOMING_MODULE_JS_API`\n        );\n      }\n    }\n    function isExportedByForceFilesystem(name) {\n      return name === "FS_createPath" || name === "FS_createDataFile" || name === "FS_createPreloadedFile" || name === "FS_unlink" || name === "addRunDependency" || // The old FS has some functionality that WasmFS lacks.\n      name === "FS_createLazyFile" || name === "FS_createDevice" || name === "removeRunDependency";\n    }\n    function hookGlobalSymbolAccess(sym, func) {\n      if (typeof globalThis != "undefined" && !Object.getOwnPropertyDescriptor(globalThis, sym)) {\n        Object.defineProperty(globalThis, sym, {\n          configurable: true,\n          get() {\n            func();\n            return void 0;\n          }\n        });\n      }\n    }\n    function missingGlobal(sym, msg) {\n      hookGlobalSymbolAccess(sym, () => {\n        warnOnce(`\\`${sym}\\` is not longer defined by emscripten. ${msg}`);\n      });\n    }\n    missingGlobal("buffer", "Please use HEAP8.buffer or wasmMemory.buffer");\n    missingGlobal("asm", "Please use wasmExports instead");\n    function missingLibrarySymbol(sym) {\n      hookGlobalSymbolAccess(sym, () => {\n        var msg = `\\`${sym}\\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`;\n        var librarySymbol = sym;\n        if (!librarySymbol.startsWith("_")) {\n          librarySymbol = "$" + sym;\n        }\n        msg += ` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE=\'${librarySymbol}\')`;\n        if (isExportedByForceFilesystem(sym)) {\n          msg += ". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you";\n        }\n        warnOnce(msg);\n      });\n      unexportedRuntimeSymbol(sym);\n    }\n    function unexportedRuntimeSymbol(sym) {\n      if (!Object.getOwnPropertyDescriptor(Module, sym)) {\n        Object.defineProperty(Module, sym, {\n          configurable: true,\n          get() {\n            var msg = `\'${sym}\' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;\n            if (isExportedByForceFilesystem(sym)) {\n              msg += ". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you";\n            }\n            abort(msg);\n          }\n        });\n      }\n    }\n    var callRuntimeCallbacks = (callbacks) => {\n      callbacks.forEach((f) => f(Module));\n    };\n    function getValue(ptr, type = "i8") {\n      if (type.endsWith("*")) type = "*";\n      switch (type) {\n        case "i1":\n          return HEAP8[ptr];\n        case "i8":\n          return HEAP8[ptr];\n        case "i16":\n          return HEAP16[ptr >> 1];\n        case "i32":\n          return HEAP32[ptr >> 2];\n        case "i64":\n          abort("to do getValue(i64) use WASM_BIGINT");\n        case "float":\n          return HEAPF32[ptr >> 2];\n        case "double":\n          return HEAPF64[ptr >> 3];\n        case "*":\n          return HEAPU32[ptr >> 2];\n        default:\n          abort(`invalid type for getValue: ${type}`);\n      }\n    }\n    Module["noExitRuntime"] || true;\n    var ptrToString = (ptr) => {\n      assert(typeof ptr === "number");\n      ptr >>>= 0;\n      return "0x" + ptr.toString(16).padStart(8, "0");\n    };\n    function setValue(ptr, value, type = "i8") {\n      if (type.endsWith("*")) type = "*";\n      switch (type) {\n        case "i1":\n          HEAP8[ptr] = value;\n          break;\n        case "i8":\n          HEAP8[ptr] = value;\n          break;\n        case "i16":\n          HEAP16[ptr >> 1] = value;\n          break;\n        case "i32":\n          HEAP32[ptr >> 2] = value;\n          break;\n        case "i64":\n          abort("to do setValue(i64) use WASM_BIGINT");\n        case "float":\n          HEAPF32[ptr >> 2] = value;\n          break;\n        case "double":\n          HEAPF64[ptr >> 3] = value;\n          break;\n        case "*":\n          HEAPU32[ptr >> 2] = value;\n          break;\n        default:\n          abort(`invalid type for setValue: ${type}`);\n      }\n    }\n    var stackRestore = (val) => __emscripten_stack_restore(val);\n    var stackSave = () => _emscripten_stack_get_current();\n    var warnOnce = (text) => {\n      warnOnce.shown || (warnOnce.shown = {});\n      if (!warnOnce.shown[text]) {\n        warnOnce.shown[text] = 1;\n        err(text);\n      }\n    };\n    var UTF8Decoder = typeof TextDecoder != "undefined" ? new TextDecoder() : void 0;\n    var UTF8ArrayToString = (heapOrArray, idx = 0, maxBytesToRead = NaN) => {\n      var endIdx = idx + maxBytesToRead;\n      var endPtr = idx;\n      while (heapOrArray[endPtr] && !(endPtr >= endIdx)) ++endPtr;\n      if (endPtr - idx > 16 && heapOrArray.buffer && UTF8Decoder) {\n        return UTF8Decoder.decode(heapOrArray.subarray(idx, endPtr));\n      }\n      var str = "";\n      while (idx < endPtr) {\n        var u0 = heapOrArray[idx++];\n        if (!(u0 & 128)) {\n          str += String.fromCharCode(u0);\n          continue;\n        }\n        var u1 = heapOrArray[idx++] & 63;\n        if ((u0 & 224) == 192) {\n          str += String.fromCharCode((u0 & 31) << 6 | u1);\n          continue;\n        }\n        var u2 = heapOrArray[idx++] & 63;\n        if ((u0 & 240) == 224) {\n          u0 = (u0 & 15) << 12 | u1 << 6 | u2;\n        } else {\n          if ((u0 & 248) != 240)\n            warnOnce(\n              "Invalid UTF-8 leading byte " + ptrToString(u0) + " encountered when deserializing a UTF-8 string in wasm memory to a JS string!"\n            );\n          u0 = (u0 & 7) << 18 | u1 << 12 | u2 << 6 | heapOrArray[idx++] & 63;\n        }\n        if (u0 < 65536) {\n          str += String.fromCharCode(u0);\n        } else {\n          var ch = u0 - 65536;\n          str += String.fromCharCode(55296 | ch >> 10, 56320 | ch & 1023);\n        }\n      }\n      return str;\n    };\n    var UTF8ToString = (ptr, maxBytesToRead) => {\n      assert(typeof ptr == "number", `UTF8ToString expects a number (got ${typeof ptr})`);\n      return ptr ? UTF8ArrayToString(HEAPU8, ptr, maxBytesToRead) : "";\n    };\n    var ___assert_fail = (condition, filename, line, func) => {\n      abort(\n        `Assertion failed: ${UTF8ToString(condition)}, at: ` + [\n          filename ? UTF8ToString(filename) : "unknown filename",\n          line,\n          func ? UTF8ToString(func) : "unknown function"\n        ]\n      );\n    };\n    function syscallGetVarargI() {\n      assert(SYSCALLS.varargs != void 0);\n      var ret = HEAP32[+SYSCALLS.varargs >> 2];\n      SYSCALLS.varargs += 4;\n      return ret;\n    }\n    var syscallGetVarargP = syscallGetVarargI;\n    var PATH = {\n      isAbs: (path) => path.charAt(0) === "/",\n      splitPath: (filename) => {\n        var splitPathRe = /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\n        return splitPathRe.exec(filename).slice(1);\n      },\n      normalizeArray: (parts, allowAboveRoot) => {\n        var up = 0;\n        for (var i = parts.length - 1; i >= 0; i--) {\n          var last = parts[i];\n          if (last === ".") {\n            parts.splice(i, 1);\n          } else if (last === "..") {\n            parts.splice(i, 1);\n            up++;\n          } else if (up) {\n            parts.splice(i, 1);\n            up--;\n          }\n        }\n        if (allowAboveRoot) {\n          for (; up; up--) {\n            parts.unshift("..");\n          }\n        }\n        return parts;\n      },\n      normalize: (path) => {\n        var isAbsolute = PATH.isAbs(path), trailingSlash = path.substr(-1) === "/";\n        path = PATH.normalizeArray(\n          path.split("/").filter((p) => !!p),\n          !isAbsolute\n        ).join("/");\n        if (!path && !isAbsolute) {\n          path = ".";\n        }\n        if (path && trailingSlash) {\n          path += "/";\n        }\n        return (isAbsolute ? "/" : "") + path;\n      },\n      dirname: (path) => {\n        var result = PATH.splitPath(path), root = result[0], dir = result[1];\n        if (!root && !dir) {\n          return ".";\n        }\n        if (dir) {\n          dir = dir.substr(0, dir.length - 1);\n        }\n        return root + dir;\n      },\n      basename: (path) => {\n        if (path === "/") return "/";\n        path = PATH.normalize(path);\n        path = path.replace(/\\/$/, "");\n        var lastSlash = path.lastIndexOf("/");\n        if (lastSlash === -1) return path;\n        return path.substr(lastSlash + 1);\n      },\n      join: (...paths) => PATH.normalize(paths.join("/")),\n      join2: (l, r) => PATH.normalize(l + "/" + r)\n    };\n    var initRandomFill = () => {\n      if (typeof crypto == "object" && typeof crypto["getRandomValues"] == "function") {\n        return (view) => crypto.getRandomValues(view);\n      }\n      abort(\n        "no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };"\n      );\n    };\n    var randomFill = (view) => {\n      return (randomFill = initRandomFill())(view);\n    };\n    var PATH_FS = {\n      resolve: (...args) => {\n        var resolvedPath = "", resolvedAbsolute = false;\n        for (var i = args.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n          var path = i >= 0 ? args[i] : FS.cwd();\n          if (typeof path != "string") {\n            throw new TypeError("Arguments to path.resolve must be strings");\n          } else if (!path) {\n            return "";\n          }\n          resolvedPath = path + "/" + resolvedPath;\n          resolvedAbsolute = PATH.isAbs(path);\n        }\n        resolvedPath = PATH.normalizeArray(\n          resolvedPath.split("/").filter((p) => !!p),\n          !resolvedAbsolute\n        ).join("/");\n        return (resolvedAbsolute ? "/" : "") + resolvedPath || ".";\n      },\n      relative: (from, to) => {\n        from = PATH_FS.resolve(from).substr(1);\n        to = PATH_FS.resolve(to).substr(1);\n        function trim(arr) {\n          var start = 0;\n          for (; start < arr.length; start++) {\n            if (arr[start] !== "") break;\n          }\n          var end = arr.length - 1;\n          for (; end >= 0; end--) {\n            if (arr[end] !== "") break;\n          }\n          if (start > end) return [];\n          return arr.slice(start, end - start + 1);\n        }\n        var fromParts = trim(from.split("/"));\n        var toParts = trim(to.split("/"));\n        var length = Math.min(fromParts.length, toParts.length);\n        var samePartsLength = length;\n        for (var i = 0; i < length; i++) {\n          if (fromParts[i] !== toParts[i]) {\n            samePartsLength = i;\n            break;\n          }\n        }\n        var outputParts = [];\n        for (var i = samePartsLength; i < fromParts.length; i++) {\n          outputParts.push("..");\n        }\n        outputParts = outputParts.concat(toParts.slice(samePartsLength));\n        return outputParts.join("/");\n      }\n    };\n    var FS_stdin_getChar_buffer = [];\n    var lengthBytesUTF8 = (str) => {\n      var len = 0;\n      for (var i = 0; i < str.length; ++i) {\n        var c = str.charCodeAt(i);\n        if (c <= 127) {\n          len++;\n        } else if (c <= 2047) {\n          len += 2;\n        } else if (c >= 55296 && c <= 57343) {\n          len += 4;\n          ++i;\n        } else {\n          len += 3;\n        }\n      }\n      return len;\n    };\n    var stringToUTF8Array = (str, heap, outIdx, maxBytesToWrite) => {\n      assert(typeof str === "string", `stringToUTF8Array expects a string (got ${typeof str})`);\n      if (!(maxBytesToWrite > 0)) return 0;\n      var startIdx = outIdx;\n      var endIdx = outIdx + maxBytesToWrite - 1;\n      for (var i = 0; i < str.length; ++i) {\n        var u = str.charCodeAt(i);\n        if (u >= 55296 && u <= 57343) {\n          var u1 = str.charCodeAt(++i);\n          u = 65536 + ((u & 1023) << 10) | u1 & 1023;\n        }\n        if (u <= 127) {\n          if (outIdx >= endIdx) break;\n          heap[outIdx++] = u;\n        } else if (u <= 2047) {\n          if (outIdx + 1 >= endIdx) break;\n          heap[outIdx++] = 192 | u >> 6;\n          heap[outIdx++] = 128 | u & 63;\n        } else if (u <= 65535) {\n          if (outIdx + 2 >= endIdx) break;\n          heap[outIdx++] = 224 | u >> 12;\n          heap[outIdx++] = 128 | u >> 6 & 63;\n          heap[outIdx++] = 128 | u & 63;\n        } else {\n          if (outIdx + 3 >= endIdx) break;\n          if (u > 1114111)\n            warnOnce(\n              "Invalid Unicode code point " + ptrToString(u) + " encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."\n            );\n          heap[outIdx++] = 240 | u >> 18;\n          heap[outIdx++] = 128 | u >> 12 & 63;\n          heap[outIdx++] = 128 | u >> 6 & 63;\n          heap[outIdx++] = 128 | u & 63;\n        }\n      }\n      heap[outIdx] = 0;\n      return outIdx - startIdx;\n    };\n    function intArrayFromString(stringy, dontAddNull, length) {\n      var len = lengthBytesUTF8(stringy) + 1;\n      var u8array = new Array(len);\n      var numBytesWritten = stringToUTF8Array(stringy, u8array, 0, u8array.length);\n      u8array.length = numBytesWritten;\n      return u8array;\n    }\n    var FS_stdin_getChar = () => {\n      if (!FS_stdin_getChar_buffer.length) {\n        var result = null;\n        if (typeof window != "undefined" && typeof window.prompt == "function") {\n          result = window.prompt("Input: ");\n          if (result !== null) {\n            result += "\\n";\n          }\n        } else if (typeof readline == "function") {\n          result = readline();\n          if (result) {\n            result += "\\n";\n          }\n        } else ;\n        if (!result) {\n          return null;\n        }\n        FS_stdin_getChar_buffer = intArrayFromString(result);\n      }\n      return FS_stdin_getChar_buffer.shift();\n    };\n    var TTY = {\n      ttys: [],\n      init() {\n      },\n      shutdown() {\n      },\n      register(dev, ops) {\n        TTY.ttys[dev] = { input: [], output: [], ops };\n        FS.registerDevice(dev, TTY.stream_ops);\n      },\n      stream_ops: {\n        open(stream) {\n          var tty = TTY.ttys[stream.node.rdev];\n          if (!tty) {\n            throw new FS.ErrnoError(43);\n          }\n          stream.tty = tty;\n          stream.seekable = false;\n        },\n        close(stream) {\n          stream.tty.ops.fsync(stream.tty);\n        },\n        fsync(stream) {\n          stream.tty.ops.fsync(stream.tty);\n        },\n        read(stream, buffer, offset, length, pos) {\n          if (!stream.tty || !stream.tty.ops.get_char) {\n            throw new FS.ErrnoError(60);\n          }\n          var bytesRead = 0;\n          for (var i = 0; i < length; i++) {\n            var result;\n            try {\n              result = stream.tty.ops.get_char(stream.tty);\n            } catch (e) {\n              throw new FS.ErrnoError(29);\n            }\n            if (result === void 0 && bytesRead === 0) {\n              throw new FS.ErrnoError(6);\n            }\n            if (result === null || result === void 0) break;\n            bytesRead++;\n            buffer[offset + i] = result;\n          }\n          if (bytesRead) {\n            stream.node.timestamp = Date.now();\n          }\n          return bytesRead;\n        },\n        write(stream, buffer, offset, length, pos) {\n          if (!stream.tty || !stream.tty.ops.put_char) {\n            throw new FS.ErrnoError(60);\n          }\n          try {\n            for (var i = 0; i < length; i++) {\n              stream.tty.ops.put_char(stream.tty, buffer[offset + i]);\n            }\n          } catch (e) {\n            throw new FS.ErrnoError(29);\n          }\n          if (length) {\n            stream.node.timestamp = Date.now();\n          }\n          return i;\n        }\n      },\n      default_tty_ops: {\n        get_char(tty) {\n          return FS_stdin_getChar();\n        },\n        put_char(tty, val) {\n          if (val === null || val === 10) {\n            out(UTF8ArrayToString(tty.output));\n            tty.output = [];\n          } else {\n            if (val != 0) tty.output.push(val);\n          }\n        },\n        fsync(tty) {\n          if (tty.output && tty.output.length > 0) {\n            out(UTF8ArrayToString(tty.output));\n            tty.output = [];\n          }\n        },\n        ioctl_tcgets(tty) {\n          return {\n            c_iflag: 25856,\n            c_oflag: 5,\n            c_cflag: 191,\n            c_lflag: 35387,\n            c_cc: [\n              3,\n              28,\n              127,\n              21,\n              4,\n              0,\n              1,\n              0,\n              17,\n              19,\n              26,\n              0,\n              18,\n              15,\n              23,\n              22,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0,\n              0\n            ]\n          };\n        },\n        ioctl_tcsets(tty, optional_actions, data) {\n          return 0;\n        },\n        ioctl_tiocgwinsz(tty) {\n          return [24, 80];\n        }\n      },\n      default_tty1_ops: {\n        put_char(tty, val) {\n          if (val === null || val === 10) {\n            err(UTF8ArrayToString(tty.output));\n            tty.output = [];\n          } else {\n            if (val != 0) tty.output.push(val);\n          }\n        },\n        fsync(tty) {\n          if (tty.output && tty.output.length > 0) {\n            err(UTF8ArrayToString(tty.output));\n            tty.output = [];\n          }\n        }\n      }\n    };\n    var zeroMemory = (address, size) => {\n      HEAPU8.fill(0, address, address + size);\n    };\n    var alignMemory = (size, alignment) => {\n      assert(alignment, "alignment argument is required");\n      return Math.ceil(size / alignment) * alignment;\n    };\n    var mmapAlloc = (size) => {\n      size = alignMemory(size, 65536);\n      var ptr = _emscripten_builtin_memalign(65536, size);\n      if (ptr) zeroMemory(ptr, size);\n      return ptr;\n    };\n    var MEMFS = {\n      ops_table: null,\n      mount(mount) {\n        return MEMFS.createNode(null, "/", 16384 | 511, 0);\n      },\n      createNode(parent, name, mode, dev) {\n        if (FS.isBlkdev(mode) || FS.isFIFO(mode)) {\n          throw new FS.ErrnoError(63);\n        }\n        MEMFS.ops_table || (MEMFS.ops_table = {\n          dir: {\n            node: {\n              getattr: MEMFS.node_ops.getattr,\n              setattr: MEMFS.node_ops.setattr,\n              lookup: MEMFS.node_ops.lookup,\n              mknod: MEMFS.node_ops.mknod,\n              rename: MEMFS.node_ops.rename,\n              unlink: MEMFS.node_ops.unlink,\n              rmdir: MEMFS.node_ops.rmdir,\n              readdir: MEMFS.node_ops.readdir,\n              symlink: MEMFS.node_ops.symlink\n            },\n            stream: {\n              llseek: MEMFS.stream_ops.llseek\n            }\n          },\n          file: {\n            node: {\n              getattr: MEMFS.node_ops.getattr,\n              setattr: MEMFS.node_ops.setattr\n            },\n            stream: {\n              llseek: MEMFS.stream_ops.llseek,\n              read: MEMFS.stream_ops.read,\n              write: MEMFS.stream_ops.write,\n              allocate: MEMFS.stream_ops.allocate,\n              mmap: MEMFS.stream_ops.mmap,\n              msync: MEMFS.stream_ops.msync\n            }\n          },\n          link: {\n            node: {\n              getattr: MEMFS.node_ops.getattr,\n              setattr: MEMFS.node_ops.setattr,\n              readlink: MEMFS.node_ops.readlink\n            },\n            stream: {}\n          },\n          chrdev: {\n            node: {\n              getattr: MEMFS.node_ops.getattr,\n              setattr: MEMFS.node_ops.setattr\n            },\n            stream: FS.chrdev_stream_ops\n          }\n        });\n        var node = FS.createNode(parent, name, mode, dev);\n        if (FS.isDir(node.mode)) {\n          node.node_ops = MEMFS.ops_table.dir.node;\n          node.stream_ops = MEMFS.ops_table.dir.stream;\n          node.contents = {};\n        } else if (FS.isFile(node.mode)) {\n          node.node_ops = MEMFS.ops_table.file.node;\n          node.stream_ops = MEMFS.ops_table.file.stream;\n          node.usedBytes = 0;\n          node.contents = null;\n        } else if (FS.isLink(node.mode)) {\n          node.node_ops = MEMFS.ops_table.link.node;\n          node.stream_ops = MEMFS.ops_table.link.stream;\n        } else if (FS.isChrdev(node.mode)) {\n          node.node_ops = MEMFS.ops_table.chrdev.node;\n          node.stream_ops = MEMFS.ops_table.chrdev.stream;\n        }\n        node.timestamp = Date.now();\n        if (parent) {\n          parent.contents[name] = node;\n          parent.timestamp = node.timestamp;\n        }\n        return node;\n      },\n      getFileDataAsTypedArray(node) {\n        if (!node.contents) return new Uint8Array(0);\n        if (node.contents.subarray) return node.contents.subarray(0, node.usedBytes);\n        return new Uint8Array(node.contents);\n      },\n      expandFileStorage(node, newCapacity) {\n        var prevCapacity = node.contents ? node.contents.length : 0;\n        if (prevCapacity >= newCapacity) return;\n        var CAPACITY_DOUBLING_MAX = 1024 * 1024;\n        newCapacity = Math.max(\n          newCapacity,\n          prevCapacity * (prevCapacity < CAPACITY_DOUBLING_MAX ? 2 : 1.125) >>> 0\n        );\n        if (prevCapacity != 0) newCapacity = Math.max(newCapacity, 256);\n        var oldContents = node.contents;\n        node.contents = new Uint8Array(newCapacity);\n        if (node.usedBytes > 0) node.contents.set(oldContents.subarray(0, node.usedBytes), 0);\n      },\n      resizeFileStorage(node, newSize) {\n        if (node.usedBytes == newSize) return;\n        if (newSize == 0) {\n          node.contents = null;\n          node.usedBytes = 0;\n        } else {\n          var oldContents = node.contents;\n          node.contents = new Uint8Array(newSize);\n          if (oldContents) {\n            node.contents.set(oldContents.subarray(0, Math.min(newSize, node.usedBytes)));\n          }\n          node.usedBytes = newSize;\n        }\n      },\n      node_ops: {\n        getattr(node) {\n          var attr = {};\n          attr.dev = FS.isChrdev(node.mode) ? node.id : 1;\n          attr.ino = node.id;\n          attr.mode = node.mode;\n          attr.nlink = 1;\n          attr.uid = 0;\n          attr.gid = 0;\n          attr.rdev = node.rdev;\n          if (FS.isDir(node.mode)) {\n            attr.size = 4096;\n          } else if (FS.isFile(node.mode)) {\n            attr.size = node.usedBytes;\n          } else if (FS.isLink(node.mode)) {\n            attr.size = node.link.length;\n          } else {\n            attr.size = 0;\n          }\n          attr.atime = new Date(node.timestamp);\n          attr.mtime = new Date(node.timestamp);\n          attr.ctime = new Date(node.timestamp);\n          attr.blksize = 4096;\n          attr.blocks = Math.ceil(attr.size / attr.blksize);\n          return attr;\n        },\n        setattr(node, attr) {\n          if (attr.mode !== void 0) {\n            node.mode = attr.mode;\n          }\n          if (attr.timestamp !== void 0) {\n            node.timestamp = attr.timestamp;\n          }\n          if (attr.size !== void 0) {\n            MEMFS.resizeFileStorage(node, attr.size);\n          }\n        },\n        lookup(parent, name) {\n          throw FS.genericErrors[44];\n        },\n        mknod(parent, name, mode, dev) {\n          return MEMFS.createNode(parent, name, mode, dev);\n        },\n        rename(old_node, new_dir, new_name) {\n          if (FS.isDir(old_node.mode)) {\n            var new_node;\n            try {\n              new_node = FS.lookupNode(new_dir, new_name);\n            } catch (e) {\n            }\n            if (new_node) {\n              for (var i in new_node.contents) {\n                throw new FS.ErrnoError(55);\n              }\n            }\n          }\n          delete old_node.parent.contents[old_node.name];\n          old_node.parent.timestamp = Date.now();\n          old_node.name = new_name;\n          new_dir.contents[new_name] = old_node;\n          new_dir.timestamp = old_node.parent.timestamp;\n        },\n        unlink(parent, name) {\n          delete parent.contents[name];\n          parent.timestamp = Date.now();\n        },\n        rmdir(parent, name) {\n          var node = FS.lookupNode(parent, name);\n          for (var i in node.contents) {\n            throw new FS.ErrnoError(55);\n          }\n          delete parent.contents[name];\n          parent.timestamp = Date.now();\n        },\n        readdir(node) {\n          var entries = [".", ".."];\n          for (var key of Object.keys(node.contents)) {\n            entries.push(key);\n          }\n          return entries;\n        },\n        symlink(parent, newname, oldpath) {\n          var node = MEMFS.createNode(parent, newname, 511 | 40960, 0);\n          node.link = oldpath;\n          return node;\n        },\n        readlink(node) {\n          if (!FS.isLink(node.mode)) {\n            throw new FS.ErrnoError(28);\n          }\n          return node.link;\n        }\n      },\n      stream_ops: {\n        read(stream, buffer, offset, length, position) {\n          var contents = stream.node.contents;\n          if (position >= stream.node.usedBytes) return 0;\n          var size = Math.min(stream.node.usedBytes - position, length);\n          assert(size >= 0);\n          if (size > 8 && contents.subarray) {\n            buffer.set(contents.subarray(position, position + size), offset);\n          } else {\n            for (var i = 0; i < size; i++) buffer[offset + i] = contents[position + i];\n          }\n          return size;\n        },\n        write(stream, buffer, offset, length, position, canOwn) {\n          assert(!(buffer instanceof ArrayBuffer));\n          if (buffer.buffer === HEAP8.buffer) {\n            canOwn = false;\n          }\n          if (!length) return 0;\n          var node = stream.node;\n          node.timestamp = Date.now();\n          if (buffer.subarray && (!node.contents || node.contents.subarray)) {\n            if (canOwn) {\n              assert(position === 0, "canOwn must imply no weird position inside the file");\n              node.contents = buffer.subarray(offset, offset + length);\n              node.usedBytes = length;\n              return length;\n            } else if (node.usedBytes === 0 && position === 0) {\n              node.contents = buffer.slice(offset, offset + length);\n              node.usedBytes = length;\n              return length;\n            } else if (position + length <= node.usedBytes) {\n              node.contents.set(buffer.subarray(offset, offset + length), position);\n              return length;\n            }\n          }\n          MEMFS.expandFileStorage(node, position + length);\n          if (node.contents.subarray && buffer.subarray) {\n            node.contents.set(buffer.subarray(offset, offset + length), position);\n          } else {\n            for (var i = 0; i < length; i++) {\n              node.contents[position + i] = buffer[offset + i];\n            }\n          }\n          node.usedBytes = Math.max(node.usedBytes, position + length);\n          return length;\n        },\n        llseek(stream, offset, whence) {\n          var position = offset;\n          if (whence === 1) {\n            position += stream.position;\n          } else if (whence === 2) {\n            if (FS.isFile(stream.node.mode)) {\n              position += stream.node.usedBytes;\n            }\n          }\n          if (position < 0) {\n            throw new FS.ErrnoError(28);\n          }\n          return position;\n        },\n        allocate(stream, offset, length) {\n          MEMFS.expandFileStorage(stream.node, offset + length);\n          stream.node.usedBytes = Math.max(stream.node.usedBytes, offset + length);\n        },\n        mmap(stream, length, position, prot, flags) {\n          if (!FS.isFile(stream.node.mode)) {\n            throw new FS.ErrnoError(43);\n          }\n          var ptr;\n          var allocated;\n          var contents = stream.node.contents;\n          if (!(flags & 2) && contents && contents.buffer === HEAP8.buffer) {\n            allocated = false;\n            ptr = contents.byteOffset;\n          } else {\n            allocated = true;\n            ptr = mmapAlloc(length);\n            if (!ptr) {\n              throw new FS.ErrnoError(48);\n            }\n            if (contents) {\n              if (position > 0 || position + length < contents.length) {\n                if (contents.subarray) {\n                  contents = contents.subarray(position, position + length);\n                } else {\n                  contents = Array.prototype.slice.call(contents, position, position + length);\n                }\n              }\n              HEAP8.set(contents, ptr);\n            }\n          }\n          return { ptr, allocated };\n        },\n        msync(stream, buffer, offset, length, mmapFlags) {\n          MEMFS.stream_ops.write(stream, buffer, 0, length, offset, false);\n          return 0;\n        }\n      }\n    };\n    var asyncLoad = (url, onload, onerror, noRunDep) => {\n      var dep = getUniqueRunDependency(`al ${url}`);\n      readAsync(url).then(\n        (arrayBuffer) => {\n          assert(arrayBuffer, `Loading data file "${url}" failed (no arrayBuffer).`);\n          onload(new Uint8Array(arrayBuffer));\n          if (dep) removeRunDependency(dep);\n        },\n        (err2) => {\n          if (onerror) {\n            onerror();\n          } else {\n            throw `Loading data file "${url}" failed.`;\n          }\n        }\n      );\n      if (dep) addRunDependency(dep);\n    };\n    var FS_createDataFile = (parent, name, fileData, canRead, canWrite, canOwn) => {\n      FS.createDataFile(parent, name, fileData, canRead, canWrite, canOwn);\n    };\n    var preloadPlugins = Module["preloadPlugins"] || [];\n    var FS_handledByPreloadPlugin = (byteArray, fullname, finish, onerror) => {\n      if (typeof Browser != "undefined") Browser.init();\n      var handled = false;\n      preloadPlugins.forEach((plugin) => {\n        if (handled) return;\n        if (plugin["canHandle"](fullname)) {\n          plugin["handle"](byteArray, fullname, finish, onerror);\n          handled = true;\n        }\n      });\n      return handled;\n    };\n    var FS_createPreloadedFile = (parent, name, url, canRead, canWrite, onload, onerror, dontCreateFile, canOwn, preFinish) => {\n      var fullname = name ? PATH_FS.resolve(PATH.join2(parent, name)) : parent;\n      var dep = getUniqueRunDependency(`cp ${fullname}`);\n      function processData(byteArray) {\n        function finish(byteArray2) {\n          preFinish == null ? void 0 : preFinish();\n          if (!dontCreateFile) {\n            FS_createDataFile(parent, name, byteArray2, canRead, canWrite, canOwn);\n          }\n          onload == null ? void 0 : onload();\n          removeRunDependency(dep);\n        }\n        if (FS_handledByPreloadPlugin(byteArray, fullname, finish, () => {\n          onerror == null ? void 0 : onerror();\n          removeRunDependency(dep);\n        })) {\n          return;\n        }\n        finish(byteArray);\n      }\n      addRunDependency(dep);\n      if (typeof url == "string") {\n        asyncLoad(url, processData, onerror);\n      } else {\n        processData(url);\n      }\n    };\n    var FS_modeStringToFlags = (str) => {\n      var flagModes = {\n        r: 0,\n        "r+": 2,\n        w: 512 | 64 | 1,\n        "w+": 512 | 64 | 2,\n        a: 1024 | 64 | 1,\n        "a+": 1024 | 64 | 2\n      };\n      var flags = flagModes[str];\n      if (typeof flags == "undefined") {\n        throw new Error(`Unknown file open mode: ${str}`);\n      }\n      return flags;\n    };\n    var FS_getMode = (canRead, canWrite) => {\n      var mode = 0;\n      if (canRead) mode |= 292 | 73;\n      if (canWrite) mode |= 146;\n      return mode;\n    };\n    var strError = (errno) => {\n      return UTF8ToString(_strerror(errno));\n    };\n    var ERRNO_CODES = {\n      EPERM: 63,\n      ENOENT: 44,\n      ESRCH: 71,\n      EINTR: 27,\n      EIO: 29,\n      ENXIO: 60,\n      E2BIG: 1,\n      ENOEXEC: 45,\n      EBADF: 8,\n      ECHILD: 12,\n      EAGAIN: 6,\n      EWOULDBLOCK: 6,\n      ENOMEM: 48,\n      EACCES: 2,\n      EFAULT: 21,\n      ENOTBLK: 105,\n      EBUSY: 10,\n      EEXIST: 20,\n      EXDEV: 75,\n      ENODEV: 43,\n      ENOTDIR: 54,\n      EISDIR: 31,\n      EINVAL: 28,\n      ENFILE: 41,\n      EMFILE: 33,\n      ENOTTY: 59,\n      ETXTBSY: 74,\n      EFBIG: 22,\n      ENOSPC: 51,\n      ESPIPE: 70,\n      EROFS: 69,\n      EMLINK: 34,\n      EPIPE: 64,\n      EDOM: 18,\n      ERANGE: 68,\n      ENOMSG: 49,\n      EIDRM: 24,\n      ECHRNG: 106,\n      EL2NSYNC: 156,\n      EL3HLT: 107,\n      EL3RST: 108,\n      ELNRNG: 109,\n      EUNATCH: 110,\n      ENOCSI: 111,\n      EL2HLT: 112,\n      EDEADLK: 16,\n      ENOLCK: 46,\n      EBADE: 113,\n      EBADR: 114,\n      EXFULL: 115,\n      ENOANO: 104,\n      EBADRQC: 103,\n      EBADSLT: 102,\n      EDEADLOCK: 16,\n      EBFONT: 101,\n      ENOSTR: 100,\n      ENODATA: 116,\n      ETIME: 117,\n      ENOSR: 118,\n      ENONET: 119,\n      ENOPKG: 120,\n      EREMOTE: 121,\n      ENOLINK: 47,\n      EADV: 122,\n      ESRMNT: 123,\n      ECOMM: 124,\n      EPROTO: 65,\n      EMULTIHOP: 36,\n      EDOTDOT: 125,\n      EBADMSG: 9,\n      ENOTUNIQ: 126,\n      EBADFD: 127,\n      EREMCHG: 128,\n      ELIBACC: 129,\n      ELIBBAD: 130,\n      ELIBSCN: 131,\n      ELIBMAX: 132,\n      ELIBEXEC: 133,\n      ENOSYS: 52,\n      ENOTEMPTY: 55,\n      ENAMETOOLONG: 37,\n      ELOOP: 32,\n      EOPNOTSUPP: 138,\n      EPFNOSUPPORT: 139,\n      ECONNRESET: 15,\n      ENOBUFS: 42,\n      EAFNOSUPPORT: 5,\n      EPROTOTYPE: 67,\n      ENOTSOCK: 57,\n      ENOPROTOOPT: 50,\n      ESHUTDOWN: 140,\n      ECONNREFUSED: 14,\n      EADDRINUSE: 3,\n      ECONNABORTED: 13,\n      ENETUNREACH: 40,\n      ENETDOWN: 38,\n      ETIMEDOUT: 73,\n      EHOSTDOWN: 142,\n      EHOSTUNREACH: 23,\n      EINPROGRESS: 26,\n      EALREADY: 7,\n      EDESTADDRREQ: 17,\n      EMSGSIZE: 35,\n      EPROTONOSUPPORT: 66,\n      ESOCKTNOSUPPORT: 137,\n      EADDRNOTAVAIL: 4,\n      ENETRESET: 39,\n      EISCONN: 30,\n      ENOTCONN: 53,\n      ETOOMANYREFS: 141,\n      EUSERS: 136,\n      EDQUOT: 19,\n      ESTALE: 72,\n      ENOTSUP: 138,\n      ENOMEDIUM: 148,\n      EILSEQ: 25,\n      EOVERFLOW: 61,\n      ECANCELED: 11,\n      ENOTRECOVERABLE: 56,\n      EOWNERDEAD: 62,\n      ESTRPIPE: 135\n    };\n    var FS = {\n      root: null,\n      mounts: [],\n      devices: {},\n      streams: [],\n      nextInode: 1,\n      nameTable: null,\n      currentPath: "/",\n      initialized: false,\n      ignorePermissions: true,\n      ErrnoError: class extends Error {\n        // We set the `name` property to be able to identify `FS.ErrnoError`\n        // - the `name` is a standard ECMA-262 property of error objects. Kind of good to have it anyway.\n        // - when using PROXYFS, an error can come from an underlying FS\n        // as different FS objects have their own FS.ErrnoError each,\n        // the test `err instanceof FS.ErrnoError` won\'t detect an error coming from another filesystem, causing bugs.\n        // we\'ll use the reliable test `err.name == "ErrnoError"` instead\n        constructor(errno) {\n          super(runtimeInitialized ? strError(errno) : "");\n          this.name = "ErrnoError";\n          this.errno = errno;\n          for (var key in ERRNO_CODES) {\n            if (ERRNO_CODES[key] === errno) {\n              this.code = key;\n              break;\n            }\n          }\n        }\n      },\n      genericErrors: {},\n      filesystems: null,\n      syncFSRequests: 0,\n      readFiles: {},\n      FSStream: class {\n        constructor() {\n          this.shared = {};\n        }\n        get object() {\n          return this.node;\n        }\n        set object(val) {\n          this.node = val;\n        }\n        get isRead() {\n          return (this.flags & 2097155) !== 1;\n        }\n        get isWrite() {\n          return (this.flags & 2097155) !== 0;\n        }\n        get isAppend() {\n          return this.flags & 1024;\n        }\n        get flags() {\n          return this.shared.flags;\n        }\n        set flags(val) {\n          this.shared.flags = val;\n        }\n        get position() {\n          return this.shared.position;\n        }\n        set position(val) {\n          this.shared.position = val;\n        }\n      },\n      FSNode: class {\n        constructor(parent, name, mode, rdev) {\n          if (!parent) {\n            parent = this;\n          }\n          this.parent = parent;\n          this.mount = parent.mount;\n          this.mounted = null;\n          this.id = FS.nextInode++;\n          this.name = name;\n          this.mode = mode;\n          this.node_ops = {};\n          this.stream_ops = {};\n          this.rdev = rdev;\n          this.readMode = 292 | 73;\n          this.writeMode = 146;\n        }\n        get read() {\n          return (this.mode & this.readMode) === this.readMode;\n        }\n        set read(val) {\n          val ? this.mode |= this.readMode : this.mode &= ~this.readMode;\n        }\n        get write() {\n          return (this.mode & this.writeMode) === this.writeMode;\n        }\n        set write(val) {\n          val ? this.mode |= this.writeMode : this.mode &= ~this.writeMode;\n        }\n        get isFolder() {\n          return FS.isDir(this.mode);\n        }\n        get isDevice() {\n          return FS.isChrdev(this.mode);\n        }\n      },\n      lookupPath(path, opts = {}) {\n        path = PATH_FS.resolve(path);\n        if (!path) return { path: "", node: null };\n        var defaults = {\n          follow_mount: true,\n          recurse_count: 0\n        };\n        opts = Object.assign(defaults, opts);\n        if (opts.recurse_count > 8) {\n          throw new FS.ErrnoError(32);\n        }\n        var parts = path.split("/").filter((p) => !!p);\n        var current = FS.root;\n        var current_path = "/";\n        for (var i = 0; i < parts.length; i++) {\n          var islast = i === parts.length - 1;\n          if (islast && opts.parent) {\n            break;\n          }\n          current = FS.lookupNode(current, parts[i]);\n          current_path = PATH.join2(current_path, parts[i]);\n          if (FS.isMountpoint(current)) {\n            if (!islast || islast && opts.follow_mount) {\n              current = current.mounted.root;\n            }\n          }\n          if (!islast || opts.follow) {\n            var count = 0;\n            while (FS.isLink(current.mode)) {\n              var link = FS.readlink(current_path);\n              current_path = PATH_FS.resolve(PATH.dirname(current_path), link);\n              var lookup = FS.lookupPath(current_path, { recurse_count: opts.recurse_count + 1 });\n              current = lookup.node;\n              if (count++ > 40) {\n                throw new FS.ErrnoError(32);\n              }\n            }\n          }\n        }\n        return { path: current_path, node: current };\n      },\n      getPath(node) {\n        var path;\n        while (true) {\n          if (FS.isRoot(node)) {\n            var mount = node.mount.mountpoint;\n            if (!path) return mount;\n            return mount[mount.length - 1] !== "/" ? `${mount}/${path}` : mount + path;\n          }\n          path = path ? `${node.name}/${path}` : node.name;\n          node = node.parent;\n        }\n      },\n      hashName(parentid, name) {\n        var hash = 0;\n        for (var i = 0; i < name.length; i++) {\n          hash = (hash << 5) - hash + name.charCodeAt(i) | 0;\n        }\n        return (parentid + hash >>> 0) % FS.nameTable.length;\n      },\n      hashAddNode(node) {\n        var hash = FS.hashName(node.parent.id, node.name);\n        node.name_next = FS.nameTable[hash];\n        FS.nameTable[hash] = node;\n      },\n      hashRemoveNode(node) {\n        var hash = FS.hashName(node.parent.id, node.name);\n        if (FS.nameTable[hash] === node) {\n          FS.nameTable[hash] = node.name_next;\n        } else {\n          var current = FS.nameTable[hash];\n          while (current) {\n            if (current.name_next === node) {\n              current.name_next = node.name_next;\n              break;\n            }\n            current = current.name_next;\n          }\n        }\n      },\n      lookupNode(parent, name) {\n        var errCode = FS.mayLookup(parent);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        var hash = FS.hashName(parent.id, name);\n        for (var node = FS.nameTable[hash]; node; node = node.name_next) {\n          var nodeName = node.name;\n          if (node.parent.id === parent.id && nodeName === name) {\n            return node;\n          }\n        }\n        return FS.lookup(parent, name);\n      },\n      createNode(parent, name, mode, rdev) {\n        assert(typeof parent == "object");\n        var node = new FS.FSNode(parent, name, mode, rdev);\n        FS.hashAddNode(node);\n        return node;\n      },\n      destroyNode(node) {\n        FS.hashRemoveNode(node);\n      },\n      isRoot(node) {\n        return node === node.parent;\n      },\n      isMountpoint(node) {\n        return !!node.mounted;\n      },\n      isFile(mode) {\n        return (mode & 61440) === 32768;\n      },\n      isDir(mode) {\n        return (mode & 61440) === 16384;\n      },\n      isLink(mode) {\n        return (mode & 61440) === 40960;\n      },\n      isChrdev(mode) {\n        return (mode & 61440) === 8192;\n      },\n      isBlkdev(mode) {\n        return (mode & 61440) === 24576;\n      },\n      isFIFO(mode) {\n        return (mode & 61440) === 4096;\n      },\n      isSocket(mode) {\n        return (mode & 49152) === 49152;\n      },\n      flagsToPermissionString(flag) {\n        var perms = ["r", "w", "rw"][flag & 3];\n        if (flag & 512) {\n          perms += "w";\n        }\n        return perms;\n      },\n      nodePermissions(node, perms) {\n        if (FS.ignorePermissions) {\n          return 0;\n        }\n        if (perms.includes("r") && !(node.mode & 292)) {\n          return 2;\n        } else if (perms.includes("w") && !(node.mode & 146)) {\n          return 2;\n        } else if (perms.includes("x") && !(node.mode & 73)) {\n          return 2;\n        }\n        return 0;\n      },\n      mayLookup(dir) {\n        if (!FS.isDir(dir.mode)) return 54;\n        var errCode = FS.nodePermissions(dir, "x");\n        if (errCode) return errCode;\n        if (!dir.node_ops.lookup) return 2;\n        return 0;\n      },\n      mayCreate(dir, name) {\n        try {\n          var node = FS.lookupNode(dir, name);\n          return 20;\n        } catch (e) {\n        }\n        return FS.nodePermissions(dir, "wx");\n      },\n      mayDelete(dir, name, isdir) {\n        var node;\n        try {\n          node = FS.lookupNode(dir, name);\n        } catch (e) {\n          return e.errno;\n        }\n        var errCode = FS.nodePermissions(dir, "wx");\n        if (errCode) {\n          return errCode;\n        }\n        if (isdir) {\n          if (!FS.isDir(node.mode)) {\n            return 54;\n          }\n          if (FS.isRoot(node) || FS.getPath(node) === FS.cwd()) {\n            return 10;\n          }\n        } else {\n          if (FS.isDir(node.mode)) {\n            return 31;\n          }\n        }\n        return 0;\n      },\n      mayOpen(node, flags) {\n        if (!node) {\n          return 44;\n        }\n        if (FS.isLink(node.mode)) {\n          return 32;\n        } else if (FS.isDir(node.mode)) {\n          if (FS.flagsToPermissionString(flags) !== "r" || // opening for write\n          flags & 512) {\n            return 31;\n          }\n        }\n        return FS.nodePermissions(node, FS.flagsToPermissionString(flags));\n      },\n      MAX_OPEN_FDS: 4096,\n      nextfd() {\n        for (var fd = 0; fd <= FS.MAX_OPEN_FDS; fd++) {\n          if (!FS.streams[fd]) {\n            return fd;\n          }\n        }\n        throw new FS.ErrnoError(33);\n      },\n      getStreamChecked(fd) {\n        var stream = FS.getStream(fd);\n        if (!stream) {\n          throw new FS.ErrnoError(8);\n        }\n        return stream;\n      },\n      getStream: (fd) => FS.streams[fd],\n      createStream(stream, fd = -1) {\n        assert(fd >= -1);\n        stream = Object.assign(new FS.FSStream(), stream);\n        if (fd == -1) {\n          fd = FS.nextfd();\n        }\n        stream.fd = fd;\n        FS.streams[fd] = stream;\n        return stream;\n      },\n      closeStream(fd) {\n        FS.streams[fd] = null;\n      },\n      dupStream(origStream, fd = -1) {\n        var _a, _b;\n        var stream = FS.createStream(origStream, fd);\n        (_b = (_a = stream.stream_ops) == null ? void 0 : _a.dup) == null ? void 0 : _b.call(_a, stream);\n        return stream;\n      },\n      chrdev_stream_ops: {\n        open(stream) {\n          var _a, _b;\n          var device = FS.getDevice(stream.node.rdev);\n          stream.stream_ops = device.stream_ops;\n          (_b = (_a = stream.stream_ops).open) == null ? void 0 : _b.call(_a, stream);\n        },\n        llseek() {\n          throw new FS.ErrnoError(70);\n        }\n      },\n      major: (dev) => dev >> 8,\n      minor: (dev) => dev & 255,\n      makedev: (ma, mi) => ma << 8 | mi,\n      registerDevice(dev, ops) {\n        FS.devices[dev] = { stream_ops: ops };\n      },\n      getDevice: (dev) => FS.devices[dev],\n      getMounts(mount) {\n        var mounts = [];\n        var check = [mount];\n        while (check.length) {\n          var m = check.pop();\n          mounts.push(m);\n          check.push(...m.mounts);\n        }\n        return mounts;\n      },\n      syncfs(populate, callback) {\n        if (typeof populate == "function") {\n          callback = populate;\n          populate = false;\n        }\n        FS.syncFSRequests++;\n        if (FS.syncFSRequests > 1) {\n          err(\n            `warning: ${FS.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`\n          );\n        }\n        var mounts = FS.getMounts(FS.root.mount);\n        var completed = 0;\n        function doCallback(errCode) {\n          assert(FS.syncFSRequests > 0);\n          FS.syncFSRequests--;\n          return callback(errCode);\n        }\n        function done(errCode) {\n          if (errCode) {\n            if (!done.errored) {\n              done.errored = true;\n              return doCallback(errCode);\n            }\n            return;\n          }\n          if (++completed >= mounts.length) {\n            doCallback(null);\n          }\n        }\n        mounts.forEach((mount) => {\n          if (!mount.type.syncfs) {\n            return done(null);\n          }\n          mount.type.syncfs(mount, populate, done);\n        });\n      },\n      mount(type, opts, mountpoint) {\n        if (typeof type == "string") {\n          throw type;\n        }\n        var root = mountpoint === "/";\n        var pseudo = !mountpoint;\n        var node;\n        if (root && FS.root) {\n          throw new FS.ErrnoError(10);\n        } else if (!root && !pseudo) {\n          var lookup = FS.lookupPath(mountpoint, { follow_mount: false });\n          mountpoint = lookup.path;\n          node = lookup.node;\n          if (FS.isMountpoint(node)) {\n            throw new FS.ErrnoError(10);\n          }\n          if (!FS.isDir(node.mode)) {\n            throw new FS.ErrnoError(54);\n          }\n        }\n        var mount = {\n          type,\n          opts,\n          mountpoint,\n          mounts: []\n        };\n        var mountRoot = type.mount(mount);\n        mountRoot.mount = mount;\n        mount.root = mountRoot;\n        if (root) {\n          FS.root = mountRoot;\n        } else if (node) {\n          node.mounted = mount;\n          if (node.mount) {\n            node.mount.mounts.push(mount);\n          }\n        }\n        return mountRoot;\n      },\n      unmount(mountpoint) {\n        var lookup = FS.lookupPath(mountpoint, { follow_mount: false });\n        if (!FS.isMountpoint(lookup.node)) {\n          throw new FS.ErrnoError(28);\n        }\n        var node = lookup.node;\n        var mount = node.mounted;\n        var mounts = FS.getMounts(mount);\n        Object.keys(FS.nameTable).forEach((hash) => {\n          var current = FS.nameTable[hash];\n          while (current) {\n            var next = current.name_next;\n            if (mounts.includes(current.mount)) {\n              FS.destroyNode(current);\n            }\n            current = next;\n          }\n        });\n        node.mounted = null;\n        var idx = node.mount.mounts.indexOf(mount);\n        assert(idx !== -1);\n        node.mount.mounts.splice(idx, 1);\n      },\n      lookup(parent, name) {\n        return parent.node_ops.lookup(parent, name);\n      },\n      mknod(path, mode, dev) {\n        var lookup = FS.lookupPath(path, { parent: true });\n        var parent = lookup.node;\n        var name = PATH.basename(path);\n        if (!name || name === "." || name === "..") {\n          throw new FS.ErrnoError(28);\n        }\n        var errCode = FS.mayCreate(parent, name);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        if (!parent.node_ops.mknod) {\n          throw new FS.ErrnoError(63);\n        }\n        return parent.node_ops.mknod(parent, name, mode, dev);\n      },\n      create(path, mode) {\n        mode = mode !== void 0 ? mode : 438;\n        mode &= 4095;\n        mode |= 32768;\n        return FS.mknod(path, mode, 0);\n      },\n      mkdir(path, mode) {\n        mode = mode !== void 0 ? mode : 511;\n        mode &= 511 | 512;\n        mode |= 16384;\n        return FS.mknod(path, mode, 0);\n      },\n      mkdirTree(path, mode) {\n        var dirs = path.split("/");\n        var d = "";\n        for (var i = 0; i < dirs.length; ++i) {\n          if (!dirs[i]) continue;\n          d += "/" + dirs[i];\n          try {\n            FS.mkdir(d, mode);\n          } catch (e) {\n            if (e.errno != 20) throw e;\n          }\n        }\n      },\n      mkdev(path, mode, dev) {\n        if (typeof dev == "undefined") {\n          dev = mode;\n          mode = 438;\n        }\n        mode |= 8192;\n        return FS.mknod(path, mode, dev);\n      },\n      symlink(oldpath, newpath) {\n        if (!PATH_FS.resolve(oldpath)) {\n          throw new FS.ErrnoError(44);\n        }\n        var lookup = FS.lookupPath(newpath, { parent: true });\n        var parent = lookup.node;\n        if (!parent) {\n          throw new FS.ErrnoError(44);\n        }\n        var newname = PATH.basename(newpath);\n        var errCode = FS.mayCreate(parent, newname);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        if (!parent.node_ops.symlink) {\n          throw new FS.ErrnoError(63);\n        }\n        return parent.node_ops.symlink(parent, newname, oldpath);\n      },\n      rename(old_path, new_path) {\n        var old_dirname = PATH.dirname(old_path);\n        var new_dirname = PATH.dirname(new_path);\n        var old_name = PATH.basename(old_path);\n        var new_name = PATH.basename(new_path);\n        var lookup, old_dir, new_dir;\n        lookup = FS.lookupPath(old_path, { parent: true });\n        old_dir = lookup.node;\n        lookup = FS.lookupPath(new_path, { parent: true });\n        new_dir = lookup.node;\n        if (!old_dir || !new_dir) throw new FS.ErrnoError(44);\n        if (old_dir.mount !== new_dir.mount) {\n          throw new FS.ErrnoError(75);\n        }\n        var old_node = FS.lookupNode(old_dir, old_name);\n        var relative = PATH_FS.relative(old_path, new_dirname);\n        if (relative.charAt(0) !== ".") {\n          throw new FS.ErrnoError(28);\n        }\n        relative = PATH_FS.relative(new_path, old_dirname);\n        if (relative.charAt(0) !== ".") {\n          throw new FS.ErrnoError(55);\n        }\n        var new_node;\n        try {\n          new_node = FS.lookupNode(new_dir, new_name);\n        } catch (e) {\n        }\n        if (old_node === new_node) {\n          return;\n        }\n        var isdir = FS.isDir(old_node.mode);\n        var errCode = FS.mayDelete(old_dir, old_name, isdir);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        errCode = new_node ? FS.mayDelete(new_dir, new_name, isdir) : FS.mayCreate(new_dir, new_name);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        if (!old_dir.node_ops.rename) {\n          throw new FS.ErrnoError(63);\n        }\n        if (FS.isMountpoint(old_node) || new_node && FS.isMountpoint(new_node)) {\n          throw new FS.ErrnoError(10);\n        }\n        if (new_dir !== old_dir) {\n          errCode = FS.nodePermissions(old_dir, "w");\n          if (errCode) {\n            throw new FS.ErrnoError(errCode);\n          }\n        }\n        FS.hashRemoveNode(old_node);\n        try {\n          old_dir.node_ops.rename(old_node, new_dir, new_name);\n          old_node.parent = new_dir;\n        } catch (e) {\n          throw e;\n        } finally {\n          FS.hashAddNode(old_node);\n        }\n      },\n      rmdir(path) {\n        var lookup = FS.lookupPath(path, { parent: true });\n        var parent = lookup.node;\n        var name = PATH.basename(path);\n        var node = FS.lookupNode(parent, name);\n        var errCode = FS.mayDelete(parent, name, true);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        if (!parent.node_ops.rmdir) {\n          throw new FS.ErrnoError(63);\n        }\n        if (FS.isMountpoint(node)) {\n          throw new FS.ErrnoError(10);\n        }\n        parent.node_ops.rmdir(parent, name);\n        FS.destroyNode(node);\n      },\n      readdir(path) {\n        var lookup = FS.lookupPath(path, { follow: true });\n        var node = lookup.node;\n        if (!node.node_ops.readdir) {\n          throw new FS.ErrnoError(54);\n        }\n        return node.node_ops.readdir(node);\n      },\n      unlink(path) {\n        var lookup = FS.lookupPath(path, { parent: true });\n        var parent = lookup.node;\n        if (!parent) {\n          throw new FS.ErrnoError(44);\n        }\n        var name = PATH.basename(path);\n        var node = FS.lookupNode(parent, name);\n        var errCode = FS.mayDelete(parent, name, false);\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        if (!parent.node_ops.unlink) {\n          throw new FS.ErrnoError(63);\n        }\n        if (FS.isMountpoint(node)) {\n          throw new FS.ErrnoError(10);\n        }\n        parent.node_ops.unlink(parent, name);\n        FS.destroyNode(node);\n      },\n      readlink(path) {\n        var lookup = FS.lookupPath(path);\n        var link = lookup.node;\n        if (!link) {\n          throw new FS.ErrnoError(44);\n        }\n        if (!link.node_ops.readlink) {\n          throw new FS.ErrnoError(28);\n        }\n        return PATH_FS.resolve(FS.getPath(link.parent), link.node_ops.readlink(link));\n      },\n      stat(path, dontFollow) {\n        var lookup = FS.lookupPath(path, { follow: !dontFollow });\n        var node = lookup.node;\n        if (!node) {\n          throw new FS.ErrnoError(44);\n        }\n        if (!node.node_ops.getattr) {\n          throw new FS.ErrnoError(63);\n        }\n        return node.node_ops.getattr(node);\n      },\n      lstat(path) {\n        return FS.stat(path, true);\n      },\n      chmod(path, mode, dontFollow) {\n        var node;\n        if (typeof path == "string") {\n          var lookup = FS.lookupPath(path, { follow: !dontFollow });\n          node = lookup.node;\n        } else {\n          node = path;\n        }\n        if (!node.node_ops.setattr) {\n          throw new FS.ErrnoError(63);\n        }\n        node.node_ops.setattr(node, {\n          mode: mode & 4095 | node.mode & -4096,\n          timestamp: Date.now()\n        });\n      },\n      lchmod(path, mode) {\n        FS.chmod(path, mode, true);\n      },\n      fchmod(fd, mode) {\n        var stream = FS.getStreamChecked(fd);\n        FS.chmod(stream.node, mode);\n      },\n      chown(path, uid, gid, dontFollow) {\n        var node;\n        if (typeof path == "string") {\n          var lookup = FS.lookupPath(path, { follow: !dontFollow });\n          node = lookup.node;\n        } else {\n          node = path;\n        }\n        if (!node.node_ops.setattr) {\n          throw new FS.ErrnoError(63);\n        }\n        node.node_ops.setattr(node, {\n          timestamp: Date.now()\n          // we ignore the uid / gid for now\n        });\n      },\n      lchown(path, uid, gid) {\n        FS.chown(path, uid, gid, true);\n      },\n      fchown(fd, uid, gid) {\n        var stream = FS.getStreamChecked(fd);\n        FS.chown(stream.node, uid, gid);\n      },\n      truncate(path, len) {\n        if (len < 0) {\n          throw new FS.ErrnoError(28);\n        }\n        var node;\n        if (typeof path == "string") {\n          var lookup = FS.lookupPath(path, { follow: true });\n          node = lookup.node;\n        } else {\n          node = path;\n        }\n        if (!node.node_ops.setattr) {\n          throw new FS.ErrnoError(63);\n        }\n        if (FS.isDir(node.mode)) {\n          throw new FS.ErrnoError(31);\n        }\n        if (!FS.isFile(node.mode)) {\n          throw new FS.ErrnoError(28);\n        }\n        var errCode = FS.nodePermissions(node, "w");\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        node.node_ops.setattr(node, {\n          size: len,\n          timestamp: Date.now()\n        });\n      },\n      ftruncate(fd, len) {\n        var stream = FS.getStreamChecked(fd);\n        if ((stream.flags & 2097155) === 0) {\n          throw new FS.ErrnoError(28);\n        }\n        FS.truncate(stream.node, len);\n      },\n      utime(path, atime, mtime) {\n        var lookup = FS.lookupPath(path, { follow: true });\n        var node = lookup.node;\n        node.node_ops.setattr(node, {\n          timestamp: Math.max(atime, mtime)\n        });\n      },\n      open(path, flags, mode) {\n        if (path === "") {\n          throw new FS.ErrnoError(44);\n        }\n        flags = typeof flags == "string" ? FS_modeStringToFlags(flags) : flags;\n        if (flags & 64) {\n          mode = typeof mode == "undefined" ? 438 : mode;\n          mode = mode & 4095 | 32768;\n        } else {\n          mode = 0;\n        }\n        var node;\n        if (typeof path == "object") {\n          node = path;\n        } else {\n          path = PATH.normalize(path);\n          try {\n            var lookup = FS.lookupPath(path, {\n              follow: !(flags & 131072)\n            });\n            node = lookup.node;\n          } catch (e) {\n          }\n        }\n        var created = false;\n        if (flags & 64) {\n          if (node) {\n            if (flags & 128) {\n              throw new FS.ErrnoError(20);\n            }\n          } else {\n            node = FS.mknod(path, mode, 0);\n            created = true;\n          }\n        }\n        if (!node) {\n          throw new FS.ErrnoError(44);\n        }\n        if (FS.isChrdev(node.mode)) {\n          flags &= -513;\n        }\n        if (flags & 65536 && !FS.isDir(node.mode)) {\n          throw new FS.ErrnoError(54);\n        }\n        if (!created) {\n          var errCode = FS.mayOpen(node, flags);\n          if (errCode) {\n            throw new FS.ErrnoError(errCode);\n          }\n        }\n        if (flags & 512 && !created) {\n          FS.truncate(node, 0);\n        }\n        flags &= -131713;\n        var stream = FS.createStream({\n          node,\n          path: FS.getPath(node),\n          // we want the absolute path to the node\n          flags,\n          seekable: true,\n          position: 0,\n          stream_ops: node.stream_ops,\n          // used by the file family libc calls (fopen, fwrite, ferror, etc.)\n          ungotten: [],\n          error: false\n        });\n        if (stream.stream_ops.open) {\n          stream.stream_ops.open(stream);\n        }\n        if (Module["logReadFiles"] && !(flags & 1)) {\n          if (!(path in FS.readFiles)) {\n            FS.readFiles[path] = 1;\n          }\n        }\n        return stream;\n      },\n      close(stream) {\n        if (FS.isClosed(stream)) {\n          throw new FS.ErrnoError(8);\n        }\n        if (stream.getdents) stream.getdents = null;\n        try {\n          if (stream.stream_ops.close) {\n            stream.stream_ops.close(stream);\n          }\n        } catch (e) {\n          throw e;\n        } finally {\n          FS.closeStream(stream.fd);\n        }\n        stream.fd = null;\n      },\n      isClosed(stream) {\n        return stream.fd === null;\n      },\n      llseek(stream, offset, whence) {\n        if (FS.isClosed(stream)) {\n          throw new FS.ErrnoError(8);\n        }\n        if (!stream.seekable || !stream.stream_ops.llseek) {\n          throw new FS.ErrnoError(70);\n        }\n        if (whence != 0 && whence != 1 && whence != 2) {\n          throw new FS.ErrnoError(28);\n        }\n        stream.position = stream.stream_ops.llseek(stream, offset, whence);\n        stream.ungotten = [];\n        return stream.position;\n      },\n      read(stream, buffer, offset, length, position) {\n        assert(offset >= 0);\n        if (length < 0 || position < 0) {\n          throw new FS.ErrnoError(28);\n        }\n        if (FS.isClosed(stream)) {\n          throw new FS.ErrnoError(8);\n        }\n        if ((stream.flags & 2097155) === 1) {\n          throw new FS.ErrnoError(8);\n        }\n        if (FS.isDir(stream.node.mode)) {\n          throw new FS.ErrnoError(31);\n        }\n        if (!stream.stream_ops.read) {\n          throw new FS.ErrnoError(28);\n        }\n        var seeking = typeof position != "undefined";\n        if (!seeking) {\n          position = stream.position;\n        } else if (!stream.seekable) {\n          throw new FS.ErrnoError(70);\n        }\n        var bytesRead = stream.stream_ops.read(stream, buffer, offset, length, position);\n        if (!seeking) stream.position += bytesRead;\n        return bytesRead;\n      },\n      write(stream, buffer, offset, length, position, canOwn) {\n        assert(offset >= 0);\n        if (length < 0 || position < 0) {\n          throw new FS.ErrnoError(28);\n        }\n        if (FS.isClosed(stream)) {\n          throw new FS.ErrnoError(8);\n        }\n        if ((stream.flags & 2097155) === 0) {\n          throw new FS.ErrnoError(8);\n        }\n        if (FS.isDir(stream.node.mode)) {\n          throw new FS.ErrnoError(31);\n        }\n        if (!stream.stream_ops.write) {\n          throw new FS.ErrnoError(28);\n        }\n        if (stream.seekable && stream.flags & 1024) {\n          FS.llseek(stream, 0, 2);\n        }\n        var seeking = typeof position != "undefined";\n        if (!seeking) {\n          position = stream.position;\n        } else if (!stream.seekable) {\n          throw new FS.ErrnoError(70);\n        }\n        var bytesWritten = stream.stream_ops.write(\n          stream,\n          buffer,\n          offset,\n          length,\n          position,\n          canOwn\n        );\n        if (!seeking) stream.position += bytesWritten;\n        return bytesWritten;\n      },\n      allocate(stream, offset, length) {\n        if (FS.isClosed(stream)) {\n          throw new FS.ErrnoError(8);\n        }\n        if (offset < 0 || length <= 0) {\n          throw new FS.ErrnoError(28);\n        }\n        if ((stream.flags & 2097155) === 0) {\n          throw new FS.ErrnoError(8);\n        }\n        if (!FS.isFile(stream.node.mode) && !FS.isDir(stream.node.mode)) {\n          throw new FS.ErrnoError(43);\n        }\n        if (!stream.stream_ops.allocate) {\n          throw new FS.ErrnoError(138);\n        }\n        stream.stream_ops.allocate(stream, offset, length);\n      },\n      mmap(stream, length, position, prot, flags) {\n        if ((prot & 2) !== 0 && (flags & 2) === 0 && (stream.flags & 2097155) !== 2) {\n          throw new FS.ErrnoError(2);\n        }\n        if ((stream.flags & 2097155) === 1) {\n          throw new FS.ErrnoError(2);\n        }\n        if (!stream.stream_ops.mmap) {\n          throw new FS.ErrnoError(43);\n        }\n        if (!length) {\n          throw new FS.ErrnoError(28);\n        }\n        return stream.stream_ops.mmap(stream, length, position, prot, flags);\n      },\n      msync(stream, buffer, offset, length, mmapFlags) {\n        assert(offset >= 0);\n        if (!stream.stream_ops.msync) {\n          return 0;\n        }\n        return stream.stream_ops.msync(stream, buffer, offset, length, mmapFlags);\n      },\n      ioctl(stream, cmd, arg) {\n        if (!stream.stream_ops.ioctl) {\n          throw new FS.ErrnoError(59);\n        }\n        return stream.stream_ops.ioctl(stream, cmd, arg);\n      },\n      readFile(path, opts = {}) {\n        opts.flags = opts.flags || 0;\n        opts.encoding = opts.encoding || "binary";\n        if (opts.encoding !== "utf8" && opts.encoding !== "binary") {\n          throw new Error(`Invalid encoding type "${opts.encoding}"`);\n        }\n        var ret;\n        var stream = FS.open(path, opts.flags);\n        var stat = FS.stat(path);\n        var length = stat.size;\n        var buf = new Uint8Array(length);\n        FS.read(stream, buf, 0, length, 0);\n        if (opts.encoding === "utf8") {\n          ret = UTF8ArrayToString(buf);\n        } else if (opts.encoding === "binary") {\n          ret = buf;\n        }\n        FS.close(stream);\n        return ret;\n      },\n      writeFile(path, data, opts = {}) {\n        opts.flags = opts.flags || 577;\n        var stream = FS.open(path, opts.flags, opts.mode);\n        if (typeof data == "string") {\n          var buf = new Uint8Array(lengthBytesUTF8(data) + 1);\n          var actualNumBytes = stringToUTF8Array(data, buf, 0, buf.length);\n          FS.write(stream, buf, 0, actualNumBytes, void 0, opts.canOwn);\n        } else if (ArrayBuffer.isView(data)) {\n          FS.write(stream, data, 0, data.byteLength, void 0, opts.canOwn);\n        } else {\n          throw new Error("Unsupported data type");\n        }\n        FS.close(stream);\n      },\n      cwd: () => FS.currentPath,\n      chdir(path) {\n        var lookup = FS.lookupPath(path, { follow: true });\n        if (lookup.node === null) {\n          throw new FS.ErrnoError(44);\n        }\n        if (!FS.isDir(lookup.node.mode)) {\n          throw new FS.ErrnoError(54);\n        }\n        var errCode = FS.nodePermissions(lookup.node, "x");\n        if (errCode) {\n          throw new FS.ErrnoError(errCode);\n        }\n        FS.currentPath = lookup.path;\n      },\n      createDefaultDirectories() {\n        FS.mkdir("/tmp");\n        FS.mkdir("/home");\n        FS.mkdir("/home/web_user");\n      },\n      createDefaultDevices() {\n        FS.mkdir("/dev");\n        FS.registerDevice(FS.makedev(1, 3), {\n          read: () => 0,\n          write: (stream, buffer, offset, length, pos) => length\n        });\n        FS.mkdev("/dev/null", FS.makedev(1, 3));\n        TTY.register(FS.makedev(5, 0), TTY.default_tty_ops);\n        TTY.register(FS.makedev(6, 0), TTY.default_tty1_ops);\n        FS.mkdev("/dev/tty", FS.makedev(5, 0));\n        FS.mkdev("/dev/tty1", FS.makedev(6, 0));\n        var randomBuffer = new Uint8Array(1024), randomLeft = 0;\n        var randomByte = () => {\n          if (randomLeft === 0) {\n            randomLeft = randomFill(randomBuffer).byteLength;\n          }\n          return randomBuffer[--randomLeft];\n        };\n        FS.createDevice("/dev", "random", randomByte);\n        FS.createDevice("/dev", "urandom", randomByte);\n        FS.mkdir("/dev/shm");\n        FS.mkdir("/dev/shm/tmp");\n      },\n      createSpecialDirectories() {\n        FS.mkdir("/proc");\n        var proc_self = FS.mkdir("/proc/self");\n        FS.mkdir("/proc/self/fd");\n        FS.mount(\n          {\n            mount() {\n              var node = FS.createNode(proc_self, "fd", 16384 | 511, 73);\n              node.node_ops = {\n                lookup(parent, name) {\n                  var fd = +name;\n                  var stream = FS.getStreamChecked(fd);\n                  var ret = {\n                    parent: null,\n                    mount: { mountpoint: "fake" },\n                    node_ops: { readlink: () => stream.path }\n                  };\n                  ret.parent = ret;\n                  return ret;\n                }\n              };\n              return node;\n            }\n          },\n          {},\n          "/proc/self/fd"\n        );\n      },\n      createStandardStreams(input, output, error) {\n        if (input) {\n          FS.createDevice("/dev", "stdin", input);\n        } else {\n          FS.symlink("/dev/tty", "/dev/stdin");\n        }\n        if (output) {\n          FS.createDevice("/dev", "stdout", null, output);\n        } else {\n          FS.symlink("/dev/tty", "/dev/stdout");\n        }\n        if (error) {\n          FS.createDevice("/dev", "stderr", null, error);\n        } else {\n          FS.symlink("/dev/tty1", "/dev/stderr");\n        }\n        var stdin = FS.open("/dev/stdin", 0);\n        var stdout = FS.open("/dev/stdout", 1);\n        var stderr = FS.open("/dev/stderr", 1);\n        assert(stdin.fd === 0, `invalid handle for stdin (${stdin.fd})`);\n        assert(stdout.fd === 1, `invalid handle for stdout (${stdout.fd})`);\n        assert(stderr.fd === 2, `invalid handle for stderr (${stderr.fd})`);\n      },\n      staticInit() {\n        [44].forEach((code) => {\n          FS.genericErrors[code] = new FS.ErrnoError(code);\n          FS.genericErrors[code].stack = "<generic error, no stack>";\n        });\n        FS.nameTable = new Array(4096);\n        FS.mount(MEMFS, {}, "/");\n        FS.createDefaultDirectories();\n        FS.createDefaultDevices();\n        FS.createSpecialDirectories();\n        FS.filesystems = {\n          MEMFS\n        };\n      },\n      init(input, output, error) {\n        assert(\n          !FS.initialized,\n          "FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"\n        );\n        FS.initialized = true;\n        input ?? (input = Module["stdin"]);\n        output ?? (output = Module["stdout"]);\n        error ?? (error = Module["stderr"]);\n        FS.createStandardStreams(input, output, error);\n      },\n      quit() {\n        FS.initialized = false;\n        _fflush(0);\n        for (var i = 0; i < FS.streams.length; i++) {\n          var stream = FS.streams[i];\n          if (!stream) {\n            continue;\n          }\n          FS.close(stream);\n        }\n      },\n      findObject(path, dontResolveLastLink) {\n        var ret = FS.analyzePath(path, dontResolveLastLink);\n        if (!ret.exists) {\n          return null;\n        }\n        return ret.object;\n      },\n      analyzePath(path, dontResolveLastLink) {\n        try {\n          var lookup = FS.lookupPath(path, { follow: !dontResolveLastLink });\n          path = lookup.path;\n        } catch (e) {\n        }\n        var ret = {\n          isRoot: false,\n          exists: false,\n          error: 0,\n          name: null,\n          path: null,\n          object: null,\n          parentExists: false,\n          parentPath: null,\n          parentObject: null\n        };\n        try {\n          var lookup = FS.lookupPath(path, { parent: true });\n          ret.parentExists = true;\n          ret.parentPath = lookup.path;\n          ret.parentObject = lookup.node;\n          ret.name = PATH.basename(path);\n          lookup = FS.lookupPath(path, { follow: !dontResolveLastLink });\n          ret.exists = true;\n          ret.path = lookup.path;\n          ret.object = lookup.node;\n          ret.name = lookup.node.name;\n          ret.isRoot = lookup.path === "/";\n        } catch (e) {\n          ret.error = e.errno;\n        }\n        return ret;\n      },\n      createPath(parent, path, canRead, canWrite) {\n        parent = typeof parent == "string" ? parent : FS.getPath(parent);\n        var parts = path.split("/").reverse();\n        while (parts.length) {\n          var part = parts.pop();\n          if (!part) continue;\n          var current = PATH.join2(parent, part);\n          try {\n            FS.mkdir(current);\n          } catch (e) {\n          }\n          parent = current;\n        }\n        return current;\n      },\n      createFile(parent, name, properties, canRead, canWrite) {\n        var path = PATH.join2(typeof parent == "string" ? parent : FS.getPath(parent), name);\n        var mode = FS_getMode(canRead, canWrite);\n        return FS.create(path, mode);\n      },\n      createDataFile(parent, name, data, canRead, canWrite, canOwn) {\n        var path = name;\n        if (parent) {\n          parent = typeof parent == "string" ? parent : FS.getPath(parent);\n          path = name ? PATH.join2(parent, name) : parent;\n        }\n        var mode = FS_getMode(canRead, canWrite);\n        var node = FS.create(path, mode);\n        if (data) {\n          if (typeof data == "string") {\n            var arr = new Array(data.length);\n            for (var i = 0, len = data.length; i < len; ++i) arr[i] = data.charCodeAt(i);\n            data = arr;\n          }\n          FS.chmod(node, mode | 146);\n          var stream = FS.open(node, 577);\n          FS.write(stream, data, 0, data.length, 0, canOwn);\n          FS.close(stream);\n          FS.chmod(node, mode);\n        }\n      },\n      createDevice(parent, name, input, output) {\n        var _a;\n        var path = PATH.join2(typeof parent == "string" ? parent : FS.getPath(parent), name);\n        var mode = FS_getMode(!!input, !!output);\n        (_a = FS.createDevice).major ?? (_a.major = 64);\n        var dev = FS.makedev(FS.createDevice.major++, 0);\n        FS.registerDevice(dev, {\n          open(stream) {\n            stream.seekable = false;\n          },\n          close(stream) {\n            var _a2;\n            if ((_a2 = output == null ? void 0 : output.buffer) == null ? void 0 : _a2.length) {\n              output(10);\n            }\n          },\n          read(stream, buffer, offset, length, pos) {\n            var bytesRead = 0;\n            for (var i = 0; i < length; i++) {\n              var result;\n              try {\n                result = input();\n              } catch (e) {\n                throw new FS.ErrnoError(29);\n              }\n              if (result === void 0 && bytesRead === 0) {\n                throw new FS.ErrnoError(6);\n              }\n              if (result === null || result === void 0) break;\n              bytesRead++;\n              buffer[offset + i] = result;\n            }\n            if (bytesRead) {\n              stream.node.timestamp = Date.now();\n            }\n            return bytesRead;\n          },\n          write(stream, buffer, offset, length, pos) {\n            for (var i = 0; i < length; i++) {\n              try {\n                output(buffer[offset + i]);\n              } catch (e) {\n                throw new FS.ErrnoError(29);\n              }\n            }\n            if (length) {\n              stream.node.timestamp = Date.now();\n            }\n            return i;\n          }\n        });\n        return FS.mkdev(path, mode, dev);\n      },\n      forceLoadFile(obj) {\n        if (obj.isDevice || obj.isFolder || obj.link || obj.contents) return true;\n        if (typeof XMLHttpRequest != "undefined") {\n          throw new Error(\n            "Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread."\n          );\n        } else {\n          try {\n            obj.contents = readBinary(obj.url);\n            obj.usedBytes = obj.contents.length;\n          } catch (e) {\n            throw new FS.ErrnoError(29);\n          }\n        }\n      },\n      createLazyFile(parent, name, url, canRead, canWrite) {\n        class LazyUint8Array {\n          constructor() {\n            this.lengthKnown = false;\n            this.chunks = [];\n          }\n          get(idx) {\n            if (idx > this.length - 1 || idx < 0) {\n              return void 0;\n            }\n            var chunkOffset = idx % this.chunkSize;\n            var chunkNum = idx / this.chunkSize | 0;\n            return this.getter(chunkNum)[chunkOffset];\n          }\n          setDataGetter(getter) {\n            this.getter = getter;\n          }\n          cacheLength() {\n            var xhr = new XMLHttpRequest();\n            xhr.open("HEAD", url, false);\n            xhr.send(null);\n            if (!(xhr.status >= 200 && xhr.status < 300 || xhr.status === 304))\n              throw new Error("Couldn\'t load " + url + ". Status: " + xhr.status);\n            var datalength = Number(xhr.getResponseHeader("Content-length"));\n            var header;\n            var hasByteServing = (header = xhr.getResponseHeader("Accept-Ranges")) && header === "bytes";\n            var usesGzip = (header = xhr.getResponseHeader("Content-Encoding")) && header === "gzip";\n            var chunkSize = 1024 * 1024;\n            if (!hasByteServing) chunkSize = datalength;\n            var doXHR = (from, to) => {\n              if (from > to)\n                throw new Error("invalid range (" + from + ", " + to + ") or no bytes requested!");\n              if (to > datalength - 1)\n                throw new Error("only " + datalength + " bytes available! programmer error!");\n              var xhr2 = new XMLHttpRequest();\n              xhr2.open("GET", url, false);\n              if (datalength !== chunkSize)\n                xhr2.setRequestHeader("Range", "bytes=" + from + "-" + to);\n              xhr2.responseType = "arraybuffer";\n              if (xhr2.overrideMimeType) {\n                xhr2.overrideMimeType("text/plain; charset=x-user-defined");\n              }\n              xhr2.send(null);\n              if (!(xhr2.status >= 200 && xhr2.status < 300 || xhr2.status === 304))\n                throw new Error("Couldn\'t load " + url + ". Status: " + xhr2.status);\n              if (xhr2.response !== void 0) {\n                return new Uint8Array(\n                  /** @type{Array<number>} */\n                  xhr2.response || []\n                );\n              }\n              return intArrayFromString(xhr2.responseText || "");\n            };\n            var lazyArray2 = this;\n            lazyArray2.setDataGetter((chunkNum) => {\n              var start = chunkNum * chunkSize;\n              var end = (chunkNum + 1) * chunkSize - 1;\n              end = Math.min(end, datalength - 1);\n              if (typeof lazyArray2.chunks[chunkNum] == "undefined") {\n                lazyArray2.chunks[chunkNum] = doXHR(start, end);\n              }\n              if (typeof lazyArray2.chunks[chunkNum] == "undefined")\n                throw new Error("doXHR failed!");\n              return lazyArray2.chunks[chunkNum];\n            });\n            if (usesGzip || !datalength) {\n              chunkSize = datalength = 1;\n              datalength = this.getter(0).length;\n              chunkSize = datalength;\n              out("LazyFiles on gzip forces download of the whole file when length is accessed");\n            }\n            this._length = datalength;\n            this._chunkSize = chunkSize;\n            this.lengthKnown = true;\n          }\n          get length() {\n            if (!this.lengthKnown) {\n              this.cacheLength();\n            }\n            return this._length;\n          }\n          get chunkSize() {\n            if (!this.lengthKnown) {\n              this.cacheLength();\n            }\n            return this._chunkSize;\n          }\n        }\n        if (typeof XMLHttpRequest != "undefined") {\n          if (!ENVIRONMENT_IS_WORKER)\n            throw "Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";\n          var lazyArray = new LazyUint8Array();\n          var properties = { isDevice: false, contents: lazyArray };\n        } else {\n          var properties = { isDevice: false, url };\n        }\n        var node = FS.createFile(parent, name, properties, canRead, canWrite);\n        if (properties.contents) {\n          node.contents = properties.contents;\n        } else if (properties.url) {\n          node.contents = null;\n          node.url = properties.url;\n        }\n        Object.defineProperties(node, {\n          usedBytes: {\n            get: function() {\n              return this.contents.length;\n            }\n          }\n        });\n        var stream_ops = {};\n        var keys = Object.keys(node.stream_ops);\n        keys.forEach((key) => {\n          var fn = node.stream_ops[key];\n          stream_ops[key] = (...args) => {\n            FS.forceLoadFile(node);\n            return fn(...args);\n          };\n        });\n        function writeChunks(stream, buffer, offset, length, position) {\n          var contents = stream.node.contents;\n          if (position >= contents.length) return 0;\n          var size = Math.min(contents.length - position, length);\n          assert(size >= 0);\n          if (contents.slice) {\n            for (var i = 0; i < size; i++) {\n              buffer[offset + i] = contents[position + i];\n            }\n          } else {\n            for (var i = 0; i < size; i++) {\n              buffer[offset + i] = contents.get(position + i);\n            }\n          }\n          return size;\n        }\n        stream_ops.read = (stream, buffer, offset, length, position) => {\n          FS.forceLoadFile(node);\n          return writeChunks(stream, buffer, offset, length, position);\n        };\n        stream_ops.mmap = (stream, length, position, prot, flags) => {\n          FS.forceLoadFile(node);\n          var ptr = mmapAlloc(length);\n          if (!ptr) {\n            throw new FS.ErrnoError(48);\n          }\n          writeChunks(stream, HEAP8, ptr, length, position);\n          return { ptr, allocated: true };\n        };\n        node.stream_ops = stream_ops;\n        return node;\n      },\n      absolutePath() {\n        abort("FS.absolutePath has been removed; use PATH_FS.resolve instead");\n      },\n      createFolder() {\n        abort("FS.createFolder has been removed; use FS.mkdir instead");\n      },\n      createLink() {\n        abort("FS.createLink has been removed; use FS.symlink instead");\n      },\n      joinPath() {\n        abort("FS.joinPath has been removed; use PATH.join instead");\n      },\n      mmapAlloc() {\n        abort("FS.mmapAlloc has been replaced by the top level function mmapAlloc");\n      },\n      standardizePath() {\n        abort("FS.standardizePath has been removed; use PATH.normalize instead");\n      }\n    };\n    var SYSCALLS = {\n      DEFAULT_POLLMASK: 5,\n      calculateAt(dirfd, path, allowEmpty) {\n        if (PATH.isAbs(path)) {\n          return path;\n        }\n        var dir;\n        if (dirfd === -100) {\n          dir = FS.cwd();\n        } else {\n          var dirstream = SYSCALLS.getStreamFromFD(dirfd);\n          dir = dirstream.path;\n        }\n        if (path.length == 0) {\n          if (!allowEmpty) {\n            throw new FS.ErrnoError(44);\n          }\n          return dir;\n        }\n        return PATH.join2(dir, path);\n      },\n      doStat(func, path, buf) {\n        var stat = func(path);\n        HEAP32[buf >> 2] = stat.dev;\n        HEAP32[buf + 4 >> 2] = stat.mode;\n        HEAPU32[buf + 8 >> 2] = stat.nlink;\n        HEAP32[buf + 12 >> 2] = stat.uid;\n        HEAP32[buf + 16 >> 2] = stat.gid;\n        HEAP32[buf + 20 >> 2] = stat.rdev;\n        tempI64 = [\n          stat.size >>> 0,\n          (tempDouble = stat.size, +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n        ], HEAP32[buf + 24 >> 2] = tempI64[0], HEAP32[buf + 28 >> 2] = tempI64[1];\n        HEAP32[buf + 32 >> 2] = 4096;\n        HEAP32[buf + 36 >> 2] = stat.blocks;\n        var atime = stat.atime.getTime();\n        var mtime = stat.mtime.getTime();\n        var ctime = stat.ctime.getTime();\n        tempI64 = [\n          Math.floor(atime / 1e3) >>> 0,\n          (tempDouble = Math.floor(atime / 1e3), +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n        ], HEAP32[buf + 40 >> 2] = tempI64[0], HEAP32[buf + 44 >> 2] = tempI64[1];\n        HEAPU32[buf + 48 >> 2] = atime % 1e3 * 1e3 * 1e3;\n        tempI64 = [\n          Math.floor(mtime / 1e3) >>> 0,\n          (tempDouble = Math.floor(mtime / 1e3), +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n        ], HEAP32[buf + 56 >> 2] = tempI64[0], HEAP32[buf + 60 >> 2] = tempI64[1];\n        HEAPU32[buf + 64 >> 2] = mtime % 1e3 * 1e3 * 1e3;\n        tempI64 = [\n          Math.floor(ctime / 1e3) >>> 0,\n          (tempDouble = Math.floor(ctime / 1e3), +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n        ], HEAP32[buf + 72 >> 2] = tempI64[0], HEAP32[buf + 76 >> 2] = tempI64[1];\n        HEAPU32[buf + 80 >> 2] = ctime % 1e3 * 1e3 * 1e3;\n        tempI64 = [\n          stat.ino >>> 0,\n          (tempDouble = stat.ino, +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n        ], HEAP32[buf + 88 >> 2] = tempI64[0], HEAP32[buf + 92 >> 2] = tempI64[1];\n        return 0;\n      },\n      doMsync(addr, stream, len, flags, offset) {\n        if (!FS.isFile(stream.node.mode)) {\n          throw new FS.ErrnoError(43);\n        }\n        if (flags & 2) {\n          return 0;\n        }\n        var buffer = HEAPU8.slice(addr, addr + len);\n        FS.msync(stream, buffer, offset, len, flags);\n      },\n      getStreamFromFD(fd) {\n        var stream = FS.getStreamChecked(fd);\n        return stream;\n      },\n      varargs: void 0,\n      getStr(ptr) {\n        var ret = UTF8ToString(ptr);\n        return ret;\n      }\n    };\n    function ___syscall_fcntl64(fd, cmd, varargs) {\n      SYSCALLS.varargs = varargs;\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        switch (cmd) {\n          case 0: {\n            var arg = syscallGetVarargI();\n            if (arg < 0) {\n              return -28;\n            }\n            while (FS.streams[arg]) {\n              arg++;\n            }\n            var newStream;\n            newStream = FS.dupStream(stream, arg);\n            return newStream.fd;\n          }\n          case 1:\n          case 2:\n            return 0;\n          // FD_CLOEXEC makes no sense for a single process.\n          case 3:\n            return stream.flags;\n          case 4: {\n            var arg = syscallGetVarargI();\n            stream.flags |= arg;\n            return 0;\n          }\n          case 12: {\n            var arg = syscallGetVarargP();\n            var offset = 0;\n            HEAP16[arg + offset >> 1] = 2;\n            return 0;\n          }\n          case 13:\n          case 14:\n            return 0;\n        }\n        return -28;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_fstat64(fd, buf) {\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        return SYSCALLS.doStat(FS.stat, stream.path, buf);\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    var convertI32PairToI53Checked = (lo, hi) => {\n      assert(lo == lo >>> 0 || lo == (lo | 0));\n      assert(hi === (hi | 0));\n      return hi + 2097152 >>> 0 < 4194305 - !!lo ? (lo >>> 0) + hi * 4294967296 : NaN;\n    };\n    function ___syscall_ftruncate64(fd, length_low, length_high) {\n      var length = convertI32PairToI53Checked(length_low, length_high);\n      try {\n        if (isNaN(length)) return 61;\n        FS.ftruncate(fd, length);\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    var stringToUTF8 = (str, outPtr, maxBytesToWrite) => {\n      assert(\n        typeof maxBytesToWrite == "number",\n        "stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"\n      );\n      return stringToUTF8Array(str, HEAPU8, outPtr, maxBytesToWrite);\n    };\n    function ___syscall_getdents64(fd, dirp, count) {\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        stream.getdents || (stream.getdents = FS.readdir(stream.path));\n        var struct_size = 280;\n        var pos = 0;\n        var off = FS.llseek(stream, 0, 1);\n        var idx = Math.floor(off / struct_size);\n        while (idx < stream.getdents.length && pos + struct_size <= count) {\n          var id;\n          var type;\n          var name = stream.getdents[idx];\n          if (name === ".") {\n            id = stream.node.id;\n            type = 4;\n          } else if (name === "..") {\n            var lookup = FS.lookupPath(stream.path, { parent: true });\n            id = lookup.node.id;\n            type = 4;\n          } else {\n            var child = FS.lookupNode(stream.node, name);\n            id = child.id;\n            type = FS.isChrdev(child.mode) ? 2 : FS.isDir(child.mode) ? 4 : FS.isLink(child.mode) ? 10 : 8;\n          }\n          assert(id);\n          tempI64 = [\n            id >>> 0,\n            (tempDouble = id, +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n          ], HEAP32[dirp + pos >> 2] = tempI64[0], HEAP32[dirp + pos + 4 >> 2] = tempI64[1];\n          tempI64 = [\n            (idx + 1) * struct_size >>> 0,\n            (tempDouble = (idx + 1) * struct_size, +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n          ], HEAP32[dirp + pos + 8 >> 2] = tempI64[0], HEAP32[dirp + pos + 12 >> 2] = tempI64[1];\n          HEAP16[dirp + pos + 16 >> 1] = 280;\n          HEAP8[dirp + pos + 18] = type;\n          stringToUTF8(name, dirp + pos + 19, 256);\n          pos += struct_size;\n          idx += 1;\n        }\n        FS.llseek(stream, idx * struct_size, 0);\n        return pos;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_ioctl(fd, op, varargs) {\n      SYSCALLS.varargs = varargs;\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        switch (op) {\n          case 21509: {\n            if (!stream.tty) return -59;\n            return 0;\n          }\n          case 21505: {\n            if (!stream.tty) return -59;\n            if (stream.tty.ops.ioctl_tcgets) {\n              var termios = stream.tty.ops.ioctl_tcgets(stream);\n              var argp = syscallGetVarargP();\n              HEAP32[argp >> 2] = termios.c_iflag || 0;\n              HEAP32[argp + 4 >> 2] = termios.c_oflag || 0;\n              HEAP32[argp + 8 >> 2] = termios.c_cflag || 0;\n              HEAP32[argp + 12 >> 2] = termios.c_lflag || 0;\n              for (var i = 0; i < 32; i++) {\n                HEAP8[argp + i + 17] = termios.c_cc[i] || 0;\n              }\n              return 0;\n            }\n            return 0;\n          }\n          case 21510:\n          case 21511:\n          case 21512: {\n            if (!stream.tty) return -59;\n            return 0;\n          }\n          case 21506:\n          case 21507:\n          case 21508: {\n            if (!stream.tty) return -59;\n            if (stream.tty.ops.ioctl_tcsets) {\n              var argp = syscallGetVarargP();\n              var c_iflag = HEAP32[argp >> 2];\n              var c_oflag = HEAP32[argp + 4 >> 2];\n              var c_cflag = HEAP32[argp + 8 >> 2];\n              var c_lflag = HEAP32[argp + 12 >> 2];\n              var c_cc = [];\n              for (var i = 0; i < 32; i++) {\n                c_cc.push(HEAP8[argp + i + 17]);\n              }\n              return stream.tty.ops.ioctl_tcsets(stream.tty, op, {\n                c_iflag,\n                c_oflag,\n                c_cflag,\n                c_lflag,\n                c_cc\n              });\n            }\n            return 0;\n          }\n          case 21519: {\n            if (!stream.tty) return -59;\n            var argp = syscallGetVarargP();\n            HEAP32[argp >> 2] = 0;\n            return 0;\n          }\n          case 21520: {\n            if (!stream.tty) return -59;\n            return -28;\n          }\n          case 21531: {\n            var argp = syscallGetVarargP();\n            return FS.ioctl(stream, op, argp);\n          }\n          case 21523: {\n            if (!stream.tty) return -59;\n            if (stream.tty.ops.ioctl_tiocgwinsz) {\n              var winsize = stream.tty.ops.ioctl_tiocgwinsz(stream.tty);\n              var argp = syscallGetVarargP();\n              HEAP16[argp >> 1] = winsize[0];\n              HEAP16[argp + 2 >> 1] = winsize[1];\n            }\n            return 0;\n          }\n          case 21524: {\n            if (!stream.tty) return -59;\n            return 0;\n          }\n          case 21515: {\n            if (!stream.tty) return -59;\n            return 0;\n          }\n          default:\n            return -28;\n        }\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_lstat64(path, buf) {\n      try {\n        path = SYSCALLS.getStr(path);\n        return SYSCALLS.doStat(FS.lstat, path, buf);\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_newfstatat(dirfd, path, buf, flags) {\n      try {\n        path = SYSCALLS.getStr(path);\n        var nofollow = flags & 256;\n        var allowEmpty = flags & 4096;\n        flags = flags & ~6400;\n        assert(!flags, `unknown flags in __syscall_newfstatat: ${flags}`);\n        path = SYSCALLS.calculateAt(dirfd, path, allowEmpty);\n        return SYSCALLS.doStat(nofollow ? FS.lstat : FS.stat, path, buf);\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_openat(dirfd, path, flags, varargs) {\n      SYSCALLS.varargs = varargs;\n      try {\n        path = SYSCALLS.getStr(path);\n        path = SYSCALLS.calculateAt(dirfd, path);\n        var mode = varargs ? syscallGetVarargI() : 0;\n        return FS.open(path, flags, mode).fd;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_rmdir(path) {\n      try {\n        path = SYSCALLS.getStr(path);\n        FS.rmdir(path);\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_stat64(path, buf) {\n      try {\n        path = SYSCALLS.getStr(path);\n        return SYSCALLS.doStat(FS.stat, path, buf);\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    function ___syscall_unlinkat(dirfd, path, flags) {\n      try {\n        path = SYSCALLS.getStr(path);\n        path = SYSCALLS.calculateAt(dirfd, path);\n        if (flags === 0) {\n          FS.unlink(path);\n        } else if (flags === 512) {\n          FS.rmdir(path);\n        } else {\n          abort("Invalid flags passed to unlinkat");\n        }\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return -e.errno;\n      }\n    }\n    var __abort_js = () => {\n      abort("native code called abort()");\n    };\n    var __emscripten_memcpy_js = (dest, src, num) => HEAPU8.copyWithin(dest, src, src + num);\n    var __emscripten_throw_longjmp = () => {\n      throw Infinity;\n    };\n    function __gmtime_js(time_low, time_high, tmPtr) {\n      var time = convertI32PairToI53Checked(time_low, time_high);\n      var date = new Date(time * 1e3);\n      HEAP32[tmPtr >> 2] = date.getUTCSeconds();\n      HEAP32[tmPtr + 4 >> 2] = date.getUTCMinutes();\n      HEAP32[tmPtr + 8 >> 2] = date.getUTCHours();\n      HEAP32[tmPtr + 12 >> 2] = date.getUTCDate();\n      HEAP32[tmPtr + 16 >> 2] = date.getUTCMonth();\n      HEAP32[tmPtr + 20 >> 2] = date.getUTCFullYear() - 1900;\n      HEAP32[tmPtr + 24 >> 2] = date.getUTCDay();\n      var start = Date.UTC(date.getUTCFullYear(), 0, 1, 0, 0, 0, 0);\n      var yday = (date.getTime() - start) / (1e3 * 60 * 60 * 24) | 0;\n      HEAP32[tmPtr + 28 >> 2] = yday;\n    }\n    var isLeapYear = (year) => year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0);\n    var MONTH_DAYS_LEAP_CUMULATIVE = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335];\n    var MONTH_DAYS_REGULAR_CUMULATIVE = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];\n    var ydayFromDate = (date) => {\n      var leap = isLeapYear(date.getFullYear());\n      var monthDaysCumulative = leap ? MONTH_DAYS_LEAP_CUMULATIVE : MONTH_DAYS_REGULAR_CUMULATIVE;\n      var yday = monthDaysCumulative[date.getMonth()] + date.getDate() - 1;\n      return yday;\n    };\n    function __localtime_js(time_low, time_high, tmPtr) {\n      var time = convertI32PairToI53Checked(time_low, time_high);\n      var date = new Date(time * 1e3);\n      HEAP32[tmPtr >> 2] = date.getSeconds();\n      HEAP32[tmPtr + 4 >> 2] = date.getMinutes();\n      HEAP32[tmPtr + 8 >> 2] = date.getHours();\n      HEAP32[tmPtr + 12 >> 2] = date.getDate();\n      HEAP32[tmPtr + 16 >> 2] = date.getMonth();\n      HEAP32[tmPtr + 20 >> 2] = date.getFullYear() - 1900;\n      HEAP32[tmPtr + 24 >> 2] = date.getDay();\n      var yday = ydayFromDate(date) | 0;\n      HEAP32[tmPtr + 28 >> 2] = yday;\n      HEAP32[tmPtr + 36 >> 2] = -(date.getTimezoneOffset() * 60);\n      var start = new Date(date.getFullYear(), 0, 1);\n      var summerOffset = new Date(date.getFullYear(), 6, 1).getTimezoneOffset();\n      var winterOffset = start.getTimezoneOffset();\n      var dst = (summerOffset != winterOffset && date.getTimezoneOffset() == Math.min(winterOffset, summerOffset)) | 0;\n      HEAP32[tmPtr + 32 >> 2] = dst;\n    }\n    var __tzset_js = (timezone, daylight, std_name, dst_name) => {\n      var currentYear = (/* @__PURE__ */ new Date()).getFullYear();\n      var winter = new Date(currentYear, 0, 1);\n      var summer = new Date(currentYear, 6, 1);\n      var winterOffset = winter.getTimezoneOffset();\n      var summerOffset = summer.getTimezoneOffset();\n      var stdTimezoneOffset = Math.max(winterOffset, summerOffset);\n      HEAPU32[timezone >> 2] = stdTimezoneOffset * 60;\n      HEAP32[daylight >> 2] = Number(winterOffset != summerOffset);\n      var extractZone = (timezoneOffset) => {\n        var sign = timezoneOffset >= 0 ? "-" : "+";\n        var absOffset = Math.abs(timezoneOffset);\n        var hours = String(Math.floor(absOffset / 60)).padStart(2, "0");\n        var minutes = String(absOffset % 60).padStart(2, "0");\n        return `UTC${sign}${hours}${minutes}`;\n      };\n      var winterName = extractZone(winterOffset);\n      var summerName = extractZone(summerOffset);\n      assert(winterName);\n      assert(summerName);\n      assert(\n        lengthBytesUTF8(winterName) <= 16,\n        `timezone name truncated to fit in TZNAME_MAX (${winterName})`\n      );\n      assert(\n        lengthBytesUTF8(summerName) <= 16,\n        `timezone name truncated to fit in TZNAME_MAX (${summerName})`\n      );\n      if (summerOffset < winterOffset) {\n        stringToUTF8(winterName, std_name, 17);\n        stringToUTF8(summerName, dst_name, 17);\n      } else {\n        stringToUTF8(winterName, dst_name, 17);\n        stringToUTF8(summerName, std_name, 17);\n      }\n    };\n    var _emscripten_date_now = () => Date.now();\n    var getHeapMax = () => (\n      // Stay one Wasm page short of 4GB: while e.g. Chrome is able to allocate\n      // full 4GB Wasm memories, the size will wrap back to 0 bytes in Wasm side\n      // for any code that deals with heap sizes, which would require special\n      // casing all heap size related code to treat 0 specially.\n      2147483648\n    );\n    var growMemory = (size) => {\n      var b = wasmMemory.buffer;\n      var pages = (size - b.byteLength + 65535) / 65536 | 0;\n      try {\n        wasmMemory.grow(pages);\n        updateMemoryViews();\n        return 1;\n      } catch (e) {\n        err(\n          `growMemory: Attempted to grow heap from ${b.byteLength} bytes to ${size} bytes, but got error: ${e}`\n        );\n      }\n    };\n    var _emscripten_resize_heap = (requestedSize) => {\n      var oldSize = HEAPU8.length;\n      requestedSize >>>= 0;\n      assert(requestedSize > oldSize);\n      var maxHeapSize = getHeapMax();\n      if (requestedSize > maxHeapSize) {\n        err(\n          `Cannot enlarge memory, requested ${requestedSize} bytes, but the limit is ${maxHeapSize} bytes!`\n        );\n        return false;\n      }\n      for (var cutDown = 1; cutDown <= 4; cutDown *= 2) {\n        var overGrownHeapSize = oldSize * (1 + 0.2 / cutDown);\n        overGrownHeapSize = Math.min(overGrownHeapSize, requestedSize + 100663296);\n        var newSize = Math.min(\n          maxHeapSize,\n          alignMemory(Math.max(requestedSize, overGrownHeapSize), 65536)\n        );\n        var replacement = growMemory(newSize);\n        if (replacement) {\n          return true;\n        }\n      }\n      err(`Failed to grow the heap from ${oldSize} bytes to ${newSize} bytes, not enough memory!`);\n      return false;\n    };\n    var ENV = {};\n    var getExecutableName = () => {\n      return thisProgram || "./this.program";\n    };\n    var getEnvStrings = () => {\n      if (!getEnvStrings.strings) {\n        var lang = (typeof navigator == "object" && navigator.languages && navigator.languages[0] || "C").replace("-", "_") + ".UTF-8";\n        var env = {\n          USER: "web_user",\n          LOGNAME: "web_user",\n          PATH: "/",\n          PWD: "/",\n          HOME: "/home/web_user",\n          LANG: lang,\n          _: getExecutableName()\n        };\n        for (var x in ENV) {\n          if (ENV[x] === void 0) delete env[x];\n          else env[x] = ENV[x];\n        }\n        var strings = [];\n        for (var x in env) {\n          strings.push(`${x}=${env[x]}`);\n        }\n        getEnvStrings.strings = strings;\n      }\n      return getEnvStrings.strings;\n    };\n    var stringToAscii = (str, buffer) => {\n      for (var i = 0; i < str.length; ++i) {\n        assert(str.charCodeAt(i) === (str.charCodeAt(i) & 255));\n        HEAP8[buffer++] = str.charCodeAt(i);\n      }\n      HEAP8[buffer] = 0;\n    };\n    var _environ_get = (__environ, environ_buf) => {\n      var bufSize = 0;\n      getEnvStrings().forEach((string, i) => {\n        var ptr = environ_buf + bufSize;\n        HEAPU32[__environ + i * 4 >> 2] = ptr;\n        stringToAscii(string, ptr);\n        bufSize += string.length + 1;\n      });\n      return 0;\n    };\n    var _environ_sizes_get = (penviron_count, penviron_buf_size) => {\n      var strings = getEnvStrings();\n      HEAPU32[penviron_count >> 2] = strings.length;\n      var bufSize = 0;\n      strings.forEach((string) => bufSize += string.length + 1);\n      HEAPU32[penviron_buf_size >> 2] = bufSize;\n      return 0;\n    };\n    function _fd_close(fd) {\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        FS.close(stream);\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return e.errno;\n      }\n    }\n    var doReadv = (stream, iov, iovcnt, offset) => {\n      var ret = 0;\n      for (var i = 0; i < iovcnt; i++) {\n        var ptr = HEAPU32[iov >> 2];\n        var len = HEAPU32[iov + 4 >> 2];\n        iov += 8;\n        var curr = FS.read(stream, HEAP8, ptr, len, offset);\n        if (curr < 0) return -1;\n        ret += curr;\n        if (curr < len) break;\n      }\n      return ret;\n    };\n    function _fd_read(fd, iov, iovcnt, pnum) {\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        var num = doReadv(stream, iov, iovcnt);\n        HEAPU32[pnum >> 2] = num;\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return e.errno;\n      }\n    }\n    function _fd_seek(fd, offset_low, offset_high, whence, newOffset) {\n      var offset = convertI32PairToI53Checked(offset_low, offset_high);\n      try {\n        if (isNaN(offset)) return 61;\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        FS.llseek(stream, offset, whence);\n        tempI64 = [\n          stream.position >>> 0,\n          (tempDouble = stream.position, +Math.abs(tempDouble) >= 1 ? tempDouble > 0 ? +Math.floor(tempDouble / 4294967296) >>> 0 : ~~+Math.ceil((tempDouble - +(~~tempDouble >>> 0)) / 4294967296) >>> 0 : 0)\n        ], HEAP32[newOffset >> 2] = tempI64[0], HEAP32[newOffset + 4 >> 2] = tempI64[1];\n        if (stream.getdents && offset === 0 && whence === 0) stream.getdents = null;\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return e.errno;\n      }\n    }\n    function _fd_sync(fd) {\n      var _a;\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        if ((_a = stream.stream_ops) == null ? void 0 : _a.fsync) {\n          return stream.stream_ops.fsync(stream);\n        }\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return e.errno;\n      }\n    }\n    var doWritev = (stream, iov, iovcnt, offset) => {\n      var ret = 0;\n      for (var i = 0; i < iovcnt; i++) {\n        var ptr = HEAPU32[iov >> 2];\n        var len = HEAPU32[iov + 4 >> 2];\n        iov += 8;\n        var curr = FS.write(stream, HEAP8, ptr, len, offset);\n        if (curr < 0) return -1;\n        ret += curr;\n        if (curr < len) {\n          break;\n        }\n      }\n      return ret;\n    };\n    function _fd_write(fd, iov, iovcnt, pnum) {\n      try {\n        var stream = SYSCALLS.getStreamFromFD(fd);\n        var num = doWritev(stream, iov, iovcnt);\n        HEAPU32[pnum >> 2] = num;\n        return 0;\n      } catch (e) {\n        if (typeof FS == "undefined" || !(e.name === "ErrnoError")) throw e;\n        return e.errno;\n      }\n    }\n    var wasmTableMirror = [];\n    var wasmTable;\n    var getWasmTableEntry = (funcPtr) => {\n      var func = wasmTableMirror[funcPtr];\n      if (!func) {\n        if (funcPtr >= wasmTableMirror.length) wasmTableMirror.length = funcPtr + 1;\n        wasmTableMirror[funcPtr] = func = wasmTable.get(funcPtr);\n      }\n      assert(\n        wasmTable.get(funcPtr) == func,\n        "JavaScript-side Wasm function table mirror is out of date!"\n      );\n      return func;\n    };\n    var UTF16Decoder = typeof TextDecoder != "undefined" ? new TextDecoder("utf-16le") : void 0;\n    var UTF16ToString = (ptr, maxBytesToRead) => {\n      assert(ptr % 2 == 0, "Pointer passed to UTF16ToString must be aligned to two bytes!");\n      var endPtr = ptr;\n      var idx = endPtr >> 1;\n      var maxIdx = idx + maxBytesToRead / 2;\n      while (!(idx >= maxIdx) && HEAPU16[idx]) ++idx;\n      endPtr = idx << 1;\n      if (endPtr - ptr > 32 && UTF16Decoder)\n        return UTF16Decoder.decode(HEAPU8.subarray(ptr, endPtr));\n      var str = "";\n      for (var i = 0; !(i >= maxBytesToRead / 2); ++i) {\n        var codeUnit = HEAP16[ptr + i * 2 >> 1];\n        if (codeUnit == 0) break;\n        str += String.fromCharCode(codeUnit);\n      }\n      return str;\n    };\n    var uleb128Encode = (n, target) => {\n      assert(n < 16384);\n      if (n < 128) {\n        target.push(n);\n      } else {\n        target.push(n % 128 | 128, n >> 7);\n      }\n    };\n    var sigToWasmTypes = (sig) => {\n      assert(\n        !sig.includes("j"),\n        "i64 not permitted in function signatures when WASM_BIGINT is disabled"\n      );\n      var typeNames = {\n        i: "i32",\n        j: "i64",\n        f: "f32",\n        d: "f64",\n        e: "externref",\n        p: "i32"\n      };\n      var type = {\n        parameters: [],\n        results: sig[0] == "v" ? [] : [typeNames[sig[0]]]\n      };\n      for (var i = 1; i < sig.length; ++i) {\n        assert(sig[i] in typeNames, "invalid signature char: " + sig[i]);\n        type.parameters.push(typeNames[sig[i]]);\n      }\n      return type;\n    };\n    var generateFuncType = (sig, target) => {\n      var sigRet = sig.slice(0, 1);\n      var sigParam = sig.slice(1);\n      var typeCodes = {\n        i: 127,\n        // i32\n        p: 127,\n        // i32\n        j: 126,\n        // i64\n        f: 125,\n        // f32\n        d: 124,\n        // f64\n        e: 111\n        // externref\n      };\n      target.push(\n        96\n        /* form: func */\n      );\n      uleb128Encode(sigParam.length, target);\n      for (var i = 0; i < sigParam.length; ++i) {\n        assert(sigParam[i] in typeCodes, "invalid signature char: " + sigParam[i]);\n        target.push(typeCodes[sigParam[i]]);\n      }\n      if (sigRet == "v") {\n        target.push(0);\n      } else {\n        target.push(1, typeCodes[sigRet]);\n      }\n    };\n    var convertJsFunctionToWasm = (func, sig) => {\n      assert(\n        !sig.includes("j"),\n        "i64 not permitted in function signatures when WASM_BIGINT is disabled"\n      );\n      if (typeof WebAssembly.Function == "function") {\n        return new WebAssembly.Function(sigToWasmTypes(sig), func);\n      }\n      var typeSectionBody = [\n        1\n        // count: 1\n      ];\n      generateFuncType(sig, typeSectionBody);\n      var bytes = [\n        0,\n        97,\n        115,\n        109,\n        // magic ("\\0asm")\n        1,\n        0,\n        0,\n        0,\n        // version: 1\n        1\n        // Type section code\n      ];\n      uleb128Encode(typeSectionBody.length, bytes);\n      bytes.push(...typeSectionBody);\n      bytes.push(\n        2,\n        7,\n        // import section\n        // (import "e" "f" (func 0 (type 0)))\n        1,\n        1,\n        101,\n        1,\n        102,\n        0,\n        0,\n        7,\n        5,\n        // export section\n        // (export "f" (func 0 (type 0)))\n        1,\n        1,\n        102,\n        0,\n        0\n      );\n      var module = new WebAssembly.Module(new Uint8Array(bytes));\n      var instance = new WebAssembly.Instance(module, { e: { f: func } });\n      var wrappedFunc = instance.exports["f"];\n      return wrappedFunc;\n    };\n    var updateTableMap = (offset, count) => {\n      if (functionsInTableMap) {\n        for (var i = offset; i < offset + count; i++) {\n          var item = getWasmTableEntry(i);\n          if (item) {\n            functionsInTableMap.set(item, i);\n          }\n        }\n      }\n    };\n    var functionsInTableMap;\n    var getFunctionAddress = (func) => {\n      if (!functionsInTableMap) {\n        functionsInTableMap = /* @__PURE__ */ new WeakMap();\n        updateTableMap(0, wasmTable.length);\n      }\n      return functionsInTableMap.get(func) || 0;\n    };\n    var freeTableIndexes = [];\n    var getEmptyTableSlot = () => {\n      if (freeTableIndexes.length) {\n        return freeTableIndexes.pop();\n      }\n      try {\n        wasmTable.grow(1);\n      } catch (err2) {\n        if (!(err2 instanceof RangeError)) {\n          throw err2;\n        }\n        throw "Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.";\n      }\n      return wasmTable.length - 1;\n    };\n    var setWasmTableEntry = (idx, func) => {\n      wasmTable.set(idx, func);\n      wasmTableMirror[idx] = wasmTable.get(idx);\n    };\n    var addFunction = (func, sig) => {\n      assert(typeof func != "undefined");\n      var rtn = getFunctionAddress(func);\n      if (rtn) {\n        return rtn;\n      }\n      var ret = getEmptyTableSlot();\n      try {\n        setWasmTableEntry(ret, func);\n      } catch (err2) {\n        if (!(err2 instanceof TypeError)) {\n          throw err2;\n        }\n        assert(typeof sig != "undefined", "Missing signature argument to addFunction: " + func);\n        var wrapped = convertJsFunctionToWasm(func, sig);\n        setWasmTableEntry(ret, wrapped);\n      }\n      functionsInTableMap.set(func, ret);\n      return ret;\n    };\n    var getCFunc = (ident) => {\n      var func = Module["_" + ident];\n      assert(func, "Cannot call unknown function " + ident + ", make sure it is exported");\n      return func;\n    };\n    var writeArrayToMemory = (array, buffer) => {\n      assert(\n        array.length >= 0,\n        "writeArrayToMemory array must have a length (should be an array or typed array)"\n      );\n      HEAP8.set(array, buffer);\n    };\n    var stackAlloc = (sz) => __emscripten_stack_alloc(sz);\n    var stringToUTF8OnStack = (str) => {\n      var size = lengthBytesUTF8(str) + 1;\n      var ret = stackAlloc(size);\n      stringToUTF8(str, ret, size);\n      return ret;\n    };\n    var ccall = (ident, returnType, argTypes, args, opts) => {\n      var toC = {\n        string: (str) => {\n          var ret2 = 0;\n          if (str !== null && str !== void 0 && str !== 0) {\n            ret2 = stringToUTF8OnStack(str);\n          }\n          return ret2;\n        },\n        array: (arr) => {\n          var ret2 = stackAlloc(arr.length);\n          writeArrayToMemory(arr, ret2);\n          return ret2;\n        }\n      };\n      function convertReturnValue(ret2) {\n        if (returnType === "string") {\n          return UTF8ToString(ret2);\n        }\n        if (returnType === "boolean") return Boolean(ret2);\n        return ret2;\n      }\n      var func = getCFunc(ident);\n      var cArgs = [];\n      var stack = 0;\n      assert(returnType !== "array", \'Return type should not be "array".\');\n      if (args) {\n        for (var i = 0; i < args.length; i++) {\n          var converter = toC[argTypes[i]];\n          if (converter) {\n            if (stack === 0) stack = stackSave();\n            cArgs[i] = converter(args[i]);\n          } else {\n            cArgs[i] = args[i];\n          }\n        }\n      }\n      var ret = func(...cArgs);\n      function onDone(ret2) {\n        if (stack !== 0) stackRestore(stack);\n        return convertReturnValue(ret2);\n      }\n      ret = onDone(ret);\n      return ret;\n    };\n    var cwrap = (ident, returnType, argTypes, opts) => {\n      return (...args) => ccall(ident, returnType, argTypes, args);\n    };\n    var removeFunction = (index) => {\n      functionsInTableMap.delete(getWasmTableEntry(index));\n      setWasmTableEntry(index, null);\n      freeTableIndexes.push(index);\n    };\n    var stringToUTF16 = (str, outPtr, maxBytesToWrite) => {\n      assert(outPtr % 2 == 0, "Pointer passed to stringToUTF16 must be aligned to two bytes!");\n      assert(\n        typeof maxBytesToWrite == "number",\n        "stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"\n      );\n      maxBytesToWrite ?? (maxBytesToWrite = 2147483647);\n      if (maxBytesToWrite < 2) return 0;\n      maxBytesToWrite -= 2;\n      var startPtr = outPtr;\n      var numCharsToWrite = maxBytesToWrite < str.length * 2 ? maxBytesToWrite / 2 : str.length;\n      for (var i = 0; i < numCharsToWrite; ++i) {\n        var codeUnit = str.charCodeAt(i);\n        HEAP16[outPtr >> 1] = codeUnit;\n        outPtr += 2;\n      }\n      HEAP16[outPtr >> 1] = 0;\n      return outPtr - startPtr;\n    };\n    FS.createPreloadedFile = FS_createPreloadedFile;\n    FS.staticInit();\n    function checkIncomingModuleAPI() {\n      ignoredModuleProp("fetchSettings");\n    }\n    var wasmImports = {\n      /** @export */\n      __assert_fail: ___assert_fail,\n      /** @export */\n      __syscall_fcntl64: ___syscall_fcntl64,\n      /** @export */\n      __syscall_fstat64: ___syscall_fstat64,\n      /** @export */\n      __syscall_ftruncate64: ___syscall_ftruncate64,\n      /** @export */\n      __syscall_getdents64: ___syscall_getdents64,\n      /** @export */\n      __syscall_ioctl: ___syscall_ioctl,\n      /** @export */\n      __syscall_lstat64: ___syscall_lstat64,\n      /** @export */\n      __syscall_newfstatat: ___syscall_newfstatat,\n      /** @export */\n      __syscall_openat: ___syscall_openat,\n      /** @export */\n      __syscall_rmdir: ___syscall_rmdir,\n      /** @export */\n      __syscall_stat64: ___syscall_stat64,\n      /** @export */\n      __syscall_unlinkat: ___syscall_unlinkat,\n      /** @export */\n      _abort_js: __abort_js,\n      /** @export */\n      _emscripten_memcpy_js: __emscripten_memcpy_js,\n      /** @export */\n      _emscripten_throw_longjmp: __emscripten_throw_longjmp,\n      /** @export */\n      _gmtime_js: __gmtime_js,\n      /** @export */\n      _localtime_js: __localtime_js,\n      /** @export */\n      _tzset_js: __tzset_js,\n      /** @export */\n      emscripten_date_now: _emscripten_date_now,\n      /** @export */\n      emscripten_resize_heap: _emscripten_resize_heap,\n      /** @export */\n      environ_get: _environ_get,\n      /** @export */\n      environ_sizes_get: _environ_sizes_get,\n      /** @export */\n      fd_close: _fd_close,\n      /** @export */\n      fd_read: _fd_read,\n      /** @export */\n      fd_seek: _fd_seek,\n      /** @export */\n      fd_sync: _fd_sync,\n      /** @export */\n      fd_write: _fd_write,\n      /** @export */\n      invoke_ii,\n      /** @export */\n      invoke_iii,\n      /** @export */\n      invoke_iiii,\n      /** @export */\n      invoke_iiiii,\n      /** @export */\n      invoke_v,\n      /** @export */\n      invoke_vii,\n      /** @export */\n      invoke_viii,\n      /** @export */\n      invoke_viiii,\n      /** @export */\n      invoke_viiiiiiiii\n    };\n    var wasmExports = createWasm();\n    Module["_PDFiumExt_Init"] = createExportWrapper("PDFiumExt_Init", 0);\n    Module["_FPDF_InitLibraryWithConfig"] = createExportWrapper(\n      "FPDF_InitLibraryWithConfig",\n      1\n    );\n    Module["_PDFiumExt_OpenFileWriter"] = createExportWrapper(\n      "PDFiumExt_OpenFileWriter",\n      0\n    );\n    Module["_PDFiumExt_GetFileWriterSize"] = createExportWrapper("PDFiumExt_GetFileWriterSize", 1);\n    Module["_PDFiumExt_GetFileWriterData"] = createExportWrapper("PDFiumExt_GetFileWriterData", 3);\n    Module["_PDFiumExt_CloseFileWriter"] = createExportWrapper(\n      "PDFiumExt_CloseFileWriter",\n      1\n    );\n    Module["_PDFiumExt_SaveAsCopy"] = createExportWrapper(\n      "PDFiumExt_SaveAsCopy",\n      2\n    );\n    Module["_FPDF_SaveAsCopy"] = createExportWrapper("FPDF_SaveAsCopy", 3);\n    Module["_PDFiumExt_OpenFormFillInfo"] = createExportWrapper(\n      "PDFiumExt_OpenFormFillInfo",\n      0\n    );\n    Module["_PDFiumExt_CloseFormFillInfo"] = createExportWrapper("PDFiumExt_CloseFormFillInfo", 1);\n    Module["_PDFiumExt_InitFormFillEnvironment"] = createExportWrapper("PDFiumExt_InitFormFillEnvironment", 2);\n    Module["_FPDFDOC_InitFormFillEnvironment"] = createExportWrapper("FPDFDOC_InitFormFillEnvironment", 2);\n    Module["_PDFiumExt_ExitFormFillEnvironment"] = createExportWrapper("PDFiumExt_ExitFormFillEnvironment", 1);\n    Module["_FPDFDOC_ExitFormFillEnvironment"] = createExportWrapper("FPDFDOC_ExitFormFillEnvironment", 1);\n    Module["_EPDFNamedDest_SetDest"] = createExportWrapper(\n      "EPDFNamedDest_SetDest",\n      3\n    );\n    Module["_EPDFNamedDest_Remove"] = createExportWrapper(\n      "EPDFNamedDest_Remove",\n      2\n    );\n    Module["_EPDFDest_CreateView"] = createExportWrapper(\n      "EPDFDest_CreateView",\n      4\n    );\n    Module["_EPDFDest_CreateXYZ"] = createExportWrapper(\n      "EPDFDest_CreateXYZ",\n      7\n    );\n    Module["_EPDFDest_CreateRemoteView"] = createExportWrapper(\n      "EPDFDest_CreateRemoteView",\n      5\n    );\n    Module["_EPDFDest_CreateRemoteXYZ"] = createExportWrapper(\n      "EPDFDest_CreateRemoteXYZ",\n      8\n    );\n    Module["_EPDFAction_CreateGoTo"] = createExportWrapper(\n      "EPDFAction_CreateGoTo",\n      2\n    );\n    Module["_EPDFAction_CreateGoToNamed"] = createExportWrapper(\n      "EPDFAction_CreateGoToNamed",\n      2\n    );\n    Module["_EPDFAction_CreateLaunch"] = createExportWrapper(\n      "EPDFAction_CreateLaunch",\n      2\n    );\n    Module["_EPDFAction_CreateRemoteGoToByName"] = createExportWrapper("EPDFAction_CreateRemoteGoToByName", 3);\n    Module["_EPDFAction_CreateRemoteGoToDest"] = createExportWrapper("EPDFAction_CreateRemoteGoToDest", 3);\n    Module["_EPDFAction_CreateURI"] = createExportWrapper(\n      "EPDFAction_CreateURI",\n      2\n    );\n    Module["_EPDFBookmark_Create"] = createExportWrapper(\n      "EPDFBookmark_Create",\n      2\n    );\n    Module["_EPDFBookmark_Delete"] = createExportWrapper(\n      "EPDFBookmark_Delete",\n      2\n    );\n    Module["_EPDFBookmark_AppendChild"] = createExportWrapper(\n      "EPDFBookmark_AppendChild",\n      3\n    );\n    Module["_EPDFBookmark_InsertAfter"] = createExportWrapper(\n      "EPDFBookmark_InsertAfter",\n      4\n    );\n    Module["_EPDFBookmark_Clear"] = createExportWrapper(\n      "EPDFBookmark_Clear",\n      1\n    );\n    Module["_EPDFBookmark_SetTitle"] = createExportWrapper(\n      "EPDFBookmark_SetTitle",\n      2\n    );\n    Module["_EPDFBookmark_SetDest"] = createExportWrapper(\n      "EPDFBookmark_SetDest",\n      3\n    );\n    Module["_EPDFBookmark_SetAction"] = createExportWrapper(\n      "EPDFBookmark_SetAction",\n      3\n    );\n    Module["_EPDFBookmark_ClearTarget"] = createExportWrapper(\n      "EPDFBookmark_ClearTarget",\n      1\n    );\n    Module["_EPDF_PNG_EncodeRGBA"] = createExportWrapper(\n      "EPDF_PNG_EncodeRGBA",\n      6\n    );\n    Module["_FPDFAnnot_IsSupportedSubtype"] = createExportWrapper("FPDFAnnot_IsSupportedSubtype", 1);\n    Module["_FPDFPage_CreateAnnot"] = createExportWrapper(\n      "FPDFPage_CreateAnnot",\n      2\n    );\n    Module["_FPDFPage_GetAnnotCount"] = createExportWrapper(\n      "FPDFPage_GetAnnotCount",\n      1\n    );\n    Module["_FPDFPage_GetAnnot"] = createExportWrapper(\n      "FPDFPage_GetAnnot",\n      2\n    );\n    Module["_FPDFPage_GetAnnotIndex"] = createExportWrapper(\n      "FPDFPage_GetAnnotIndex",\n      2\n    );\n    Module["_FPDFPage_CloseAnnot"] = createExportWrapper(\n      "FPDFPage_CloseAnnot",\n      1\n    );\n    Module["_FPDFPage_RemoveAnnot"] = createExportWrapper(\n      "FPDFPage_RemoveAnnot",\n      2\n    );\n    Module["_FPDFAnnot_GetSubtype"] = createExportWrapper(\n      "FPDFAnnot_GetSubtype",\n      1\n    );\n    Module["_FPDFAnnot_IsObjectSupportedSubtype"] = createExportWrapper("FPDFAnnot_IsObjectSupportedSubtype", 1);\n    Module["_FPDFAnnot_UpdateObject"] = createExportWrapper(\n      "FPDFAnnot_UpdateObject",\n      2\n    );\n    Module["_FPDFAnnot_AddInkStroke"] = createExportWrapper(\n      "FPDFAnnot_AddInkStroke",\n      3\n    );\n    Module["_FPDFAnnot_RemoveInkList"] = createExportWrapper(\n      "FPDFAnnot_RemoveInkList",\n      1\n    );\n    Module["_FPDFAnnot_AppendObject"] = createExportWrapper(\n      "FPDFAnnot_AppendObject",\n      2\n    );\n    Module["_FPDFAnnot_GetObjectCount"] = createExportWrapper(\n      "FPDFAnnot_GetObjectCount",\n      1\n    );\n    Module["_FPDFAnnot_GetObject"] = createExportWrapper(\n      "FPDFAnnot_GetObject",\n      2\n    );\n    Module["_FPDFAnnot_RemoveObject"] = createExportWrapper(\n      "FPDFAnnot_RemoveObject",\n      2\n    );\n    Module["_FPDFAnnot_SetColor"] = createExportWrapper(\n      "FPDFAnnot_SetColor",\n      6\n    );\n    Module["_FPDFAnnot_GetColor"] = createExportWrapper(\n      "FPDFAnnot_GetColor",\n      6\n    );\n    Module["_FPDFAnnot_HasAttachmentPoints"] = createExportWrapper("FPDFAnnot_HasAttachmentPoints", 1);\n    Module["_FPDFAnnot_SetAttachmentPoints"] = createExportWrapper("FPDFAnnot_SetAttachmentPoints", 3);\n    Module["_FPDFAnnot_AppendAttachmentPoints"] = createExportWrapper("FPDFAnnot_AppendAttachmentPoints", 2);\n    Module["_FPDFAnnot_CountAttachmentPoints"] = createExportWrapper("FPDFAnnot_CountAttachmentPoints", 1);\n    Module["_FPDFAnnot_GetAttachmentPoints"] = createExportWrapper("FPDFAnnot_GetAttachmentPoints", 3);\n    Module["_FPDFAnnot_SetRect"] = createExportWrapper(\n      "FPDFAnnot_SetRect",\n      2\n    );\n    Module["_FPDFAnnot_GetRect"] = createExportWrapper(\n      "FPDFAnnot_GetRect",\n      2\n    );\n    Module["_FPDFAnnot_GetVertices"] = createExportWrapper(\n      "FPDFAnnot_GetVertices",\n      3\n    );\n    Module["_FPDFAnnot_GetInkListCount"] = createExportWrapper(\n      "FPDFAnnot_GetInkListCount",\n      1\n    );\n    Module["_FPDFAnnot_GetInkListPath"] = createExportWrapper(\n      "FPDFAnnot_GetInkListPath",\n      4\n    );\n    Module["_FPDFAnnot_GetLine"] = createExportWrapper(\n      "FPDFAnnot_GetLine",\n      3\n    );\n    Module["_FPDFAnnot_SetBorder"] = createExportWrapper(\n      "FPDFAnnot_SetBorder",\n      4\n    );\n    Module["_FPDFAnnot_GetBorder"] = createExportWrapper(\n      "FPDFAnnot_GetBorder",\n      4\n    );\n    Module["_FPDFAnnot_HasKey"] = createExportWrapper(\n      "FPDFAnnot_HasKey",\n      2\n    );\n    Module["_FPDFAnnot_GetValueType"] = createExportWrapper(\n      "FPDFAnnot_GetValueType",\n      2\n    );\n    Module["_FPDFAnnot_SetStringValue"] = createExportWrapper(\n      "FPDFAnnot_SetStringValue",\n      3\n    );\n    Module["_FPDFAnnot_GetStringValue"] = createExportWrapper(\n      "FPDFAnnot_GetStringValue",\n      4\n    );\n    Module["_FPDFAnnot_GetNumberValue"] = createExportWrapper(\n      "FPDFAnnot_GetNumberValue",\n      3\n    );\n    Module["_FPDFAnnot_SetAP"] = createExportWrapper("FPDFAnnot_SetAP", 3);\n    Module["_FPDFAnnot_GetAP"] = createExportWrapper("FPDFAnnot_GetAP", 4);\n    Module["_FPDFAnnot_GetLinkedAnnot"] = createExportWrapper(\n      "FPDFAnnot_GetLinkedAnnot",\n      2\n    );\n    Module["_FPDFAnnot_GetFlags"] = createExportWrapper(\n      "FPDFAnnot_GetFlags",\n      1\n    );\n    Module["_FPDFAnnot_SetFlags"] = createExportWrapper(\n      "FPDFAnnot_SetFlags",\n      2\n    );\n    Module["_FPDFAnnot_GetFormFieldFlags"] = createExportWrapper("FPDFAnnot_GetFormFieldFlags", 2);\n    Module["_FPDFAnnot_SetFormFieldFlags"] = createExportWrapper("FPDFAnnot_SetFormFieldFlags", 3);\n    Module["_FPDFAnnot_GetFormFieldAtPoint"] = createExportWrapper("FPDFAnnot_GetFormFieldAtPoint", 3);\n    Module["_FPDFAnnot_GetFormFieldName"] = createExportWrapper(\n      "FPDFAnnot_GetFormFieldName",\n      4\n    );\n    Module["_FPDFAnnot_GetFormFieldType"] = createExportWrapper(\n      "FPDFAnnot_GetFormFieldType",\n      2\n    );\n    Module["_FPDFAnnot_GetFormAdditionalActionJavaScript"] = createExportWrapper("FPDFAnnot_GetFormAdditionalActionJavaScript", 5);\n    Module["_FPDFAnnot_GetFormFieldAlternateName"] = createExportWrapper("FPDFAnnot_GetFormFieldAlternateName", 4);\n    Module["_FPDFAnnot_GetFormFieldValue"] = createExportWrapper("FPDFAnnot_GetFormFieldValue", 4);\n    Module["_FPDFAnnot_GetOptionCount"] = createExportWrapper(\n      "FPDFAnnot_GetOptionCount",\n      2\n    );\n    Module["_FPDFAnnot_GetOptionLabel"] = createExportWrapper(\n      "FPDFAnnot_GetOptionLabel",\n      5\n    );\n    Module["_FPDFAnnot_IsOptionSelected"] = createExportWrapper(\n      "FPDFAnnot_IsOptionSelected",\n      3\n    );\n    Module["_FPDFAnnot_GetFontSize"] = createExportWrapper(\n      "FPDFAnnot_GetFontSize",\n      3\n    );\n    Module["_FPDFAnnot_SetFontColor"] = createExportWrapper(\n      "FPDFAnnot_SetFontColor",\n      5\n    );\n    Module["_FPDFAnnot_GetFontColor"] = createExportWrapper(\n      "FPDFAnnot_GetFontColor",\n      5\n    );\n    Module["_FPDFAnnot_IsChecked"] = createExportWrapper(\n      "FPDFAnnot_IsChecked",\n      2\n    );\n    Module["_FPDFAnnot_SetFocusableSubtypes"] = createExportWrapper("FPDFAnnot_SetFocusableSubtypes", 3);\n    Module["_FPDFAnnot_GetFocusableSubtypesCount"] = createExportWrapper("FPDFAnnot_GetFocusableSubtypesCount", 1);\n    Module["_FPDFAnnot_GetFocusableSubtypes"] = createExportWrapper("FPDFAnnot_GetFocusableSubtypes", 3);\n    Module["_FPDFAnnot_GetLink"] = createExportWrapper(\n      "FPDFAnnot_GetLink",\n      1\n    );\n    Module["_FPDFAnnot_GetFormControlCount"] = createExportWrapper("FPDFAnnot_GetFormControlCount", 2);\n    Module["_FPDFAnnot_GetFormControlIndex"] = createExportWrapper("FPDFAnnot_GetFormControlIndex", 2);\n    Module["_FPDFAnnot_GetFormFieldExportValue"] = createExportWrapper("FPDFAnnot_GetFormFieldExportValue", 4);\n    Module["_FPDFAnnot_SetURI"] = createExportWrapper(\n      "FPDFAnnot_SetURI",\n      2\n    );\n    Module["_FPDFAnnot_GetFileAttachment"] = createExportWrapper("FPDFAnnot_GetFileAttachment", 1);\n    Module["_FPDFAnnot_AddFileAttachment"] = createExportWrapper("FPDFAnnot_AddFileAttachment", 2);\n    Module["_EPDFAnnot_SetColor"] = createExportWrapper(\n      "EPDFAnnot_SetColor",\n      5\n    );\n    Module["_EPDFAnnot_GetColor"] = createExportWrapper(\n      "EPDFAnnot_GetColor",\n      5\n    );\n    Module["_EPDFAnnot_ClearColor"] = createExportWrapper(\n      "EPDFAnnot_ClearColor",\n      2\n    );\n    Module["_EPDFAnnot_SetOpacity"] = createExportWrapper(\n      "EPDFAnnot_SetOpacity",\n      2\n    );\n    Module["_EPDFAnnot_GetOpacity"] = createExportWrapper(\n      "EPDFAnnot_GetOpacity",\n      2\n    );\n    Module["_EPDFAnnot_GetBorderEffect"] = createExportWrapper(\n      "EPDFAnnot_GetBorderEffect",\n      2\n    );\n    Module["_EPDFAnnot_GetRectangleDifferences"] = createExportWrapper("EPDFAnnot_GetRectangleDifferences", 5);\n    Module["_EPDFAnnot_GetBorderDashPatternCount"] = createExportWrapper("EPDFAnnot_GetBorderDashPatternCount", 1);\n    Module["_EPDFAnnot_GetBorderDashPattern"] = createExportWrapper("EPDFAnnot_GetBorderDashPattern", 3);\n    Module["_EPDFAnnot_SetBorderDashPattern"] = createExportWrapper("EPDFAnnot_SetBorderDashPattern", 3);\n    Module["_EPDFAnnot_GetBorderStyle"] = createExportWrapper(\n      "EPDFAnnot_GetBorderStyle",\n      2\n    );\n    Module["_EPDFAnnot_SetBorderStyle"] = createExportWrapper(\n      "EPDFAnnot_SetBorderStyle",\n      3\n    );\n    Module["_EPDFAnnot_GenerateAppearance"] = createExportWrapper("EPDFAnnot_GenerateAppearance", 1);\n    Module["_EPDFAnnot_GenerateAppearanceWithBlend"] = createExportWrapper("EPDFAnnot_GenerateAppearanceWithBlend", 2);\n    Module["_EPDFAnnot_GetBlendMode"] = createExportWrapper(\n      "EPDFAnnot_GetBlendMode",\n      1\n    );\n    Module["_EPDFAnnot_SetIntent"] = createExportWrapper(\n      "EPDFAnnot_SetIntent",\n      2\n    );\n    Module["_EPDFAnnot_GetIntent"] = createExportWrapper(\n      "EPDFAnnot_GetIntent",\n      3\n    );\n    Module["_EPDFAnnot_GetRichContent"] = createExportWrapper(\n      "EPDFAnnot_GetRichContent",\n      3\n    );\n    Module["_EPDFAnnot_SetLineEndings"] = createExportWrapper(\n      "EPDFAnnot_SetLineEndings",\n      3\n    );\n    Module["_EPDFAnnot_GetLineEndings"] = createExportWrapper(\n      "EPDFAnnot_GetLineEndings",\n      3\n    );\n    Module["_EPDFAnnot_SetVertices"] = createExportWrapper(\n      "EPDFAnnot_SetVertices",\n      3\n    );\n    Module["_EPDFAnnot_SetLine"] = createExportWrapper(\n      "EPDFAnnot_SetLine",\n      3\n    );\n    Module["_EPDFAnnot_SetDefaultAppearance"] = createExportWrapper("EPDFAnnot_SetDefaultAppearance", 6);\n    Module["_EPDFAnnot_GetDefaultAppearance"] = createExportWrapper("EPDFAnnot_GetDefaultAppearance", 6);\n    Module["_EPDFAnnot_SetTextAlignment"] = createExportWrapper(\n      "EPDFAnnot_SetTextAlignment",\n      2\n    );\n    Module["_EPDFAnnot_GetTextAlignment"] = createExportWrapper(\n      "EPDFAnnot_GetTextAlignment",\n      1\n    );\n    Module["_EPDFAnnot_SetVerticalAlignment"] = createExportWrapper("EPDFAnnot_SetVerticalAlignment", 2);\n    Module["_EPDFAnnot_GetVerticalAlignment"] = createExportWrapper("EPDFAnnot_GetVerticalAlignment", 1);\n    Module["_EPDFPage_GetAnnotByName"] = createExportWrapper(\n      "EPDFPage_GetAnnotByName",\n      2\n    );\n    Module["_EPDFPage_RemoveAnnotByName"] = createExportWrapper(\n      "EPDFPage_RemoveAnnotByName",\n      2\n    );\n    Module["_EPDFAnnot_SetLinkedAnnot"] = createExportWrapper(\n      "EPDFAnnot_SetLinkedAnnot",\n      3\n    );\n    Module["_EPDFPage_GetAnnotCountRaw"] = createExportWrapper(\n      "EPDFPage_GetAnnotCountRaw",\n      2\n    );\n    Module["_EPDFPage_GetAnnotRaw"] = createExportWrapper(\n      "EPDFPage_GetAnnotRaw",\n      3\n    );\n    Module["_EPDFPage_RemoveAnnotRaw"] = createExportWrapper(\n      "EPDFPage_RemoveAnnotRaw",\n      3\n    );\n    Module["_EPDFAnnot_SetIcon"] = createExportWrapper(\n      "EPDFAnnot_SetIcon",\n      2\n    );\n    Module["_EPDFAnnot_GetIcon"] = createExportWrapper(\n      "EPDFAnnot_GetIcon",\n      1\n    );\n    Module["_EPDFAnnot_UpdateAppearanceToRect"] = createExportWrapper("EPDFAnnot_UpdateAppearanceToRect", 2);\n    Module["_EPDFPage_CreateAnnot"] = createExportWrapper(\n      "EPDFPage_CreateAnnot",\n      2\n    );\n    Module["_FPDFDoc_GetAttachmentCount"] = createExportWrapper(\n      "FPDFDoc_GetAttachmentCount",\n      1\n    );\n    Module["_FPDFDoc_AddAttachment"] = createExportWrapper(\n      "FPDFDoc_AddAttachment",\n      2\n    );\n    Module["_FPDFDoc_GetAttachment"] = createExportWrapper(\n      "FPDFDoc_GetAttachment",\n      2\n    );\n    Module["_FPDFDoc_DeleteAttachment"] = createExportWrapper(\n      "FPDFDoc_DeleteAttachment",\n      2\n    );\n    Module["_FPDFAttachment_GetName"] = createExportWrapper(\n      "FPDFAttachment_GetName",\n      3\n    );\n    Module["_FPDFAttachment_HasKey"] = createExportWrapper(\n      "FPDFAttachment_HasKey",\n      2\n    );\n    Module["_FPDFAttachment_GetValueType"] = createExportWrapper("FPDFAttachment_GetValueType", 2);\n    Module["_FPDFAttachment_SetStringValue"] = createExportWrapper("FPDFAttachment_SetStringValue", 3);\n    Module["_FPDFAttachment_GetStringValue"] = createExportWrapper("FPDFAttachment_GetStringValue", 4);\n    Module["_FPDFAttachment_SetFile"] = createExportWrapper(\n      "FPDFAttachment_SetFile",\n      4\n    );\n    Module["_FPDFAttachment_GetFile"] = createExportWrapper(\n      "FPDFAttachment_GetFile",\n      4\n    );\n    Module["_FPDFAttachment_GetSubtype"] = createExportWrapper(\n      "FPDFAttachment_GetSubtype",\n      3\n    );\n    Module["_EPDFAttachment_SetSubtype"] = createExportWrapper(\n      "EPDFAttachment_SetSubtype",\n      2\n    );\n    Module["_EPDFAttachment_SetDescription"] = createExportWrapper("EPDFAttachment_SetDescription", 2);\n    Module["_EPDFAttachment_GetDescription"] = createExportWrapper("EPDFAttachment_GetDescription", 3);\n    Module["_EPDFAttachment_GetIntegerValue"] = createExportWrapper("EPDFAttachment_GetIntegerValue", 3);\n    Module["_FPDFCatalog_IsTagged"] = createExportWrapper(\n      "FPDFCatalog_IsTagged",\n      1\n    );\n    Module["_FPDFCatalog_SetLanguage"] = createExportWrapper(\n      "FPDFCatalog_SetLanguage",\n      2\n    );\n    Module["_EPDFCatalog_GetLanguage"] = createExportWrapper(\n      "EPDFCatalog_GetLanguage",\n      3\n    );\n    Module["_FPDFAvail_Create"] = createExportWrapper(\n      "FPDFAvail_Create",\n      2\n    );\n    Module["_FPDFAvail_Destroy"] = createExportWrapper(\n      "FPDFAvail_Destroy",\n      1\n    );\n    Module["_FPDFAvail_IsDocAvail"] = createExportWrapper(\n      "FPDFAvail_IsDocAvail",\n      2\n    );\n    Module["_FPDFAvail_GetDocument"] = createExportWrapper(\n      "FPDFAvail_GetDocument",\n      2\n    );\n    Module["_FPDFAvail_GetFirstPageNum"] = createExportWrapper(\n      "FPDFAvail_GetFirstPageNum",\n      1\n    );\n    Module["_FPDFAvail_IsPageAvail"] = createExportWrapper(\n      "FPDFAvail_IsPageAvail",\n      3\n    );\n    Module["_FPDFAvail_IsFormAvail"] = createExportWrapper(\n      "FPDFAvail_IsFormAvail",\n      2\n    );\n    Module["_FPDFAvail_IsLinearized"] = createExportWrapper(\n      "FPDFAvail_IsLinearized",\n      1\n    );\n    Module["_FPDFBookmark_GetFirstChild"] = createExportWrapper(\n      "FPDFBookmark_GetFirstChild",\n      2\n    );\n    Module["_FPDFBookmark_GetNextSibling"] = createExportWrapper("FPDFBookmark_GetNextSibling", 2);\n    Module["_FPDFBookmark_GetTitle"] = createExportWrapper(\n      "FPDFBookmark_GetTitle",\n      3\n    );\n    Module["_FPDFBookmark_GetCount"] = createExportWrapper(\n      "FPDFBookmark_GetCount",\n      1\n    );\n    Module["_FPDFBookmark_Find"] = createExportWrapper(\n      "FPDFBookmark_Find",\n      2\n    );\n    Module["_FPDFBookmark_GetDest"] = createExportWrapper(\n      "FPDFBookmark_GetDest",\n      2\n    );\n    Module["_FPDFBookmark_GetAction"] = createExportWrapper(\n      "FPDFBookmark_GetAction",\n      1\n    );\n    Module["_FPDFAction_GetType"] = createExportWrapper(\n      "FPDFAction_GetType",\n      1\n    );\n    Module["_FPDFAction_GetDest"] = createExportWrapper(\n      "FPDFAction_GetDest",\n      2\n    );\n    Module["_FPDFAction_GetFilePath"] = createExportWrapper(\n      "FPDFAction_GetFilePath",\n      3\n    );\n    Module["_FPDFAction_GetURIPath"] = createExportWrapper(\n      "FPDFAction_GetURIPath",\n      4\n    );\n    Module["_FPDFDest_GetDestPageIndex"] = createExportWrapper(\n      "FPDFDest_GetDestPageIndex",\n      2\n    );\n    Module["_FPDFDest_GetView"] = createExportWrapper(\n      "FPDFDest_GetView",\n      3\n    );\n    Module["_FPDFDest_GetLocationInPage"] = createExportWrapper(\n      "FPDFDest_GetLocationInPage",\n      7\n    );\n    Module["_FPDFLink_GetLinkAtPoint"] = createExportWrapper(\n      "FPDFLink_GetLinkAtPoint",\n      3\n    );\n    Module["_FPDFLink_GetLinkZOrderAtPoint"] = createExportWrapper("FPDFLink_GetLinkZOrderAtPoint", 3);\n    Module["_FPDFLink_GetDest"] = createExportWrapper(\n      "FPDFLink_GetDest",\n      2\n    );\n    Module["_FPDFLink_GetAction"] = createExportWrapper(\n      "FPDFLink_GetAction",\n      1\n    );\n    Module["_FPDFLink_Enumerate"] = createExportWrapper(\n      "FPDFLink_Enumerate",\n      3\n    );\n    Module["_FPDFLink_GetAnnot"] = createExportWrapper(\n      "FPDFLink_GetAnnot",\n      2\n    );\n    Module["_FPDFLink_GetAnnotRect"] = createExportWrapper(\n      "FPDFLink_GetAnnotRect",\n      2\n    );\n    Module["_FPDFLink_CountQuadPoints"] = createExportWrapper(\n      "FPDFLink_CountQuadPoints",\n      1\n    );\n    Module["_FPDFLink_GetQuadPoints"] = createExportWrapper(\n      "FPDFLink_GetQuadPoints",\n      3\n    );\n    Module["_FPDF_GetPageAAction"] = createExportWrapper(\n      "FPDF_GetPageAAction",\n      2\n    );\n    Module["_FPDF_GetFileIdentifier"] = createExportWrapper(\n      "FPDF_GetFileIdentifier",\n      4\n    );\n    Module["_FPDF_GetMetaText"] = createExportWrapper(\n      "FPDF_GetMetaText",\n      4\n    );\n    Module["_FPDF_GetPageLabel"] = createExportWrapper(\n      "FPDF_GetPageLabel",\n      4\n    );\n    Module["_EPDF_SetMetaText"] = createExportWrapper(\n      "EPDF_SetMetaText",\n      3\n    );\n    Module["_EPDF_HasMetaText"] = createExportWrapper(\n      "EPDF_HasMetaText",\n      2\n    );\n    Module["_EPDF_GetMetaTrapped"] = createExportWrapper(\n      "EPDF_GetMetaTrapped",\n      1\n    );\n    Module["_EPDF_SetMetaTrapped"] = createExportWrapper(\n      "EPDF_SetMetaTrapped",\n      2\n    );\n    Module["_EPDF_GetMetaKeyCount"] = createExportWrapper(\n      "EPDF_GetMetaKeyCount",\n      2\n    );\n    Module["_EPDF_GetMetaKeyName"] = createExportWrapper(\n      "EPDF_GetMetaKeyName",\n      5\n    );\n    Module["_FPDFPageObj_NewImageObj"] = createExportWrapper(\n      "FPDFPageObj_NewImageObj",\n      1\n    );\n    Module["_FPDFImageObj_LoadJpegFile"] = createExportWrapper(\n      "FPDFImageObj_LoadJpegFile",\n      4\n    );\n    Module["_FPDFImageObj_LoadJpegFileInline"] = createExportWrapper("FPDFImageObj_LoadJpegFileInline", 4);\n    Module["_FPDFImageObj_SetMatrix"] = createExportWrapper(\n      "FPDFImageObj_SetMatrix",\n      7\n    );\n    Module["_FPDFImageObj_SetBitmap"] = createExportWrapper(\n      "FPDFImageObj_SetBitmap",\n      4\n    );\n    Module["_FPDFImageObj_GetBitmap"] = createExportWrapper(\n      "FPDFImageObj_GetBitmap",\n      1\n    );\n    Module["_FPDFImageObj_GetRenderedBitmap"] = createExportWrapper("FPDFImageObj_GetRenderedBitmap", 3);\n    Module["_FPDFImageObj_GetImageDataDecoded"] = createExportWrapper("FPDFImageObj_GetImageDataDecoded", 3);\n    Module["_FPDFImageObj_GetImageDataRaw"] = createExportWrapper("FPDFImageObj_GetImageDataRaw", 3);\n    Module["_FPDFImageObj_GetImageFilterCount"] = createExportWrapper("FPDFImageObj_GetImageFilterCount", 1);\n    Module["_FPDFImageObj_GetImageFilter"] = createExportWrapper("FPDFImageObj_GetImageFilter", 4);\n    Module["_FPDFImageObj_GetImageMetadata"] = createExportWrapper("FPDFImageObj_GetImageMetadata", 3);\n    Module["_FPDFImageObj_GetImagePixelSize"] = createExportWrapper("FPDFImageObj_GetImagePixelSize", 3);\n    Module["_FPDFImageObj_GetIccProfileDataDecoded"] = createExportWrapper("FPDFImageObj_GetIccProfileDataDecoded", 5);\n    Module["_FPDF_CreateNewDocument"] = createExportWrapper(\n      "FPDF_CreateNewDocument",\n      0\n    );\n    Module["_FPDFPage_Delete"] = createExportWrapper("FPDFPage_Delete", 2);\n    Module["_FPDF_MovePages"] = createExportWrapper("FPDF_MovePages", 4);\n    Module["_FPDFPage_New"] = createExportWrapper("FPDFPage_New", 4);\n    Module["_FPDFPage_GetRotation"] = createExportWrapper(\n      "FPDFPage_GetRotation",\n      1\n    );\n    Module["_FPDFPage_InsertObject"] = createExportWrapper(\n      "FPDFPage_InsertObject",\n      2\n    );\n    Module["_FPDFPage_InsertObjectAtIndex"] = createExportWrapper("FPDFPage_InsertObjectAtIndex", 3);\n    Module["_FPDFPage_RemoveObject"] = createExportWrapper(\n      "FPDFPage_RemoveObject",\n      2\n    );\n    Module["_FPDFPage_CountObjects"] = createExportWrapper(\n      "FPDFPage_CountObjects",\n      1\n    );\n    Module["_FPDFPage_GetObject"] = createExportWrapper(\n      "FPDFPage_GetObject",\n      2\n    );\n    Module["_FPDFPage_HasTransparency"] = createExportWrapper(\n      "FPDFPage_HasTransparency",\n      1\n    );\n    Module["_FPDFPageObj_Destroy"] = createExportWrapper(\n      "FPDFPageObj_Destroy",\n      1\n    );\n    Module["_FPDFPageObj_GetMarkedContentID"] = createExportWrapper("FPDFPageObj_GetMarkedContentID", 1);\n    Module["_FPDFPageObj_CountMarks"] = createExportWrapper(\n      "FPDFPageObj_CountMarks",\n      1\n    );\n    Module["_FPDFPageObj_GetMark"] = createExportWrapper(\n      "FPDFPageObj_GetMark",\n      2\n    );\n    Module["_FPDFPageObj_AddMark"] = createExportWrapper(\n      "FPDFPageObj_AddMark",\n      2\n    );\n    Module["_FPDFPageObj_RemoveMark"] = createExportWrapper(\n      "FPDFPageObj_RemoveMark",\n      2\n    );\n    Module["_FPDFPageObjMark_GetName"] = createExportWrapper(\n      "FPDFPageObjMark_GetName",\n      4\n    );\n    Module["_FPDFPageObjMark_CountParams"] = createExportWrapper("FPDFPageObjMark_CountParams", 1);\n    Module["_FPDFPageObjMark_GetParamKey"] = createExportWrapper("FPDFPageObjMark_GetParamKey", 5);\n    Module["_FPDFPageObjMark_GetParamValueType"] = createExportWrapper("FPDFPageObjMark_GetParamValueType", 2);\n    Module["_FPDFPageObjMark_GetParamIntValue"] = createExportWrapper("FPDFPageObjMark_GetParamIntValue", 3);\n    Module["_FPDFPageObjMark_GetParamStringValue"] = createExportWrapper("FPDFPageObjMark_GetParamStringValue", 5);\n    Module["_FPDFPageObjMark_GetParamBlobValue"] = createExportWrapper("FPDFPageObjMark_GetParamBlobValue", 5);\n    Module["_FPDFPageObj_HasTransparency"] = createExportWrapper("FPDFPageObj_HasTransparency", 1);\n    Module["_FPDFPageObjMark_SetIntParam"] = createExportWrapper("FPDFPageObjMark_SetIntParam", 5);\n    Module["_FPDFPageObjMark_SetStringParam"] = createExportWrapper("FPDFPageObjMark_SetStringParam", 5);\n    Module["_FPDFPageObjMark_SetBlobParam"] = createExportWrapper("FPDFPageObjMark_SetBlobParam", 6);\n    Module["_FPDFPageObjMark_RemoveParam"] = createExportWrapper("FPDFPageObjMark_RemoveParam", 3);\n    Module["_FPDFPageObj_GetType"] = createExportWrapper(\n      "FPDFPageObj_GetType",\n      1\n    );\n    Module["_FPDFPageObj_GetIsActive"] = createExportWrapper(\n      "FPDFPageObj_GetIsActive",\n      2\n    );\n    Module["_FPDFPageObj_SetIsActive"] = createExportWrapper(\n      "FPDFPageObj_SetIsActive",\n      2\n    );\n    Module["_FPDFPage_GenerateContent"] = createExportWrapper(\n      "FPDFPage_GenerateContent",\n      1\n    );\n    Module["_FPDFPageObj_Transform"] = createExportWrapper(\n      "FPDFPageObj_Transform",\n      7\n    );\n    Module["_FPDFPageObj_TransformF"] = createExportWrapper(\n      "FPDFPageObj_TransformF",\n      2\n    );\n    Module["_FPDFPageObj_GetMatrix"] = createExportWrapper(\n      "FPDFPageObj_GetMatrix",\n      2\n    );\n    Module["_FPDFPageObj_SetMatrix"] = createExportWrapper(\n      "FPDFPageObj_SetMatrix",\n      2\n    );\n    Module["_FPDFPageObj_SetBlendMode"] = createExportWrapper(\n      "FPDFPageObj_SetBlendMode",\n      2\n    );\n    Module["_FPDFPage_TransformAnnots"] = createExportWrapper(\n      "FPDFPage_TransformAnnots",\n      7\n    );\n    Module["_FPDFPage_SetRotation"] = createExportWrapper(\n      "FPDFPage_SetRotation",\n      2\n    );\n    Module["_FPDFPageObj_SetFillColor"] = createExportWrapper(\n      "FPDFPageObj_SetFillColor",\n      5\n    );\n    Module["_FPDFPageObj_GetFillColor"] = createExportWrapper(\n      "FPDFPageObj_GetFillColor",\n      5\n    );\n    Module["_FPDFPageObj_GetBounds"] = createExportWrapper(\n      "FPDFPageObj_GetBounds",\n      5\n    );\n    Module["_FPDFPageObj_GetRotatedBounds"] = createExportWrapper("FPDFPageObj_GetRotatedBounds", 2);\n    Module["_FPDFPageObj_SetStrokeColor"] = createExportWrapper(\n      "FPDFPageObj_SetStrokeColor",\n      5\n    );\n    Module["_FPDFPageObj_GetStrokeColor"] = createExportWrapper(\n      "FPDFPageObj_GetStrokeColor",\n      5\n    );\n    Module["_FPDFPageObj_SetStrokeWidth"] = createExportWrapper(\n      "FPDFPageObj_SetStrokeWidth",\n      2\n    );\n    Module["_FPDFPageObj_GetStrokeWidth"] = createExportWrapper(\n      "FPDFPageObj_GetStrokeWidth",\n      2\n    );\n    Module["_FPDFPageObj_GetLineJoin"] = createExportWrapper(\n      "FPDFPageObj_GetLineJoin",\n      1\n    );\n    Module["_FPDFPageObj_SetLineJoin"] = createExportWrapper(\n      "FPDFPageObj_SetLineJoin",\n      2\n    );\n    Module["_FPDFPageObj_GetLineCap"] = createExportWrapper(\n      "FPDFPageObj_GetLineCap",\n      1\n    );\n    Module["_FPDFPageObj_SetLineCap"] = createExportWrapper(\n      "FPDFPageObj_SetLineCap",\n      2\n    );\n    Module["_FPDFPageObj_GetDashPhase"] = createExportWrapper(\n      "FPDFPageObj_GetDashPhase",\n      2\n    );\n    Module["_FPDFPageObj_SetDashPhase"] = createExportWrapper(\n      "FPDFPageObj_SetDashPhase",\n      2\n    );\n    Module["_FPDFPageObj_GetDashCount"] = createExportWrapper(\n      "FPDFPageObj_GetDashCount",\n      1\n    );\n    Module["_FPDFPageObj_GetDashArray"] = createExportWrapper(\n      "FPDFPageObj_GetDashArray",\n      3\n    );\n    Module["_FPDFPageObj_SetDashArray"] = createExportWrapper(\n      "FPDFPageObj_SetDashArray",\n      4\n    );\n    Module["_FPDFFormObj_CountObjects"] = createExportWrapper(\n      "FPDFFormObj_CountObjects",\n      1\n    );\n    Module["_FPDFFormObj_GetObject"] = createExportWrapper(\n      "FPDFFormObj_GetObject",\n      2\n    );\n    Module["_FPDFFormObj_RemoveObject"] = createExportWrapper(\n      "FPDFFormObj_RemoveObject",\n      2\n    );\n    Module["_FPDFPageObj_CreateNewPath"] = createExportWrapper(\n      "FPDFPageObj_CreateNewPath",\n      2\n    );\n    Module["_FPDFPageObj_CreateNewRect"] = createExportWrapper(\n      "FPDFPageObj_CreateNewRect",\n      4\n    );\n    Module["_FPDFPath_CountSegments"] = createExportWrapper(\n      "FPDFPath_CountSegments",\n      1\n    );\n    Module["_FPDFPath_GetPathSegment"] = createExportWrapper(\n      "FPDFPath_GetPathSegment",\n      2\n    );\n    Module["_FPDFPath_MoveTo"] = createExportWrapper("FPDFPath_MoveTo", 3);\n    Module["_FPDFPath_LineTo"] = createExportWrapper("FPDFPath_LineTo", 3);\n    Module["_FPDFPath_BezierTo"] = createExportWrapper(\n      "FPDFPath_BezierTo",\n      7\n    );\n    Module["_FPDFPath_Close"] = createExportWrapper("FPDFPath_Close", 1);\n    Module["_FPDFPath_SetDrawMode"] = createExportWrapper(\n      "FPDFPath_SetDrawMode",\n      3\n    );\n    Module["_FPDFPath_GetDrawMode"] = createExportWrapper(\n      "FPDFPath_GetDrawMode",\n      3\n    );\n    Module["_FPDFPathSegment_GetPoint"] = createExportWrapper(\n      "FPDFPathSegment_GetPoint",\n      3\n    );\n    Module["_FPDFPathSegment_GetType"] = createExportWrapper(\n      "FPDFPathSegment_GetType",\n      1\n    );\n    Module["_FPDFPathSegment_GetClose"] = createExportWrapper(\n      "FPDFPathSegment_GetClose",\n      1\n    );\n    Module["_FPDFPageObj_NewTextObj"] = createExportWrapper(\n      "FPDFPageObj_NewTextObj",\n      3\n    );\n    Module["_FPDFText_SetText"] = createExportWrapper(\n      "FPDFText_SetText",\n      2\n    );\n    Module["_FPDFText_SetCharcodes"] = createExportWrapper(\n      "FPDFText_SetCharcodes",\n      3\n    );\n    Module["_FPDFText_LoadFont"] = createExportWrapper(\n      "FPDFText_LoadFont",\n      5\n    );\n    Module["_FPDFText_LoadStandardFont"] = createExportWrapper(\n      "FPDFText_LoadStandardFont",\n      2\n    );\n    Module["_FPDFText_LoadCidType2Font"] = createExportWrapper(\n      "FPDFText_LoadCidType2Font",\n      6\n    );\n    Module["_FPDFTextObj_GetFontSize"] = createExportWrapper(\n      "FPDFTextObj_GetFontSize",\n      2\n    );\n    Module["_FPDFTextObj_GetText"] = createExportWrapper(\n      "FPDFTextObj_GetText",\n      4\n    );\n    Module["_FPDFTextObj_GetRenderedBitmap"] = createExportWrapper("FPDFTextObj_GetRenderedBitmap", 4);\n    Module["_FPDFFont_Close"] = createExportWrapper("FPDFFont_Close", 1);\n    Module["_FPDFPageObj_CreateTextObj"] = createExportWrapper(\n      "FPDFPageObj_CreateTextObj",\n      3\n    );\n    Module["_FPDFTextObj_GetTextRenderMode"] = createExportWrapper("FPDFTextObj_GetTextRenderMode", 1);\n    Module["_FPDFTextObj_SetTextRenderMode"] = createExportWrapper("FPDFTextObj_SetTextRenderMode", 2);\n    Module["_FPDFTextObj_GetFont"] = createExportWrapper(\n      "FPDFTextObj_GetFont",\n      1\n    );\n    Module["_FPDFFont_GetBaseFontName"] = createExportWrapper(\n      "FPDFFont_GetBaseFontName",\n      3\n    );\n    Module["_FPDFFont_GetFamilyName"] = createExportWrapper(\n      "FPDFFont_GetFamilyName",\n      3\n    );\n    Module["_FPDFFont_GetFontData"] = createExportWrapper(\n      "FPDFFont_GetFontData",\n      4\n    );\n    Module["_FPDFFont_GetIsEmbedded"] = createExportWrapper(\n      "FPDFFont_GetIsEmbedded",\n      1\n    );\n    Module["_FPDFFont_GetFlags"] = createExportWrapper(\n      "FPDFFont_GetFlags",\n      1\n    );\n    Module["_FPDFFont_GetWeight"] = createExportWrapper(\n      "FPDFFont_GetWeight",\n      1\n    );\n    Module["_FPDFFont_GetItalicAngle"] = createExportWrapper(\n      "FPDFFont_GetItalicAngle",\n      2\n    );\n    Module["_FPDFFont_GetAscent"] = createExportWrapper(\n      "FPDFFont_GetAscent",\n      3\n    );\n    Module["_FPDFFont_GetDescent"] = createExportWrapper(\n      "FPDFFont_GetDescent",\n      3\n    );\n    Module["_FPDFFont_GetGlyphWidth"] = createExportWrapper(\n      "FPDFFont_GetGlyphWidth",\n      4\n    );\n    Module["_FPDFFont_GetGlyphPath"] = createExportWrapper(\n      "FPDFFont_GetGlyphPath",\n      3\n    );\n    Module["_FPDFGlyphPath_CountGlyphSegments"] = createExportWrapper("FPDFGlyphPath_CountGlyphSegments", 1);\n    Module["_FPDFGlyphPath_GetGlyphPathSegment"] = createExportWrapper("FPDFGlyphPath_GetGlyphPathSegment", 2);\n    Module["_EPDFText_RedactInRect"] = createExportWrapper(\n      "EPDFText_RedactInRect",\n      4\n    );\n    Module["_EPDFText_RedactInQuads"] = createExportWrapper(\n      "EPDFText_RedactInQuads",\n      5\n    );\n    Module["_FPDFDoc_GetPageMode"] = createExportWrapper(\n      "FPDFDoc_GetPageMode",\n      1\n    );\n    Module["_FPDFPage_Flatten"] = createExportWrapper(\n      "FPDFPage_Flatten",\n      2\n    );\n    Module["_FPDFPage_HasFormFieldAtPoint"] = createExportWrapper("FPDFPage_HasFormFieldAtPoint", 4);\n    Module["_FPDFPage_FormFieldZOrderAtPoint"] = createExportWrapper("FPDFPage_FormFieldZOrderAtPoint", 4);\n    Module["_malloc"] = createExportWrapper("malloc", 1);\n    Module["_free"] = createExportWrapper("free", 1);\n    Module["_FORM_OnMouseMove"] = createExportWrapper(\n      "FORM_OnMouseMove",\n      5\n    );\n    Module["_FORM_OnMouseWheel"] = createExportWrapper(\n      "FORM_OnMouseWheel",\n      6\n    );\n    Module["_FORM_OnFocus"] = createExportWrapper("FORM_OnFocus", 5);\n    Module["_FORM_OnLButtonDown"] = createExportWrapper(\n      "FORM_OnLButtonDown",\n      5\n    );\n    Module["_FORM_OnLButtonUp"] = createExportWrapper(\n      "FORM_OnLButtonUp",\n      5\n    );\n    Module["_FORM_OnLButtonDoubleClick"] = createExportWrapper(\n      "FORM_OnLButtonDoubleClick",\n      5\n    );\n    Module["_FORM_OnRButtonDown"] = createExportWrapper(\n      "FORM_OnRButtonDown",\n      5\n    );\n    Module["_FORM_OnRButtonUp"] = createExportWrapper(\n      "FORM_OnRButtonUp",\n      5\n    );\n    Module["_FORM_OnKeyDown"] = createExportWrapper("FORM_OnKeyDown", 4);\n    Module["_FORM_OnKeyUp"] = createExportWrapper("FORM_OnKeyUp", 4);\n    Module["_FORM_OnChar"] = createExportWrapper("FORM_OnChar", 4);\n    Module["_FORM_GetFocusedText"] = createExportWrapper(\n      "FORM_GetFocusedText",\n      4\n    );\n    Module["_FORM_GetSelectedText"] = createExportWrapper(\n      "FORM_GetSelectedText",\n      4\n    );\n    Module["_FORM_ReplaceAndKeepSelection"] = createExportWrapper("FORM_ReplaceAndKeepSelection", 3);\n    Module["_FORM_ReplaceSelection"] = createExportWrapper(\n      "FORM_ReplaceSelection",\n      3\n    );\n    Module["_FORM_SelectAllText"] = createExportWrapper(\n      "FORM_SelectAllText",\n      2\n    );\n    Module["_FORM_CanUndo"] = createExportWrapper("FORM_CanUndo", 2);\n    Module["_FORM_CanRedo"] = createExportWrapper("FORM_CanRedo", 2);\n    Module["_FORM_Undo"] = createExportWrapper("FORM_Undo", 2);\n    Module["_FORM_Redo"] = createExportWrapper("FORM_Redo", 2);\n    Module["_FORM_ForceToKillFocus"] = createExportWrapper(\n      "FORM_ForceToKillFocus",\n      1\n    );\n    Module["_FORM_GetFocusedAnnot"] = createExportWrapper(\n      "FORM_GetFocusedAnnot",\n      3\n    );\n    Module["_FORM_SetFocusedAnnot"] = createExportWrapper(\n      "FORM_SetFocusedAnnot",\n      2\n    );\n    Module["_FPDF_FFLDraw"] = createExportWrapper("FPDF_FFLDraw", 9);\n    Module["_FPDF_SetFormFieldHighlightColor"] = createExportWrapper("FPDF_SetFormFieldHighlightColor", 3);\n    Module["_FPDF_SetFormFieldHighlightAlpha"] = createExportWrapper("FPDF_SetFormFieldHighlightAlpha", 2);\n    Module["_FPDF_RemoveFormFieldHighlight"] = createExportWrapper("FPDF_RemoveFormFieldHighlight", 1);\n    Module["_FORM_OnAfterLoadPage"] = createExportWrapper(\n      "FORM_OnAfterLoadPage",\n      2\n    );\n    Module["_FORM_OnBeforeClosePage"] = createExportWrapper(\n      "FORM_OnBeforeClosePage",\n      2\n    );\n    Module["_FORM_DoDocumentJSAction"] = createExportWrapper(\n      "FORM_DoDocumentJSAction",\n      1\n    );\n    Module["_FORM_DoDocumentOpenAction"] = createExportWrapper(\n      "FORM_DoDocumentOpenAction",\n      1\n    );\n    Module["_FORM_DoDocumentAAction"] = createExportWrapper(\n      "FORM_DoDocumentAAction",\n      2\n    );\n    Module["_FORM_DoPageAAction"] = createExportWrapper(\n      "FORM_DoPageAAction",\n      3\n    );\n    Module["_FORM_SetIndexSelected"] = createExportWrapper(\n      "FORM_SetIndexSelected",\n      4\n    );\n    Module["_FORM_IsIndexSelected"] = createExportWrapper(\n      "FORM_IsIndexSelected",\n      3\n    );\n    Module["_FPDFDoc_GetJavaScriptActionCount"] = createExportWrapper("FPDFDoc_GetJavaScriptActionCount", 1);\n    Module["_FPDFDoc_GetJavaScriptAction"] = createExportWrapper("FPDFDoc_GetJavaScriptAction", 2);\n    Module["_FPDFDoc_CloseJavaScriptAction"] = createExportWrapper("FPDFDoc_CloseJavaScriptAction", 1);\n    Module["_FPDFJavaScriptAction_GetName"] = createExportWrapper("FPDFJavaScriptAction_GetName", 3);\n    Module["_FPDFJavaScriptAction_GetScript"] = createExportWrapper("FPDFJavaScriptAction_GetScript", 3);\n    Module["_FPDF_ImportPagesByIndex"] = createExportWrapper(\n      "FPDF_ImportPagesByIndex",\n      5\n    );\n    Module["_FPDF_ImportPages"] = createExportWrapper(\n      "FPDF_ImportPages",\n      4\n    );\n    Module["_FPDF_ImportNPagesToOne"] = createExportWrapper(\n      "FPDF_ImportNPagesToOne",\n      5\n    );\n    Module["_FPDF_NewXObjectFromPage"] = createExportWrapper(\n      "FPDF_NewXObjectFromPage",\n      3\n    );\n    Module["_FPDF_CloseXObject"] = createExportWrapper(\n      "FPDF_CloseXObject",\n      1\n    );\n    Module["_FPDF_NewFormObjectFromXObject"] = createExportWrapper("FPDF_NewFormObjectFromXObject", 1);\n    Module["_FPDF_CopyViewerPreferences"] = createExportWrapper(\n      "FPDF_CopyViewerPreferences",\n      2\n    );\n    Module["_FPDF_RenderPageBitmapWithColorScheme_Start"] = createExportWrapper("FPDF_RenderPageBitmapWithColorScheme_Start", 10);\n    Module["_FPDF_RenderPageBitmap_Start"] = createExportWrapper("FPDF_RenderPageBitmap_Start", 9);\n    Module["_FPDF_RenderPage_Continue"] = createExportWrapper(\n      "FPDF_RenderPage_Continue",\n      2\n    );\n    Module["_FPDF_RenderPage_Close"] = createExportWrapper(\n      "FPDF_RenderPage_Close",\n      1\n    );\n    Module["_FPDF_SaveWithVersion"] = createExportWrapper(\n      "FPDF_SaveWithVersion",\n      4\n    );\n    Module["_FPDFText_GetCharIndexFromTextIndex"] = createExportWrapper("FPDFText_GetCharIndexFromTextIndex", 2);\n    Module["_FPDFText_GetTextIndexFromCharIndex"] = createExportWrapper("FPDFText_GetTextIndexFromCharIndex", 2);\n    Module["_FPDF_GetSignatureCount"] = createExportWrapper(\n      "FPDF_GetSignatureCount",\n      1\n    );\n    Module["_FPDF_GetSignatureObject"] = createExportWrapper(\n      "FPDF_GetSignatureObject",\n      2\n    );\n    Module["_FPDFSignatureObj_GetContents"] = createExportWrapper("FPDFSignatureObj_GetContents", 3);\n    Module["_FPDFSignatureObj_GetByteRange"] = createExportWrapper("FPDFSignatureObj_GetByteRange", 3);\n    Module["_FPDFSignatureObj_GetSubFilter"] = createExportWrapper("FPDFSignatureObj_GetSubFilter", 3);\n    Module["_FPDFSignatureObj_GetReason"] = createExportWrapper(\n      "FPDFSignatureObj_GetReason",\n      3\n    );\n    Module["_FPDFSignatureObj_GetTime"] = createExportWrapper(\n      "FPDFSignatureObj_GetTime",\n      3\n    );\n    Module["_FPDFSignatureObj_GetDocMDPPermission"] = createExportWrapper("FPDFSignatureObj_GetDocMDPPermission", 1);\n    Module["_FPDF_StructTree_GetForPage"] = createExportWrapper(\n      "FPDF_StructTree_GetForPage",\n      1\n    );\n    Module["_FPDF_StructTree_Close"] = createExportWrapper(\n      "FPDF_StructTree_Close",\n      1\n    );\n    Module["_FPDF_StructTree_CountChildren"] = createExportWrapper("FPDF_StructTree_CountChildren", 1);\n    Module["_FPDF_StructTree_GetChildAtIndex"] = createExportWrapper("FPDF_StructTree_GetChildAtIndex", 2);\n    Module["_FPDF_StructElement_GetAltText"] = createExportWrapper("FPDF_StructElement_GetAltText", 3);\n    Module["_FPDF_StructElement_GetActualText"] = createExportWrapper("FPDF_StructElement_GetActualText", 3);\n    Module["_FPDF_StructElement_GetID"] = createExportWrapper(\n      "FPDF_StructElement_GetID",\n      3\n    );\n    Module["_FPDF_StructElement_GetLang"] = createExportWrapper(\n      "FPDF_StructElement_GetLang",\n      3\n    );\n    Module["_FPDF_StructElement_GetAttributeCount"] = createExportWrapper("FPDF_StructElement_GetAttributeCount", 1);\n    Module["_FPDF_StructElement_GetAttributeAtIndex"] = createExportWrapper("FPDF_StructElement_GetAttributeAtIndex", 2);\n    Module["_FPDF_StructElement_GetStringAttribute"] = createExportWrapper("FPDF_StructElement_GetStringAttribute", 4);\n    Module["_FPDF_StructElement_GetMarkedContentID"] = createExportWrapper("FPDF_StructElement_GetMarkedContentID", 1);\n    Module["_FPDF_StructElement_GetType"] = createExportWrapper(\n      "FPDF_StructElement_GetType",\n      3\n    );\n    Module["_FPDF_StructElement_GetObjType"] = createExportWrapper("FPDF_StructElement_GetObjType", 3);\n    Module["_FPDF_StructElement_GetTitle"] = createExportWrapper("FPDF_StructElement_GetTitle", 3);\n    Module["_FPDF_StructElement_CountChildren"] = createExportWrapper("FPDF_StructElement_CountChildren", 1);\n    Module["_FPDF_StructElement_GetChildAtIndex"] = createExportWrapper("FPDF_StructElement_GetChildAtIndex", 2);\n    Module["_FPDF_StructElement_GetChildMarkedContentID"] = createExportWrapper("FPDF_StructElement_GetChildMarkedContentID", 2);\n    Module["_FPDF_StructElement_GetParent"] = createExportWrapper("FPDF_StructElement_GetParent", 1);\n    Module["_FPDF_StructElement_Attr_GetCount"] = createExportWrapper("FPDF_StructElement_Attr_GetCount", 1);\n    Module["_FPDF_StructElement_Attr_GetName"] = createExportWrapper("FPDF_StructElement_Attr_GetName", 5);\n    Module["_FPDF_StructElement_Attr_GetValue"] = createExportWrapper("FPDF_StructElement_Attr_GetValue", 2);\n    Module["_FPDF_StructElement_Attr_GetType"] = createExportWrapper("FPDF_StructElement_Attr_GetType", 1);\n    Module["_FPDF_StructElement_Attr_GetBooleanValue"] = createExportWrapper("FPDF_StructElement_Attr_GetBooleanValue", 2);\n    Module["_FPDF_StructElement_Attr_GetNumberValue"] = createExportWrapper("FPDF_StructElement_Attr_GetNumberValue", 2);\n    Module["_FPDF_StructElement_Attr_GetStringValue"] = createExportWrapper("FPDF_StructElement_Attr_GetStringValue", 4);\n    Module["_FPDF_StructElement_Attr_GetBlobValue"] = createExportWrapper("FPDF_StructElement_Attr_GetBlobValue", 4);\n    Module["_FPDF_StructElement_Attr_CountChildren"] = createExportWrapper("FPDF_StructElement_Attr_CountChildren", 1);\n    Module["_FPDF_StructElement_Attr_GetChildAtIndex"] = createExportWrapper("FPDF_StructElement_Attr_GetChildAtIndex", 2);\n    Module["_FPDF_StructElement_GetMarkedContentIdCount"] = createExportWrapper("FPDF_StructElement_GetMarkedContentIdCount", 1);\n    Module["_FPDF_StructElement_GetMarkedContentIdAtIndex"] = createExportWrapper("FPDF_StructElement_GetMarkedContentIdAtIndex", 2);\n    Module["_FPDF_AddInstalledFont"] = createExportWrapper(\n      "FPDF_AddInstalledFont",\n      3\n    );\n    Module["_FPDF_SetSystemFontInfo"] = createExportWrapper(\n      "FPDF_SetSystemFontInfo",\n      1\n    );\n    Module["_FPDF_GetDefaultTTFMap"] = createExportWrapper(\n      "FPDF_GetDefaultTTFMap",\n      0\n    );\n    Module["_FPDF_GetDefaultTTFMapCount"] = createExportWrapper(\n      "FPDF_GetDefaultTTFMapCount",\n      0\n    );\n    Module["_FPDF_GetDefaultTTFMapEntry"] = createExportWrapper(\n      "FPDF_GetDefaultTTFMapEntry",\n      1\n    );\n    Module["_FPDF_GetDefaultSystemFontInfo"] = createExportWrapper("FPDF_GetDefaultSystemFontInfo", 0);\n    Module["_FPDF_FreeDefaultSystemFontInfo"] = createExportWrapper("FPDF_FreeDefaultSystemFontInfo", 1);\n    Module["_FPDFText_LoadPage"] = createExportWrapper(\n      "FPDFText_LoadPage",\n      1\n    );\n    Module["_FPDFText_ClosePage"] = createExportWrapper(\n      "FPDFText_ClosePage",\n      1\n    );\n    Module["_FPDFText_CountChars"] = createExportWrapper(\n      "FPDFText_CountChars",\n      1\n    );\n    Module["_FPDFText_GetUnicode"] = createExportWrapper(\n      "FPDFText_GetUnicode",\n      2\n    );\n    Module["_FPDFText_GetTextObject"] = createExportWrapper(\n      "FPDFText_GetTextObject",\n      2\n    );\n    Module["_FPDFText_IsGenerated"] = createExportWrapper(\n      "FPDFText_IsGenerated",\n      2\n    );\n    Module["_FPDFText_IsHyphen"] = createExportWrapper(\n      "FPDFText_IsHyphen",\n      2\n    );\n    Module["_FPDFText_HasUnicodeMapError"] = createExportWrapper("FPDFText_HasUnicodeMapError", 2);\n    Module["_FPDFText_GetFontSize"] = createExportWrapper(\n      "FPDFText_GetFontSize",\n      2\n    );\n    Module["_FPDFText_GetFontInfo"] = createExportWrapper(\n      "FPDFText_GetFontInfo",\n      5\n    );\n    Module["_FPDFText_GetFontWeight"] = createExportWrapper(\n      "FPDFText_GetFontWeight",\n      2\n    );\n    Module["_FPDFText_GetFillColor"] = createExportWrapper(\n      "FPDFText_GetFillColor",\n      6\n    );\n    Module["_FPDFText_GetStrokeColor"] = createExportWrapper(\n      "FPDFText_GetStrokeColor",\n      6\n    );\n    Module["_FPDFText_GetCharAngle"] = createExportWrapper(\n      "FPDFText_GetCharAngle",\n      2\n    );\n    Module["_FPDFText_GetCharBox"] = createExportWrapper(\n      "FPDFText_GetCharBox",\n      6\n    );\n    Module["_FPDFText_GetLooseCharBox"] = createExportWrapper(\n      "FPDFText_GetLooseCharBox",\n      3\n    );\n    Module["_FPDFText_GetMatrix"] = createExportWrapper(\n      "FPDFText_GetMatrix",\n      3\n    );\n    Module["_FPDFText_GetCharOrigin"] = createExportWrapper(\n      "FPDFText_GetCharOrigin",\n      4\n    );\n    Module["_FPDFText_GetCharIndexAtPos"] = createExportWrapper(\n      "FPDFText_GetCharIndexAtPos",\n      5\n    );\n    Module["_FPDFText_GetText"] = createExportWrapper(\n      "FPDFText_GetText",\n      4\n    );\n    Module["_FPDFText_CountRects"] = createExportWrapper(\n      "FPDFText_CountRects",\n      3\n    );\n    Module["_FPDFText_GetRect"] = createExportWrapper(\n      "FPDFText_GetRect",\n      6\n    );\n    Module["_FPDFText_GetBoundedText"] = createExportWrapper(\n      "FPDFText_GetBoundedText",\n      7\n    );\n    Module["_FPDFText_FindStart"] = createExportWrapper(\n      "FPDFText_FindStart",\n      4\n    );\n    Module["_FPDFText_FindNext"] = createExportWrapper(\n      "FPDFText_FindNext",\n      1\n    );\n    Module["_FPDFText_FindPrev"] = createExportWrapper(\n      "FPDFText_FindPrev",\n      1\n    );\n    Module["_FPDFText_GetSchResultIndex"] = createExportWrapper(\n      "FPDFText_GetSchResultIndex",\n      1\n    );\n    Module["_FPDFText_GetSchCount"] = createExportWrapper(\n      "FPDFText_GetSchCount",\n      1\n    );\n    Module["_FPDFText_FindClose"] = createExportWrapper(\n      "FPDFText_FindClose",\n      1\n    );\n    Module["_FPDFLink_LoadWebLinks"] = createExportWrapper(\n      "FPDFLink_LoadWebLinks",\n      1\n    );\n    Module["_FPDFLink_CountWebLinks"] = createExportWrapper(\n      "FPDFLink_CountWebLinks",\n      1\n    );\n    Module["_FPDFLink_GetURL"] = createExportWrapper("FPDFLink_GetURL", 4);\n    Module["_FPDFLink_CountRects"] = createExportWrapper(\n      "FPDFLink_CountRects",\n      2\n    );\n    Module["_FPDFLink_GetRect"] = createExportWrapper(\n      "FPDFLink_GetRect",\n      7\n    );\n    Module["_FPDFLink_GetTextRange"] = createExportWrapper(\n      "FPDFLink_GetTextRange",\n      4\n    );\n    Module["_FPDFLink_CloseWebLinks"] = createExportWrapper(\n      "FPDFLink_CloseWebLinks",\n      1\n    );\n    Module["_FPDFPage_GetDecodedThumbnailData"] = createExportWrapper("FPDFPage_GetDecodedThumbnailData", 3);\n    Module["_FPDFPage_GetRawThumbnailData"] = createExportWrapper("FPDFPage_GetRawThumbnailData", 3);\n    Module["_FPDFPage_GetThumbnailAsBitmap"] = createExportWrapper("FPDFPage_GetThumbnailAsBitmap", 1);\n    Module["_FPDFPage_SetMediaBox"] = createExportWrapper(\n      "FPDFPage_SetMediaBox",\n      5\n    );\n    Module["_FPDFPage_SetCropBox"] = createExportWrapper(\n      "FPDFPage_SetCropBox",\n      5\n    );\n    Module["_FPDFPage_SetBleedBox"] = createExportWrapper(\n      "FPDFPage_SetBleedBox",\n      5\n    );\n    Module["_FPDFPage_SetTrimBox"] = createExportWrapper(\n      "FPDFPage_SetTrimBox",\n      5\n    );\n    Module["_FPDFPage_SetArtBox"] = createExportWrapper(\n      "FPDFPage_SetArtBox",\n      5\n    );\n    Module["_FPDFPage_GetMediaBox"] = createExportWrapper(\n      "FPDFPage_GetMediaBox",\n      5\n    );\n    Module["_FPDFPage_GetCropBox"] = createExportWrapper(\n      "FPDFPage_GetCropBox",\n      5\n    );\n    Module["_FPDFPage_GetBleedBox"] = createExportWrapper(\n      "FPDFPage_GetBleedBox",\n      5\n    );\n    Module["_FPDFPage_GetTrimBox"] = createExportWrapper(\n      "FPDFPage_GetTrimBox",\n      5\n    );\n    Module["_FPDFPage_GetArtBox"] = createExportWrapper(\n      "FPDFPage_GetArtBox",\n      5\n    );\n    Module["_FPDFPage_TransFormWithClip"] = createExportWrapper(\n      "FPDFPage_TransFormWithClip",\n      3\n    );\n    Module["_FPDFPageObj_TransformClipPath"] = createExportWrapper("FPDFPageObj_TransformClipPath", 7);\n    Module["_FPDFPageObj_GetClipPath"] = createExportWrapper(\n      "FPDFPageObj_GetClipPath",\n      1\n    );\n    Module["_FPDFClipPath_CountPaths"] = createExportWrapper(\n      "FPDFClipPath_CountPaths",\n      1\n    );\n    Module["_FPDFClipPath_CountPathSegments"] = createExportWrapper("FPDFClipPath_CountPathSegments", 2);\n    Module["_FPDFClipPath_GetPathSegment"] = createExportWrapper("FPDFClipPath_GetPathSegment", 3);\n    Module["_FPDF_CreateClipPath"] = createExportWrapper(\n      "FPDF_CreateClipPath",\n      4\n    );\n    Module["_FPDF_DestroyClipPath"] = createExportWrapper(\n      "FPDF_DestroyClipPath",\n      1\n    );\n    Module["_FPDFPage_InsertClipPath"] = createExportWrapper(\n      "FPDFPage_InsertClipPath",\n      2\n    );\n    Module["_FPDF_InitLibrary"] = createExportWrapper(\n      "FPDF_InitLibrary",\n      0\n    );\n    Module["_FPDF_DestroyLibrary"] = createExportWrapper(\n      "FPDF_DestroyLibrary",\n      0\n    );\n    Module["_FPDF_SetSandBoxPolicy"] = createExportWrapper(\n      "FPDF_SetSandBoxPolicy",\n      2\n    );\n    Module["_FPDF_LoadDocument"] = createExportWrapper(\n      "FPDF_LoadDocument",\n      2\n    );\n    Module["_FPDF_GetFormType"] = createExportWrapper(\n      "FPDF_GetFormType",\n      1\n    );\n    Module["_FPDF_LoadXFA"] = createExportWrapper("FPDF_LoadXFA", 1);\n    Module["_FPDF_LoadMemDocument"] = createExportWrapper(\n      "FPDF_LoadMemDocument",\n      3\n    );\n    Module["_FPDF_LoadMemDocument64"] = createExportWrapper(\n      "FPDF_LoadMemDocument64",\n      3\n    );\n    Module["_FPDF_LoadCustomDocument"] = createExportWrapper(\n      "FPDF_LoadCustomDocument",\n      2\n    );\n    Module["_FPDF_GetFileVersion"] = createExportWrapper(\n      "FPDF_GetFileVersion",\n      2\n    );\n    Module["_FPDF_DocumentHasValidCrossReferenceTable"] = createExportWrapper("FPDF_DocumentHasValidCrossReferenceTable", 1);\n    Module["_FPDF_GetDocPermissions"] = createExportWrapper(\n      "FPDF_GetDocPermissions",\n      1\n    );\n    Module["_FPDF_GetDocUserPermissions"] = createExportWrapper(\n      "FPDF_GetDocUserPermissions",\n      1\n    );\n    Module["_FPDF_GetSecurityHandlerRevision"] = createExportWrapper("FPDF_GetSecurityHandlerRevision", 1);\n    Module["_FPDF_GetPageCount"] = createExportWrapper(\n      "FPDF_GetPageCount",\n      1\n    );\n    Module["_FPDF_LoadPage"] = createExportWrapper("FPDF_LoadPage", 2);\n    Module["_FPDF_GetPageWidthF"] = createExportWrapper(\n      "FPDF_GetPageWidthF",\n      1\n    );\n    Module["_FPDF_GetPageWidth"] = createExportWrapper(\n      "FPDF_GetPageWidth",\n      1\n    );\n    Module["_FPDF_GetPageHeightF"] = createExportWrapper(\n      "FPDF_GetPageHeightF",\n      1\n    );\n    Module["_FPDF_GetPageHeight"] = createExportWrapper(\n      "FPDF_GetPageHeight",\n      1\n    );\n    Module["_FPDF_GetPageBoundingBox"] = createExportWrapper(\n      "FPDF_GetPageBoundingBox",\n      2\n    );\n    Module["_FPDF_RenderPageBitmap"] = createExportWrapper(\n      "FPDF_RenderPageBitmap",\n      8\n    );\n    Module["_FPDF_RenderPageBitmapWithMatrix"] = createExportWrapper("FPDF_RenderPageBitmapWithMatrix", 5);\n    Module["_EPDF_RenderAnnotBitmap"] = createExportWrapper(\n      "EPDF_RenderAnnotBitmap",\n      6\n    );\n    Module["_FPDF_ClosePage"] = createExportWrapper("FPDF_ClosePage", 1);\n    Module["_FPDF_CloseDocument"] = createExportWrapper(\n      "FPDF_CloseDocument",\n      1\n    );\n    Module["_FPDF_GetLastError"] = createExportWrapper(\n      "FPDF_GetLastError",\n      0\n    );\n    Module["_FPDF_DeviceToPage"] = createExportWrapper(\n      "FPDF_DeviceToPage",\n      10\n    );\n    Module["_FPDF_PageToDevice"] = createExportWrapper(\n      "FPDF_PageToDevice",\n      10\n    );\n    Module["_FPDFBitmap_Create"] = createExportWrapper(\n      "FPDFBitmap_Create",\n      3\n    );\n    Module["_FPDFBitmap_CreateEx"] = createExportWrapper(\n      "FPDFBitmap_CreateEx",\n      5\n    );\n    Module["_FPDFBitmap_GetFormat"] = createExportWrapper(\n      "FPDFBitmap_GetFormat",\n      1\n    );\n    Module["_FPDFBitmap_FillRect"] = createExportWrapper(\n      "FPDFBitmap_FillRect",\n      6\n    );\n    Module["_FPDFBitmap_GetBuffer"] = createExportWrapper(\n      "FPDFBitmap_GetBuffer",\n      1\n    );\n    Module["_FPDFBitmap_GetWidth"] = createExportWrapper(\n      "FPDFBitmap_GetWidth",\n      1\n    );\n    Module["_FPDFBitmap_GetHeight"] = createExportWrapper(\n      "FPDFBitmap_GetHeight",\n      1\n    );\n    Module["_FPDFBitmap_GetStride"] = createExportWrapper(\n      "FPDFBitmap_GetStride",\n      1\n    );\n    Module["_FPDFBitmap_Destroy"] = createExportWrapper(\n      "FPDFBitmap_Destroy",\n      1\n    );\n    Module["_FPDF_GetPageSizeByIndexF"] = createExportWrapper(\n      "FPDF_GetPageSizeByIndexF",\n      3\n    );\n    Module["_EPDF_GetPageRotationByIndex"] = createExportWrapper("EPDF_GetPageRotationByIndex", 2);\n    Module["_FPDF_GetPageSizeByIndex"] = createExportWrapper(\n      "FPDF_GetPageSizeByIndex",\n      4\n    );\n    Module["_FPDF_VIEWERREF_GetPrintScaling"] = createExportWrapper("FPDF_VIEWERREF_GetPrintScaling", 1);\n    Module["_FPDF_VIEWERREF_GetNumCopies"] = createExportWrapper("FPDF_VIEWERREF_GetNumCopies", 1);\n    Module["_FPDF_VIEWERREF_GetPrintPageRange"] = createExportWrapper("FPDF_VIEWERREF_GetPrintPageRange", 1);\n    Module["_FPDF_VIEWERREF_GetPrintPageRangeCount"] = createExportWrapper("FPDF_VIEWERREF_GetPrintPageRangeCount", 1);\n    Module["_FPDF_VIEWERREF_GetPrintPageRangeElement"] = createExportWrapper("FPDF_VIEWERREF_GetPrintPageRangeElement", 2);\n    Module["_FPDF_VIEWERREF_GetDuplex"] = createExportWrapper(\n      "FPDF_VIEWERREF_GetDuplex",\n      1\n    );\n    Module["_FPDF_VIEWERREF_GetName"] = createExportWrapper(\n      "FPDF_VIEWERREF_GetName",\n      4\n    );\n    Module["_FPDF_CountNamedDests"] = createExportWrapper(\n      "FPDF_CountNamedDests",\n      1\n    );\n    Module["_FPDF_GetNamedDestByName"] = createExportWrapper(\n      "FPDF_GetNamedDestByName",\n      2\n    );\n    Module["_FPDF_GetNamedDest"] = createExportWrapper(\n      "FPDF_GetNamedDest",\n      4\n    );\n    Module["_FPDF_GetXFAPacketCount"] = createExportWrapper(\n      "FPDF_GetXFAPacketCount",\n      1\n    );\n    Module["_FPDF_GetXFAPacketName"] = createExportWrapper(\n      "FPDF_GetXFAPacketName",\n      4\n    );\n    Module["_FPDF_GetXFAPacketContent"] = createExportWrapper(\n      "FPDF_GetXFAPacketContent",\n      5\n    );\n    Module["_FPDF_GetTrailerEnds"] = createExportWrapper(\n      "FPDF_GetTrailerEnds",\n      3\n    );\n    var _fflush = createExportWrapper("fflush", 1);\n    var _emscripten_builtin_memalign = createExportWrapper("emscripten_builtin_memalign", 2);\n    var _strerror = createExportWrapper("strerror", 1);\n    var _setThrew = createExportWrapper("setThrew", 2);\n    var _emscripten_stack_init = () => (_emscripten_stack_init = wasmExports["emscripten_stack_init"])();\n    var _emscripten_stack_get_end = () => (_emscripten_stack_get_end = wasmExports["emscripten_stack_get_end"])();\n    var __emscripten_stack_restore = (a0) => (__emscripten_stack_restore = wasmExports["_emscripten_stack_restore"])(a0);\n    var __emscripten_stack_alloc = (a0) => (__emscripten_stack_alloc = wasmExports["_emscripten_stack_alloc"])(a0);\n    var _emscripten_stack_get_current = () => (_emscripten_stack_get_current = wasmExports["emscripten_stack_get_current"])();\n    Module["dynCall_ji"] = createExportWrapper("dynCall_ji", 2);\n    Module["dynCall_jij"] = createExportWrapper("dynCall_jij", 4);\n    Module["dynCall_iiij"] = createExportWrapper("dynCall_iiij", 5);\n    Module["dynCall_iij"] = createExportWrapper("dynCall_iij", 4);\n    Module["dynCall_j"] = createExportWrapper("dynCall_j", 1);\n    Module["dynCall_jji"] = createExportWrapper("dynCall_jji", 4);\n    Module["dynCall_iji"] = createExportWrapper("dynCall_iji", 4);\n    Module["dynCall_viijii"] = createExportWrapper("dynCall_viijii", 7);\n    Module["dynCall_iiji"] = createExportWrapper("dynCall_iiji", 5);\n    Module["dynCall_jiji"] = createExportWrapper("dynCall_jiji", 5);\n    Module["dynCall_iiiiij"] = createExportWrapper("dynCall_iiiiij", 7);\n    Module["dynCall_iiiiijj"] = createExportWrapper("dynCall_iiiiijj", 9);\n    Module["dynCall_iiiiiijj"] = createExportWrapper(\n      "dynCall_iiiiiijj",\n      10\n    );\n    Module["dynCall_viji"] = createExportWrapper("dynCall_viji", 5);\n    function invoke_viii(index, a1, a2, a3) {\n      var sp = stackSave();\n      try {\n        getWasmTableEntry(index)(a1, a2, a3);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_ii(index, a1) {\n      var sp = stackSave();\n      try {\n        return getWasmTableEntry(index)(a1);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_iii(index, a1, a2) {\n      var sp = stackSave();\n      try {\n        return getWasmTableEntry(index)(a1, a2);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_iiii(index, a1, a2, a3) {\n      var sp = stackSave();\n      try {\n        return getWasmTableEntry(index)(a1, a2, a3);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_viiii(index, a1, a2, a3, a4) {\n      var sp = stackSave();\n      try {\n        getWasmTableEntry(index)(a1, a2, a3, a4);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_iiiii(index, a1, a2, a3, a4) {\n      var sp = stackSave();\n      try {\n        return getWasmTableEntry(index)(a1, a2, a3, a4);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_v(index) {\n      var sp = stackSave();\n      try {\n        getWasmTableEntry(index)();\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_vii(index, a1, a2) {\n      var sp = stackSave();\n      try {\n        getWasmTableEntry(index)(a1, a2);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    function invoke_viiiiiiiii(index, a1, a2, a3, a4, a5, a6, a7, a8, a9) {\n      var sp = stackSave();\n      try {\n        getWasmTableEntry(index)(a1, a2, a3, a4, a5, a6, a7, a8, a9);\n      } catch (e) {\n        stackRestore(sp);\n        if (e !== e + 0) throw e;\n        _setThrew(1, 0);\n      }\n    }\n    Module["wasmExports"] = wasmExports;\n    Module["ccall"] = ccall;\n    Module["cwrap"] = cwrap;\n    Module["addFunction"] = addFunction;\n    Module["removeFunction"] = removeFunction;\n    Module["setValue"] = setValue;\n    Module["getValue"] = getValue;\n    Module["UTF8ToString"] = UTF8ToString;\n    Module["stringToUTF8"] = stringToUTF8;\n    Module["UTF16ToString"] = UTF16ToString;\n    Module["stringToUTF16"] = stringToUTF16;\n    var missingLibrarySymbols = [\n      "writeI53ToI64",\n      "writeI53ToI64Clamped",\n      "writeI53ToI64Signaling",\n      "writeI53ToU64Clamped",\n      "writeI53ToU64Signaling",\n      "readI53FromI64",\n      "readI53FromU64",\n      "convertI32PairToI53",\n      "convertU32PairToI53",\n      "getTempRet0",\n      "setTempRet0",\n      "exitJS",\n      "inetPton4",\n      "inetNtop4",\n      "inetPton6",\n      "inetNtop6",\n      "readSockaddr",\n      "writeSockaddr",\n      "emscriptenLog",\n      "readEmAsmArgs",\n      "jstoi_q",\n      "listenOnce",\n      "autoResumeAudioContext",\n      "dynCallLegacy",\n      "getDynCaller",\n      "dynCall",\n      "handleException",\n      "keepRuntimeAlive",\n      "runtimeKeepalivePush",\n      "runtimeKeepalivePop",\n      "callUserCallback",\n      "maybeExit",\n      "asmjsMangle",\n      "HandleAllocator",\n      "getNativeTypeSize",\n      "STACK_SIZE",\n      "STACK_ALIGN",\n      "POINTER_SIZE",\n      "ASSERTIONS",\n      "reallyNegative",\n      "unSign",\n      "strLen",\n      "reSign",\n      "formatString",\n      "intArrayToString",\n      "AsciiToString",\n      "lengthBytesUTF16",\n      "UTF32ToString",\n      "stringToUTF32",\n      "lengthBytesUTF32",\n      "stringToNewUTF8",\n      "registerKeyEventCallback",\n      "maybeCStringToJsString",\n      "findEventTarget",\n      "getBoundingClientRect",\n      "fillMouseEventData",\n      "registerMouseEventCallback",\n      "registerWheelEventCallback",\n      "registerUiEventCallback",\n      "registerFocusEventCallback",\n      "fillDeviceOrientationEventData",\n      "registerDeviceOrientationEventCallback",\n      "fillDeviceMotionEventData",\n      "registerDeviceMotionEventCallback",\n      "screenOrientation",\n      "fillOrientationChangeEventData",\n      "registerOrientationChangeEventCallback",\n      "fillFullscreenChangeEventData",\n      "registerFullscreenChangeEventCallback",\n      "JSEvents_requestFullscreen",\n      "JSEvents_resizeCanvasForFullscreen",\n      "registerRestoreOldStyle",\n      "hideEverythingExceptGivenElement",\n      "restoreHiddenElements",\n      "setLetterbox",\n      "softFullscreenResizeWebGLRenderTarget",\n      "doRequestFullscreen",\n      "fillPointerlockChangeEventData",\n      "registerPointerlockChangeEventCallback",\n      "registerPointerlockErrorEventCallback",\n      "requestPointerLock",\n      "fillVisibilityChangeEventData",\n      "registerVisibilityChangeEventCallback",\n      "registerTouchEventCallback",\n      "fillGamepadEventData",\n      "registerGamepadEventCallback",\n      "registerBeforeUnloadEventCallback",\n      "fillBatteryEventData",\n      "battery",\n      "registerBatteryEventCallback",\n      "setCanvasElementSize",\n      "getCanvasElementSize",\n      "jsStackTrace",\n      "getCallstack",\n      "convertPCtoSourceLocation",\n      "checkWasiClock",\n      "wasiRightsToMuslOFlags",\n      "wasiOFlagsToMuslOFlags",\n      "createDyncallWrapper",\n      "safeSetTimeout",\n      "setImmediateWrapped",\n      "clearImmediateWrapped",\n      "polyfillSetImmediate",\n      "registerPostMainLoop",\n      "registerPreMainLoop",\n      "getPromise",\n      "makePromise",\n      "idsToPromises",\n      "makePromiseCallback",\n      "ExceptionInfo",\n      "findMatchingCatch",\n      "Browser_asyncPrepareDataCounter",\n      "safeRequestAnimationFrame",\n      "arraySum",\n      "addDays",\n      "getSocketFromFD",\n      "getSocketAddress",\n      "FS_unlink",\n      "FS_mkdirTree",\n      "_setNetworkCallback",\n      "heapObjectForWebGLType",\n      "toTypedArrayIndex",\n      "webgl_enable_ANGLE_instanced_arrays",\n      "webgl_enable_OES_vertex_array_object",\n      "webgl_enable_WEBGL_draw_buffers",\n      "webgl_enable_WEBGL_multi_draw",\n      "webgl_enable_EXT_polygon_offset_clamp",\n      "webgl_enable_EXT_clip_control",\n      "webgl_enable_WEBGL_polygon_mode",\n      "emscriptenWebGLGet",\n      "computeUnpackAlignedImageSize",\n      "colorChannelsInGlTextureFormat",\n      "emscriptenWebGLGetTexPixelData",\n      "emscriptenWebGLGetUniform",\n      "webglGetUniformLocation",\n      "webglPrepareUniformLocationsBeforeFirstUse",\n      "webglGetLeftBracePos",\n      "emscriptenWebGLGetVertexAttrib",\n      "__glGetActiveAttribOrUniform",\n      "writeGLArray",\n      "registerWebGlEventCallback",\n      "runAndAbortIfError",\n      "ALLOC_NORMAL",\n      "ALLOC_STACK",\n      "allocate",\n      "writeStringToMemory",\n      "writeAsciiToMemory",\n      "setErrNo",\n      "demangle",\n      "stackTrace"\n    ];\n    missingLibrarySymbols.forEach(missingLibrarySymbol);\n    var unexportedSymbols = [\n      "run",\n      "addOnPreRun",\n      "addOnInit",\n      "addOnPreMain",\n      "addOnExit",\n      "addOnPostRun",\n      "addRunDependency",\n      "removeRunDependency",\n      "out",\n      "err",\n      "callMain",\n      "abort",\n      "wasmMemory",\n      "writeStackCookie",\n      "checkStackCookie",\n      "convertI32PairToI53Checked",\n      "stackSave",\n      "stackRestore",\n      "stackAlloc",\n      "ptrToString",\n      "zeroMemory",\n      "getHeapMax",\n      "growMemory",\n      "ENV",\n      "ERRNO_CODES",\n      "strError",\n      "DNS",\n      "Protocols",\n      "Sockets",\n      "initRandomFill",\n      "randomFill",\n      "timers",\n      "warnOnce",\n      "readEmAsmArgsArray",\n      "jstoi_s",\n      "getExecutableName",\n      "asyncLoad",\n      "alignMemory",\n      "mmapAlloc",\n      "wasmTable",\n      "noExitRuntime",\n      "getCFunc",\n      "uleb128Encode",\n      "sigToWasmTypes",\n      "generateFuncType",\n      "convertJsFunctionToWasm",\n      "freeTableIndexes",\n      "functionsInTableMap",\n      "getEmptyTableSlot",\n      "updateTableMap",\n      "getFunctionAddress",\n      "PATH",\n      "PATH_FS",\n      "UTF8Decoder",\n      "UTF8ArrayToString",\n      "stringToUTF8Array",\n      "lengthBytesUTF8",\n      "intArrayFromString",\n      "stringToAscii",\n      "UTF16Decoder",\n      "stringToUTF8OnStack",\n      "writeArrayToMemory",\n      "JSEvents",\n      "specialHTMLTargets",\n      "findCanvasEventTarget",\n      "currentFullscreenStrategy",\n      "restoreOldWindowedStyle",\n      "UNWIND_CACHE",\n      "ExitStatus",\n      "getEnvStrings",\n      "doReadv",\n      "doWritev",\n      "promiseMap",\n      "uncaughtExceptionCount",\n      "exceptionLast",\n      "exceptionCaught",\n      "Browser",\n      "getPreloadedImageData__data",\n      "wget",\n      "MONTH_DAYS_REGULAR",\n      "MONTH_DAYS_LEAP",\n      "MONTH_DAYS_REGULAR_CUMULATIVE",\n      "MONTH_DAYS_LEAP_CUMULATIVE",\n      "isLeapYear",\n      "ydayFromDate",\n      "SYSCALLS",\n      "preloadPlugins",\n      "FS_createPreloadedFile",\n      "FS_modeStringToFlags",\n      "FS_getMode",\n      "FS_stdin_getChar_buffer",\n      "FS_stdin_getChar",\n      "FS_createPath",\n      "FS_createDevice",\n      "FS_readFile",\n      "FS",\n      "FS_createDataFile",\n      "FS_createLazyFile",\n      "MEMFS",\n      "TTY",\n      "PIPEFS",\n      "SOCKFS",\n      "tempFixedLengthArray",\n      "miniTempWebGLFloatBuffers",\n      "miniTempWebGLIntBuffers",\n      "GL",\n      "AL",\n      "GLUT",\n      "EGL",\n      "GLEW",\n      "IDBStore",\n      "SDL",\n      "SDL_gfx",\n      "allocateUTF8",\n      "allocateUTF8OnStack",\n      "print",\n      "printErr"\n    ];\n    unexportedSymbols.forEach(unexportedRuntimeSymbol);\n    var calledRun;\n    var calledPrerun;\n    dependenciesFulfilled = function runCaller() {\n      if (!calledRun) run();\n      if (!calledRun) dependenciesFulfilled = runCaller;\n    };\n    function stackCheckInit() {\n      _emscripten_stack_init();\n      writeStackCookie();\n    }\n    function run() {\n      if (runDependencies > 0) {\n        return;\n      }\n      stackCheckInit();\n      if (!calledPrerun) {\n        calledPrerun = 1;\n        preRun();\n        if (runDependencies > 0) {\n          return;\n        }\n      }\n      function doRun() {\n        var _a;\n        if (calledRun) return;\n        calledRun = 1;\n        Module["calledRun"] = 1;\n        if (ABORT) return;\n        initRuntime();\n        readyPromiseResolve(Module);\n        (_a = Module["onRuntimeInitialized"]) == null ? void 0 : _a.call(Module);\n        assert(\n          !Module["_main"],\n          \'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]\'\n        );\n        postRun();\n      }\n      if (Module["setStatus"]) {\n        Module["setStatus"]("Running...");\n        setTimeout(() => {\n          setTimeout(() => Module["setStatus"](""), 1);\n          doRun();\n        }, 1);\n      } else {\n        doRun();\n      }\n      checkStackCookie();\n    }\n    if (Module["preInit"]) {\n      if (typeof Module["preInit"] == "function") Module["preInit"] = [Module["preInit"]];\n      while (Module["preInit"].length > 0) {\n        Module["preInit"].pop()();\n      }\n    }\n    run();\n    moduleRtn = readyPromise;\n    for (const prop of Object.keys(Module)) {\n      if (!(prop in moduleArg)) {\n        Object.defineProperty(moduleArg, prop, {\n          configurable: true,\n          get() {\n            abort(\n              `Access to module property (\'${prop}\') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`\n            );\n          }\n        });\n      }\n    }\n    return moduleRtn;\n  };\n})();\nconst functions = {\n  EPDF_GetMetaKeyCount: [["number", "boolean"], "number"],\n  EPDF_GetMetaKeyName: [\n    ["number", "number", "boolean", "number", "number"],\n    "number"\n  ],\n  EPDF_GetMetaTrapped: [["number"], "number"],\n  EPDF_GetPageRotationByIndex: [["number", "number"], "number"],\n  EPDF_HasMetaText: [["number", "string"], "boolean"],\n  EPDF_PNG_EncodeRGBA: [\n    ["number", "number", "number", "number", "number", "number"],\n    "number"\n  ],\n  EPDF_RenderAnnotBitmap: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  EPDF_SetMetaText: [["number", "string", "number"], "boolean"],\n  EPDF_SetMetaTrapped: [["number", "number"], "boolean"],\n  EPDFAction_CreateGoTo: [["number", "number"], "number"],\n  EPDFAction_CreateGoToNamed: [["number", "string"], "number"],\n  EPDFAction_CreateLaunch: [["number", "number"], "number"],\n  EPDFAction_CreateRemoteGoToByName: [["number", "number", "number"], "number"],\n  EPDFAction_CreateRemoteGoToDest: [["number", "number", "number"], "number"],\n  EPDFAction_CreateURI: [["number", "string"], "number"],\n  EPDFAnnot_ClearColor: [["number", "number"], "boolean"],\n  EPDFAnnot_GenerateAppearance: [["number"], "boolean"],\n  EPDFAnnot_GenerateAppearanceWithBlend: [["number", "number"], "boolean"],\n  EPDFAnnot_GetBlendMode: [["number"], "number"],\n  EPDFAnnot_GetBorderDashPattern: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_GetBorderDashPatternCount: [["number"], "number"],\n  EPDFAnnot_GetBorderEffect: [["number", "number"], "boolean"],\n  EPDFAnnot_GetBorderStyle: [["number", "number"], "number"],\n  EPDFAnnot_GetColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  EPDFAnnot_GetDefaultAppearance: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  EPDFAnnot_GetIcon: [["number"], "number"],\n  EPDFAnnot_GetIntent: [["number", "number", "number"], "number"],\n  EPDFAnnot_GetLineEndings: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_GetOpacity: [["number", "number"], "boolean"],\n  EPDFAnnot_GetRectangleDifferences: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  EPDFAnnot_GetRichContent: [["number", "number", "number"], "number"],\n  EPDFAnnot_GetTextAlignment: [["number"], "number"],\n  EPDFAnnot_GetVerticalAlignment: [["number"], "number"],\n  EPDFAnnot_SetBorderDashPattern: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_SetBorderStyle: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_SetColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  EPDFAnnot_SetDefaultAppearance: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  EPDFAnnot_SetIcon: [["number", "number"], "boolean"],\n  EPDFAnnot_SetIntent: [["number", "string"], "boolean"],\n  EPDFAnnot_SetLine: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_SetLineEndings: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_SetLinkedAnnot: [["number", "string", "number"], "boolean"],\n  EPDFAnnot_SetOpacity: [["number", "number"], "boolean"],\n  EPDFAnnot_SetTextAlignment: [["number", "number"], "boolean"],\n  EPDFAnnot_SetVerticalAlignment: [["number", "number"], "boolean"],\n  EPDFAnnot_SetVertices: [["number", "number", "number"], "boolean"],\n  EPDFAnnot_UpdateAppearanceToRect: [["number", "number"], "boolean"],\n  EPDFAttachment_GetDescription: [["number", "number", "number"], "number"],\n  EPDFAttachment_GetIntegerValue: [["number", "string", "number"], "boolean"],\n  EPDFAttachment_SetDescription: [["number", "number"], "boolean"],\n  EPDFAttachment_SetSubtype: [["number", "string"], "boolean"],\n  EPDFBookmark_AppendChild: [["number", "number", "number"], "number"],\n  EPDFBookmark_Clear: [["number"], "boolean"],\n  EPDFBookmark_ClearTarget: [["number"], "boolean"],\n  EPDFBookmark_Create: [["number", "number"], "number"],\n  EPDFBookmark_Delete: [["number", "number"], "boolean"],\n  EPDFBookmark_InsertAfter: [["number", "number", "number", "number"], "number"],\n  EPDFBookmark_SetAction: [["number", "number", "number"], "boolean"],\n  EPDFBookmark_SetDest: [["number", "number", "number"], "boolean"],\n  EPDFBookmark_SetTitle: [["number", "number"], "boolean"],\n  EPDFCatalog_GetLanguage: [["number", "number", "number"], "number"],\n  EPDFDest_CreateRemoteView: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  EPDFDest_CreateRemoteXYZ: [\n    ["number", "number", "boolean", "number", "boolean", "number", "boolean", "number"],\n    "number"\n  ],\n  EPDFDest_CreateView: [["number", "number", "number", "number"], "number"],\n  EPDFDest_CreateXYZ: [\n    ["number", "boolean", "number", "boolean", "number", "boolean", "number"],\n    "number"\n  ],\n  EPDFNamedDest_Remove: [["number", "string"], "boolean"],\n  EPDFNamedDest_SetDest: [["number", "string", "number"], "boolean"],\n  EPDFPage_CreateAnnot: [["number", "number"], "number"],\n  EPDFPage_GetAnnotByName: [["number", "number"], "number"],\n  EPDFPage_GetAnnotCountRaw: [["number", "number"], "number"],\n  EPDFPage_GetAnnotRaw: [["number", "number", "number"], "number"],\n  EPDFPage_RemoveAnnotByName: [["number", "number"], "boolean"],\n  EPDFPage_RemoveAnnotRaw: [["number", "number", "number"], "boolean"],\n  EPDFText_RedactInQuads: [\n    ["number", "number", "number", "boolean", "boolean"],\n    "boolean"\n  ],\n  EPDFText_RedactInRect: [["number", "number", "boolean", "boolean"], "boolean"],\n  FORM_CanRedo: [["number", "number"], "boolean"],\n  FORM_CanUndo: [["number", "number"], "boolean"],\n  FORM_DoDocumentAAction: [["number", "number"], null],\n  FORM_DoDocumentJSAction: [["number"], null],\n  FORM_DoDocumentOpenAction: [["number"], null],\n  FORM_DoPageAAction: [["number", "number", "number"], null],\n  FORM_ForceToKillFocus: [["number"], "boolean"],\n  FORM_GetFocusedAnnot: [["number", "number", "number"], "boolean"],\n  FORM_GetFocusedText: [["number", "number", "number", "number"], "number"],\n  FORM_GetSelectedText: [["number", "number", "number", "number"], "number"],\n  FORM_IsIndexSelected: [["number", "number", "number"], "boolean"],\n  FORM_OnAfterLoadPage: [["number", "number"], null],\n  FORM_OnBeforeClosePage: [["number", "number"], null],\n  FORM_OnChar: [["number", "number", "number", "number"], "boolean"],\n  FORM_OnFocus: [["number", "number", "number", "number", "number"], "boolean"],\n  FORM_OnKeyDown: [["number", "number", "number", "number"], "boolean"],\n  FORM_OnKeyUp: [["number", "number", "number", "number"], "boolean"],\n  FORM_OnLButtonDoubleClick: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_OnLButtonDown: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_OnLButtonUp: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_OnMouseMove: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_OnMouseWheel: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_OnRButtonDown: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_OnRButtonUp: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FORM_Redo: [["number", "number"], "boolean"],\n  FORM_ReplaceAndKeepSelection: [["number", "number", "number"], null],\n  FORM_ReplaceSelection: [["number", "number", "number"], null],\n  FORM_SelectAllText: [["number", "number"], "boolean"],\n  FORM_SetFocusedAnnot: [["number", "number"], "boolean"],\n  FORM_SetIndexSelected: [["number", "number", "number", "boolean"], "boolean"],\n  FORM_Undo: [["number", "number"], "boolean"],\n  FPDF_AddInstalledFont: [["number", "number", "number"], null],\n  FPDF_CloseDocument: [["number"], null],\n  FPDF_ClosePage: [["number"], null],\n  FPDF_CloseXObject: [["number"], null],\n  FPDF_CopyViewerPreferences: [["number", "number"], "boolean"],\n  FPDF_CountNamedDests: [["number"], "number"],\n  FPDF_CreateClipPath: [["number", "number", "number", "number"], "number"],\n  FPDF_CreateNewDocument: [[], "number"],\n  FPDF_DestroyClipPath: [["number"], null],\n  FPDF_DestroyLibrary: [[], null],\n  FPDF_DeviceToPage: [\n    [\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number"\n    ],\n    "boolean"\n  ],\n  FPDF_DocumentHasValidCrossReferenceTable: [["number"], "boolean"],\n  FPDF_FFLDraw: [\n    [\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number"\n    ],\n    null\n  ],\n  FPDF_FreeDefaultSystemFontInfo: [["number"], null],\n  FPDF_GetDefaultSystemFontInfo: [[], "number"],\n  FPDF_GetDefaultTTFMap: [[], "number"],\n  FPDF_GetDefaultTTFMapCount: [[], "number"],\n  FPDF_GetDefaultTTFMapEntry: [["number"], "number"],\n  FPDF_GetDocPermissions: [["number"], "number"],\n  FPDF_GetDocUserPermissions: [["number"], "number"],\n  FPDF_GetFileIdentifier: [["number", "number", "number", "number"], "number"],\n  FPDF_GetFileVersion: [["number", "number"], "boolean"],\n  FPDF_GetFormType: [["number"], "number"],\n  FPDF_GetLastError: [[], "number"],\n  FPDF_GetMetaText: [["number", "string", "number", "number"], "number"],\n  FPDF_GetNamedDest: [["number", "number", "number", "number"], "number"],\n  FPDF_GetNamedDestByName: [["number", "string"], "number"],\n  FPDF_GetPageAAction: [["number", "number"], "number"],\n  FPDF_GetPageBoundingBox: [["number", "number"], "boolean"],\n  FPDF_GetPageCount: [["number"], "number"],\n  FPDF_GetPageHeight: [["number"], "number"],\n  FPDF_GetPageHeightF: [["number"], "number"],\n  FPDF_GetPageLabel: [["number", "number", "number", "number"], "number"],\n  FPDF_GetPageSizeByIndex: [["number", "number", "number", "number"], "number"],\n  FPDF_GetPageSizeByIndexF: [["number", "number", "number"], "boolean"],\n  FPDF_GetPageWidth: [["number"], "number"],\n  FPDF_GetPageWidthF: [["number"], "number"],\n  FPDF_GetSecurityHandlerRevision: [["number"], "number"],\n  FPDF_GetSignatureCount: [["number"], "number"],\n  FPDF_GetSignatureObject: [["number", "number"], "number"],\n  FPDF_GetTrailerEnds: [["number", "number", "number"], "number"],\n  FPDF_GetXFAPacketContent: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDF_GetXFAPacketCount: [["number"], "number"],\n  FPDF_GetXFAPacketName: [["number", "number", "number", "number"], "number"],\n  FPDF_ImportNPagesToOne: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDF_ImportPages: [["number", "number", "string", "number"], "boolean"],\n  FPDF_ImportPagesByIndex: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDF_InitLibrary: [[], null],\n  FPDF_InitLibraryWithConfig: [["number"], null],\n  FPDF_LoadCustomDocument: [["number", "string"], "number"],\n  FPDF_LoadDocument: [["number", "string"], "number"],\n  FPDF_LoadMemDocument: [["number", "number", "string"], "number"],\n  FPDF_LoadMemDocument64: [["number", "number", "string"], "number"],\n  FPDF_LoadPage: [["number", "number"], "number"],\n  FPDF_LoadXFA: [["number"], "boolean"],\n  FPDF_MovePages: [["number", "number", "number", "number"], "boolean"],\n  FPDF_NewFormObjectFromXObject: [["number"], "number"],\n  FPDF_NewXObjectFromPage: [["number", "number", "number"], "number"],\n  FPDF_PageToDevice: [\n    [\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number"\n    ],\n    "boolean"\n  ],\n  FPDF_RemoveFormFieldHighlight: [["number"], null],\n  FPDF_RenderPage_Close: [["number"], null],\n  FPDF_RenderPage_Continue: [["number", "number"], "number"],\n  FPDF_RenderPageBitmap: [\n    ["number", "number", "number", "number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDF_RenderPageBitmap_Start: [\n    [\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number"\n    ],\n    "number"\n  ],\n  FPDF_RenderPageBitmapWithColorScheme_Start: [\n    [\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number",\n      "number"\n    ],\n    "number"\n  ],\n  FPDF_RenderPageBitmapWithMatrix: [\n    ["number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDF_SaveAsCopy: [["number", "number", "number"], "boolean"],\n  FPDF_SaveWithVersion: [["number", "number", "number", "number"], "boolean"],\n  FPDF_SetFormFieldHighlightAlpha: [["number", "number"], null],\n  FPDF_SetFormFieldHighlightColor: [["number", "number", "number"], null],\n  FPDF_SetSandBoxPolicy: [["number", "boolean"], null],\n  FPDF_SetSystemFontInfo: [["number"], null],\n  FPDF_StructElement_Attr_CountChildren: [["number"], "number"],\n  FPDF_StructElement_Attr_GetBlobValue: [\n    ["number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDF_StructElement_Attr_GetBooleanValue: [["number", "number"], "boolean"],\n  FPDF_StructElement_Attr_GetChildAtIndex: [["number", "number"], "number"],\n  FPDF_StructElement_Attr_GetCount: [["number"], "number"],\n  FPDF_StructElement_Attr_GetName: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDF_StructElement_Attr_GetNumberValue: [["number", "number"], "boolean"],\n  FPDF_StructElement_Attr_GetStringValue: [\n    ["number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDF_StructElement_Attr_GetType: [["number"], "number"],\n  FPDF_StructElement_Attr_GetValue: [["number", "string"], "number"],\n  FPDF_StructElement_CountChildren: [["number"], "number"],\n  FPDF_StructElement_GetActualText: [["number", "number", "number"], "number"],\n  FPDF_StructElement_GetAltText: [["number", "number", "number"], "number"],\n  FPDF_StructElement_GetAttributeAtIndex: [["number", "number"], "number"],\n  FPDF_StructElement_GetAttributeCount: [["number"], "number"],\n  FPDF_StructElement_GetChildAtIndex: [["number", "number"], "number"],\n  FPDF_StructElement_GetChildMarkedContentID: [["number", "number"], "number"],\n  FPDF_StructElement_GetID: [["number", "number", "number"], "number"],\n  FPDF_StructElement_GetLang: [["number", "number", "number"], "number"],\n  FPDF_StructElement_GetMarkedContentID: [["number"], "number"],\n  FPDF_StructElement_GetMarkedContentIdAtIndex: [["number", "number"], "number"],\n  FPDF_StructElement_GetMarkedContentIdCount: [["number"], "number"],\n  FPDF_StructElement_GetObjType: [["number", "number", "number"], "number"],\n  FPDF_StructElement_GetParent: [["number"], "number"],\n  FPDF_StructElement_GetStringAttribute: [\n    ["number", "string", "number", "number"],\n    "number"\n  ],\n  FPDF_StructElement_GetTitle: [["number", "number", "number"], "number"],\n  FPDF_StructElement_GetType: [["number", "number", "number"], "number"],\n  FPDF_StructTree_Close: [["number"], null],\n  FPDF_StructTree_CountChildren: [["number"], "number"],\n  FPDF_StructTree_GetChildAtIndex: [["number", "number"], "number"],\n  FPDF_StructTree_GetForPage: [["number"], "number"],\n  FPDF_VIEWERREF_GetDuplex: [["number"], "number"],\n  FPDF_VIEWERREF_GetName: [["number", "string", "number", "number"], "number"],\n  FPDF_VIEWERREF_GetNumCopies: [["number"], "number"],\n  FPDF_VIEWERREF_GetPrintPageRange: [["number"], "number"],\n  FPDF_VIEWERREF_GetPrintPageRangeCount: [["number"], "number"],\n  FPDF_VIEWERREF_GetPrintPageRangeElement: [["number", "number"], "number"],\n  FPDF_VIEWERREF_GetPrintScaling: [["number"], "boolean"],\n  FPDFAction_GetDest: [["number", "number"], "number"],\n  FPDFAction_GetFilePath: [["number", "number", "number"], "number"],\n  FPDFAction_GetType: [["number"], "number"],\n  FPDFAction_GetURIPath: [["number", "number", "number", "number"], "number"],\n  FPDFAnnot_AddFileAttachment: [["number", "number"], "number"],\n  FPDFAnnot_AddInkStroke: [["number", "number", "number"], "number"],\n  FPDFAnnot_AppendAttachmentPoints: [["number", "number"], "boolean"],\n  FPDFAnnot_AppendObject: [["number", "number"], "boolean"],\n  FPDFAnnot_CountAttachmentPoints: [["number"], "number"],\n  FPDFAnnot_GetAP: [["number", "number", "number", "number"], "number"],\n  FPDFAnnot_GetAttachmentPoints: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_GetBorder: [["number", "number", "number", "number"], "boolean"],\n  FPDFAnnot_GetColor: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFAnnot_GetFileAttachment: [["number"], "number"],\n  FPDFAnnot_GetFlags: [["number"], "number"],\n  FPDFAnnot_GetFocusableSubtypes: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_GetFocusableSubtypesCount: [["number"], "number"],\n  FPDFAnnot_GetFontColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFAnnot_GetFontSize: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_GetFormAdditionalActionJavaScript: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFAnnot_GetFormControlCount: [["number", "number"], "number"],\n  FPDFAnnot_GetFormControlIndex: [["number", "number"], "number"],\n  FPDFAnnot_GetFormFieldAlternateName: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFAnnot_GetFormFieldAtPoint: [["number", "number", "number"], "number"],\n  FPDFAnnot_GetFormFieldExportValue: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFAnnot_GetFormFieldFlags: [["number", "number"], "number"],\n  FPDFAnnot_GetFormFieldName: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFAnnot_GetFormFieldType: [["number", "number"], "number"],\n  FPDFAnnot_GetFormFieldValue: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFAnnot_GetInkListCount: [["number"], "number"],\n  FPDFAnnot_GetInkListPath: [["number", "number", "number", "number"], "number"],\n  FPDFAnnot_GetLine: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_GetLink: [["number"], "number"],\n  FPDFAnnot_GetLinkedAnnot: [["number", "string"], "number"],\n  FPDFAnnot_GetNumberValue: [["number", "string", "number"], "boolean"],\n  FPDFAnnot_GetObject: [["number", "number"], "number"],\n  FPDFAnnot_GetObjectCount: [["number"], "number"],\n  FPDFAnnot_GetOptionCount: [["number", "number"], "number"],\n  FPDFAnnot_GetOptionLabel: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFAnnot_GetRect: [["number", "number"], "boolean"],\n  FPDFAnnot_GetStringValue: [["number", "string", "number", "number"], "number"],\n  FPDFAnnot_GetSubtype: [["number"], "number"],\n  FPDFAnnot_GetValueType: [["number", "string"], "number"],\n  FPDFAnnot_GetVertices: [["number", "number", "number"], "number"],\n  FPDFAnnot_HasAttachmentPoints: [["number"], "boolean"],\n  FPDFAnnot_HasKey: [["number", "string"], "boolean"],\n  FPDFAnnot_IsChecked: [["number", "number"], "boolean"],\n  FPDFAnnot_IsObjectSupportedSubtype: [["number"], "boolean"],\n  FPDFAnnot_IsOptionSelected: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_IsSupportedSubtype: [["number"], "boolean"],\n  FPDFAnnot_RemoveInkList: [["number"], "boolean"],\n  FPDFAnnot_RemoveObject: [["number", "number"], "boolean"],\n  FPDFAnnot_SetAP: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_SetAttachmentPoints: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_SetBorder: [["number", "number", "number", "number"], "boolean"],\n  FPDFAnnot_SetColor: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFAnnot_SetFlags: [["number", "number"], "boolean"],\n  FPDFAnnot_SetFocusableSubtypes: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_SetFontColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFAnnot_SetFormFieldFlags: [["number", "number", "number"], "boolean"],\n  FPDFAnnot_SetRect: [["number", "number"], "boolean"],\n  FPDFAnnot_SetStringValue: [["number", "string", "number"], "boolean"],\n  FPDFAnnot_SetURI: [["number", "number"], "boolean"],\n  FPDFAnnot_UpdateObject: [["number", "number"], "boolean"],\n  FPDFAttachment_GetFile: [["number", "number", "number", "number"], "boolean"],\n  FPDFAttachment_GetName: [["number", "number", "number"], "number"],\n  FPDFAttachment_GetStringValue: [\n    ["number", "string", "number", "number"],\n    "number"\n  ],\n  FPDFAttachment_GetSubtype: [["number", "number", "number"], "number"],\n  FPDFAttachment_GetValueType: [["number", "string"], "number"],\n  FPDFAttachment_HasKey: [["number", "string"], "boolean"],\n  FPDFAttachment_SetFile: [["number", "number", "number", "number"], "boolean"],\n  FPDFAttachment_SetStringValue: [["number", "string", "number"], "boolean"],\n  FPDFAvail_Create: [["number", "number"], "number"],\n  FPDFAvail_Destroy: [["number"], null],\n  FPDFAvail_GetDocument: [["number", "string"], "number"],\n  FPDFAvail_GetFirstPageNum: [["number"], "number"],\n  FPDFAvail_IsDocAvail: [["number", "number"], "number"],\n  FPDFAvail_IsFormAvail: [["number", "number"], "number"],\n  FPDFAvail_IsLinearized: [["number"], "number"],\n  FPDFAvail_IsPageAvail: [["number", "number", "number"], "number"],\n  FPDFBitmap_Create: [["number", "number", "number"], "number"],\n  FPDFBitmap_CreateEx: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFBitmap_Destroy: [["number"], null],\n  FPDFBitmap_FillRect: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFBitmap_GetBuffer: [["number"], "number"],\n  FPDFBitmap_GetFormat: [["number"], "number"],\n  FPDFBitmap_GetHeight: [["number"], "number"],\n  FPDFBitmap_GetStride: [["number"], "number"],\n  FPDFBitmap_GetWidth: [["number"], "number"],\n  FPDFBookmark_Find: [["number", "number"], "number"],\n  FPDFBookmark_GetAction: [["number"], "number"],\n  FPDFBookmark_GetCount: [["number"], "number"],\n  FPDFBookmark_GetDest: [["number", "number"], "number"],\n  FPDFBookmark_GetFirstChild: [["number", "number"], "number"],\n  FPDFBookmark_GetNextSibling: [["number", "number"], "number"],\n  FPDFBookmark_GetTitle: [["number", "number", "number"], "number"],\n  FPDFCatalog_IsTagged: [["number"], "boolean"],\n  FPDFCatalog_SetLanguage: [["number", "string"], "boolean"],\n  FPDFClipPath_CountPaths: [["number"], "number"],\n  FPDFClipPath_CountPathSegments: [["number", "number"], "number"],\n  FPDFClipPath_GetPathSegment: [["number", "number", "number"], "number"],\n  FPDFDest_GetDestPageIndex: [["number", "number"], "number"],\n  FPDFDest_GetLocationInPage: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFDest_GetView: [["number", "number", "number"], "number"],\n  FPDFDoc_AddAttachment: [["number", "number"], "number"],\n  FPDFDoc_CloseJavaScriptAction: [["number"], null],\n  FPDFDoc_DeleteAttachment: [["number", "number"], "boolean"],\n  FPDFDOC_ExitFormFillEnvironment: [["number"], null],\n  FPDFDoc_GetAttachment: [["number", "number"], "number"],\n  FPDFDoc_GetAttachmentCount: [["number"], "number"],\n  FPDFDoc_GetJavaScriptAction: [["number", "number"], "number"],\n  FPDFDoc_GetJavaScriptActionCount: [["number"], "number"],\n  FPDFDoc_GetPageMode: [["number"], "number"],\n  FPDFDOC_InitFormFillEnvironment: [["number", "number"], "number"],\n  FPDFFont_Close: [["number"], null],\n  FPDFFont_GetAscent: [["number", "number", "number"], "boolean"],\n  FPDFFont_GetBaseFontName: [["number", "number", "number"], "number"],\n  FPDFFont_GetDescent: [["number", "number", "number"], "boolean"],\n  FPDFFont_GetFamilyName: [["number", "number", "number"], "number"],\n  FPDFFont_GetFlags: [["number"], "number"],\n  FPDFFont_GetFontData: [["number", "number", "number", "number"], "boolean"],\n  FPDFFont_GetGlyphPath: [["number", "number", "number"], "number"],\n  FPDFFont_GetGlyphWidth: [["number", "number", "number", "number"], "boolean"],\n  FPDFFont_GetIsEmbedded: [["number"], "number"],\n  FPDFFont_GetItalicAngle: [["number", "number"], "boolean"],\n  FPDFFont_GetWeight: [["number"], "number"],\n  FPDFFormObj_CountObjects: [["number"], "number"],\n  FPDFFormObj_GetObject: [["number", "number"], "number"],\n  FPDFFormObj_RemoveObject: [["number", "number"], "boolean"],\n  FPDFGlyphPath_CountGlyphSegments: [["number"], "number"],\n  FPDFGlyphPath_GetGlyphPathSegment: [["number", "number"], "number"],\n  FPDFImageObj_GetBitmap: [["number"], "number"],\n  FPDFImageObj_GetIccProfileDataDecoded: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFImageObj_GetImageDataDecoded: [["number", "number", "number"], "number"],\n  FPDFImageObj_GetImageDataRaw: [["number", "number", "number"], "number"],\n  FPDFImageObj_GetImageFilter: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFImageObj_GetImageFilterCount: [["number"], "number"],\n  FPDFImageObj_GetImageMetadata: [["number", "number", "number"], "boolean"],\n  FPDFImageObj_GetImagePixelSize: [["number", "number", "number"], "boolean"],\n  FPDFImageObj_GetRenderedBitmap: [["number", "number", "number"], "number"],\n  FPDFImageObj_LoadJpegFile: [\n    ["number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFImageObj_LoadJpegFileInline: [\n    ["number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFImageObj_SetBitmap: [["number", "number", "number", "number"], "boolean"],\n  FPDFImageObj_SetMatrix: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFJavaScriptAction_GetName: [["number", "number", "number"], "number"],\n  FPDFJavaScriptAction_GetScript: [["number", "number", "number"], "number"],\n  FPDFLink_CloseWebLinks: [["number"], null],\n  FPDFLink_CountQuadPoints: [["number"], "number"],\n  FPDFLink_CountRects: [["number", "number"], "number"],\n  FPDFLink_CountWebLinks: [["number"], "number"],\n  FPDFLink_Enumerate: [["number", "number", "number"], "boolean"],\n  FPDFLink_GetAction: [["number"], "number"],\n  FPDFLink_GetAnnot: [["number", "number"], "number"],\n  FPDFLink_GetAnnotRect: [["number", "number"], "boolean"],\n  FPDFLink_GetDest: [["number", "number"], "number"],\n  FPDFLink_GetLinkAtPoint: [["number", "number", "number"], "number"],\n  FPDFLink_GetLinkZOrderAtPoint: [["number", "number", "number"], "number"],\n  FPDFLink_GetQuadPoints: [["number", "number", "number"], "boolean"],\n  FPDFLink_GetRect: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFLink_GetTextRange: [["number", "number", "number", "number"], "boolean"],\n  FPDFLink_GetURL: [["number", "number", "number", "number"], "number"],\n  FPDFLink_LoadWebLinks: [["number"], "number"],\n  FPDFPage_CloseAnnot: [["number"], null],\n  FPDFPage_CountObjects: [["number"], "number"],\n  FPDFPage_CreateAnnot: [["number", "number"], "number"],\n  FPDFPage_Delete: [["number", "number"], null],\n  FPDFPage_Flatten: [["number", "number"], "number"],\n  FPDFPage_FormFieldZOrderAtPoint: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFPage_GenerateContent: [["number"], "boolean"],\n  FPDFPage_GetAnnot: [["number", "number"], "number"],\n  FPDFPage_GetAnnotCount: [["number"], "number"],\n  FPDFPage_GetAnnotIndex: [["number", "number"], "number"],\n  FPDFPage_GetArtBox: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPage_GetBleedBox: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPage_GetCropBox: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPage_GetDecodedThumbnailData: [["number", "number", "number"], "number"],\n  FPDFPage_GetMediaBox: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPage_GetObject: [["number", "number"], "number"],\n  FPDFPage_GetRawThumbnailData: [["number", "number", "number"], "number"],\n  FPDFPage_GetRotation: [["number"], "number"],\n  FPDFPage_GetThumbnailAsBitmap: [["number"], "number"],\n  FPDFPage_GetTrimBox: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPage_HasFormFieldAtPoint: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFPage_HasTransparency: [["number"], "boolean"],\n  FPDFPage_InsertClipPath: [["number", "number"], null],\n  FPDFPage_InsertObject: [["number", "number"], null],\n  FPDFPage_InsertObjectAtIndex: [["number", "number", "number"], "boolean"],\n  FPDFPage_New: [["number", "number", "number", "number"], "number"],\n  FPDFPage_RemoveAnnot: [["number", "number"], "boolean"],\n  FPDFPage_RemoveObject: [["number", "number"], "boolean"],\n  FPDFPage_SetArtBox: [["number", "number", "number", "number", "number"], null],\n  FPDFPage_SetBleedBox: [\n    ["number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDFPage_SetCropBox: [["number", "number", "number", "number", "number"], null],\n  FPDFPage_SetMediaBox: [\n    ["number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDFPage_SetRotation: [["number", "number"], null],\n  FPDFPage_SetTrimBox: [["number", "number", "number", "number", "number"], null],\n  FPDFPage_TransformAnnots: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDFPage_TransFormWithClip: [["number", "number", "number"], "boolean"],\n  FPDFPageObj_AddMark: [["number", "string"], "number"],\n  FPDFPageObj_CountMarks: [["number"], "number"],\n  FPDFPageObj_CreateNewPath: [["number", "number"], "number"],\n  FPDFPageObj_CreateNewRect: [["number", "number", "number", "number"], "number"],\n  FPDFPageObj_CreateTextObj: [["number", "number", "number"], "number"],\n  FPDFPageObj_Destroy: [["number"], null],\n  FPDFPageObj_GetBounds: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObj_GetClipPath: [["number"], "number"],\n  FPDFPageObj_GetDashArray: [["number", "number", "number"], "boolean"],\n  FPDFPageObj_GetDashCount: [["number"], "number"],\n  FPDFPageObj_GetDashPhase: [["number", "number"], "boolean"],\n  FPDFPageObj_GetFillColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObj_GetIsActive: [["number", "number"], "boolean"],\n  FPDFPageObj_GetLineCap: [["number"], "number"],\n  FPDFPageObj_GetLineJoin: [["number"], "number"],\n  FPDFPageObj_GetMark: [["number", "number"], "number"],\n  FPDFPageObj_GetMarkedContentID: [["number"], "number"],\n  FPDFPageObj_GetMatrix: [["number", "number"], "boolean"],\n  FPDFPageObj_GetRotatedBounds: [["number", "number"], "boolean"],\n  FPDFPageObj_GetStrokeColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObj_GetStrokeWidth: [["number", "number"], "boolean"],\n  FPDFPageObj_GetType: [["number"], "number"],\n  FPDFPageObj_HasTransparency: [["number"], "boolean"],\n  FPDFPageObj_NewImageObj: [["number"], "number"],\n  FPDFPageObj_NewTextObj: [["number", "string", "number"], "number"],\n  FPDFPageObj_RemoveMark: [["number", "number"], "boolean"],\n  FPDFPageObj_SetBlendMode: [["number", "string"], null],\n  FPDFPageObj_SetDashArray: [["number", "number", "number", "number"], "boolean"],\n  FPDFPageObj_SetDashPhase: [["number", "number"], "boolean"],\n  FPDFPageObj_SetFillColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObj_SetIsActive: [["number", "boolean"], "boolean"],\n  FPDFPageObj_SetLineCap: [["number", "number"], "boolean"],\n  FPDFPageObj_SetLineJoin: [["number", "number"], "boolean"],\n  FPDFPageObj_SetMatrix: [["number", "number"], "boolean"],\n  FPDFPageObj_SetStrokeColor: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObj_SetStrokeWidth: [["number", "number"], "boolean"],\n  FPDFPageObj_Transform: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDFPageObj_TransformClipPath: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    null\n  ],\n  FPDFPageObj_TransformF: [["number", "number"], "boolean"],\n  FPDFPageObjMark_CountParams: [["number"], "number"],\n  FPDFPageObjMark_GetName: [["number", "number", "number", "number"], "boolean"],\n  FPDFPageObjMark_GetParamBlobValue: [\n    ["number", "string", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObjMark_GetParamIntValue: [["number", "string", "number"], "boolean"],\n  FPDFPageObjMark_GetParamKey: [\n    ["number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObjMark_GetParamStringValue: [\n    ["number", "string", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObjMark_GetParamValueType: [["number", "string"], "number"],\n  FPDFPageObjMark_RemoveParam: [["number", "number", "string"], "boolean"],\n  FPDFPageObjMark_SetBlobParam: [\n    ["number", "number", "number", "string", "number", "number"],\n    "boolean"\n  ],\n  FPDFPageObjMark_SetIntParam: [\n    ["number", "number", "number", "string", "number"],\n    "boolean"\n  ],\n  FPDFPageObjMark_SetStringParam: [\n    ["number", "number", "number", "string", "string"],\n    "boolean"\n  ],\n  FPDFPath_BezierTo: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFPath_Close: [["number"], "boolean"],\n  FPDFPath_CountSegments: [["number"], "number"],\n  FPDFPath_GetDrawMode: [["number", "number", "number"], "boolean"],\n  FPDFPath_GetPathSegment: [["number", "number"], "number"],\n  FPDFPath_LineTo: [["number", "number", "number"], "boolean"],\n  FPDFPath_MoveTo: [["number", "number", "number"], "boolean"],\n  FPDFPath_SetDrawMode: [["number", "number", "boolean"], "boolean"],\n  FPDFPathSegment_GetClose: [["number"], "boolean"],\n  FPDFPathSegment_GetPoint: [["number", "number", "number"], "boolean"],\n  FPDFPathSegment_GetType: [["number"], "number"],\n  FPDFSignatureObj_GetByteRange: [["number", "number", "number"], "number"],\n  FPDFSignatureObj_GetContents: [["number", "number", "number"], "number"],\n  FPDFSignatureObj_GetDocMDPPermission: [["number"], "number"],\n  FPDFSignatureObj_GetReason: [["number", "number", "number"], "number"],\n  FPDFSignatureObj_GetSubFilter: [["number", "number", "number"], "number"],\n  FPDFSignatureObj_GetTime: [["number", "number", "number"], "number"],\n  FPDFText_ClosePage: [["number"], null],\n  FPDFText_CountChars: [["number"], "number"],\n  FPDFText_CountRects: [["number", "number", "number"], "number"],\n  FPDFText_FindClose: [["number"], null],\n  FPDFText_FindNext: [["number"], "boolean"],\n  FPDFText_FindPrev: [["number"], "boolean"],\n  FPDFText_FindStart: [["number", "number", "number", "number"], "number"],\n  FPDFText_GetBoundedText: [\n    ["number", "number", "number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFText_GetCharAngle: [["number", "number"], "number"],\n  FPDFText_GetCharBox: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFText_GetCharIndexAtPos: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFText_GetCharIndexFromTextIndex: [["number", "number"], "number"],\n  FPDFText_GetCharOrigin: [["number", "number", "number", "number"], "boolean"],\n  FPDFText_GetFillColor: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFText_GetFontInfo: [\n    ["number", "number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFText_GetFontSize: [["number", "number"], "number"],\n  FPDFText_GetFontWeight: [["number", "number"], "number"],\n  FPDFText_GetLooseCharBox: [["number", "number", "number"], "boolean"],\n  FPDFText_GetMatrix: [["number", "number", "number"], "boolean"],\n  FPDFText_GetRect: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFText_GetSchCount: [["number"], "number"],\n  FPDFText_GetSchResultIndex: [["number"], "number"],\n  FPDFText_GetStrokeColor: [\n    ["number", "number", "number", "number", "number", "number"],\n    "boolean"\n  ],\n  FPDFText_GetText: [["number", "number", "number", "number"], "number"],\n  FPDFText_GetTextIndexFromCharIndex: [["number", "number"], "number"],\n  FPDFText_GetTextObject: [["number", "number"], "number"],\n  FPDFText_GetUnicode: [["number", "number"], "number"],\n  FPDFText_HasUnicodeMapError: [["number", "number"], "number"],\n  FPDFText_IsGenerated: [["number", "number"], "number"],\n  FPDFText_IsHyphen: [["number", "number"], "number"],\n  FPDFText_LoadCidType2Font: [\n    ["number", "number", "number", "string", "number", "number"],\n    "number"\n  ],\n  FPDFText_LoadFont: [\n    ["number", "number", "number", "number", "boolean"],\n    "number"\n  ],\n  FPDFText_LoadPage: [["number"], "number"],\n  FPDFText_LoadStandardFont: [["number", "string"], "number"],\n  FPDFText_SetCharcodes: [["number", "number", "number"], "boolean"],\n  FPDFText_SetText: [["number", "number"], "boolean"],\n  FPDFTextObj_GetFont: [["number"], "number"],\n  FPDFTextObj_GetFontSize: [["number", "number"], "boolean"],\n  FPDFTextObj_GetRenderedBitmap: [\n    ["number", "number", "number", "number"],\n    "number"\n  ],\n  FPDFTextObj_GetText: [["number", "number", "number", "number"], "number"],\n  FPDFTextObj_GetTextRenderMode: [["number"], "number"],\n  FPDFTextObj_SetTextRenderMode: [["number", "number"], "boolean"],\n  PDFiumExt_CloseFileWriter: [["number"], null],\n  PDFiumExt_CloseFormFillInfo: [["number"], null],\n  PDFiumExt_ExitFormFillEnvironment: [["number"], null],\n  PDFiumExt_GetFileWriterData: [["number", "number", "number"], "number"],\n  PDFiumExt_GetFileWriterSize: [["number"], "number"],\n  PDFiumExt_Init: [[], null],\n  PDFiumExt_InitFormFillEnvironment: [["number", "number"], "number"],\n  PDFiumExt_OpenFileWriter: [[], "number"],\n  PDFiumExt_OpenFormFillInfo: [[], "number"],\n  PDFiumExt_SaveAsCopy: [["number", "number"], "number"]\n};\nasync function createWrappedModule(pdfium) {\n  const module = {\n    pdfium\n  };\n  for (const key in functions) {\n    const ident = key;\n    const args = functions[ident][0];\n    const ret = functions[ident][1];\n    module[ident] = pdfium.cwrap(key, ret, args);\n  }\n  return module;\n}\nasync function init(moduleOverrides) {\n  const pdfium = await createPdfium(moduleOverrides);\n  return createWrappedModule(pdfium);\n}\nfunction readString(wasmModule, readChars, parseChars, defaultLength = 100) {\n  let buffer = wasmModule.wasmExports.malloc(defaultLength);\n  for (let i = 0; i < defaultLength; i++) {\n    wasmModule.HEAP8[buffer + i] = 0;\n  }\n  const actualLength = readChars(buffer, defaultLength);\n  let str;\n  if (actualLength > defaultLength) {\n    wasmModule.wasmExports.free(buffer);\n    buffer = wasmModule.wasmExports.malloc(actualLength);\n    for (let i = 0; i < actualLength; i++) {\n      wasmModule.HEAP8[buffer + i] = 0;\n    }\n    readChars(buffer, actualLength);\n    str = parseChars(buffer);\n  } else {\n    str = parseChars(buffer);\n  }\n  wasmModule.wasmExports.free(buffer);\n  return str;\n}\nfunction readArrayBuffer(wasmModule, readChars) {\n  const bufferSize = readChars(0, 0);\n  const bufferPtr = wasmModule.wasmExports.malloc(bufferSize);\n  readChars(bufferPtr, bufferSize);\n  const arrayBuffer = new ArrayBuffer(bufferSize);\n  const view = new DataView(arrayBuffer);\n  for (let i = 0; i < bufferSize; i++) {\n    view.setInt8(i, wasmModule.getValue(bufferPtr + i, "i8"));\n  }\n  wasmModule.wasmExports.free(bufferPtr);\n  return arrayBuffer;\n}\nconst RESERVED_INFO_KEYS = /* @__PURE__ */ new Set([\n  "Title",\n  "Author",\n  "Subject",\n  "Keywords",\n  "Producer",\n  "Creator",\n  "CreationDate",\n  "ModDate",\n  "Trapped"\n]);\nfunction isValidCustomKey(key) {\n  if (!key || key.length > 127) return false;\n  if (RESERVED_INFO_KEYS.has(key)) return false;\n  if (key[0] === "/") return false;\n  for (let i = 0; i < key.length; i++) {\n    const c = key.charCodeAt(i);\n    if (c < 32 || c > 126) return false;\n  }\n  return true;\n}\nfunction computeFormDrawParams(matrix, rect, pageSize, rotation) {\n  const rectLeft = rect.origin.x;\n  const rectBottom = rect.origin.y;\n  const rectRight = rectLeft + rect.size.width;\n  const rectTop = rectBottom + rect.size.height;\n  const pageWidth = pageSize.width;\n  const pageHeight = pageSize.height;\n  const scaleX = Math.hypot(matrix.a, matrix.b);\n  const scaleY = Math.hypot(matrix.c, matrix.d);\n  const swap2 = (rotation & 1) === 1;\n  const formsWidth = swap2 ? Math.max(1, Math.round(pageHeight * scaleX)) : Math.max(1, Math.round(pageWidth * scaleX));\n  const formsHeight = swap2 ? Math.max(1, Math.round(pageWidth * scaleY)) : Math.max(1, Math.round(pageHeight * scaleY));\n  let startX;\n  let startY;\n  switch (rotation) {\n    case Rotation.Degree0:\n      startX = -Math.round(rectLeft * scaleX);\n      startY = -Math.round(rectBottom * scaleY);\n      break;\n    case Rotation.Degree90:\n      startX = Math.round((rectTop - pageHeight) * scaleX);\n      startY = -Math.round(rectLeft * scaleY);\n      break;\n    case Rotation.Degree180:\n      startX = Math.round((rectRight - pageWidth) * scaleX);\n      startY = Math.round((rectTop - pageHeight) * scaleY);\n      break;\n    case Rotation.Degree270:\n      startX = -Math.round(rectBottom * scaleX);\n      startY = Math.round((rectRight - pageWidth) * scaleY);\n      break;\n    default:\n      startX = -Math.round(rectLeft * scaleX);\n      startY = -Math.round(rectBottom * scaleY);\n      break;\n  }\n  return { startX, startY, formsWidth, formsHeight, scaleX, scaleY };\n}\nconst WasmPointer = (ptr) => ptr;\nconst DEFAULT_CONFIG = {\n  pageTtl: 5e3,\n  // 5 seconds\n  maxPagesPerDocument: 10\n};\nclass PdfCache {\n  constructor(pdfium, memoryManager, config = {}) {\n    this.pdfium = pdfium;\n    this.memoryManager = memoryManager;\n    this.docs = /* @__PURE__ */ new Map();\n    this.config = { ...DEFAULT_CONFIG, ...config };\n  }\n  /** Open (or re-use) a document */\n  setDocument(id, filePtr, docPtr) {\n    let ctx = this.docs.get(id);\n    if (!ctx) {\n      ctx = new DocumentContext(filePtr, docPtr, this.pdfium, this.memoryManager, this.config);\n      this.docs.set(id, ctx);\n    }\n  }\n  /** Retrieve the DocumentContext for a given PdfDocumentObject */\n  getContext(docId) {\n    return this.docs.get(docId);\n  }\n  /** Close & fully release a document and all its pages */\n  closeDocument(docId) {\n    const ctx = this.docs.get(docId);\n    if (!ctx) return false;\n    ctx.dispose();\n    this.docs.delete(docId);\n    return true;\n  }\n  /** Close all documents */\n  closeAllDocuments() {\n    for (const ctx of this.docs.values()) {\n      ctx.dispose();\n    }\n    this.docs.clear();\n  }\n  /** Update cache configuration for all existing documents */\n  updateConfig(newConfig) {\n    Object.assign(this.config, newConfig);\n    for (const ctx of this.docs.values()) {\n      ctx.updateConfig(this.config);\n    }\n  }\n  /** Get current cache statistics */\n  getCacheStats() {\n    const pagesByDocument = {};\n    let totalPages = 0;\n    for (const [docId, ctx] of this.docs.entries()) {\n      const pageCount = ctx.getCacheSize();\n      pagesByDocument[docId] = pageCount;\n      totalPages += pageCount;\n    }\n    return {\n      documents: this.docs.size,\n      totalPages,\n      pagesByDocument\n    };\n  }\n}\nclass DocumentContext {\n  constructor(filePtr, docPtr, pdfium, memoryManager, config) {\n    this.filePtr = filePtr;\n    this.docPtr = docPtr;\n    this.memoryManager = memoryManager;\n    this.pageCache = new PageCache(pdfium, docPtr, config);\n  }\n  /** Main accessor for pages */\n  acquirePage(pageIdx) {\n    return this.pageCache.acquire(pageIdx);\n  }\n  /** Scoped accessor for one-off / bulk operations */\n  borrowPage(pageIdx, fn) {\n    return this.pageCache.borrowPage(pageIdx, fn);\n  }\n  /** Update cache configuration */\n  updateConfig(config) {\n    this.pageCache.updateConfig(config);\n  }\n  /** Get number of pages currently in cache */\n  getCacheSize() {\n    return this.pageCache.size();\n  }\n  /** Tear down all pages + this document */\n  dispose() {\n    this.pageCache.forceReleaseAll();\n    this.pageCache.pdf.FPDF_CloseDocument(this.docPtr);\n    this.memoryManager.free(WasmPointer(this.filePtr));\n  }\n}\nclass PageCache {\n  constructor(pdf, docPtr, config) {\n    this.pdf = pdf;\n    this.docPtr = docPtr;\n    this.cache = /* @__PURE__ */ new Map();\n    this.accessOrder = [];\n    this.config = config;\n  }\n  acquire(pageIdx) {\n    let ctx = this.cache.get(pageIdx);\n    if (!ctx) {\n      this.evictIfNeeded();\n      const pagePtr = this.pdf.FPDF_LoadPage(this.docPtr, pageIdx);\n      ctx = new PageContext(this.pdf, this.docPtr, pageIdx, pagePtr, this.config.pageTtl, () => {\n        this.cache.delete(pageIdx);\n        this.removeFromAccessOrder(pageIdx);\n      });\n      this.cache.set(pageIdx, ctx);\n    }\n    this.updateAccessOrder(pageIdx);\n    ctx.clearExpiryTimer();\n    ctx.bumpRefCount();\n    return ctx;\n  }\n  /** Helper: run a function "scoped" to a page.\n   *    – if the page was already cached  → .release() (keeps TTL logic)\n   *    – if the page was loaded just now → .disposeImmediate() (free right away)\n   */\n  borrowPage(pageIdx, fn) {\n    const existed = this.cache.has(pageIdx);\n    const ctx = this.acquire(pageIdx);\n    try {\n      return fn(ctx);\n    } finally {\n      existed ? ctx.release() : ctx.disposeImmediate();\n    }\n  }\n  forceReleaseAll() {\n    for (const ctx of this.cache.values()) {\n      ctx.disposeImmediate();\n    }\n    this.cache.clear();\n    this.accessOrder.length = 0;\n  }\n  /** Update cache configuration */\n  updateConfig(config) {\n    this.config = config;\n    for (const ctx of this.cache.values()) {\n      ctx.updateTtl(config.pageTtl);\n    }\n    this.evictIfNeeded();\n  }\n  /** Get current cache size */\n  size() {\n    return this.cache.size;\n  }\n  /** Evict least recently used pages if cache exceeds max size */\n  evictIfNeeded() {\n    while (this.cache.size >= this.config.maxPagesPerDocument) {\n      const lruPageIdx = this.accessOrder[0];\n      if (lruPageIdx !== void 0) {\n        const ctx = this.cache.get(lruPageIdx);\n        if (ctx) {\n          if (ctx.getRefCount() === 0) {\n            ctx.disposeImmediate();\n          } else {\n            break;\n          }\n        } else {\n          this.removeFromAccessOrder(lruPageIdx);\n        }\n      } else {\n        break;\n      }\n    }\n  }\n  /** Update the access order for LRU tracking */\n  updateAccessOrder(pageIdx) {\n    this.removeFromAccessOrder(pageIdx);\n    this.accessOrder.push(pageIdx);\n  }\n  /** Remove a page from the access order array */\n  removeFromAccessOrder(pageIdx) {\n    const index = this.accessOrder.indexOf(pageIdx);\n    if (index > -1) {\n      this.accessOrder.splice(index, 1);\n    }\n  }\n}\nclass PageContext {\n  constructor(pdf, docPtr, pageIdx, pagePtr, ttl, onFinalDispose) {\n    this.pdf = pdf;\n    this.docPtr = docPtr;\n    this.pageIdx = pageIdx;\n    this.pagePtr = pagePtr;\n    this.onFinalDispose = onFinalDispose;\n    this.refCount = 0;\n    this.disposed = false;\n    this.ttl = ttl;\n  }\n  /** Called by PageCache.acquire() */\n  bumpRefCount() {\n    if (this.disposed) throw new Error("Context already disposed");\n    this.refCount++;\n  }\n  /** Get current reference count */\n  getRefCount() {\n    return this.refCount;\n  }\n  /** Called by PageCache.acquire() */\n  clearExpiryTimer() {\n    if (this.expiryTimer) {\n      clearTimeout(this.expiryTimer);\n      this.expiryTimer = void 0;\n    }\n  }\n  /** Update TTL configuration */\n  updateTtl(newTtl) {\n    this.ttl = newTtl;\n    if (this.expiryTimer && this.refCount === 0) {\n      this.clearExpiryTimer();\n      this.expiryTimer = setTimeout(() => this.disposeImmediate(), this.ttl);\n    }\n  }\n  /** Called by PageCache.release() internally */\n  release() {\n    if (this.disposed) return;\n    this.refCount--;\n    if (this.refCount === 0) {\n      this.expiryTimer = setTimeout(() => this.disposeImmediate(), this.ttl);\n    }\n  }\n  /** Tear down _all_ sub-pointers & the page. */\n  disposeImmediate() {\n    if (this.disposed) return;\n    this.disposed = true;\n    this.clearExpiryTimer();\n    if (this.textPagePtr !== void 0) {\n      this.pdf.FPDFText_ClosePage(this.textPagePtr);\n    }\n    if (this.formHandle !== void 0) {\n      this.pdf.FORM_OnBeforeClosePage(this.pagePtr, this.formHandle);\n      this.pdf.PDFiumExt_ExitFormFillEnvironment(this.formHandle);\n    }\n    if (this.formInfoPtr !== void 0) {\n      this.pdf.PDFiumExt_CloseFormFillInfo(this.formInfoPtr);\n    }\n    this.pdf.FPDF_ClosePage(this.pagePtr);\n    this.onFinalDispose();\n  }\n  // ── public helpers ──\n  /** Always safe: opens (once) and returns the text-page ptr. */\n  getTextPage() {\n    this.ensureAlive();\n    if (this.textPagePtr === void 0) {\n      this.textPagePtr = this.pdf.FPDFText_LoadPage(this.pagePtr);\n    }\n    return this.textPagePtr;\n  }\n  /** Always safe: opens (once) and returns the form-fill handle. */\n  getFormHandle() {\n    this.ensureAlive();\n    if (this.formHandle === void 0) {\n      this.formInfoPtr = this.pdf.PDFiumExt_OpenFormFillInfo();\n      this.formHandle = this.pdf.PDFiumExt_InitFormFillEnvironment(this.docPtr, this.formInfoPtr);\n      this.pdf.FORM_OnAfterLoadPage(this.pagePtr, this.formHandle);\n    }\n    return this.formHandle;\n  }\n  /**\n   * Safely execute `fn` with an annotation pointer.\n   * Pointer is ALWAYS closed afterwards.\n   */\n  withAnnotation(annotIdx, fn) {\n    this.ensureAlive();\n    const annotPtr = this.pdf.FPDFPage_GetAnnot(this.pagePtr, annotIdx);\n    try {\n      return fn(annotPtr);\n    } finally {\n      this.pdf.FPDFPage_CloseAnnot(annotPtr);\n    }\n  }\n  ensureAlive() {\n    if (this.disposed) throw new Error("PageContext already disposed");\n  }\n}\nconst MEMORY_LIMITS = {\n  /** Maximum total memory that can be allocated (2GB) */\n  MAX_TOTAL_MEMORY: 2 * 1024 * 1024 * 1024\n};\nconst LIMITS = {\n  MEMORY: MEMORY_LIMITS\n};\nconst LOG_SOURCE$3 = "PDFiumEngine";\nconst LOG_CATEGORY$3 = "MemoryManager";\nclass MemoryManager {\n  constructor(pdfiumModule, logger) {\n    this.pdfiumModule = pdfiumModule;\n    this.logger = logger;\n    this.allocations = /* @__PURE__ */ new Map();\n    this.totalAllocated = 0;\n  }\n  /**\n   * Allocate memory with tracking and validation\n   */\n  malloc(size) {\n    if (this.totalAllocated + size > LIMITS.MEMORY.MAX_TOTAL_MEMORY) {\n      throw new Error(\n        `Total memory usage would exceed limit: ${this.totalAllocated + size} > ${LIMITS.MEMORY.MAX_TOTAL_MEMORY}`\n      );\n    }\n    const ptr = this.pdfiumModule.pdfium.wasmExports.malloc(size);\n    if (!ptr) {\n      throw new Error(`Failed to allocate ${size} bytes`);\n    }\n    const allocation = {\n      ptr: WasmPointer(ptr),\n      size,\n      timestamp: Date.now(),\n      stack: this.logger.isEnabled("debug") ? new Error().stack : void 0\n    };\n    this.allocations.set(ptr, allocation);\n    this.totalAllocated += size;\n    return WasmPointer(ptr);\n  }\n  /**\n   * Free memory with validation\n   */\n  free(ptr) {\n    const allocation = this.allocations.get(ptr);\n    if (!allocation) {\n      this.logger.warn(LOG_SOURCE$3, LOG_CATEGORY$3, `Freeing untracked pointer: ${ptr}`);\n    } else {\n      this.totalAllocated -= allocation.size;\n      this.allocations.delete(ptr);\n    }\n    this.pdfiumModule.pdfium.wasmExports.free(ptr);\n  }\n  /**\n   * Get memory statistics\n   */\n  getStats() {\n    return {\n      totalAllocated: this.totalAllocated,\n      allocationCount: this.allocations.size,\n      allocations: this.logger.isEnabled("debug") ? Array.from(this.allocations.values()) : []\n    };\n  }\n  /**\n   * Check for memory leaks\n   */\n  checkLeaks() {\n    if (this.allocations.size > 0) {\n      this.logger.warn(\n        LOG_SOURCE$3,\n        LOG_CATEGORY$3,\n        `Potential memory leak: ${this.allocations.size} unfreed allocations`\n      );\n      for (const [ptr, alloc] of this.allocations) {\n        this.logger.warn(LOG_SOURCE$3, LOG_CATEGORY$3, `  - ${ptr}: ${alloc.size} bytes`, alloc.stack);\n      }\n    }\n  }\n}\nconst SYSFONTINFO_SIZE = 36;\nconst OFFSET_VERSION = 0;\nconst OFFSET_RELEASE = 4;\nconst OFFSET_ENUMFONTS = 8;\nconst OFFSET_MAPFONT = 12;\nconst OFFSET_GETFONT = 16;\nconst OFFSET_GETFONTDATA = 20;\nconst OFFSET_GETFACENAME = 24;\nconst OFFSET_GETFONTCHARSET = 28;\nconst OFFSET_DELETEFONT = 32;\nconst LOG_SOURCE$2 = "pdfium";\nconst LOG_CATEGORY$2 = "font-fallback";\nclass FontFallbackManager {\n  constructor(config, logger = new NoopLogger()) {\n    this.fontHandles = /* @__PURE__ */ new Map();\n    this.fontCache = /* @__PURE__ */ new Map();\n    this.nextHandleId = 1;\n    this.module = null;\n    this.enabled = false;\n    this.structPtr = 0;\n    this.releaseFnPtr = 0;\n    this.enumFontsFnPtr = 0;\n    this.mapFontFnPtr = 0;\n    this.getFontFnPtr = 0;\n    this.getFontDataFnPtr = 0;\n    this.getFaceNameFnPtr = 0;\n    this.getFontCharsetFnPtr = 0;\n    this.deleteFontFnPtr = 0;\n    this.fontConfig = config;\n    this.logger = logger;\n  }\n  /**\n   * Initialize the font fallback system and attach to PDFium module\n   */\n  initialize(module) {\n    if (this.enabled) {\n      this.logger.warn(LOG_SOURCE$2, LOG_CATEGORY$2, "Font fallback already initialized");\n      return;\n    }\n    this.module = module;\n    const pdfium = module.pdfium;\n    if (typeof pdfium.addFunction !== "function") {\n      this.logger.error(\n        LOG_SOURCE$2,\n        LOG_CATEGORY$2,\n        "addFunction not available. Make sure WASM is compiled with -sALLOW_TABLE_GROWTH"\n      );\n      return;\n    }\n    try {\n      this.structPtr = pdfium.wasmExports.malloc(SYSFONTINFO_SIZE);\n      if (!this.structPtr) {\n        throw new Error("Failed to allocate FPDF_SYSFONTINFO struct");\n      }\n      for (let i = 0; i < SYSFONTINFO_SIZE; i++) {\n        pdfium.setValue(this.structPtr + i, 0, "i8");\n      }\n      this.releaseFnPtr = pdfium.addFunction((_pThis) => {\n      }, "vi");\n      this.enumFontsFnPtr = pdfium.addFunction((_pThis, _pMapper) => {\n      }, "vii");\n      this.mapFontFnPtr = pdfium.addFunction(\n        (_pThis, weight, bItalic, charset, pitchFamily, facePtr, bExactPtr) => {\n          const face = facePtr ? pdfium.UTF8ToString(facePtr) : "";\n          const handle = this.mapFont(weight, bItalic, charset, pitchFamily, face);\n          if (bExactPtr) {\n            pdfium.setValue(bExactPtr, 0, "i32");\n          }\n          return handle;\n        },\n        "iiiiiiii"\n      );\n      this.getFontFnPtr = pdfium.addFunction((_pThis, facePtr) => {\n        const face = facePtr ? pdfium.UTF8ToString(facePtr) : "";\n        return this.mapFont(400, 0, 0, 0, face);\n      }, "iii");\n      this.getFontDataFnPtr = pdfium.addFunction(\n        (_pThis, hFont, table, buffer, bufSize) => {\n          return this.getFontData(hFont, table, buffer, bufSize);\n        },\n        "iiiiii"\n      );\n      this.getFaceNameFnPtr = pdfium.addFunction(\n        (_pThis, _hFont, _buffer, _bufSize) => {\n          return 0;\n        },\n        "iiiii"\n      );\n      this.getFontCharsetFnPtr = pdfium.addFunction((_pThis, hFont) => {\n        const handle = this.fontHandles.get(hFont);\n        return (handle == null ? void 0 : handle.charset) ?? 0;\n      }, "iii");\n      this.deleteFontFnPtr = pdfium.addFunction((_pThis, hFont) => {\n        this.deleteFont(hFont);\n      }, "vii");\n      pdfium.setValue(this.structPtr + OFFSET_VERSION, 1, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_RELEASE, this.releaseFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_ENUMFONTS, this.enumFontsFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_MAPFONT, this.mapFontFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_GETFONT, this.getFontFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_GETFONTDATA, this.getFontDataFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_GETFACENAME, this.getFaceNameFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_GETFONTCHARSET, this.getFontCharsetFnPtr, "i32");\n      pdfium.setValue(this.structPtr + OFFSET_DELETEFONT, this.deleteFontFnPtr, "i32");\n      module.FPDF_SetSystemFontInfo(this.structPtr);\n      this.enabled = true;\n      this.logger.info(\n        LOG_SOURCE$2,\n        LOG_CATEGORY$2,\n        "Font fallback system initialized (pure TypeScript)",\n        Object.keys(this.fontConfig.fonts)\n      );\n    } catch (error) {\n      this.logger.error(LOG_SOURCE$2, LOG_CATEGORY$2, "Failed to initialize font fallback", error);\n      this.cleanup();\n      throw error;\n    }\n  }\n  /**\n   * Disable the font fallback system and clean up resources\n   */\n  disable() {\n    if (!this.enabled || !this.module) {\n      return;\n    }\n    this.module.FPDF_SetSystemFontInfo(0);\n    this.cleanup();\n    this.enabled = false;\n    this.logger.debug(LOG_SOURCE$2, LOG_CATEGORY$2, "Font fallback system disabled");\n  }\n  /**\n   * Clean up allocated resources\n   */\n  cleanup() {\n    if (!this.module) return;\n    const pdfium = this.module.pdfium;\n    if (this.structPtr) {\n      pdfium.wasmExports.free(this.structPtr);\n      this.structPtr = 0;\n    }\n    const removeIfExists = (ptr) => {\n      if (ptr && typeof pdfium.removeFunction === "function") {\n        try {\n          pdfium.removeFunction(ptr);\n        } catch {\n        }\n      }\n    };\n    removeIfExists(this.releaseFnPtr);\n    removeIfExists(this.enumFontsFnPtr);\n    removeIfExists(this.mapFontFnPtr);\n    removeIfExists(this.getFontFnPtr);\n    removeIfExists(this.getFontDataFnPtr);\n    removeIfExists(this.getFaceNameFnPtr);\n    removeIfExists(this.getFontCharsetFnPtr);\n    removeIfExists(this.deleteFontFnPtr);\n    this.releaseFnPtr = 0;\n    this.enumFontsFnPtr = 0;\n    this.mapFontFnPtr = 0;\n    this.getFontFnPtr = 0;\n    this.getFontDataFnPtr = 0;\n    this.getFaceNameFnPtr = 0;\n    this.getFontCharsetFnPtr = 0;\n    this.deleteFontFnPtr = 0;\n  }\n  /**\n   * Check if font fallback is enabled\n   */\n  isEnabled() {\n    return this.enabled;\n  }\n  /**\n   * Get statistics about font loading\n   */\n  getStats() {\n    return {\n      handleCount: this.fontHandles.size,\n      cacheSize: this.fontCache.size,\n      cachedUrls: Array.from(this.fontCache.keys())\n    };\n  }\n  /**\n   * Pre-load fonts for specific charsets (optional optimization)\n   * This can be called to warm the cache before rendering\n   */\n  async preloadFonts(charsets) {\n    const urls = charsets.map((charset) => this.getFontUrlForCharset(charset)).filter((url) => url !== null);\n    const uniqueUrls = [...new Set(urls)];\n    await Promise.all(\n      uniqueUrls.map(async (url) => {\n        if (!this.fontCache.has(url)) {\n          try {\n            const data = await this.fetchFontAsync(url);\n            if (data) {\n              this.fontCache.set(url, data);\n              this.logger.debug(LOG_SOURCE$2, LOG_CATEGORY$2, `Pre-loaded font: ${url}`);\n            }\n          } catch (error) {\n            this.logger.warn(LOG_SOURCE$2, LOG_CATEGORY$2, `Failed to pre-load font: ${url}`, error);\n          }\n        }\n      })\n    );\n  }\n  // ============================================================================\n  // PDFium Callback Implementations\n  // ============================================================================\n  /**\n   * MapFont - called by PDFium when it needs a font\n   */\n  mapFont(weight, bItalic, charset, pitchFamily, face) {\n    const italic = bItalic !== 0;\n    this.logger.debug(LOG_SOURCE$2, LOG_CATEGORY$2, "MapFont called", {\n      weight,\n      italic,\n      charset,\n      pitchFamily,\n      face\n    });\n    const result = this.findBestFontMatch(charset, weight, italic);\n    if (!result) {\n      this.logger.debug(LOG_SOURCE$2, LOG_CATEGORY$2, `No font configured for charset ${charset}`);\n      return 0;\n    }\n    const handle = {\n      id: this.nextHandleId++,\n      charset,\n      weight,\n      italic,\n      url: result.url,\n      data: null\n    };\n    this.fontHandles.set(handle.id, handle);\n    this.logger.debug(\n      LOG_SOURCE$2,\n      LOG_CATEGORY$2,\n      `Created font handle ${handle.id} for ${result.url} (requested: weight=${weight}, italic=${italic}, matched: weight=${result.matchedWeight}, italic=${result.matchedItalic})`\n    );\n    return handle.id;\n  }\n  /**\n   * GetFontData - called by PDFium to get font bytes\n   */\n  getFontData(fontHandle, table, bufferPtr, bufSize) {\n    const handle = this.fontHandles.get(fontHandle);\n    if (!handle) {\n      this.logger.warn(LOG_SOURCE$2, LOG_CATEGORY$2, `Unknown font handle: ${fontHandle}`);\n      return 0;\n    }\n    if (!handle.data) {\n      if (this.fontCache.has(handle.url)) {\n        handle.data = this.fontCache.get(handle.url);\n      } else {\n        handle.data = this.fetchFontSync(handle.url);\n        if (handle.data) {\n          this.fontCache.set(handle.url, handle.data);\n        }\n      }\n    }\n    if (!handle.data) {\n      this.logger.warn(LOG_SOURCE$2, LOG_CATEGORY$2, `Failed to load font: ${handle.url}`);\n      return 0;\n    }\n    const fontData = handle.data;\n    if (table !== 0) {\n      this.logger.debug(\n        LOG_SOURCE$2,\n        LOG_CATEGORY$2,\n        `Table ${table} requested - returning 0 to request whole file`\n      );\n      return 0;\n    }\n    if (bufferPtr === 0 || bufSize < fontData.length) {\n      return fontData.length;\n    }\n    if (this.module) {\n      const heap = this.module.pdfium.HEAPU8;\n      heap.set(fontData, bufferPtr);\n      this.logger.debug(\n        LOG_SOURCE$2,\n        LOG_CATEGORY$2,\n        `Copied ${fontData.length} bytes to buffer for handle ${fontHandle}`\n      );\n    }\n    return fontData.length;\n  }\n  /**\n   * DeleteFont - called by PDFium when done with a font\n   */\n  deleteFont(fontHandle) {\n    const handle = this.fontHandles.get(fontHandle);\n    if (handle) {\n      this.logger.debug(LOG_SOURCE$2, LOG_CATEGORY$2, `Deleting font handle ${fontHandle}`);\n      this.fontHandles.delete(fontHandle);\n    }\n  }\n  // ============================================================================\n  // Helper Methods\n  // ============================================================================\n  /**\n   * Find the best matching font variant for the given parameters\n   */\n  findBestFontMatch(charset, requestedWeight, requestedItalic) {\n    const { fonts: fonts2, defaultFont, baseUrl } = this.fontConfig;\n    const entry = fonts2[charset] ?? defaultFont;\n    if (!entry) {\n      return null;\n    }\n    const variants = this.normalizeToVariants(entry);\n    if (variants.length === 0) {\n      return null;\n    }\n    const best = this.selectBestVariant(variants, requestedWeight, requestedItalic);\n    let url = best.url;\n    if (baseUrl && !url.startsWith("http://") && !url.startsWith("https://") && !url.startsWith("/")) {\n      url = `${baseUrl}/${url}`;\n    }\n    return {\n      url,\n      matchedWeight: best.weight ?? 400,\n      matchedItalic: best.italic ?? false\n    };\n  }\n  /**\n   * Normalize a FontEntry to an array of FontVariants\n   */\n  normalizeToVariants(entry) {\n    if (typeof entry === "string") {\n      return [{ url: entry, weight: 400, italic: false }];\n    }\n    if (Array.isArray(entry)) {\n      return entry.map((v) => ({\n        url: v.url,\n        weight: v.weight ?? 400,\n        italic: v.italic ?? false\n      }));\n    }\n    return [{ url: entry.url, weight: entry.weight ?? 400, italic: entry.italic ?? false }];\n  }\n  /**\n   * Select the best matching variant based on weight and italic\n   * Uses CSS font matching algorithm principles:\n   * 1. Exact italic match preferred\n   * 2. Closest weight (with bias toward bolder for weights >= 400)\n   */\n  selectBestVariant(variants, requestedWeight, requestedItalic) {\n    if (variants.length === 1) {\n      return variants[0];\n    }\n    const italicMatches = variants.filter((v) => (v.italic ?? false) === requestedItalic);\n    const candidates = italicMatches.length > 0 ? italicMatches : variants;\n    let bestMatch = candidates[0];\n    let bestDistance = Math.abs((bestMatch.weight ?? 400) - requestedWeight);\n    for (const variant of candidates) {\n      const variantWeight = variant.weight ?? 400;\n      const distance = Math.abs(variantWeight - requestedWeight);\n      if (distance < bestDistance) {\n        bestMatch = variant;\n        bestDistance = distance;\n      } else if (distance === bestDistance) {\n        const currentWeight = bestMatch.weight ?? 400;\n        if (requestedWeight >= 500) {\n          if (variantWeight > currentWeight) {\n            bestMatch = variant;\n          }\n        } else {\n          if (variantWeight < currentWeight) {\n            bestMatch = variant;\n          }\n        }\n      }\n    }\n    return bestMatch;\n  }\n  /**\n   * Get font URL for a charset (backward compatible helper)\n   */\n  getFontUrlForCharset(charset) {\n    const result = this.findBestFontMatch(charset, 400, false);\n    return (result == null ? void 0 : result.url) ?? null;\n  }\n  /**\n   * Fetch font data synchronously\n   * Uses custom fontLoader if provided, otherwise falls back to XMLHttpRequest (browser)\n   */\n  fetchFontSync(pathOrUrl) {\n    this.logger.debug(LOG_SOURCE$2, LOG_CATEGORY$2, `Fetching font synchronously: ${pathOrUrl}`);\n    if (this.fontConfig.fontLoader) {\n      try {\n        const data = this.fontConfig.fontLoader(pathOrUrl);\n        if (data) {\n          this.logger.info(\n            LOG_SOURCE$2,\n            LOG_CATEGORY$2,\n            `Loaded font via custom loader: ${pathOrUrl} (${data.length} bytes)`\n          );\n        } else {\n          this.logger.warn(\n            LOG_SOURCE$2,\n            LOG_CATEGORY$2,\n            `Custom font loader returned null for: ${pathOrUrl}`\n          );\n        }\n        return data;\n      } catch (error) {\n        this.logger.error(\n          LOG_SOURCE$2,\n          LOG_CATEGORY$2,\n          `Error in custom font loader: ${pathOrUrl}`,\n          error\n        );\n        return null;\n      }\n    }\n    try {\n      const xhr = new XMLHttpRequest();\n      xhr.open("GET", pathOrUrl, false);\n      xhr.responseType = "arraybuffer";\n      xhr.send();\n      if (xhr.status === 200) {\n        const data = new Uint8Array(xhr.response);\n        this.logger.info(\n          LOG_SOURCE$2,\n          LOG_CATEGORY$2,\n          `Loaded font: ${pathOrUrl} (${data.length} bytes)`\n        );\n        return data;\n      } else {\n        this.logger.error(\n          LOG_SOURCE$2,\n          LOG_CATEGORY$2,\n          `Failed to load font: ${pathOrUrl} (HTTP ${xhr.status})`\n        );\n        return null;\n      }\n    } catch (error) {\n      this.logger.error(LOG_SOURCE$2, LOG_CATEGORY$2, `Error fetching font: ${pathOrUrl}`, error);\n      return null;\n    }\n  }\n  /**\n   * Fetch font data asynchronously (for preloading)\n   * Uses custom fontLoader if provided, otherwise falls back to fetch API\n   */\n  async fetchFontAsync(pathOrUrl) {\n    if (this.fontConfig.fontLoader) {\n      try {\n        return this.fontConfig.fontLoader(pathOrUrl);\n      } catch {\n        return null;\n      }\n    }\n    try {\n      const response = await fetch(pathOrUrl);\n      if (response.ok) {\n        const buffer = await response.arrayBuffer();\n        return new Uint8Array(buffer);\n      }\n      return null;\n    } catch {\n      return null;\n    }\n  }\n}\nconst LOG_SOURCE$1 = "PDFiumEngine";\nconst LOG_CATEGORY$1 = "Engine";\nclass PdfiumNative {\n  /**\n   * Create an instance of PdfiumNative and initialize PDFium\n   * @param wasmModule - pdfium wasm module\n   * @param options - configuration options\n   */\n  constructor(pdfiumModule, options = {}) {\n    this.pdfiumModule = pdfiumModule;\n    this.memoryLeakCheckInterval = null;\n    this.fontFallbackManager = null;\n    const { logger = new NoopLogger(), fontFallback } = options;\n    this.logger = logger;\n    this.memoryManager = new MemoryManager(this.pdfiumModule, this.logger);\n    this.cache = new PdfCache(this.pdfiumModule, this.memoryManager);\n    if (this.logger.isEnabled("debug")) {\n      this.memoryLeakCheckInterval = setInterval(() => {\n        this.memoryManager.checkLeaks();\n      }, 1e4);\n    }\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "initialize");\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Initialize`, "Begin", "General");\n    this.pdfiumModule.PDFiumExt_Init();\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Initialize`, "End", "General");\n    if (fontFallback) {\n      this.fontFallbackManager = new FontFallbackManager(fontFallback, this.logger);\n      this.fontFallbackManager.initialize(this.pdfiumModule);\n      this.logger.info(LOG_SOURCE$1, LOG_CATEGORY$1, "Font fallback system enabled");\n    }\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.destroy}\n   *\n   * @public\n   */\n  destroy() {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "destroy");\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Destroy`, "Begin", "General");\n    if (this.fontFallbackManager) {\n      this.fontFallbackManager.disable();\n      this.fontFallbackManager = null;\n    }\n    this.pdfiumModule.FPDF_DestroyLibrary();\n    if (this.memoryLeakCheckInterval) {\n      clearInterval(this.memoryLeakCheckInterval);\n      this.memoryLeakCheckInterval = null;\n    }\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Destroy`, "End", "General");\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * Get the font fallback manager instance\n   * Useful for pre-loading fonts or checking stats\n   */\n  getFontFallbackManager() {\n    return this.fontFallbackManager;\n  }\n  /** Write a UTF-16LE (WIDESTRING) to wasm, call `fn(ptr)`, then free. */\n  withWString(value, fn) {\n    const length = (value.length + 1) * 2;\n    const ptr = this.memoryManager.malloc(length);\n    try {\n      this.pdfiumModule.pdfium.stringToUTF16(value, ptr, length);\n      return fn(ptr);\n    } finally {\n      this.memoryManager.free(ptr);\n    }\n  }\n  /** Write a float[] to wasm, call `fn(ptr, count)`, then free. */\n  withFloatArray(values, fn) {\n    const arr = values ?? [];\n    const bytes = arr.length * 4;\n    const ptr = bytes ? this.memoryManager.malloc(bytes) : WasmPointer(0);\n    try {\n      if (bytes) {\n        for (let i = 0; i < arr.length; i++) {\n          this.pdfiumModule.pdfium.setValue(ptr + i * 4, arr[i], "float");\n        }\n      }\n      return fn(ptr, arr.length);\n    } finally {\n      if (bytes) this.memoryManager.free(ptr);\n    }\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.openDocument}\n   *\n   * @public\n   */\n  openDocumentBuffer(file, options) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "openDocumentBuffer", file, options);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `OpenDocumentBuffer`, "Begin", file.id);\n    const array = new Uint8Array(file.content);\n    const length = array.length;\n    const filePtr = this.memoryManager.malloc(length);\n    this.pdfiumModule.pdfium.HEAPU8.set(array, filePtr);\n    const docPtr = this.pdfiumModule.FPDF_LoadMemDocument(filePtr, length, (options == null ? void 0 : options.password) ?? "");\n    if (!docPtr) {\n      const lastError = this.pdfiumModule.FPDF_GetLastError();\n      this.logger.error(LOG_SOURCE$1, LOG_CATEGORY$1, `FPDF_LoadMemDocument failed with ${lastError}`);\n      this.memoryManager.free(filePtr);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `OpenDocumentBuffer`, "End", file.id);\n      return PdfTaskHelper.reject({\n        code: lastError,\n        message: `FPDF_LoadMemDocument failed`\n      });\n    }\n    const pageCount = this.pdfiumModule.FPDF_GetPageCount(docPtr);\n    const pages = [];\n    const sizePtr = this.memoryManager.malloc(8);\n    for (let index = 0; index < pageCount; index++) {\n      const result = this.pdfiumModule.FPDF_GetPageSizeByIndexF(docPtr, index, sizePtr);\n      if (!result) {\n        const lastError = this.pdfiumModule.FPDF_GetLastError();\n        this.logger.error(\n          LOG_SOURCE$1,\n          LOG_CATEGORY$1,\n          `FPDF_GetPageSizeByIndexF failed with ${lastError}`\n        );\n        this.memoryManager.free(sizePtr);\n        this.pdfiumModule.FPDF_CloseDocument(docPtr);\n        this.memoryManager.free(filePtr);\n        this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `OpenDocumentBuffer`, "End", file.id);\n        return PdfTaskHelper.reject({\n          code: lastError,\n          message: `FPDF_GetPageSizeByIndexF failed`\n        });\n      }\n      const rotation = this.pdfiumModule.EPDF_GetPageRotationByIndex(docPtr, index);\n      const page = {\n        index,\n        size: {\n          width: this.pdfiumModule.pdfium.getValue(sizePtr, "float"),\n          height: this.pdfiumModule.pdfium.getValue(sizePtr + 4, "float")\n        },\n        rotation\n      };\n      pages.push(page);\n    }\n    this.memoryManager.free(sizePtr);\n    const pdfDoc = {\n      id: file.id,\n      pageCount,\n      pages\n    };\n    this.cache.setDocument(file.id, filePtr, docPtr);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `OpenDocumentBuffer`, "End", file.id);\n    return PdfTaskHelper.resolve(pdfDoc);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getMetadata}\n   *\n   * @public\n   */\n  getMetadata(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getMetadata", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetMetadata`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetMetadata`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const creationRaw = this.readMetaText(ctx.docPtr, "CreationDate");\n    const modRaw = this.readMetaText(ctx.docPtr, "ModDate");\n    const metadata = {\n      title: this.readMetaText(ctx.docPtr, "Title"),\n      author: this.readMetaText(ctx.docPtr, "Author"),\n      subject: this.readMetaText(ctx.docPtr, "Subject"),\n      keywords: this.readMetaText(ctx.docPtr, "Keywords"),\n      producer: this.readMetaText(ctx.docPtr, "Producer"),\n      creator: this.readMetaText(ctx.docPtr, "Creator"),\n      creationDate: creationRaw ? pdfDateToDate(creationRaw) ?? null : null,\n      modificationDate: modRaw ? pdfDateToDate(modRaw) ?? null : null,\n      trapped: this.getMetaTrapped(ctx.docPtr),\n      custom: this.readAllMeta(ctx.docPtr, true)\n    };\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetMetadata`, "End", doc.id);\n    return PdfTaskHelper.resolve(metadata);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.setMetadata}\n   *\n   * @public\n   */\n  setMetadata(doc, meta) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "setMetadata", doc, meta);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "SetMetadata", "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "SetMetadata", "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const strMap = [\n      ["title", "Title"],\n      ["author", "Author"],\n      ["subject", "Subject"],\n      ["keywords", "Keywords"],\n      ["producer", "Producer"],\n      ["creator", "Creator"]\n    ];\n    let ok = true;\n    for (const [field, key] of strMap) {\n      const v = meta[field];\n      if (v === void 0) continue;\n      const s = v === null ? null : v;\n      if (!this.setMetaText(ctx.docPtr, key, s)) ok = false;\n    }\n    const writeDate = (field, key) => {\n      const v = meta[field];\n      if (v === void 0) return;\n      if (v === null) {\n        if (!this.setMetaText(ctx.docPtr, key, null)) ok = false;\n        return;\n      }\n      const d = v;\n      const raw = dateToPdfDate(d);\n      if (!this.setMetaText(ctx.docPtr, key, raw)) ok = false;\n    };\n    writeDate("creationDate", "CreationDate");\n    writeDate("modificationDate", "ModDate");\n    if (meta.trapped !== void 0) {\n      if (!this.setMetaTrapped(ctx.docPtr, meta.trapped ?? null)) ok = false;\n    }\n    if (meta.custom !== void 0) {\n      for (const [key, value] of Object.entries(meta.custom)) {\n        if (!isValidCustomKey(key)) {\n          this.logger.warn(LOG_SOURCE$1, LOG_CATEGORY$1, "Invalid custom metadata key skipped", key);\n          continue;\n        }\n        if (!this.setMetaText(ctx.docPtr, key, value ?? null)) ok = false;\n      }\n    }\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "SetMetadata", "End", doc.id);\n    return ok ? PdfTaskHelper.resolve(true) : PdfTaskHelper.reject({\n      code: PdfErrorCode.Unknown,\n      message: "one or more metadata fields could not be written"\n    });\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getDocPermissions}\n   *\n   * @public\n   */\n  getDocPermissions(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getDocPermissions", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `getDocPermissions`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `getDocPermissions`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const permissions = this.pdfiumModule.FPDF_GetDocPermissions(ctx.docPtr);\n    return PdfTaskHelper.resolve(permissions);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getDocUserPermissions}\n   *\n   * @public\n   */\n  getDocUserPermissions(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getDocUserPermissions", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `getDocUserPermissions`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `getDocUserPermissions`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const permissions = this.pdfiumModule.FPDF_GetDocUserPermissions(ctx.docPtr);\n    return PdfTaskHelper.resolve(permissions);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getSignatures}\n   *\n   * @public\n   */\n  getSignatures(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getSignatures", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetSignatures`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetSignatures`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const signatures = [];\n    const count = this.pdfiumModule.FPDF_GetSignatureCount(ctx.docPtr);\n    for (let i = 0; i < count; i++) {\n      const signatureObjPtr = this.pdfiumModule.FPDF_GetSignatureObject(ctx.docPtr, i);\n      const contents = readArrayBuffer(this.pdfiumModule.pdfium, (buffer, bufferSize) => {\n        return this.pdfiumModule.FPDFSignatureObj_GetContents(signatureObjPtr, buffer, bufferSize);\n      });\n      const byteRange = readArrayBuffer(this.pdfiumModule.pdfium, (buffer, bufferSize) => {\n        return this.pdfiumModule.FPDFSignatureObj_GetByteRange(signatureObjPtr, buffer, bufferSize) * 4;\n      });\n      const subFilter = readArrayBuffer(this.pdfiumModule.pdfium, (buffer, bufferSize) => {\n        return this.pdfiumModule.FPDFSignatureObj_GetSubFilter(signatureObjPtr, buffer, bufferSize);\n      });\n      const reason = readString(\n        this.pdfiumModule.pdfium,\n        (buffer, bufferLength) => {\n          return this.pdfiumModule.FPDFSignatureObj_GetReason(\n            signatureObjPtr,\n            buffer,\n            bufferLength\n          );\n        },\n        this.pdfiumModule.pdfium.UTF16ToString\n      );\n      const time = readString(\n        this.pdfiumModule.pdfium,\n        (buffer, bufferLength) => {\n          return this.pdfiumModule.FPDFSignatureObj_GetTime(signatureObjPtr, buffer, bufferLength);\n        },\n        this.pdfiumModule.pdfium.UTF8ToString\n      );\n      const docMDP = this.pdfiumModule.FPDFSignatureObj_GetDocMDPPermission(signatureObjPtr);\n      signatures.push({\n        contents,\n        byteRange,\n        subFilter,\n        reason,\n        time,\n        docMDP\n      });\n    }\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetSignatures`, "End", doc.id);\n    return PdfTaskHelper.resolve(signatures);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getBookmarks}\n   *\n   * @public\n   */\n  getBookmarks(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getBookmarks", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetBookmarks`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `getBookmarks`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const bookmarks = this.readPdfBookmarks(ctx.docPtr, 0);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetBookmarks`, "End", doc.id);\n    return PdfTaskHelper.resolve({\n      bookmarks\n    });\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.setBookmarks}\n   *\n   * @public\n   */\n  setBookmarks(doc, list) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "setBookmarks", doc, list);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SetBookmarks`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SetBookmarks`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    if (!this.pdfiumModule.EPDFBookmark_Clear(ctx.docPtr)) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SetBookmarks`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: "failed to clear existing bookmarks"\n      });\n    }\n    const build = (parentPtr, items) => {\n      var _a;\n      for (const item of items) {\n        const bmPtr = this.withWString(\n          item.title ?? "",\n          (wptr) => this.pdfiumModule.EPDFBookmark_AppendChild(ctx.docPtr, parentPtr, wptr)\n        );\n        if (!bmPtr) return false;\n        if (item.target) {\n          const ok2 = this.applyBookmarkTarget(ctx.docPtr, bmPtr, item.target);\n          if (!ok2) return false;\n        }\n        if ((_a = item.children) == null ? void 0 : _a.length) {\n          const ok2 = build(bmPtr, item.children);\n          if (!ok2) return false;\n        }\n      }\n      return true;\n    };\n    const ok = build(\n      /*top-level*/\n      0,\n      list\n    );\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SetBookmarks`, "End", doc.id);\n    if (!ok) {\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: "failed to build bookmark tree"\n      });\n    }\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.deleteBookmarks}\n   *\n   * @public\n   */\n  deleteBookmarks(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "deleteBookmarks", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteBookmarks`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteBookmarks`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const ok = this.pdfiumModule.EPDFBookmark_Clear(ctx.docPtr);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteBookmarks`, "End", doc.id);\n    return ok ? PdfTaskHelper.resolve(true) : PdfTaskHelper.reject({\n      code: PdfErrorCode.Unknown,\n      message: "failed to clear bookmarks"\n    });\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.renderPage}\n   *\n   * @public\n   */\n  renderPageRaw(doc, page, options) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "renderPage", doc, page, options);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `RenderPage`, "Begin", `${doc.id}-${page.index}`);\n    const rect = { origin: { x: 0, y: 0 }, size: page.size };\n    const task = this.renderRectEncoded(doc, page, rect, options);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `RenderPage`, "End", `${doc.id}-${page.index}`);\n    return task;\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.renderPageRect}\n   *\n   * @public\n   */\n  renderPageRect(doc, page, rect, options) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "renderPageRect", doc, page, rect, options);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderPageRect`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const task = this.renderRectEncoded(doc, page, rect, options);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `RenderPageRect`, "End", `${doc.id}-${page.index}`);\n    return task;\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getPageAnnotations}\n   *\n   * @public\n   */\n  getPageAnnotations(doc, page) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageAnnotations", doc, page);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageAnnotations`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `GetPageAnnotations`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const annotations = this.readPageAnnotations(ctx, page);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageAnnotations`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    this.logger.debug(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageAnnotations`,\n      `${doc.id}-${page.index}`,\n      annotations\n    );\n    return PdfTaskHelper.resolve(annotations);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.createPageAnnotation}\n   *\n   * @public\n   */\n  createPageAnnotation(doc, page, annotation, context) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "createPageAnnotation", doc, page, annotation);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `CreatePageAnnotation`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `CreatePageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const annotationPtr = this.pdfiumModule.EPDFPage_CreateAnnot(pageCtx.pagePtr, annotation.type);\n    if (!annotationPtr) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `CreatePageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      pageCtx.release();\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantCreateAnnot,\n        message: "can not create annotation with specified type"\n      });\n    }\n    if (!isUuidV4(annotation.id)) {\n      annotation.id = uuidV4();\n    }\n    if (!this.setAnnotString(annotationPtr, "NM", annotation.id)) {\n      this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n      pageCtx.release();\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantSetAnnotString,\n        message: "can not set the name of the annotation"\n      });\n    }\n    if (!this.setPageAnnoRect(page, annotationPtr, annotation.rect)) {\n      this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n      pageCtx.release();\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `CreatePageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantSetAnnotRect,\n        message: "can not set the rect of the annotation"\n      });\n    }\n    let isSucceed = false;\n    switch (annotation.type) {\n      case PdfAnnotationSubtype.INK:\n        isSucceed = this.addInkStroke(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n      case PdfAnnotationSubtype.STAMP:\n        isSucceed = this.addStampContent(\n          ctx.docPtr,\n          page,\n          pageCtx.pagePtr,\n          annotationPtr,\n          annotation,\n          context == null ? void 0 : context.imageData\n        );\n        break;\n      case PdfAnnotationSubtype.TEXT:\n        isSucceed = this.addTextContent(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n      case PdfAnnotationSubtype.FREETEXT:\n        isSucceed = this.addFreeTextContent(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n      case PdfAnnotationSubtype.LINE:\n        isSucceed = this.addLineContent(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n      case PdfAnnotationSubtype.POLYLINE:\n      case PdfAnnotationSubtype.POLYGON:\n        isSucceed = this.addPolyContent(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n      case PdfAnnotationSubtype.CIRCLE:\n      case PdfAnnotationSubtype.SQUARE:\n        isSucceed = this.addShapeContent(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n      case PdfAnnotationSubtype.UNDERLINE:\n      case PdfAnnotationSubtype.STRIKEOUT:\n      case PdfAnnotationSubtype.SQUIGGLY:\n      case PdfAnnotationSubtype.HIGHLIGHT:\n        isSucceed = this.addTextMarkupContent(page, pageCtx.pagePtr, annotationPtr, annotation);\n        break;\n    }\n    if (!isSucceed) {\n      this.pdfiumModule.FPDFPage_RemoveAnnot(pageCtx.pagePtr, annotationPtr);\n      pageCtx.release();\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `CreatePageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantSetAnnotContent,\n        message: "can not add content of the annotation"\n      });\n    }\n    if (annotation.blendMode !== void 0) {\n      this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(annotationPtr, annotation.blendMode);\n    } else {\n      this.pdfiumModule.EPDFAnnot_GenerateAppearance(annotationPtr);\n    }\n    this.pdfiumModule.FPDFPage_GenerateContent(pageCtx.pagePtr);\n    this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n    pageCtx.release();\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `CreatePageAnnotation`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    return PdfTaskHelper.resolve(annotation.id);\n  }\n  /**\n   * Update an existing page annotation in-place\n   *\n   *  • Locates the annot by page-local index (`annotation.id`)\n   *  • Re-writes its /Rect and type-specific payload\n   *  • Calls FPDFPage_GenerateContent so the new appearance is rendered\n   *\n   * @returns PdfTask<boolean>  –  true on success\n   */\n  updatePageAnnotation(doc, page, annotation) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "updatePageAnnotation", doc, page, annotation);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      "UpdatePageAnnotation",\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        "UpdatePageAnnotation",\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const annotPtr = this.getAnnotationByName(pageCtx.pagePtr, annotation.id);\n    if (!annotPtr) {\n      pageCtx.release();\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        "UpdatePageAnnotation",\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: "annotation not found" });\n    }\n    if (!this.setPageAnnoRect(page, annotPtr, annotation.rect)) {\n      this.pdfiumModule.FPDFPage_CloseAnnot(annotPtr);\n      pageCtx.release();\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        "UpdatePageAnnotation",\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantSetAnnotRect,\n        message: "failed to move annotation"\n      });\n    }\n    let ok = false;\n    switch (annotation.type) {\n      /* ── Ink ─────────────────────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.INK: {\n        if (!this.pdfiumModule.FPDFAnnot_RemoveInkList(annotPtr)) break;\n        ok = this.addInkStroke(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Stamp ───────────────────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.STAMP: {\n        ok = this.addStampContent(ctx.docPtr, page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      case PdfAnnotationSubtype.TEXT: {\n        ok = this.addTextContent(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Free text ────────────────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.FREETEXT: {\n        ok = this.addFreeTextContent(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Shape ───────────────────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.CIRCLE:\n      case PdfAnnotationSubtype.SQUARE: {\n        ok = this.addShapeContent(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Line ─────────────────────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.LINE: {\n        ok = this.addLineContent(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Polygon / Polyline ───────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.POLYGON:\n      case PdfAnnotationSubtype.POLYLINE: {\n        ok = this.addPolyContent(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Text-markup family ──────────────────────────────────────────────── */\n      case PdfAnnotationSubtype.HIGHLIGHT:\n      case PdfAnnotationSubtype.UNDERLINE:\n      case PdfAnnotationSubtype.STRIKEOUT:\n      case PdfAnnotationSubtype.SQUIGGLY: {\n        ok = this.addTextMarkupContent(page, pageCtx.pagePtr, annotPtr, annotation);\n        break;\n      }\n      /* ── Unsupported edits – fall through to error ───────────────────────── */\n      default:\n        ok = false;\n    }\n    if (ok) {\n      if (annotation.blendMode !== void 0) {\n        this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(annotPtr, annotation.blendMode);\n      } else {\n        this.pdfiumModule.EPDFAnnot_GenerateAppearance(annotPtr);\n      }\n      this.pdfiumModule.FPDFPage_GenerateContent(pageCtx.pagePtr);\n    }\n    this.pdfiumModule.FPDFPage_CloseAnnot(annotPtr);\n    pageCtx.release();\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      "UpdatePageAnnotation",\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    return ok ? PdfTaskHelper.resolve(true) : PdfTaskHelper.reject({\n      code: PdfErrorCode.CantSetAnnotContent,\n      message: "failed to update annotation"\n    });\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.removePageAnnotation}\n   *\n   * @public\n   */\n  removePageAnnotation(doc, page, annotation) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "removePageAnnotation", doc, page, annotation);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RemovePageAnnotation`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `RemovePageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    let result = false;\n    result = this.removeAnnotationByName(pageCtx.pagePtr, annotation.id);\n    if (!result) {\n      this.logger.error(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `FPDFPage_RemoveAnnot Failed`,\n        `${doc.id}-${page.index}`\n      );\n    } else {\n      result = this.pdfiumModule.FPDFPage_GenerateContent(pageCtx.pagePtr);\n      if (!result) {\n        this.logger.error(\n          LOG_SOURCE$1,\n          LOG_CATEGORY$1,\n          `FPDFPage_GenerateContent Failed`,\n          `${doc.id}-${page.index}`\n        );\n      }\n    }\n    pageCtx.release();\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RemovePageAnnotation`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    return PdfTaskHelper.resolve(result);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getPageTextRects}\n   *\n   * @public\n   */\n  getPageTextRects(doc, page) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageTextRects", doc, page);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageTextRects`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `GetPageTextRects`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const textPagePtr = this.pdfiumModule.FPDFText_LoadPage(pageCtx.pagePtr);\n    const textRects = this.readPageTextRects(page, pageCtx.docPtr, pageCtx.pagePtr, textPagePtr);\n    this.pdfiumModule.FPDFText_ClosePage(textPagePtr);\n    pageCtx.release();\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageTextRects`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    return PdfTaskHelper.resolve(textRects);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.renderThumbnail}\n   *\n   * @public\n   */\n  renderThumbnailRaw(doc, page, options) {\n    const { scaleFactor = 1, ...rest } = options ?? {};\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "renderThumbnail", doc, page, options);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderThumbnail`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `RenderThumbnail`,\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const result = this.renderPageRaw(doc, page, {\n      scaleFactor: Math.max(scaleFactor, 0.5),\n      ...rest\n    });\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `RenderThumbnail`, "End", `${doc.id}-${page.index}`);\n    return result;\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getAttachments}\n   *\n   * @public\n   */\n  getAttachments(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getAttachments", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetAttachments`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetAttachments`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const attachments = [];\n    const count = this.pdfiumModule.FPDFDoc_GetAttachmentCount(ctx.docPtr);\n    for (let i = 0; i < count; i++) {\n      const attachment = this.readPdfAttachment(ctx.docPtr, i);\n      attachments.push(attachment);\n    }\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `GetAttachments`, "End", doc.id);\n    return PdfTaskHelper.resolve(attachments);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.addAttachment}\n   *\n   * @public\n   */\n  addAttachment(doc, params) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "addAttachment", doc, params == null ? void 0 : params.name);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const { name, description, mimeType, data } = params ?? {};\n    if (!name) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.NotFound,\n        message: "attachment name is required"\n      });\n    }\n    if (!data || (data instanceof Uint8Array ? data.byteLength === 0 : data.byteLength === 0)) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.NotFound,\n        message: "attachment data is empty"\n      });\n    }\n    const attachmentPtr = this.withWString(\n      name,\n      (wNamePtr) => this.pdfiumModule.FPDFDoc_AddAttachment(ctx.docPtr, wNamePtr)\n    );\n    if (!attachmentPtr) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: `An attachment named "${name}" already exists`\n      });\n    }\n    this.withWString(\n      description,\n      (wDescriptionPtr) => this.pdfiumModule.EPDFAttachment_SetDescription(attachmentPtr, wDescriptionPtr)\n    );\n    this.pdfiumModule.EPDFAttachment_SetSubtype(attachmentPtr, mimeType);\n    const u8 = data instanceof Uint8Array ? data : new Uint8Array(data);\n    const len = u8.byteLength;\n    const contentPtr = this.memoryManager.malloc(len);\n    try {\n      this.pdfiumModule.pdfium.HEAPU8.set(u8, contentPtr);\n      const ok = this.pdfiumModule.FPDFAttachment_SetFile(\n        attachmentPtr,\n        ctx.docPtr,\n        contentPtr,\n        len\n      );\n      if (!ok) {\n        this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "End", doc.id);\n        return PdfTaskHelper.reject({\n          code: PdfErrorCode.Unknown,\n          message: "failed to write attachment bytes"\n        });\n      }\n    } finally {\n      this.memoryManager.free(contentPtr);\n    }\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `AddAttachment`, "End", doc.id);\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.removeAttachment}\n   *\n   * @public\n   */\n  removeAttachment(doc, attachment) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "deleteAttachment", doc, attachment);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteAttachment`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteAttachment`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const count = this.pdfiumModule.FPDFDoc_GetAttachmentCount(ctx.docPtr);\n    if (attachment.index < 0 || attachment.index >= count) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteAttachment`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: `attachment index ${attachment.index} out of range`\n      });\n    }\n    const ok = this.pdfiumModule.FPDFDoc_DeleteAttachment(ctx.docPtr, attachment.index);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `DeleteAttachment`, "End", doc.id);\n    if (!ok) {\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: "failed to delete attachment"\n      });\n    }\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.readAttachmentContent}\n   *\n   * @public\n   */\n  readAttachmentContent(doc, attachment) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "readAttachmentContent", doc, attachment);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ReadAttachmentContent`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ReadAttachmentContent`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const attachmentPtr = this.pdfiumModule.FPDFDoc_GetAttachment(ctx.docPtr, attachment.index);\n    const sizePtr = this.memoryManager.malloc(4);\n    if (!this.pdfiumModule.FPDFAttachment_GetFile(attachmentPtr, 0, 0, sizePtr)) {\n      this.memoryManager.free(sizePtr);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ReadAttachmentContent`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantReadAttachmentSize,\n        message: "can not read attachment size"\n      });\n    }\n    const size = this.pdfiumModule.pdfium.getValue(sizePtr, "i32") >>> 0;\n    const contentPtr = this.memoryManager.malloc(size);\n    if (!this.pdfiumModule.FPDFAttachment_GetFile(attachmentPtr, contentPtr, size, sizePtr)) {\n      this.memoryManager.free(sizePtr);\n      this.memoryManager.free(contentPtr);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ReadAttachmentContent`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantReadAttachmentContent,\n        message: "can not read attachment content"\n      });\n    }\n    const buffer = new ArrayBuffer(size);\n    const view = new DataView(buffer);\n    for (let i = 0; i < size; i++) {\n      view.setInt8(i, this.pdfiumModule.pdfium.getValue(contentPtr + i, "i8"));\n    }\n    this.memoryManager.free(sizePtr);\n    this.memoryManager.free(contentPtr);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ReadAttachmentContent`, "End", doc.id);\n    return PdfTaskHelper.resolve(buffer);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.setFormFieldValue}\n   *\n   * @public\n   */\n  setFormFieldValue(doc, page, annotation, value) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "SetFormFieldValue", doc, annotation, value);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `SetFormFieldValue`,\n      "Begin",\n      `${doc.id}-${annotation.id}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "SetFormFieldValue", "document is not opened");\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `SetFormFieldValue`,\n        "End",\n        `${doc.id}-${annotation.id}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const formFillInfoPtr = this.pdfiumModule.PDFiumExt_OpenFormFillInfo();\n    const formHandle = this.pdfiumModule.PDFiumExt_InitFormFillEnvironment(\n      ctx.docPtr,\n      formFillInfoPtr\n    );\n    const pageCtx = ctx.acquirePage(page.index);\n    this.pdfiumModule.FORM_OnAfterLoadPage(pageCtx.pagePtr, formHandle);\n    const annotationPtr = this.getAnnotationByName(pageCtx.pagePtr, annotation.id);\n    if (!annotationPtr) {\n      pageCtx.release();\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        "SetFormFieldValue",\n        "End",\n        `${doc.id}-${page.index}`\n      );\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: "annotation not found" });\n    }\n    if (!this.pdfiumModule.FORM_SetFocusedAnnot(formHandle, annotationPtr)) {\n      this.logger.debug(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        "SetFormFieldValue",\n        "failed to set focused annotation"\n      );\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `SetFormFieldValue`,\n        "End",\n        `${doc.id}-${annotation.id}`\n      );\n      this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n      this.pdfiumModule.FORM_OnBeforeClosePage(pageCtx.pagePtr, formHandle);\n      pageCtx.release();\n      this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(formHandle);\n      this.pdfiumModule.PDFiumExt_CloseFormFillInfo(formFillInfoPtr);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantFocusAnnot,\n        message: "failed to set focused annotation"\n      });\n    }\n    switch (value.kind) {\n      case "text":\n        {\n          if (!this.pdfiumModule.FORM_SelectAllText(formHandle, pageCtx.pagePtr)) {\n            this.logger.debug(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              "SetFormFieldValue",\n              "failed to select all text"\n            );\n            this.logger.perf(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              `SetFormFieldValue`,\n              "End",\n              `${doc.id}-${annotation.id}`\n            );\n            this.pdfiumModule.FORM_ForceToKillFocus(formHandle);\n            this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n            this.pdfiumModule.FORM_OnBeforeClosePage(pageCtx.pagePtr, formHandle);\n            pageCtx.release();\n            this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(formHandle);\n            this.pdfiumModule.PDFiumExt_CloseFormFillInfo(formFillInfoPtr);\n            return PdfTaskHelper.reject({\n              code: PdfErrorCode.CantSelectText,\n              message: "failed to select all text"\n            });\n          }\n          const length = 2 * (value.text.length + 1);\n          const textPtr = this.memoryManager.malloc(length);\n          this.pdfiumModule.pdfium.stringToUTF16(value.text, textPtr, length);\n          this.pdfiumModule.FORM_ReplaceSelection(formHandle, pageCtx.pagePtr, textPtr);\n          this.memoryManager.free(textPtr);\n        }\n        break;\n      case "selection":\n        {\n          if (!this.pdfiumModule.FORM_SetIndexSelected(\n            formHandle,\n            pageCtx.pagePtr,\n            value.index,\n            value.isSelected\n          )) {\n            this.logger.debug(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              "SetFormFieldValue",\n              "failed to set index selected"\n            );\n            this.logger.perf(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              `SetFormFieldValue`,\n              "End",\n              `${doc.id}-${annotation.id}`\n            );\n            this.pdfiumModule.FORM_ForceToKillFocus(formHandle);\n            this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n            this.pdfiumModule.FORM_OnBeforeClosePage(pageCtx.pagePtr, formHandle);\n            pageCtx.release();\n            this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(formHandle);\n            this.pdfiumModule.PDFiumExt_CloseFormFillInfo(formFillInfoPtr);\n            return PdfTaskHelper.reject({\n              code: PdfErrorCode.CantSelectOption,\n              message: "failed to set index selected"\n            });\n          }\n        }\n        break;\n      case "checked":\n        {\n          const kReturn = 13;\n          if (!this.pdfiumModule.FORM_OnChar(formHandle, pageCtx.pagePtr, kReturn, 0)) {\n            this.logger.debug(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              "SetFormFieldValue",\n              "failed to set field checked"\n            );\n            this.logger.perf(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              `SetFormFieldValue`,\n              "End",\n              `${doc.id}-${annotation.id}`\n            );\n            this.pdfiumModule.FORM_ForceToKillFocus(formHandle);\n            this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n            this.pdfiumModule.FORM_OnBeforeClosePage(pageCtx.pagePtr, formHandle);\n            pageCtx.release();\n            this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(formHandle);\n            this.pdfiumModule.PDFiumExt_CloseFormFillInfo(formFillInfoPtr);\n            return PdfTaskHelper.reject({\n              code: PdfErrorCode.CantCheckField,\n              message: "failed to set field checked"\n            });\n          }\n        }\n        break;\n    }\n    this.pdfiumModule.FORM_ForceToKillFocus(formHandle);\n    this.pdfiumModule.FPDFPage_CloseAnnot(annotationPtr);\n    this.pdfiumModule.FORM_OnBeforeClosePage(pageCtx.pagePtr, formHandle);\n    pageCtx.release();\n    this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(formHandle);\n    this.pdfiumModule.PDFiumExt_CloseFormFillInfo(formFillInfoPtr);\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.flattenPage}\n   *\n   * @public\n   */\n  flattenPage(doc, page, options) {\n    const { flag = PdfPageFlattenFlag.Display } = options ?? {};\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "flattenPage", doc, page, flag);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `flattenPage`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `flattenPage`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const result = this.pdfiumModule.FPDFPage_Flatten(pageCtx.pagePtr, flag);\n    pageCtx.release();\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `flattenPage`, "End", doc.id);\n    return PdfTaskHelper.resolve(result);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.extractPages}\n   *\n   * @public\n   */\n  extractPages(doc, pageIndexes) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "extractPages", doc, pageIndexes);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractPages`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractPages`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const newDocPtr = this.pdfiumModule.FPDF_CreateNewDocument();\n    if (!newDocPtr) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractPages`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantCreateNewDoc,\n        message: "can not create new document"\n      });\n    }\n    const pageIndexesPtr = this.memoryManager.malloc(pageIndexes.length * 4);\n    for (let i = 0; i < pageIndexes.length; i++) {\n      this.pdfiumModule.pdfium.setValue(pageIndexesPtr + i * 4, pageIndexes[i], "i32");\n    }\n    if (!this.pdfiumModule.FPDF_ImportPagesByIndex(\n      newDocPtr,\n      ctx.docPtr,\n      pageIndexesPtr,\n      pageIndexes.length,\n      0\n    )) {\n      this.pdfiumModule.FPDF_CloseDocument(newDocPtr);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractPages`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantImportPages,\n        message: "can not import pages to new document"\n      });\n    }\n    const buffer = this.saveDocument(newDocPtr);\n    this.pdfiumModule.FPDF_CloseDocument(newDocPtr);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractPages`, "End", doc.id);\n    return PdfTaskHelper.resolve(buffer);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.extractText}\n   *\n   * @public\n   */\n  extractText(doc, pageIndexes) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "extractText", doc, pageIndexes);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractText`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractText`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const strings = [];\n    for (let i = 0; i < pageIndexes.length; i++) {\n      const pageCtx = ctx.acquirePage(pageIndexes[i]);\n      const textPagePtr = this.pdfiumModule.FPDFText_LoadPage(pageCtx.pagePtr);\n      const charCount = this.pdfiumModule.FPDFText_CountChars(textPagePtr);\n      const bufferPtr = this.memoryManager.malloc((charCount + 1) * 2);\n      this.pdfiumModule.FPDFText_GetText(textPagePtr, 0, charCount, bufferPtr);\n      const text2 = this.pdfiumModule.pdfium.UTF16ToString(bufferPtr);\n      this.memoryManager.free(bufferPtr);\n      strings.push(text2);\n      this.pdfiumModule.FPDFText_ClosePage(textPagePtr);\n      pageCtx.release();\n    }\n    const text = strings.join("\\n\\n");\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `ExtractText`, "End", doc.id);\n    return PdfTaskHelper.resolve(text);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.getTextSlices}\n   *\n   * @public\n   */\n  getTextSlices(doc, slices) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getTextSlices", doc, slices);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetTextSlices", "Begin", doc.id);\n    if (slices.length === 0) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetTextSlices", "End", doc.id);\n      return PdfTaskHelper.resolve([]);\n    }\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetTextSlices", "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    try {\n      const out = new Array(slices.length);\n      const byPage = /* @__PURE__ */ new Map();\n      slices.forEach((s, i) => {\n        (byPage.get(s.pageIndex) ?? byPage.set(s.pageIndex, []).get(s.pageIndex)).push({\n          slice: s,\n          pos: i\n        });\n      });\n      for (const [pageIdx, list] of byPage) {\n        const pageCtx = ctx.acquirePage(pageIdx);\n        const textPagePtr = pageCtx.getTextPage();\n        for (const { slice, pos } of list) {\n          const bufPtr = this.memoryManager.malloc(2 * (slice.charCount + 1));\n          this.pdfiumModule.FPDFText_GetText(textPagePtr, slice.charIndex, slice.charCount, bufPtr);\n          out[pos] = stripPdfUnwantedMarkers(this.pdfiumModule.pdfium.UTF16ToString(bufPtr));\n          this.memoryManager.free(bufPtr);\n        }\n        pageCtx.release();\n      }\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetTextSlices", "End", doc.id);\n      return PdfTaskHelper.resolve(out);\n    } catch (e) {\n      this.logger.error(LOG_SOURCE$1, LOG_CATEGORY$1, "getTextSlices error", e);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetTextSlices", "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: String(e)\n      });\n    }\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.merge}\n   *\n   * @public\n   */\n  merge(files) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "merge", files);\n    const fileIds = files.map((file2) => file2.id).join(".");\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Merge`, "Begin", fileIds);\n    const newDocPtr = this.pdfiumModule.FPDF_CreateNewDocument();\n    if (!newDocPtr) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Merge`, "End", fileIds);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantCreateNewDoc,\n        message: "can not create new document"\n      });\n    }\n    const ptrs = [];\n    for (const file2 of files.reverse()) {\n      const array = new Uint8Array(file2.content);\n      const length = array.length;\n      const filePtr = this.memoryManager.malloc(length);\n      this.pdfiumModule.pdfium.HEAPU8.set(array, filePtr);\n      const docPtr = this.pdfiumModule.FPDF_LoadMemDocument(filePtr, length, "");\n      if (!docPtr) {\n        const lastError = this.pdfiumModule.FPDF_GetLastError();\n        this.logger.error(\n          LOG_SOURCE$1,\n          LOG_CATEGORY$1,\n          `FPDF_LoadMemDocument failed with ${lastError}`\n        );\n        this.memoryManager.free(filePtr);\n        for (const ptr of ptrs) {\n          this.pdfiumModule.FPDF_CloseDocument(ptr.docPtr);\n          this.memoryManager.free(ptr.filePtr);\n        }\n        this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Merge`, "End", fileIds);\n        return PdfTaskHelper.reject({\n          code: lastError,\n          message: `FPDF_LoadMemDocument failed`\n        });\n      }\n      ptrs.push({ filePtr, docPtr });\n      if (!this.pdfiumModule.FPDF_ImportPages(newDocPtr, docPtr, "", 0)) {\n        this.pdfiumModule.FPDF_CloseDocument(newDocPtr);\n        for (const ptr of ptrs) {\n          this.pdfiumModule.FPDF_CloseDocument(ptr.docPtr);\n          this.memoryManager.free(ptr.filePtr);\n        }\n        this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Merge`, "End", fileIds);\n        return PdfTaskHelper.reject({\n          code: PdfErrorCode.CantImportPages,\n          message: "can not import pages to new document"\n        });\n      }\n    }\n    const buffer = this.saveDocument(newDocPtr);\n    this.pdfiumModule.FPDF_CloseDocument(newDocPtr);\n    for (const ptr of ptrs) {\n      this.pdfiumModule.FPDF_CloseDocument(ptr.docPtr);\n      this.memoryManager.free(ptr.filePtr);\n    }\n    const file = {\n      id: `${Math.random()}`,\n      content: buffer\n    };\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `Merge`, "End", fileIds);\n    return PdfTaskHelper.resolve(file);\n  }\n  /**\n   * Merges specific pages from multiple PDF documents in a custom order\n   *\n   * @param mergeConfigs Array of configurations specifying which pages to merge from which documents\n   * @returns A PdfTask that resolves with the merged PDF file\n   * @public\n   */\n  mergePages(mergeConfigs) {\n    const configIds = mergeConfigs.map((config) => `${config.docId}:${config.pageIndices.join(",")}`).join("|");\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "mergePages", mergeConfigs);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `MergePages`, "Begin", configIds);\n    const newDocPtr = this.pdfiumModule.FPDF_CreateNewDocument();\n    if (!newDocPtr) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `MergePages`, "End", configIds);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantCreateNewDoc,\n        message: "Cannot create new document"\n      });\n    }\n    try {\n      for (const config of [...mergeConfigs].reverse()) {\n        const ctx = this.cache.getContext(config.docId);\n        if (!ctx) {\n          this.logger.warn(\n            LOG_SOURCE$1,\n            LOG_CATEGORY$1,\n            `Document ${config.docId} is not open, skipping`\n          );\n          continue;\n        }\n        const pageCount = this.pdfiumModule.FPDF_GetPageCount(ctx.docPtr);\n        const validPageIndices = config.pageIndices.filter(\n          (index) => index >= 0 && index < pageCount\n        );\n        if (validPageIndices.length === 0) {\n          continue;\n        }\n        const pageString = validPageIndices.map((index) => index + 1).join(",");\n        try {\n          if (!this.pdfiumModule.FPDF_ImportPages(\n            newDocPtr,\n            ctx.docPtr,\n            pageString,\n            0\n            // Insert at the beginning\n          )) {\n            throw new Error(`Failed to import pages ${pageString} from document ${config.docId}`);\n          }\n        } finally {\n        }\n      }\n      const buffer = this.saveDocument(newDocPtr);\n      const file = {\n        id: `${Math.random()}`,\n        content: buffer\n      };\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `MergePages`, "End", configIds);\n      return PdfTaskHelper.resolve(file);\n    } catch (error) {\n      this.logger.error(LOG_SOURCE$1, LOG_CATEGORY$1, "mergePages failed", error);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `MergePages`, "End", configIds);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantImportPages,\n        message: error instanceof Error ? error.message : "Failed to merge pages"\n      });\n    } finally {\n      if (newDocPtr) {\n        this.pdfiumModule.FPDF_CloseDocument(newDocPtr);\n      }\n    }\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.saveAsCopy}\n   *\n   * @public\n   */\n  saveAsCopy(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "saveAsCopy", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SaveAsCopy`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SaveAsCopy`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const buffer = this.saveDocument(ctx.docPtr);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SaveAsCopy`, "End", doc.id);\n    return PdfTaskHelper.resolve(buffer);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.closeDocument}\n   *\n   * @public\n   */\n  closeDocument(doc) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "closeDocument", doc);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `CloseDocument`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) return PdfTaskHelper.resolve(true);\n    ctx.dispose();\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `CloseDocument`, "End", doc.id);\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.closeAllDocuments}\n   *\n   * @public\n   */\n  closeAllDocuments() {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "closeAllDocuments");\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `CloseAllDocuments`, "Begin");\n    this.cache.closeAllDocuments();\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `CloseAllDocuments`, "End");\n    return PdfTaskHelper.resolve(true);\n  }\n  /**\n   * Add text content to annotation\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to text annotation\n   * @param annotation - text annotation\n   * @returns whether text content is added to annotation\n   *\n   * @private\n   */\n  addTextContent(page, pagePtr, annotationPtr, annotation) {\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.inReplyToId && !this.setInReplyToId(pagePtr, annotationPtr, annotation.inReplyToId)) {\n      return false;\n    }\n    if (!this.setAnnotationIcon(annotationPtr, annotation.icon || PdfAnnotationIcon.Comment)) {\n      return false;\n    }\n    if (!this.setAnnotationFlags(annotationPtr, annotation.flags || ["print", "noZoom", "noRotate"])) {\n      return false;\n    }\n    if (annotation.state && !this.setAnnotString(annotationPtr, "State", annotation.state)) {\n      return false;\n    }\n    if (annotation.stateModel && !this.setAnnotString(annotationPtr, "StateModel", annotation.stateModel)) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add free text content to annotation\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to free text annotation\n   * @param annotation - free text annotation\n   * @returns whether free text content is added to annotation\n   *\n   * @private\n   */\n  addFreeTextContent(page, pagePtr, annotationPtr, annotation) {\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.flags && !this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (!this.setBorderStyle(annotationPtr, PdfAnnotationBorderStyle.SOLID, 0)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (!this.setAnnotationOpacity(annotationPtr, annotation.opacity ?? 1)) {\n      return false;\n    }\n    if (!this.setAnnotationTextAlignment(annotationPtr, annotation.textAlign)) {\n      return false;\n    }\n    if (!this.setAnnotationVerticalAlignment(annotationPtr, annotation.verticalAlign)) {\n      return false;\n    }\n    if (!this.setAnnotationDefaultAppearance(\n      annotationPtr,\n      annotation.fontFamily,\n      annotation.fontSize,\n      annotation.fontColor\n    )) {\n      return false;\n    }\n    if (annotation.intent && !this.setAnnotIntent(annotationPtr, annotation.intent)) {\n      return false;\n    }\n    if (!annotation.backgroundColor || annotation.backgroundColor === "transparent") {\n      if (!this.pdfiumModule.EPDFAnnot_ClearColor(annotationPtr, PdfAnnotationColorType.Color)) {\n        return false;\n      }\n    } else if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.backgroundColor ?? "#FFFFFF",\n      PdfAnnotationColorType.Color\n    )) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Set the rect of specified annotation\n   * @param page - page info that the annotation is belonged to\n   * @param pagePtr - pointer of page object\n   * @param annotationPtr - pointer to annotation object\n   * @param inkList - ink lists that added to the annotation\n   * @returns whether the ink lists is setted\n   *\n   * @private\n   */\n  addInkStroke(page, pagePtr, annotationPtr, annotation) {\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.flags && !this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (!this.setBorderStyle(annotationPtr, PdfAnnotationBorderStyle.SOLID, annotation.strokeWidth)) {\n      return false;\n    }\n    if (!this.setInkList(page, annotationPtr, annotation.inkList)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (!this.setAnnotationOpacity(annotationPtr, annotation.opacity ?? 1)) {\n      return false;\n    }\n    if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.color ?? "#FFFF00",\n      PdfAnnotationColorType.Color\n    )) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add line content to annotation\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to line annotation\n   * @param annotation - line annotation\n   * @returns whether line content is added to annotation\n   *\n   * @private\n   */\n  addLineContent(page, pagePtr, annotationPtr, annotation) {\n    var _a, _b;\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.flags && !this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (!this.setLinePoints(\n      page,\n      annotationPtr,\n      annotation.linePoints.start,\n      annotation.linePoints.end\n    )) {\n      return false;\n    }\n    if (!this.setLineEndings(\n      annotationPtr,\n      ((_a = annotation.lineEndings) == null ? void 0 : _a.start) ?? PdfAnnotationLineEnding.None,\n      ((_b = annotation.lineEndings) == null ? void 0 : _b.end) ?? PdfAnnotationLineEnding.None\n    )) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (!this.setBorderStyle(annotationPtr, annotation.strokeStyle, annotation.strokeWidth)) {\n      return false;\n    }\n    if (!this.setBorderDashPattern(annotationPtr, annotation.strokeDashArray ?? [])) {\n      return false;\n    }\n    if (annotation.intent && !this.setAnnotIntent(annotationPtr, annotation.intent)) {\n      return false;\n    }\n    if (!annotation.color || annotation.color === "transparent") {\n      if (!this.pdfiumModule.EPDFAnnot_ClearColor(annotationPtr, PdfAnnotationColorType.InteriorColor)) {\n        return false;\n      }\n    } else if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.color ?? "#FFFF00",\n      PdfAnnotationColorType.InteriorColor\n    )) {\n      return false;\n    }\n    if (!this.setAnnotationOpacity(annotationPtr, annotation.opacity ?? 1)) {\n      return false;\n    }\n    if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.strokeColor ?? "#FFFF00",\n      PdfAnnotationColorType.Color\n    )) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add polygon or polyline content to annotation\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to polygon or polyline annotation\n   * @param annotation - polygon or polyline annotation\n   * @returns whether polygon or polyline content is added to annotation\n   *\n   * @private\n   */\n  addPolyContent(page, pagePtr, annotationPtr, annotation) {\n    var _a, _b;\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (annotation.flags && !this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (annotation.type === PdfAnnotationSubtype.POLYLINE && !this.setLineEndings(\n      annotationPtr,\n      ((_a = annotation.lineEndings) == null ? void 0 : _a.start) ?? PdfAnnotationLineEnding.None,\n      ((_b = annotation.lineEndings) == null ? void 0 : _b.end) ?? PdfAnnotationLineEnding.None\n    )) {\n      return false;\n    }\n    if (!this.setPdfAnnoVertices(page, annotationPtr, annotation.vertices)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (!this.setBorderStyle(annotationPtr, annotation.strokeStyle, annotation.strokeWidth)) {\n      return false;\n    }\n    if (!this.setBorderDashPattern(annotationPtr, annotation.strokeDashArray ?? [])) {\n      return false;\n    }\n    if (annotation.intent && !this.setAnnotIntent(annotationPtr, annotation.intent)) {\n      return false;\n    }\n    if (!annotation.color || annotation.color === "transparent") {\n      if (!this.pdfiumModule.EPDFAnnot_ClearColor(annotationPtr, PdfAnnotationColorType.InteriorColor)) {\n        return false;\n      }\n    } else if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.color ?? "#FFFF00",\n      PdfAnnotationColorType.InteriorColor\n    )) {\n      return false;\n    }\n    if (!this.setAnnotationOpacity(annotationPtr, annotation.opacity ?? 1)) {\n      return false;\n    }\n    if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.strokeColor ?? "#FFFF00",\n      PdfAnnotationColorType.Color\n    )) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add shape content to annotation\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to shape annotation\n   * @param annotation - shape annotation\n   * @returns whether shape content is added to annotation\n   *\n   * @private\n   */\n  addShapeContent(page, pagePtr, annotationPtr, annotation) {\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (!this.setBorderStyle(annotationPtr, annotation.strokeStyle, annotation.strokeWidth)) {\n      return false;\n    }\n    if (!this.setBorderDashPattern(annotationPtr, annotation.strokeDashArray ?? [])) {\n      return false;\n    }\n    if (!this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (!annotation.color || annotation.color === "transparent") {\n      if (!this.pdfiumModule.EPDFAnnot_ClearColor(annotationPtr, PdfAnnotationColorType.InteriorColor)) {\n        return false;\n      }\n    } else if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.color ?? "#FFFF00",\n      PdfAnnotationColorType.InteriorColor\n    )) {\n      return false;\n    }\n    if (!this.setAnnotationOpacity(annotationPtr, annotation.opacity ?? 1)) {\n      return false;\n    }\n    if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.strokeColor ?? "#FFFF00",\n      PdfAnnotationColorType.Color\n    )) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add highlight content to annotation\n   * @param page - page info\n   * @param annotationPtr - pointer to highlight annotation\n   * @param annotation - highlight annotation\n   * @returns whether highlight content is added to annotation\n   *\n   * @private\n   */\n  addTextMarkupContent(page, pagePtr, annotationPtr, annotation) {\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.flags && !this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (!this.syncQuadPointsAnno(page, annotationPtr, annotation.segmentRects)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (!this.setAnnotationOpacity(annotationPtr, annotation.opacity ?? 1)) {\n      return false;\n    }\n    if (!this.setAnnotationColor(\n      annotationPtr,\n      annotation.color ?? "#FFFF00",\n      PdfAnnotationColorType.Color\n    )) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add contents to stamp annotation\n   * @param docPtr - pointer to pdf document object\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to stamp annotation\n   * @param rect - rect of stamp annotation\n   * @param contents - contents of stamp annotation\n   * @returns whether contents is added to annotation\n   *\n   * @private\n   */\n  addStampContent(docPtr, page, pagePtr, annotationPtr, annotation, imageData) {\n    if (annotation.created && !this.setAnnotationDate(annotationPtr, "CreationDate", annotation.created)) {\n      return false;\n    }\n    if (annotation.custom && !this.setAnnotCustom(annotationPtr, annotation.custom)) {\n      return false;\n    }\n    if (annotation.flags && !this.setAnnotationFlags(annotationPtr, annotation.flags)) {\n      return false;\n    }\n    if (annotation.modified && !this.setAnnotationDate(annotationPtr, "M", annotation.modified)) {\n      return false;\n    }\n    if (annotation.icon && !this.setAnnotationIcon(annotationPtr, annotation.icon)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "T", annotation.author || "")) {\n      return false;\n    }\n    if (annotation.subject && !this.setAnnotString(annotationPtr, "Subj", annotation.subject)) {\n      return false;\n    }\n    if (!this.setAnnotString(annotationPtr, "Contents", annotation.contents ?? "")) {\n      return false;\n    }\n    if (imageData) {\n      for (let i = this.pdfiumModule.FPDFAnnot_GetObjectCount(annotationPtr) - 1; i >= 0; i--) {\n        this.pdfiumModule.FPDFAnnot_RemoveObject(annotationPtr, i);\n      }\n      if (!this.addImageObject(docPtr, page, pagePtr, annotationPtr, annotation.rect, imageData)) {\n        return false;\n      }\n    }\n    if (!this.pdfiumModule.EPDFAnnot_UpdateAppearanceToRect(annotationPtr, PdfStampFit.Cover)) {\n      return false;\n    }\n    return true;\n  }\n  /**\n   * Add image object to annotation\n   * @param docPtr - pointer to pdf document object\n   * @param page - page info\n   * @param pagePtr - pointer to page object\n   * @param annotationPtr - pointer to stamp annotation\n   * @param position - position of image\n   * @param imageData - data of image\n   * @returns whether image is added to annotation\n   *\n   * @private\n   */\n  addImageObject(docPtr, page, pagePtr, annotationPtr, rect, imageData) {\n    const bytesPerPixel = 4;\n    const pixelCount = imageData.width * imageData.height;\n    const bitmapBufferPtr = this.memoryManager.malloc(bytesPerPixel * pixelCount);\n    if (!bitmapBufferPtr) {\n      return false;\n    }\n    for (let i = 0; i < pixelCount; i++) {\n      const red = imageData.data[i * bytesPerPixel];\n      const green = imageData.data[i * bytesPerPixel + 1];\n      const blue = imageData.data[i * bytesPerPixel + 2];\n      const alpha = imageData.data[i * bytesPerPixel + 3];\n      this.pdfiumModule.pdfium.setValue(bitmapBufferPtr + i * bytesPerPixel, blue, "i8");\n      this.pdfiumModule.pdfium.setValue(bitmapBufferPtr + i * bytesPerPixel + 1, green, "i8");\n      this.pdfiumModule.pdfium.setValue(bitmapBufferPtr + i * bytesPerPixel + 2, red, "i8");\n      this.pdfiumModule.pdfium.setValue(bitmapBufferPtr + i * bytesPerPixel + 3, alpha, "i8");\n    }\n    const format = 4;\n    const bitmapPtr = this.pdfiumModule.FPDFBitmap_CreateEx(\n      imageData.width,\n      imageData.height,\n      format,\n      bitmapBufferPtr,\n      0\n    );\n    if (!bitmapPtr) {\n      this.memoryManager.free(bitmapBufferPtr);\n      return false;\n    }\n    const imageObjectPtr = this.pdfiumModule.FPDFPageObj_NewImageObj(docPtr);\n    if (!imageObjectPtr) {\n      this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n      this.memoryManager.free(bitmapBufferPtr);\n      return false;\n    }\n    if (!this.pdfiumModule.FPDFImageObj_SetBitmap(pagePtr, 0, imageObjectPtr, bitmapPtr)) {\n      this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n      this.pdfiumModule.FPDFPageObj_Destroy(imageObjectPtr);\n      this.memoryManager.free(bitmapBufferPtr);\n      return false;\n    }\n    const matrixPtr = this.memoryManager.malloc(6 * 4);\n    this.pdfiumModule.pdfium.setValue(matrixPtr, imageData.width, "float");\n    this.pdfiumModule.pdfium.setValue(matrixPtr + 4, 0, "float");\n    this.pdfiumModule.pdfium.setValue(matrixPtr + 8, 0, "float");\n    this.pdfiumModule.pdfium.setValue(matrixPtr + 12, imageData.height, "float");\n    this.pdfiumModule.pdfium.setValue(matrixPtr + 16, 0, "float");\n    this.pdfiumModule.pdfium.setValue(matrixPtr + 20, 0, "float");\n    if (!this.pdfiumModule.FPDFPageObj_SetMatrix(imageObjectPtr, matrixPtr)) {\n      this.memoryManager.free(matrixPtr);\n      this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n      this.pdfiumModule.FPDFPageObj_Destroy(imageObjectPtr);\n      this.memoryManager.free(bitmapBufferPtr);\n      return false;\n    }\n    this.memoryManager.free(matrixPtr);\n    const pagePos = this.convertDevicePointToPagePoint(page, {\n      x: rect.origin.x,\n      y: rect.origin.y + imageData.height\n      // shift down by the image height\n    });\n    this.pdfiumModule.FPDFPageObj_Transform(imageObjectPtr, 1, 0, 0, 1, pagePos.x, pagePos.y);\n    if (!this.pdfiumModule.FPDFAnnot_AppendObject(annotationPtr, imageObjectPtr)) {\n      this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n      this.pdfiumModule.FPDFPageObj_Destroy(imageObjectPtr);\n      this.memoryManager.free(bitmapBufferPtr);\n      return false;\n    }\n    this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n    this.memoryManager.free(bitmapBufferPtr);\n    return true;\n  }\n  /**\n   * Save document to array buffer\n   * @param docPtr - pointer to pdf document\n   * @returns array buffer contains the pdf content\n   *\n   * @private\n   */\n  saveDocument(docPtr) {\n    const writerPtr = this.pdfiumModule.PDFiumExt_OpenFileWriter();\n    this.pdfiumModule.PDFiumExt_SaveAsCopy(docPtr, writerPtr);\n    const size = this.pdfiumModule.PDFiumExt_GetFileWriterSize(writerPtr);\n    const dataPtr = this.memoryManager.malloc(size);\n    this.pdfiumModule.PDFiumExt_GetFileWriterData(writerPtr, dataPtr, size);\n    const buffer = new ArrayBuffer(size);\n    const view = new DataView(buffer);\n    for (let i = 0; i < size; i++) {\n      view.setInt8(i, this.pdfiumModule.pdfium.getValue(dataPtr + i, "i8"));\n    }\n    this.memoryManager.free(dataPtr);\n    this.pdfiumModule.PDFiumExt_CloseFileWriter(writerPtr);\n    return buffer;\n  }\n  /**\n   * Read Catalog /Lang via EPDFCatalog_GetLanguage (UTF-16LE → JS string).\n   * Returns:\n   *   null  -> /Lang not present (getter returned 0) OR doc not open,\n   *   \'\'    -> /Lang exists but is explicitly empty,\n   *   \'en\', \'en-US\', ... -> normal tag.\n   *\n   * Note: EPDFCatalog_GetLanguage lengths are BYTES (incl. trailing NUL).\n   *\n   * @private\n   */\n  readCatalogLanguage(docPtr) {\n    const byteLen = this.pdfiumModule.EPDFCatalog_GetLanguage(docPtr, 0, 0) >>> 0;\n    if (byteLen === 0) return null;\n    if (byteLen === 2) return "";\n    return readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => this.pdfiumModule.EPDFCatalog_GetLanguage(docPtr, buffer, bufferLength),\n      this.pdfiumModule.pdfium.UTF16ToString,\n      byteLen\n    );\n  }\n  /**\n   * Read metadata from pdf document\n   * @param docPtr - pointer to pdf document\n   * @param key - key of metadata field\n   * @returns metadata value\n   *\n   * @private\n   */\n  readMetaText(docPtr, key) {\n    const exists = !!this.pdfiumModule.EPDF_HasMetaText(docPtr, key);\n    if (!exists) return null;\n    const len = this.pdfiumModule.FPDF_GetMetaText(docPtr, key, 0, 0);\n    if (len === 2) return "";\n    return readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => this.pdfiumModule.FPDF_GetMetaText(docPtr, key, buffer, bufferLength),\n      this.pdfiumModule.pdfium.UTF16ToString,\n      len\n    );\n  }\n  /**\n   * Write metadata into the PDF\'s Info dictionary.\n   * If `value` is null or empty string, the key is removed.\n   * @param docPtr - pointer to pdf document\n   * @param key - key of metadata field\n   * @param value - value of metadata field\n   * @returns whether metadata is written to the pdf document\n   *\n   * @private\n   */\n  setMetaText(docPtr, key, value) {\n    if (value == null || value.length === 0) {\n      const ok = this.pdfiumModule.EPDF_SetMetaText(docPtr, key, 0);\n      return !!ok;\n    }\n    const bytes = 2 * (value.length + 1);\n    const ptr = this.memoryManager.malloc(bytes);\n    try {\n      this.pdfiumModule.pdfium.stringToUTF16(value, ptr, bytes);\n      const ok = this.pdfiumModule.EPDF_SetMetaText(docPtr, key, ptr);\n      return !!ok;\n    } finally {\n      this.memoryManager.free(ptr);\n    }\n  }\n  /**\n   * Read the document\'s trapped status via PDFium.\n   * Falls back to `Unknown` on unexpected values.\n   *\n   * @private\n   */\n  getMetaTrapped(docPtr) {\n    const raw = Number(this.pdfiumModule.EPDF_GetMetaTrapped(docPtr));\n    switch (raw) {\n      case PdfTrappedStatus.NotSet:\n      case PdfTrappedStatus.True:\n      case PdfTrappedStatus.False:\n      case PdfTrappedStatus.Unknown:\n        return raw;\n      default:\n        return PdfTrappedStatus.Unknown;\n    }\n  }\n  /**\n   * Write (or clear) the document\'s trapped status via PDFium.\n   * Pass `null`/`undefined` to remove the `/Trapped` key.\n   *\n   * @private\n   */\n  setMetaTrapped(docPtr, status) {\n    const toSet = status == null || status === void 0 ? PdfTrappedStatus.NotSet : status;\n    const valid = toSet === PdfTrappedStatus.NotSet || toSet === PdfTrappedStatus.True || toSet === PdfTrappedStatus.False || toSet === PdfTrappedStatus.Unknown;\n    if (!valid) return false;\n    return !!this.pdfiumModule.EPDF_SetMetaTrapped(docPtr, toSet);\n  }\n  /**\n   * Get the number of keys in the document\'s Info dictionary.\n   * @param docPtr - pointer to pdf document\n   * @param customOnly - if true, only count non-reserved (custom) keys; if false, count all keys.\n   * @returns the number of keys (possibly 0). On error, returns 0.\n   *\n   * @private\n   */\n  getMetaKeyCount(docPtr, customOnly) {\n    return Number(this.pdfiumModule.EPDF_GetMetaKeyCount(docPtr, customOnly)) | 0;\n  }\n  /**\n   * Get the name of the Info dictionary key at |index|.\n   * @param docPtr - pointer to pdf document\n   * @param index - 0-based key index in the order returned by PDFium.\n   * @param customOnly - if true, indexes only over non-reserved (custom) keys; if false, indexes over all keys.\n   * @returns the name of the key, or null if the key is not found.\n   *\n   * @private\n   */\n  getMetaKeyName(docPtr, index, customOnly) {\n    const len = this.pdfiumModule.EPDF_GetMetaKeyName(docPtr, index, customOnly, 0, 0);\n    if (!len) return null;\n    return readString(\n      this.pdfiumModule.pdfium,\n      (buffer, buflen) => this.pdfiumModule.EPDF_GetMetaKeyName(docPtr, index, customOnly, buffer, buflen),\n      this.pdfiumModule.pdfium.UTF8ToString,\n      len\n    );\n  }\n  /**\n   * Read all metadata from the document\'s Info dictionary.\n   * @param docPtr - pointer to pdf document\n   * @param customOnly - if true, only read non-reserved (custom) keys; if false, read all keys.\n   * @returns all metadata\n   *\n   * @private\n   */\n  readAllMeta(docPtr, customOnly = true) {\n    const n = this.getMetaKeyCount(docPtr, customOnly);\n    const out = {};\n    for (let i = 0; i < n; i++) {\n      const key = this.getMetaKeyName(docPtr, i, customOnly);\n      if (!key) continue;\n      out[key] = this.readMetaText(docPtr, key);\n    }\n    return out;\n  }\n  /**\n   * Read bookmarks in the pdf document\n   * @param docPtr - pointer to pdf document\n   * @param rootBookmarkPtr - pointer to root bookmark\n   * @returns bookmarks in the pdf document\n   *\n   * @private\n   */\n  readPdfBookmarks(docPtr, rootBookmarkPtr = 0) {\n    let bookmarkPtr = this.pdfiumModule.FPDFBookmark_GetFirstChild(docPtr, rootBookmarkPtr);\n    const bookmarks = [];\n    while (bookmarkPtr) {\n      const bookmark = this.readPdfBookmark(docPtr, bookmarkPtr);\n      bookmarks.push(bookmark);\n      const nextBookmarkPtr = this.pdfiumModule.FPDFBookmark_GetNextSibling(docPtr, bookmarkPtr);\n      bookmarkPtr = nextBookmarkPtr;\n    }\n    return bookmarks;\n  }\n  /**\n   * Read bookmark in the pdf document\n   * @param docPtr - pointer to pdf document\n   * @param bookmarkPtr - pointer to bookmark object\n   * @returns pdf bookmark object\n   *\n   * @private\n   */\n  readPdfBookmark(docPtr, bookmarkPtr) {\n    const title = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFBookmark_GetTitle(bookmarkPtr, buffer, bufferLength);\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const bookmarks = this.readPdfBookmarks(docPtr, bookmarkPtr);\n    const target = this.readPdfBookmarkTarget(\n      docPtr,\n      () => {\n        return this.pdfiumModule.FPDFBookmark_GetAction(bookmarkPtr);\n      },\n      () => {\n        return this.pdfiumModule.FPDFBookmark_GetDest(docPtr, bookmarkPtr);\n      }\n    );\n    return {\n      title,\n      target,\n      children: bookmarks\n    };\n  }\n  /**\n   * Read text rects in pdf page\n   * @param page - pdf page info\n   * @param docPtr - pointer to pdf document\n   * @param pagePtr - pointer to pdf page\n   * @param textPagePtr - pointer to pdf text page\n   * @returns text rects in the pdf page\n   *\n   * @public\n   */\n  readPageTextRects(page, docPtr, pagePtr, textPagePtr) {\n    const rectsCount = this.pdfiumModule.FPDFText_CountRects(textPagePtr, 0, -1);\n    const textRects = [];\n    for (let i = 0; i < rectsCount; i++) {\n      const topPtr = this.memoryManager.malloc(8);\n      const leftPtr = this.memoryManager.malloc(8);\n      const rightPtr = this.memoryManager.malloc(8);\n      const bottomPtr = this.memoryManager.malloc(8);\n      const isSucceed = this.pdfiumModule.FPDFText_GetRect(\n        textPagePtr,\n        i,\n        leftPtr,\n        topPtr,\n        rightPtr,\n        bottomPtr\n      );\n      if (!isSucceed) {\n        this.memoryManager.free(leftPtr);\n        this.memoryManager.free(topPtr);\n        this.memoryManager.free(rightPtr);\n        this.memoryManager.free(bottomPtr);\n        continue;\n      }\n      const left = this.pdfiumModule.pdfium.getValue(leftPtr, "double");\n      const top = this.pdfiumModule.pdfium.getValue(topPtr, "double");\n      const right = this.pdfiumModule.pdfium.getValue(rightPtr, "double");\n      const bottom = this.pdfiumModule.pdfium.getValue(bottomPtr, "double");\n      this.memoryManager.free(leftPtr);\n      this.memoryManager.free(topPtr);\n      this.memoryManager.free(rightPtr);\n      this.memoryManager.free(bottomPtr);\n      const deviceXPtr = this.memoryManager.malloc(4);\n      const deviceYPtr = this.memoryManager.malloc(4);\n      this.pdfiumModule.FPDF_PageToDevice(\n        pagePtr,\n        0,\n        0,\n        page.size.width,\n        page.size.height,\n        0,\n        left,\n        top,\n        deviceXPtr,\n        deviceYPtr\n      );\n      const x = this.pdfiumModule.pdfium.getValue(deviceXPtr, "i32");\n      const y = this.pdfiumModule.pdfium.getValue(deviceYPtr, "i32");\n      this.memoryManager.free(deviceXPtr);\n      this.memoryManager.free(deviceYPtr);\n      const rect = {\n        origin: {\n          x,\n          y\n        },\n        size: {\n          width: Math.ceil(Math.abs(right - left)),\n          height: Math.ceil(Math.abs(top - bottom))\n        }\n      };\n      const utf16Length = this.pdfiumModule.FPDFText_GetBoundedText(\n        textPagePtr,\n        left,\n        top,\n        right,\n        bottom,\n        0,\n        0\n      );\n      const bytesCount = (utf16Length + 1) * 2;\n      const textBuffer = this.memoryManager.malloc(bytesCount);\n      this.pdfiumModule.FPDFText_GetBoundedText(\n        textPagePtr,\n        left,\n        top,\n        right,\n        bottom,\n        textBuffer,\n        utf16Length\n      );\n      const content = this.pdfiumModule.pdfium.UTF16ToString(textBuffer);\n      this.memoryManager.free(textBuffer);\n      const charIndex = this.pdfiumModule.FPDFText_GetCharIndexAtPos(textPagePtr, left, top, 2, 2);\n      let fontFamily = "";\n      let fontSize = rect.size.height;\n      if (charIndex >= 0) {\n        fontSize = this.pdfiumModule.FPDFText_GetFontSize(textPagePtr, charIndex);\n        const fontNameLength = this.pdfiumModule.FPDFText_GetFontInfo(\n          textPagePtr,\n          charIndex,\n          0,\n          0,\n          0\n        );\n        const bytesCount2 = fontNameLength + 1;\n        const textBufferPtr = this.memoryManager.malloc(bytesCount2);\n        const flagsPtr = this.memoryManager.malloc(4);\n        this.pdfiumModule.FPDFText_GetFontInfo(\n          textPagePtr,\n          charIndex,\n          textBufferPtr,\n          bytesCount2,\n          flagsPtr\n        );\n        fontFamily = this.pdfiumModule.pdfium.UTF8ToString(textBufferPtr);\n        this.memoryManager.free(textBufferPtr);\n        this.memoryManager.free(flagsPtr);\n      }\n      const textRect = {\n        content,\n        rect,\n        font: {\n          family: fontFamily,\n          size: fontSize\n        }\n      };\n      textRects.push(textRect);\n    }\n    return textRects;\n  }\n  /**\n   * Return geometric + logical text layout for one page\n   * (glyph-only implementation, no FPDFText_GetRect).\n   *\n   * @public\n   */\n  getPageGeometry(doc, page) {\n    const label = "getPageGeometry";\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, label, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, label, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const textPagePtr = pageCtx.getTextPage();\n    const glyphCount = this.pdfiumModule.FPDFText_CountChars(textPagePtr);\n    const glyphs = [];\n    for (let i = 0; i < glyphCount; i++) {\n      const g = this.readGlyphInfo(page, pageCtx.pagePtr, textPagePtr, i);\n      glyphs.push(g);\n    }\n    const runs = this.buildRunsFromGlyphs(glyphs, textPagePtr);\n    pageCtx.release();\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, label, "End", doc.id);\n    return PdfTaskHelper.resolve({ runs });\n  }\n  /**\n   * Group consecutive glyphs that belong to the same CPDF_TextObject\n   * using FPDFText_GetTextObject(), and calculate rotation from glyph positions.\n   */\n  buildRunsFromGlyphs(glyphs, textPagePtr) {\n    const runs = [];\n    let current = null;\n    let curObjPtr = null;\n    let bounds = null;\n    for (let i = 0; i < glyphs.length; i++) {\n      const g = glyphs[i];\n      const objPtr = this.pdfiumModule.FPDFText_GetTextObject(textPagePtr, i);\n      if (objPtr !== curObjPtr) {\n        curObjPtr = objPtr;\n        current = {\n          rect: {\n            x: g.origin.x,\n            y: g.origin.y,\n            width: g.size.width,\n            height: g.size.height\n          },\n          charStart: i,\n          glyphs: []\n        };\n        bounds = {\n          minX: g.origin.x,\n          minY: g.origin.y,\n          maxX: g.origin.x + g.size.width,\n          maxY: g.origin.y + g.size.height\n        };\n        runs.push(current);\n      }\n      current.glyphs.push({\n        x: g.origin.x,\n        y: g.origin.y,\n        width: g.size.width,\n        height: g.size.height,\n        flags: g.isEmpty ? 2 : g.isSpace ? 1 : 0\n      });\n      if (g.isEmpty) {\n        continue;\n      }\n      const right = g.origin.x + g.size.width;\n      const bottom = g.origin.y + g.size.height;\n      bounds.minX = Math.min(bounds.minX, g.origin.x);\n      bounds.minY = Math.min(bounds.minY, g.origin.y);\n      bounds.maxX = Math.max(bounds.maxX, right);\n      bounds.maxY = Math.max(bounds.maxY, bottom);\n      current.rect.x = bounds.minX;\n      current.rect.y = bounds.minY;\n      current.rect.width = bounds.maxX - bounds.minX;\n      current.rect.height = bounds.maxY - bounds.minY;\n    }\n    return runs;\n  }\n  /**\n   * Extract glyph geometry + metadata for `charIndex`\n   *\n   * Returns device–space coordinates:\n   *   x,y  → **top-left** corner (integer-pixels)\n   *   w,h  → width / height (integer-pixels, ≥ 1)\n   *\n   * And two flags:\n   *   isSpace → true if the glyph\'s Unicode code-point is U+0020\n   */\n  readGlyphInfo(page, pagePtr, textPagePtr, charIndex) {\n    const dx1Ptr = this.memoryManager.malloc(4);\n    const dy1Ptr = this.memoryManager.malloc(4);\n    const dx2Ptr = this.memoryManager.malloc(4);\n    const dy2Ptr = this.memoryManager.malloc(4);\n    const rectPtr = this.memoryManager.malloc(16);\n    let x = 0, y = 0, width = 0, height = 0, isSpace = false;\n    if (this.pdfiumModule.FPDFText_GetLooseCharBox(textPagePtr, charIndex, rectPtr)) {\n      const left = this.pdfiumModule.pdfium.getValue(rectPtr, "float");\n      const top = this.pdfiumModule.pdfium.getValue(rectPtr + 4, "float");\n      const right = this.pdfiumModule.pdfium.getValue(rectPtr + 8, "float");\n      const bottom = this.pdfiumModule.pdfium.getValue(rectPtr + 12, "float");\n      if (left === right || top === bottom) {\n        [rectPtr, dx1Ptr, dy1Ptr, dx2Ptr, dy2Ptr].forEach((p) => this.memoryManager.free(p));\n        return {\n          origin: { x: 0, y: 0 },\n          size: { width: 0, height: 0 },\n          isEmpty: true\n        };\n      }\n      this.pdfiumModule.FPDF_PageToDevice(\n        pagePtr,\n        0,\n        0,\n        page.size.width,\n        page.size.height,\n        /*rotate=*/\n        0,\n        left,\n        top,\n        dx1Ptr,\n        dy1Ptr\n      );\n      this.pdfiumModule.FPDF_PageToDevice(\n        pagePtr,\n        0,\n        0,\n        page.size.width,\n        page.size.height,\n        /*rotate=*/\n        0,\n        right,\n        bottom,\n        dx2Ptr,\n        dy2Ptr\n      );\n      const x1 = this.pdfiumModule.pdfium.getValue(dx1Ptr, "i32");\n      const y1 = this.pdfiumModule.pdfium.getValue(dy1Ptr, "i32");\n      const x2 = this.pdfiumModule.pdfium.getValue(dx2Ptr, "i32");\n      const y2 = this.pdfiumModule.pdfium.getValue(dy2Ptr, "i32");\n      x = Math.min(x1, x2);\n      y = Math.min(y1, y2);\n      width = Math.max(1, Math.abs(x2 - x1));\n      height = Math.max(1, Math.abs(y2 - y1));\n      const uc = this.pdfiumModule.FPDFText_GetUnicode(textPagePtr, charIndex);\n      isSpace = uc === 32;\n    }\n    [rectPtr, dx1Ptr, dy1Ptr, dx2Ptr, dy2Ptr].forEach((p) => this.memoryManager.free(p));\n    return {\n      origin: { x, y },\n      size: { width, height },\n      ...isSpace && { isSpace }\n    };\n  }\n  /**\n   * Geometry-only text extraction\n   * ------------------------------------------\n   * Returns every glyph on the requested page\n   * in the logical order delivered by PDFium.\n   *\n   * The promise resolves to an array of objects:\n   *   {\n   *     idx:     number;            // glyph index on the page (0…n-1)\n   *     origin:  { x: number; y: number };\n   *     size:    { width: number;  height: number };\n   *     angle:   number;            // degrees, counter-clock-wise\n   *     isSpace: boolean;           // true  → U+0020\n   *   }\n   *\n   * No Unicode is included; front-end decides whether to hydrate it.\n   */\n  getPageGlyphs(doc, page) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageGlyphs", doc, page);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageGlyphs", "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageGlyphs", "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const textPagePtr = pageCtx.getTextPage();\n    const total = this.pdfiumModule.FPDFText_CountChars(textPagePtr);\n    const glyphs = new Array(total);\n    for (let i = 0; i < total; i++) {\n      const g = this.readGlyphInfo(page, pageCtx.pagePtr, textPagePtr, i);\n      if (g.isEmpty) {\n        continue;\n      }\n      glyphs[i] = { ...g };\n    }\n    pageCtx.release();\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageGlyphs", "End", doc.id);\n    return PdfTaskHelper.resolve(glyphs);\n  }\n  readCharBox(page, pagePtr, textPagePtr, charIndex) {\n    const topPtr = this.memoryManager.malloc(8);\n    const leftPtr = this.memoryManager.malloc(8);\n    const bottomPtr = this.memoryManager.malloc(8);\n    const rightPtr = this.memoryManager.malloc(8);\n    let x = 0;\n    let y = 0;\n    let width = 0;\n    let height = 0;\n    if (this.pdfiumModule.FPDFText_GetCharBox(\n      textPagePtr,\n      charIndex,\n      leftPtr,\n      rightPtr,\n      bottomPtr,\n      topPtr\n    )) {\n      const top = this.pdfiumModule.pdfium.getValue(topPtr, "double");\n      const left = this.pdfiumModule.pdfium.getValue(leftPtr, "double");\n      const bottom = this.pdfiumModule.pdfium.getValue(bottomPtr, "double");\n      const right = this.pdfiumModule.pdfium.getValue(rightPtr, "double");\n      const deviceXPtr = this.memoryManager.malloc(4);\n      const deviceYPtr = this.memoryManager.malloc(4);\n      this.pdfiumModule.FPDF_PageToDevice(\n        pagePtr,\n        0,\n        0,\n        page.size.width,\n        page.size.height,\n        0,\n        left,\n        top,\n        deviceXPtr,\n        deviceYPtr\n      );\n      x = this.pdfiumModule.pdfium.getValue(deviceXPtr, "i32");\n      y = this.pdfiumModule.pdfium.getValue(deviceYPtr, "i32");\n      this.memoryManager.free(deviceXPtr);\n      this.memoryManager.free(deviceYPtr);\n      width = Math.ceil(Math.abs(right - left));\n      height = Math.ceil(Math.abs(top - bottom));\n    }\n    this.memoryManager.free(topPtr);\n    this.memoryManager.free(leftPtr);\n    this.memoryManager.free(bottomPtr);\n    this.memoryManager.free(rightPtr);\n    return {\n      origin: {\n        x,\n        y\n      },\n      size: {\n        width,\n        height\n      }\n    };\n  }\n  /**\n   * Read page annotations\n   *\n   * @param ctx - document context\n   * @param page - page info\n   * @returns annotations on the pdf page\n   *\n   * @private\n   */\n  readPageAnnotations(ctx, page) {\n    return ctx.borrowPage(page.index, (pageCtx) => {\n      const annotationCount = this.pdfiumModule.FPDFPage_GetAnnotCount(pageCtx.pagePtr);\n      const annotations = [];\n      for (let i = 0; i < annotationCount; i++) {\n        pageCtx.withAnnotation(i, (annotPtr) => {\n          const anno = this.readPageAnnotation(ctx.docPtr, page, annotPtr, pageCtx);\n          if (anno) annotations.push(anno);\n        });\n      }\n      return annotations;\n    });\n  }\n  /**\n   * Read page annotations without loading the page (raw approach)\n   *\n   * @param ctx - document context\n   * @param page - page info\n   * @returns annotations on the pdf page\n   *\n   * @private\n   */\n  readPageAnnotationsRaw(ctx, page) {\n    const count = this.pdfiumModule.EPDFPage_GetAnnotCountRaw(ctx.docPtr, page.index);\n    if (count <= 0) return [];\n    const out = [];\n    for (let i = 0; i < count; ++i) {\n      const annotPtr = this.pdfiumModule.EPDFPage_GetAnnotRaw(ctx.docPtr, page.index, i);\n      if (!annotPtr) continue;\n      try {\n        const anno = this.readPageAnnotation(ctx.docPtr, page, annotPtr);\n        if (anno) out.push(anno);\n      } finally {\n        this.pdfiumModule.FPDFPage_CloseAnnot(annotPtr);\n      }\n    }\n    return out;\n  }\n  /**\n   * Get page annotations (public API, returns Task)\n   *\n   * @param doc - pdf document\n   * @param page - page info\n   * @returns task with annotations on the pdf page\n   *\n   * @public\n   */\n  getPageAnnotationsRaw(doc, page) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getPageAnnotationsRaw", doc, page);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageAnnotationsRaw`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const out = this.readPageAnnotationsRaw(ctx, page);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `GetPageAnnotationsRaw`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    this.logger.debug(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      "getPageAnnotationsRaw",\n      `${doc.id}-${page.index}`,\n      out\n    );\n    return PdfTaskHelper.resolve(out);\n  }\n  /**\n   * Read pdf annotation from pdf document\n   *\n   * @param docPtr - pointer to pdf document\n   * @param page - page info\n   * @param annotationPtr - pointer to pdf annotation\n   * @param pageCtx - page context\n   * @returns pdf annotation\n   *\n   * @private\n   */\n  readPageAnnotation(docPtr, page, annotationPtr, pageCtx) {\n    let index = this.getAnnotString(annotationPtr, "NM");\n    if (!index || !isUuidV4(index)) {\n      index = uuidV4();\n      this.setAnnotString(annotationPtr, "NM", index);\n    }\n    const subType = this.pdfiumModule.FPDFAnnot_GetSubtype(\n      annotationPtr\n    );\n    let annotation;\n    switch (subType) {\n      case PdfAnnotationSubtype.TEXT:\n        {\n          annotation = this.readPdfTextAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.FREETEXT:\n        {\n          annotation = this.readPdfFreeTextAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.LINK:\n        {\n          annotation = this.readPdfLinkAnno(page, docPtr, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.WIDGET:\n        if (pageCtx) {\n          return this.readPdfWidgetAnno(page, annotationPtr, pageCtx.getFormHandle(), index);\n        }\n      case PdfAnnotationSubtype.FILEATTACHMENT:\n        {\n          annotation = this.readPdfFileAttachmentAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.INK:\n        {\n          annotation = this.readPdfInkAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.POLYGON:\n        {\n          annotation = this.readPdfPolygonAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.POLYLINE:\n        {\n          annotation = this.readPdfPolylineAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.LINE:\n        {\n          annotation = this.readPdfLineAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.HIGHLIGHT:\n        annotation = this.readPdfHighlightAnno(page, annotationPtr, index);\n        break;\n      case PdfAnnotationSubtype.STAMP:\n        {\n          annotation = this.readPdfStampAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.SQUARE:\n        {\n          annotation = this.readPdfSquareAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.CIRCLE:\n        {\n          annotation = this.readPdfCircleAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.UNDERLINE:\n        {\n          annotation = this.readPdfUnderlineAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.SQUIGGLY:\n        {\n          annotation = this.readPdfSquigglyAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.STRIKEOUT:\n        {\n          annotation = this.readPdfStrikeOutAnno(page, annotationPtr, index);\n        }\n        break;\n      case PdfAnnotationSubtype.CARET:\n        {\n          annotation = this.readPdfCaretAnno(page, annotationPtr, index);\n        }\n        break;\n      default:\n        {\n          annotation = this.readPdfAnno(page, subType, annotationPtr, index);\n        }\n        break;\n    }\n    return annotation;\n  }\n  /**\n   * Return the colour stored directly in the annotation dictionary\'s `/C` entry.\n   *\n   * Most PDFs created by Acrobat, Microsoft Office, LaTeX, etc. include this entry.\n   * When the key is absent (common in macOS Preview, Chrome, Drawboard) the call\n   * fails and the function returns `undefined`.\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @returns An RGBA tuple (0-255 channels) or `undefined` if no `/C` entry exists\n   *\n   * @private\n   */\n  readAnnotationColor(annotationPtr, colorType = PdfAnnotationColorType.Color) {\n    const rPtr = this.memoryManager.malloc(4);\n    const gPtr = this.memoryManager.malloc(4);\n    const bPtr = this.memoryManager.malloc(4);\n    const ok = this.pdfiumModule.EPDFAnnot_GetColor(annotationPtr, colorType, rPtr, gPtr, bPtr);\n    let colour;\n    if (ok) {\n      colour = {\n        red: this.pdfiumModule.pdfium.getValue(rPtr, "i32") & 255,\n        green: this.pdfiumModule.pdfium.getValue(gPtr, "i32") & 255,\n        blue: this.pdfiumModule.pdfium.getValue(bPtr, "i32") & 255\n      };\n    }\n    this.memoryManager.free(rPtr);\n    this.memoryManager.free(gPtr);\n    this.memoryManager.free(bPtr);\n    return colour;\n  }\n  /**\n   * Get the fill/stroke colour annotation.\n   *\n   * @param annotationPtr - pointer to the annotation whose colour is being set\n   * @param colorType - which colour to get (0 = fill, 1 = stroke)\n   * @returns WebColor with hex color\n   *\n   * @private\n   */\n  getAnnotationColor(annotationPtr, colorType = PdfAnnotationColorType.Color) {\n    const annotationColor = this.readAnnotationColor(annotationPtr, colorType);\n    return annotationColor ? pdfColorToWebColor(annotationColor) : void 0;\n  }\n  /**\n   * Set the fill/stroke colour for a **Highlight / Underline / StrikeOut / Squiggly** markup annotation.\n   *\n   * @param annotationPtr - pointer to the annotation whose colour is being set\n   * @param webAlphaColor - WebAlphaColor with hex color and opacity (0-1)\n   * @param shouldClearAP - whether to clear the /AP entry\n   * @param which - which colour to set (0 = fill, 1 = stroke)\n   * @returns `true` if the operation was successful\n   *\n   * @private\n   */\n  setAnnotationColor(annotationPtr, webColor, colorType = PdfAnnotationColorType.Color) {\n    const pdfColor = webColorToPdfColor(webColor);\n    return this.pdfiumModule.EPDFAnnot_SetColor(\n      annotationPtr,\n      colorType,\n      pdfColor.red & 255,\n      pdfColor.green & 255,\n      pdfColor.blue & 255\n    );\n  }\n  /**\n   * Get the opacity of the annotation.\n   *\n   * @param annotationPtr - pointer to the annotation whose opacity is being set\n   * @returns opacity (0-1)\n   *\n   * @private\n   */\n  getAnnotationOpacity(annotationPtr) {\n    const opacityPtr = this.memoryManager.malloc(4);\n    const ok = this.pdfiumModule.EPDFAnnot_GetOpacity(annotationPtr, opacityPtr);\n    const opacity = ok ? this.pdfiumModule.pdfium.getValue(opacityPtr, "i32") : 255;\n    this.memoryManager.free(opacityPtr);\n    return pdfAlphaToWebOpacity(opacity);\n  }\n  /**\n   * Set the opacity of the annotation.\n   *\n   * @param annotationPtr - pointer to the annotation whose opacity is being set\n   * @param opacity - opacity (0-1)\n   * @returns true on success\n   *\n   * @private\n   */\n  setAnnotationOpacity(annotationPtr, opacity) {\n    const pdfOpacity = webOpacityToPdfAlpha(opacity);\n    return this.pdfiumModule.EPDFAnnot_SetOpacity(annotationPtr, pdfOpacity & 255);\n  }\n  /**\n   * Fetch the `/Q` text-alignment value from a **FreeText** annotation.\n   *\n   * @param annotationPtr pointer returned by `FPDFPage_GetAnnot`\n   * @returns `PdfTextAlignment`\n   */\n  getAnnotationTextAlignment(annotationPtr) {\n    return this.pdfiumModule.EPDFAnnot_GetTextAlignment(annotationPtr);\n  }\n  /**\n   * Write the `/Q` text-alignment value into a **FreeText** annotation\n   * and clear the existing appearance stream so it can be regenerated.\n   *\n   * @param annotationPtr pointer returned by `FPDFPage_GetAnnot`\n   * @param alignment     `PdfTextAlignment`\n   * @returns `true` on success\n   */\n  setAnnotationTextAlignment(annotationPtr, alignment) {\n    return !!this.pdfiumModule.EPDFAnnot_SetTextAlignment(annotationPtr, alignment);\n  }\n  /**\n   * Fetch the `/EPDF:VerticalAlignment` vertical-alignment value from a **FreeText** annotation.\n   *\n   * @param annotationPtr pointer returned by `FPDFPage_GetAnnot`\n   * @returns `PdfVerticalAlignment`\n   */\n  getAnnotationVerticalAlignment(annotationPtr) {\n    return this.pdfiumModule.EPDFAnnot_GetVerticalAlignment(annotationPtr);\n  }\n  /**\n   * Write the `/EPDF:VerticalAlignment` vertical-alignment value into a **FreeText** annotation\n   * and clear the existing appearance stream so it can be regenerated.\n   *\n   * @param annotationPtr pointer returned by `FPDFPage_GetAnnot`\n   * @param alignment     `PdfVerticalAlignment`\n   * @returns `true` on success\n   */\n  setAnnotationVerticalAlignment(annotationPtr, alignment) {\n    return !!this.pdfiumModule.EPDFAnnot_SetVerticalAlignment(annotationPtr, alignment);\n  }\n  /**\n   * Return the **default appearance** (font, size, colour) declared in the\n   * `/DA` string of a **FreeText** annotation.\n   *\n   * @param annotationPtr  pointer to `FPDF_ANNOTATION`\n   * @returns `{ font, fontSize, color }` or `undefined` when PDFium returns false\n   *\n   * NOTE – `font` is the raw `FPDF_STANDARD_FONT` enum value that PDFium uses\n   *        (same range as the C API: 0 = Courier, 12 = ZapfDingbats, …).\n   */\n  getAnnotationDefaultAppearance(annotationPtr) {\n    const fontPtr = this.memoryManager.malloc(4);\n    const sizePtr = this.memoryManager.malloc(4);\n    const rPtr = this.memoryManager.malloc(4);\n    const gPtr = this.memoryManager.malloc(4);\n    const bPtr = this.memoryManager.malloc(4);\n    const ok = !!this.pdfiumModule.EPDFAnnot_GetDefaultAppearance(\n      annotationPtr,\n      fontPtr,\n      sizePtr,\n      rPtr,\n      gPtr,\n      bPtr\n    );\n    if (!ok) {\n      [fontPtr, sizePtr, rPtr, gPtr, bPtr].forEach((p) => this.memoryManager.free(p));\n      return;\n    }\n    const pdf = this.pdfiumModule.pdfium;\n    const font = pdf.getValue(fontPtr, "i32");\n    const fontSize = pdf.getValue(sizePtr, "float");\n    const red = pdf.getValue(rPtr, "i32") & 255;\n    const green = pdf.getValue(gPtr, "i32") & 255;\n    const blue = pdf.getValue(bPtr, "i32") & 255;\n    [fontPtr, sizePtr, rPtr, gPtr, bPtr].forEach((p) => this.memoryManager.free(p));\n    return {\n      fontFamily: font,\n      fontSize,\n      fontColor: pdfColorToWebColor({ red, green, blue })\n    };\n  }\n  /**\n   * Write a **default appearance** (`/DA`) into a FreeText annotation.\n   *\n   * @param annotationPtr pointer to `FPDF_ANNOTATION`\n   * @param font          `FPDF_STANDARD_FONT` enum value\n   * @param fontSize      size in points (≥ 0)\n   * @param color         CSS-style `#rrggbb` string (alpha ignored)\n   * @returns `true` on success\n   */\n  setAnnotationDefaultAppearance(annotationPtr, font, fontSize, color) {\n    const { red, green, blue } = webColorToPdfColor(color);\n    return !!this.pdfiumModule.EPDFAnnot_SetDefaultAppearance(\n      annotationPtr,\n      font,\n      fontSize,\n      red & 255,\n      green & 255,\n      blue & 255\n    );\n  }\n  /**\n   * Border‐style + width helper\n   *\n   * Tries the new PDFium helper `EPDFAnnot_GetBorderStyle()` (patch series\n   * 9 July 2025).\n   *\n   * @param  annotationPtr  pointer to an `FPDF_ANNOTATION`\n   * @returns `{ ok, style, width }`\n   *          • `ok`     – `true` when the call succeeded\n   *          • `style`  – `PdfAnnotationBorderStyle` enum\n   *          • `width`  – stroke-width in points (defaults to 0 pt)\n   */\n  getBorderStyle(annotationPtr) {\n    const widthPtr = this.memoryManager.malloc(4);\n    let width = 0;\n    let style = PdfAnnotationBorderStyle.UNKNOWN;\n    let ok = false;\n    style = this.pdfiumModule.EPDFAnnot_GetBorderStyle(annotationPtr, widthPtr);\n    width = this.pdfiumModule.pdfium.getValue(widthPtr, "float");\n    ok = style !== PdfAnnotationBorderStyle.UNKNOWN;\n    this.memoryManager.free(widthPtr);\n    return { ok, style, width };\n  }\n  setBorderStyle(annotationPtr, style, width) {\n    return this.pdfiumModule.EPDFAnnot_SetBorderStyle(annotationPtr, style, width);\n  }\n  /**\n   * Get the icon of the annotation\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @returns `PdfAnnotationIcon`\n   */\n  getAnnotationIcon(annotationPtr) {\n    return this.pdfiumModule.EPDFAnnot_GetIcon(annotationPtr);\n  }\n  /**\n   * Set the icon of the annotation\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @param icon - `PdfAnnotationIcon`\n   * @returns `true` on success\n   */\n  setAnnotationIcon(annotationPtr, icon) {\n    return this.pdfiumModule.EPDFAnnot_SetIcon(annotationPtr, icon);\n  }\n  /**\n   * Border-effect (“cloudy”) helper\n   *\n   * Calls the new PDFium function `EPDFAnnot_GetBorderEffect()` (July 2025).\n   *\n   * @param  annotationPtr  pointer to an `FPDF_ANNOTATION`\n   * @returns `{ ok, intensity }`\n   *          • `ok`        – `true` when the annotation *does* have a\n   *                          valid cloudy-border effect\n   *          • `intensity` – radius/intensity value (0 when `ok` is false)\n   */\n  getBorderEffect(annotationPtr) {\n    const intensityPtr = this.memoryManager.malloc(4);\n    const ok = !!this.pdfiumModule.EPDFAnnot_GetBorderEffect(annotationPtr, intensityPtr);\n    const intensity = ok ? this.pdfiumModule.pdfium.getValue(intensityPtr, "float") : 0;\n    this.memoryManager.free(intensityPtr);\n    return { ok, intensity };\n  }\n  /**\n   * Rectangle-differences helper ( /RD array on Square / Circle annots )\n   *\n   * Calls `EPDFAnnot_GetRectangleDifferences()` introduced in July 2025.\n   *\n   * @param  annotationPtr  pointer to an `FPDF_ANNOTATION`\n   * @returns `{ ok, left, top, right, bottom }`\n   *          • `ok`     – `true` when the annotation *has* an /RD entry\n   *          • the four floats are 0 when `ok` is false\n   */\n  getRectangleDifferences(annotationPtr) {\n    const lPtr = this.memoryManager.malloc(4);\n    const tPtr = this.memoryManager.malloc(4);\n    const rPtr = this.memoryManager.malloc(4);\n    const bPtr = this.memoryManager.malloc(4);\n    const ok = !!this.pdfiumModule.EPDFAnnot_GetRectangleDifferences(\n      annotationPtr,\n      lPtr,\n      tPtr,\n      rPtr,\n      bPtr\n    );\n    const pdf = this.pdfiumModule.pdfium;\n    const left = pdf.getValue(lPtr, "float");\n    const top = pdf.getValue(tPtr, "float");\n    const right = pdf.getValue(rPtr, "float");\n    const bottom = pdf.getValue(bPtr, "float");\n    this.memoryManager.free(lPtr);\n    this.memoryManager.free(tPtr);\n    this.memoryManager.free(rPtr);\n    this.memoryManager.free(bPtr);\n    return { ok, left, top, right, bottom };\n  }\n  /**\n   * Get the date of the annotation\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @param key - \'M\' for modified date, \'CreationDate\' for creation date\n   * @returns `Date` or `undefined` when PDFium can\'t read the date\n   */\n  getAnnotationDate(annotationPtr, key) {\n    const raw = this.getAnnotString(annotationPtr, key);\n    return raw ? pdfDateToDate(raw) : void 0;\n  }\n  /**\n   * Set the date of the annotation\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @param key - \'M\' for modified date, \'CreationDate\' for creation date\n   * @param date - `Date` to set\n   * @returns `true` on success\n   */\n  setAnnotationDate(annotationPtr, key, date) {\n    const raw = dateToPdfDate(date);\n    return this.setAnnotString(annotationPtr, key, raw);\n  }\n  /**\n   * Get the date of the attachment\n   *\n   * @param attachmentPtr - pointer to an `FPDF_ATTACHMENT`\n   * @param key - \'ModDate\' for modified date, \'CreationDate\' for creation date\n   * @returns `Date` or `undefined` when PDFium can\'t read the date\n   */\n  getAttachmentDate(attachmentPtr, key) {\n    const raw = this.getAttachmentString(attachmentPtr, key);\n    return raw ? pdfDateToDate(raw) : void 0;\n  }\n  /**\n   * Set the date of the attachment\n   *\n   * @param attachmentPtr - pointer to an `FPDF_ATTACHMENT`\n   * @param key - \'ModDate\' for modified date, \'CreationDate\' for creation date\n   * @param date - `Date` to set\n   * @returns `true` on success\n   */\n  setAttachmentDate(attachmentPtr, key, date) {\n    const raw = dateToPdfDate(date);\n    return this.setAttachmentString(attachmentPtr, key, raw);\n  }\n  /**\n   * Dash-pattern helper ( /BS → /D array, dashed borders only )\n   *\n   * Uses the two new PDFium helpers:\n   *   • `EPDFAnnot_GetBorderDashPatternCount`\n   *   • `EPDFAnnot_GetBorderDashPattern`\n   *\n   * @param  annotationPtr  pointer to an `FPDF_ANNOTATION`\n   * @returns `{ ok, pattern }`\n   *          • `ok`       – `true` when the annot is dashed *and* the array\n   *                          was retrieved successfully\n   *          • `pattern`  – numeric array of dash/space lengths (empty when `ok` is false)\n   */\n  getBorderDashPattern(annotationPtr) {\n    const count = this.pdfiumModule.EPDFAnnot_GetBorderDashPatternCount(annotationPtr);\n    if (count === 0) {\n      return { ok: false, pattern: [] };\n    }\n    const arrPtr = this.memoryManager.malloc(4 * count);\n    const okNative = !!this.pdfiumModule.EPDFAnnot_GetBorderDashPattern(\n      annotationPtr,\n      arrPtr,\n      count\n    );\n    const pattern = [];\n    if (okNative) {\n      const pdf = this.pdfiumModule.pdfium;\n      for (let i = 0; i < count; i++) {\n        pattern.push(pdf.getValue(arrPtr + 4 * i, "float"));\n      }\n    }\n    this.memoryManager.free(arrPtr);\n    return { ok: okNative, pattern };\n  }\n  /**\n   * Write the /BS /D dash pattern array for an annotation border.\n   *\n   * @param annotationPtr Pointer to FPDF_ANNOTATION\n   * @param pattern       Array of dash/space lengths in *points* (e.g. [3, 2])\n   *                      Empty array clears the pattern (solid line).\n   * @returns true on success\n   *\n   * @private\n   */\n  setBorderDashPattern(annotationPtr, pattern) {\n    if (!pattern || pattern.length === 0) {\n      return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(annotationPtr, 0, 0);\n    }\n    const clean = pattern.map((n) => Number.isFinite(n) && n > 0 ? n : 0).filter((n) => n > 0);\n    if (clean.length === 0) {\n      return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(annotationPtr, 0, 0);\n    }\n    const bytes = 4 * clean.length;\n    const bufPtr = this.memoryManager.malloc(bytes);\n    for (let i = 0; i < clean.length; i++) {\n      this.pdfiumModule.pdfium.setValue(bufPtr + 4 * i, clean[i], "float");\n    }\n    const ok = !!this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(\n      annotationPtr,\n      bufPtr,\n      clean.length\n    );\n    this.memoryManager.free(bufPtr);\n    return ok;\n  }\n  /**\n   * Return the `/LE` array (start/end line-ending styles) for a LINE / POLYLINE annot.\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @returns `{ start, end }` or `undefined` when PDFium can\'t read them\n   *\n   * @private\n   */\n  getLineEndings(annotationPtr) {\n    const startPtr = this.memoryManager.malloc(4);\n    const endPtr = this.memoryManager.malloc(4);\n    const ok = !!this.pdfiumModule.EPDFAnnot_GetLineEndings(annotationPtr, startPtr, endPtr);\n    if (!ok) {\n      this.memoryManager.free(startPtr);\n      this.memoryManager.free(endPtr);\n      return void 0;\n    }\n    const start = this.pdfiumModule.pdfium.getValue(startPtr, "i32");\n    const end = this.pdfiumModule.pdfium.getValue(endPtr, "i32");\n    this.memoryManager.free(startPtr);\n    this.memoryManager.free(endPtr);\n    return { start, end };\n  }\n  /**\n   * Write the `/LE` array (start/end line-ending styles) for a LINE / POLYLINE annot.\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @param start - start line ending style\n   * @param end - end line ending style\n   * @returns `true` on success\n   */\n  setLineEndings(annotationPtr, start, end) {\n    return !!this.pdfiumModule.EPDFAnnot_SetLineEndings(annotationPtr, start, end);\n  }\n  /**\n   * Get the start and end points of a LINE / POLYLINE annot.\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @param page - logical page info object (`PdfPageObject`)\n   * @returns `{ start, end }` or `undefined` when PDFium can\'t read them\n   */\n  getLinePoints(page, annotationPtr) {\n    const startPtr = this.memoryManager.malloc(8);\n    const endPtr = this.memoryManager.malloc(8);\n    const ok = this.pdfiumModule.FPDFAnnot_GetLine(annotationPtr, startPtr, endPtr);\n    if (!ok) {\n      this.memoryManager.free(startPtr);\n      this.memoryManager.free(endPtr);\n      return void 0;\n    }\n    const pdf = this.pdfiumModule.pdfium;\n    const sx = pdf.getValue(startPtr + 0, "float");\n    const sy = pdf.getValue(startPtr + 4, "float");\n    const ex = pdf.getValue(endPtr + 0, "float");\n    const ey = pdf.getValue(endPtr + 4, "float");\n    this.memoryManager.free(startPtr);\n    this.memoryManager.free(endPtr);\n    const start = this.convertPagePointToDevicePoint(page, { x: sx, y: sy });\n    const end = this.convertPagePointToDevicePoint(page, { x: ex, y: ey });\n    return { start, end };\n  }\n  /**\n   * Set the two end‑points of a **Line** annotation\n   * by writing a new /L array `[ x1 y1 x2 y2 ]`.\n   * @param page - logical page info object (`PdfPageObject`)\n   * @param annotPtr - pointer to the annotation whose line points are needed\n   * @param start - start point\n   * @param end - end point\n   * @returns true on success\n   */\n  setLinePoints(page, annotPtr, start, end) {\n    const p1 = this.convertDevicePointToPagePoint(page, start);\n    const p2 = this.convertDevicePointToPagePoint(page, end);\n    if (!p1 || !p2) return false;\n    const buf = this.memoryManager.malloc(16);\n    const pdf = this.pdfiumModule.pdfium;\n    pdf.setValue(buf + 0, p1.x, "float");\n    pdf.setValue(buf + 4, p1.y, "float");\n    pdf.setValue(buf + 8, p2.x, "float");\n    pdf.setValue(buf + 12, p2.y, "float");\n    const ok = this.pdfiumModule.EPDFAnnot_SetLine(annotPtr, buf, buf + 8);\n    this.memoryManager.free(buf);\n    return !!ok;\n  }\n  /**\n   * Read `/QuadPoints` from any annotation and convert each quadrilateral to\n   * device-space coordinates.\n   *\n   * The four points are returned in natural reading order:\n   *   `p1 → p2` (top edge) and `p4 → p3` (bottom edge).\n   * This preserves the true shape for rotated / skewed text, whereas callers\n   * that only need axis-aligned boxes can collapse each quad themselves.\n   *\n   * @param page          - logical page info object (`PdfPageObject`)\n   * @param annotationPtr - pointer to the annotation whose quads are needed\n   * @returns Array of `Rect` objects (`[]` if the annotation has no quads)\n   *\n   * @private\n   */\n  getQuadPointsAnno(page, annotationPtr) {\n    const quadCount = this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(annotationPtr);\n    if (quadCount === 0) return [];\n    const FS_QUADPOINTSF_SIZE = 8 * 4;\n    const quads = [];\n    for (let qi = 0; qi < quadCount; qi++) {\n      const quadPtr = this.memoryManager.malloc(FS_QUADPOINTSF_SIZE);\n      const ok = this.pdfiumModule.FPDFAnnot_GetAttachmentPoints(annotationPtr, qi, quadPtr);\n      if (ok) {\n        const xs = [];\n        const ys = [];\n        for (let i = 0; i < 4; i++) {\n          const base = quadPtr + i * 8;\n          xs.push(this.pdfiumModule.pdfium.getValue(base, "float"));\n          ys.push(this.pdfiumModule.pdfium.getValue(base + 4, "float"));\n        }\n        const p1 = this.convertPagePointToDevicePoint(page, { x: xs[0], y: ys[0] });\n        const p2 = this.convertPagePointToDevicePoint(page, { x: xs[1], y: ys[1] });\n        const p3 = this.convertPagePointToDevicePoint(page, { x: xs[2], y: ys[2] });\n        const p4 = this.convertPagePointToDevicePoint(page, { x: xs[3], y: ys[3] });\n        quads.push({ p1, p2, p3, p4 });\n      }\n      this.memoryManager.free(quadPtr);\n    }\n    return quads.map(quadToRect);\n  }\n  /**\n   * Set the quadrilaterals for a **Highlight / Underline / StrikeOut / Squiggly** markup annotation.\n   *\n   * @param page          - logical page info object (`PdfPageObject`)\n   * @param annotationPtr - pointer to the annotation whose quads are needed\n   * @param rects         - array of `Rect` objects (`[]` if the annotation has no quads)\n   * @returns `true` if the operation was successful\n   *\n   * @private\n   */\n  syncQuadPointsAnno(page, annotPtr, rects) {\n    const FS_QUADPOINTSF_SIZE = 8 * 4;\n    const pdf = this.pdfiumModule.pdfium;\n    const count = this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(annotPtr);\n    const buf = this.memoryManager.malloc(FS_QUADPOINTSF_SIZE);\n    const writeQuad = (r) => {\n      const q = rectToQuad(r);\n      const p1 = this.convertDevicePointToPagePoint(page, q.p1);\n      const p2 = this.convertDevicePointToPagePoint(page, q.p2);\n      const p3 = this.convertDevicePointToPagePoint(page, q.p3);\n      const p4 = this.convertDevicePointToPagePoint(page, q.p4);\n      pdf.setValue(buf + 0, p1.x, "float");\n      pdf.setValue(buf + 4, p1.y, "float");\n      pdf.setValue(buf + 8, p2.x, "float");\n      pdf.setValue(buf + 12, p2.y, "float");\n      pdf.setValue(buf + 16, p4.x, "float");\n      pdf.setValue(buf + 20, p4.y, "float");\n      pdf.setValue(buf + 24, p3.x, "float");\n      pdf.setValue(buf + 28, p3.y, "float");\n    };\n    const min = Math.min(count, rects.length);\n    for (let i = 0; i < min; i++) {\n      writeQuad(rects[i]);\n      if (!this.pdfiumModule.FPDFAnnot_SetAttachmentPoints(annotPtr, i, buf)) {\n        this.memoryManager.free(buf);\n        return false;\n      }\n    }\n    for (let i = count; i < rects.length; i++) {\n      writeQuad(rects[i]);\n      if (!this.pdfiumModule.FPDFAnnot_AppendAttachmentPoints(annotPtr, buf)) {\n        this.memoryManager.free(buf);\n        return false;\n      }\n    }\n    this.memoryManager.free(buf);\n    return true;\n  }\n  /**\n   * Redact text that intersects ANY of the provided **quads** (device-space).\n   * Returns `true` if the page changed. Always regenerates the page stream.\n   */\n  redactTextInRects(doc, page, rects, options) {\n    const { recurseForms = true, drawBlackBoxes = false } = options ?? {};\n    this.logger.debug(\n      "PDFiumEngine",\n      "Engine",\n      "redactTextInQuads",\n      doc.id,\n      page.index,\n      rects.length\n    );\n    const label = "RedactTextInQuads";\n    this.logger.perf("PDFiumEngine", "Engine", label, "Begin", `${doc.id}-${page.index}`);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf("PDFiumEngine", "Engine", label, "End", `${doc.id}-${page.index}`);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const clean = (rects ?? []).filter(\n      (r) => {\n        var _a, _b, _c, _d;\n        return r && Number.isFinite((_a = r.origin) == null ? void 0 : _a.x) && Number.isFinite((_b = r.origin) == null ? void 0 : _b.y) && Number.isFinite((_c = r.size) == null ? void 0 : _c.width) && Number.isFinite((_d = r.size) == null ? void 0 : _d.height) && r.size.width > 0 && r.size.height > 0;\n      }\n    );\n    if (clean.length === 0) {\n      this.logger.perf("PDFiumEngine", "Engine", label, "End", `${doc.id}-${page.index}`);\n      return PdfTaskHelper.resolve(false);\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const { ptr, count } = this.allocFSQuadsBufferFromRects(page, clean);\n    let ok = false;\n    try {\n      ok = !!this.pdfiumModule.EPDFText_RedactInQuads(\n        pageCtx.pagePtr,\n        ptr,\n        count,\n        recurseForms ? true : false,\n        drawBlackBoxes ? true : false\n      );\n    } finally {\n      this.memoryManager.free(ptr);\n    }\n    if (ok) {\n      ok = !!this.pdfiumModule.FPDFPage_GenerateContent(pageCtx.pagePtr);\n    }\n    pageCtx.disposeImmediate();\n    this.logger.perf("PDFiumEngine", "Engine", label, "End", `${doc.id}-${page.index}`);\n    return PdfTaskHelper.resolve(!!ok);\n  }\n  /** Pack device-space Rects into an FS_QUADPOINTSF[] buffer (page space). */\n  allocFSQuadsBufferFromRects(page, rects) {\n    const STRIDE = 32;\n    const count = rects.length;\n    const ptr = this.memoryManager.malloc(STRIDE * count);\n    const pdf = this.pdfiumModule.pdfium;\n    for (let i = 0; i < count; i++) {\n      const r = rects[i];\n      const q = rectToQuad(r);\n      const p1 = this.convertDevicePointToPagePoint(page, q.p1);\n      const p2 = this.convertDevicePointToPagePoint(page, q.p2);\n      const p3 = this.convertDevicePointToPagePoint(page, q.p3);\n      const p4 = this.convertDevicePointToPagePoint(page, q.p4);\n      const base = ptr + i * STRIDE;\n      pdf.setValue(base + 0, p1.x, "float");\n      pdf.setValue(base + 4, p1.y, "float");\n      pdf.setValue(base + 8, p2.x, "float");\n      pdf.setValue(base + 12, p2.y, "float");\n      pdf.setValue(base + 16, p4.x, "float");\n      pdf.setValue(base + 20, p4.y, "float");\n      pdf.setValue(base + 24, p3.x, "float");\n      pdf.setValue(base + 28, p3.y, "float");\n    }\n    return { ptr, count };\n  }\n  /**\n   * Read ink list from annotation\n   * @param page  - logical page info object (`PdfPageObject`)\n   * @param pagePtr - pointer to the page\n   * @param annotationPtr - pointer to the annotation whose ink list is needed\n   * @returns ink list\n   */\n  getInkList(page, annotationPtr) {\n    const inkList = [];\n    const pathCount = this.pdfiumModule.FPDFAnnot_GetInkListCount(annotationPtr);\n    if (pathCount <= 0) return inkList;\n    const pdf = this.pdfiumModule.pdfium;\n    const POINT_STRIDE = 8;\n    for (let i = 0; i < pathCount; i++) {\n      const points = [];\n      const n = this.pdfiumModule.FPDFAnnot_GetInkListPath(annotationPtr, i, 0, 0);\n      if (n > 0) {\n        const buf = this.memoryManager.malloc(n * POINT_STRIDE);\n        this.pdfiumModule.FPDFAnnot_GetInkListPath(annotationPtr, i, buf, n);\n        for (let j = 0; j < n; j++) {\n          const base = buf + j * POINT_STRIDE;\n          const px = pdf.getValue(base + 0, "float");\n          const py = pdf.getValue(base + 4, "float");\n          const d = this.convertPagePointToDevicePoint(page, { x: px, y: py });\n          points.push({ x: d.x, y: d.y });\n        }\n        this.memoryManager.free(buf);\n      }\n      inkList.push({ points });\n    }\n    return inkList;\n  }\n  /**\n   * Add ink list to annotation\n   * @param page  - logical page info object (`PdfPageObject`)\n   * @param pagePtr - pointer to the page\n   * @param annotationPtr - pointer to the annotation whose ink list is needed\n   * @param inkList - ink list array of `PdfInkListObject`\n   * @returns `true` if the operation was successful\n   */\n  setInkList(page, annotationPtr, inkList) {\n    const pdf = this.pdfiumModule.pdfium;\n    const POINT_STRIDE = 8;\n    for (const stroke of inkList) {\n      const n = stroke.points.length;\n      if (n === 0) continue;\n      const buf = this.memoryManager.malloc(n * POINT_STRIDE);\n      for (let i = 0; i < n; i++) {\n        const pDev = stroke.points[i];\n        const pPage = this.convertDevicePointToPagePoint(page, pDev);\n        pdf.setValue(buf + i * POINT_STRIDE + 0, pPage.x, "float");\n        pdf.setValue(buf + i * POINT_STRIDE + 4, pPage.y, "float");\n      }\n      const idx = this.pdfiumModule.FPDFAnnot_AddInkStroke(annotationPtr, buf, n);\n      this.memoryManager.free(buf);\n      if (idx === -1) {\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n   * Read pdf text annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf text annotation\n   *\n   * @private\n   */\n  readPdfTextAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const annoRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, annoRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const state = this.getAnnotString(annotationPtr, "State");\n    const stateModel = this.getAnnotString(annotationPtr, "StateModel");\n    const color = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const inReplyToId = this.getInReplyToId(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const icon = this.getAnnotationIcon(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.TEXT,\n      flags,\n      contents,\n      color: color ?? "#FFFF00",\n      opacity,\n      rect,\n      inReplyToId,\n      author,\n      modified,\n      created,\n      state,\n      stateModel,\n      icon\n    };\n  }\n  /**\n   * Read pdf freetext annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf freetext annotation\n   *\n   * @private\n   */\n  readPdfFreeTextAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const annoRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, annoRect);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const defaultStyle = this.getAnnotString(annotationPtr, "DS");\n    const da = this.getAnnotationDefaultAppearance(annotationPtr);\n    const backgroundColor = this.getAnnotationColor(annotationPtr);\n    const textAlign = this.getAnnotationTextAlignment(annotationPtr);\n    const verticalAlign = this.getAnnotationVerticalAlignment(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const richContent = this.getAnnotRichContent(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.FREETEXT,\n      fontFamily: (da == null ? void 0 : da.fontFamily) ?? PdfStandardFont.Unknown,\n      fontSize: (da == null ? void 0 : da.fontSize) ?? 12,\n      fontColor: (da == null ? void 0 : da.fontColor) ?? "#000000",\n      verticalAlign,\n      backgroundColor,\n      flags,\n      opacity,\n      textAlign,\n      defaultStyle,\n      richContent,\n      contents,\n      author,\n      modified,\n      created,\n      rect\n    };\n  }\n  /**\n   * Read pdf link annotation from pdf document\n   * @param page  - pdf page infor\n   * @param docPtr - pointer to pdf document object\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf link annotation\n   *\n   * @private\n   */\n  readPdfLinkAnno(page, docPtr, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const linkPtr = this.pdfiumModule.FPDFAnnot_GetLink(annotationPtr);\n    if (!linkPtr) {\n      return;\n    }\n    const annoRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, annoRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const target = this.readPdfLinkAnnoTarget(\n      docPtr,\n      () => {\n        return this.pdfiumModule.FPDFLink_GetAction(linkPtr);\n      },\n      () => {\n        return this.pdfiumModule.FPDFLink_GetDest(docPtr, linkPtr);\n      }\n    );\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.LINK,\n      flags,\n      target,\n      rect,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf widget annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param formHandle - form handle\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf widget annotation\n   *\n   * @private\n   */\n  readPdfWidgetAnno(page, annotationPtr, formHandle, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const field = this.readPdfWidgetAnnoField(formHandle, annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.WIDGET,\n      flags,\n      rect,\n      field,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf file attachment annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf file attachment annotation\n   *\n   * @private\n   */\n  readPdfFileAttachmentAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.FILEATTACHMENT,\n      flags,\n      rect,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf ink annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf ink annotation\n   *\n   * @private\n   */\n  readPdfInkAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const color = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const { width: strokeWidth } = this.getBorderStyle(annotationPtr);\n    const inkList = this.getInkList(page, annotationPtr);\n    const blendMode = this.pdfiumModule.EPDFAnnot_GetBlendMode(annotationPtr);\n    const intent = this.getAnnotIntent(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.INK,\n      ...intent && { intent },\n      contents,\n      blendMode,\n      flags,\n      color: color ?? "#FF0000",\n      opacity,\n      strokeWidth: strokeWidth === 0 ? 1 : strokeWidth,\n      rect,\n      inkList,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf polygon annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf polygon annotation\n   *\n   * @private\n   */\n  readPdfPolygonAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const vertices = this.readPdfAnnoVertices(page, annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const strokeColor = this.getAnnotationColor(annotationPtr);\n    const interiorColor = this.getAnnotationColor(\n      annotationPtr,\n      PdfAnnotationColorType.InteriorColor\n    );\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    let { style: strokeStyle, width: strokeWidth } = this.getBorderStyle(annotationPtr);\n    let strokeDashArray;\n    if (strokeStyle === PdfAnnotationBorderStyle.DASHED) {\n      const { ok, pattern } = this.getBorderDashPattern(annotationPtr);\n      if (ok) {\n        strokeDashArray = pattern;\n      }\n    }\n    if (vertices.length > 1) {\n      const first = vertices[0];\n      const last = vertices[vertices.length - 1];\n      if (first.x === last.x && first.y === last.y) {\n        vertices.pop();\n      }\n    }\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.POLYGON,\n      contents,\n      flags,\n      strokeColor: strokeColor ?? "#FF0000",\n      color: interiorColor ?? "transparent",\n      opacity,\n      strokeWidth: strokeWidth === 0 ? 1 : strokeWidth,\n      strokeStyle,\n      strokeDashArray,\n      rect,\n      vertices,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf polyline annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf polyline annotation\n   *\n   * @private\n   */\n  readPdfPolylineAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const vertices = this.readPdfAnnoVertices(page, annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const strokeColor = this.getAnnotationColor(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const interiorColor = this.getAnnotationColor(\n      annotationPtr,\n      PdfAnnotationColorType.InteriorColor\n    );\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    let { style: strokeStyle, width: strokeWidth } = this.getBorderStyle(annotationPtr);\n    let strokeDashArray;\n    if (strokeStyle === PdfAnnotationBorderStyle.DASHED) {\n      const { ok, pattern } = this.getBorderDashPattern(annotationPtr);\n      if (ok) {\n        strokeDashArray = pattern;\n      }\n    }\n    const lineEndings = this.getLineEndings(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.POLYLINE,\n      contents,\n      flags,\n      strokeColor: strokeColor ?? "#FF0000",\n      color: interiorColor ?? "transparent",\n      opacity,\n      strokeWidth: strokeWidth === 0 ? 1 : strokeWidth,\n      strokeStyle,\n      strokeDashArray,\n      lineEndings,\n      rect,\n      vertices,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf line annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf line annotation\n   *\n   * @private\n   */\n  readPdfLineAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const linePoints = this.getLinePoints(page, annotationPtr);\n    const lineEndings = this.getLineEndings(annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const strokeColor = this.getAnnotationColor(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const interiorColor = this.getAnnotationColor(\n      annotationPtr,\n      PdfAnnotationColorType.InteriorColor\n    );\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    let { style: strokeStyle, width: strokeWidth } = this.getBorderStyle(annotationPtr);\n    let strokeDashArray;\n    if (strokeStyle === PdfAnnotationBorderStyle.DASHED) {\n      const { ok, pattern } = this.getBorderDashPattern(annotationPtr);\n      if (ok) {\n        strokeDashArray = pattern;\n      }\n    }\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.LINE,\n      flags,\n      rect,\n      contents,\n      strokeWidth: strokeWidth === 0 ? 1 : strokeWidth,\n      strokeStyle,\n      strokeDashArray,\n      strokeColor: strokeColor ?? "#FF0000",\n      color: interiorColor ?? "transparent",\n      opacity,\n      linePoints: linePoints || { start: { x: 0, y: 0 }, end: { x: 0, y: 0 } },\n      lineEndings: lineEndings || {\n        start: PdfAnnotationLineEnding.None,\n        end: PdfAnnotationLineEnding.None\n      },\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf highlight annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf highlight annotation\n   *\n   * @private\n   */\n  readPdfHighlightAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const segmentRects = this.getQuadPointsAnno(page, annotationPtr);\n    const color = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const blendMode = this.pdfiumModule.EPDFAnnot_GetBlendMode(annotationPtr);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      blendMode,\n      type: PdfAnnotationSubtype.HIGHLIGHT,\n      rect,\n      flags,\n      contents,\n      segmentRects,\n      color: color ?? "#FFFF00",\n      opacity,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf underline annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf underline annotation\n   *\n   * @private\n   */\n  readPdfUnderlineAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const segmentRects = this.getQuadPointsAnno(page, annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const color = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const blendMode = this.pdfiumModule.EPDFAnnot_GetBlendMode(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      blendMode,\n      type: PdfAnnotationSubtype.UNDERLINE,\n      rect,\n      flags,\n      contents,\n      segmentRects,\n      color: color ?? "#FF0000",\n      opacity,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read strikeout annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf strikeout annotation\n   *\n   * @private\n   */\n  readPdfStrikeOutAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const segmentRects = this.getQuadPointsAnno(page, annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const color = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const blendMode = this.pdfiumModule.EPDFAnnot_GetBlendMode(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      blendMode,\n      type: PdfAnnotationSubtype.STRIKEOUT,\n      flags,\n      rect,\n      contents,\n      segmentRects,\n      color: color ?? "#FF0000",\n      opacity,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf squiggly annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf squiggly annotation\n   *\n   * @private\n   */\n  readPdfSquigglyAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const segmentRects = this.getQuadPointsAnno(page, annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const color = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    const blendMode = this.pdfiumModule.EPDFAnnot_GetBlendMode(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      blendMode,\n      type: PdfAnnotationSubtype.SQUIGGLY,\n      rect,\n      flags,\n      contents,\n      segmentRects,\n      color: color ?? "#FF0000",\n      opacity,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf caret annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf caret annotation\n   *\n   * @private\n   */\n  readPdfCaretAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.CARET,\n      rect,\n      flags,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Read pdf stamp annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf stamp annotation\n   *\n   * @private\n   */\n  readPdfStampAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.STAMP,\n      contents,\n      rect,\n      author,\n      modified,\n      created,\n      flags\n    };\n  }\n  /**\n   * Read pdf object in pdf page\n   * @param pageObjectPtr  - pointer to pdf object in page\n   * @returns pdf object in page\n   *\n   * @private\n   */\n  readPdfPageObject(pageObjectPtr) {\n    const type = this.pdfiumModule.FPDFPageObj_GetType(pageObjectPtr);\n    switch (type) {\n      case PdfPageObjectType.PATH:\n        return this.readPathObject(pageObjectPtr);\n      case PdfPageObjectType.IMAGE:\n        return this.readImageObject(pageObjectPtr);\n      case PdfPageObjectType.FORM:\n        return this.readFormObject(pageObjectPtr);\n    }\n  }\n  /**\n   * Read pdf path object\n   * @param pathObjectPtr  - pointer to pdf path object in page\n   * @returns pdf path object\n   *\n   * @private\n   */\n  readPathObject(pathObjectPtr) {\n    const segmentCount = this.pdfiumModule.FPDFPath_CountSegments(pathObjectPtr);\n    const leftPtr = this.memoryManager.malloc(4);\n    const bottomPtr = this.memoryManager.malloc(4);\n    const rightPtr = this.memoryManager.malloc(4);\n    const topPtr = this.memoryManager.malloc(4);\n    this.pdfiumModule.FPDFPageObj_GetBounds(pathObjectPtr, leftPtr, bottomPtr, rightPtr, topPtr);\n    const left = this.pdfiumModule.pdfium.getValue(leftPtr, "float");\n    const bottom = this.pdfiumModule.pdfium.getValue(bottomPtr, "float");\n    const right = this.pdfiumModule.pdfium.getValue(rightPtr, "float");\n    const top = this.pdfiumModule.pdfium.getValue(topPtr, "float");\n    const bounds = { left, bottom, right, top };\n    this.memoryManager.free(leftPtr);\n    this.memoryManager.free(bottomPtr);\n    this.memoryManager.free(rightPtr);\n    this.memoryManager.free(topPtr);\n    const segments = [];\n    for (let i = 0; i < segmentCount; i++) {\n      const segment = this.readPdfSegment(pathObjectPtr, i);\n      segments.push(segment);\n    }\n    const matrix = this.readPdfPageObjectTransformMatrix(pathObjectPtr);\n    return {\n      type: PdfPageObjectType.PATH,\n      bounds,\n      segments,\n      matrix\n    };\n  }\n  /**\n   * Read segment of pdf path object\n   * @param annotationObjectPtr - pointer to pdf path object\n   * @param segmentIndex - index of segment\n   * @returns pdf segment in pdf path\n   *\n   * @private\n   */\n  readPdfSegment(annotationObjectPtr, segmentIndex) {\n    const segmentPtr = this.pdfiumModule.FPDFPath_GetPathSegment(annotationObjectPtr, segmentIndex);\n    const segmentType = this.pdfiumModule.FPDFPathSegment_GetType(segmentPtr);\n    const isClosed = this.pdfiumModule.FPDFPathSegment_GetClose(segmentPtr);\n    const pointXPtr = this.memoryManager.malloc(4);\n    const pointYPtr = this.memoryManager.malloc(4);\n    this.pdfiumModule.FPDFPathSegment_GetPoint(segmentPtr, pointXPtr, pointYPtr);\n    const pointX = this.pdfiumModule.pdfium.getValue(pointXPtr, "float");\n    const pointY = this.pdfiumModule.pdfium.getValue(pointYPtr, "float");\n    this.memoryManager.free(pointXPtr);\n    this.memoryManager.free(pointYPtr);\n    return {\n      type: segmentType,\n      point: { x: pointX, y: pointY },\n      isClosed\n    };\n  }\n  /**\n   * Read pdf image object from pdf document\n   * @param pageObjectPtr  - pointer to pdf image object in page\n   * @returns pdf image object\n   *\n   * @private\n   */\n  readImageObject(imageObjectPtr) {\n    const bitmapPtr = this.pdfiumModule.FPDFImageObj_GetBitmap(imageObjectPtr);\n    const bitmapBufferPtr = this.pdfiumModule.FPDFBitmap_GetBuffer(bitmapPtr);\n    const bitmapWidth = this.pdfiumModule.FPDFBitmap_GetWidth(bitmapPtr);\n    const bitmapHeight = this.pdfiumModule.FPDFBitmap_GetHeight(bitmapPtr);\n    const format = this.pdfiumModule.FPDFBitmap_GetFormat(bitmapPtr);\n    const pixelCount = bitmapWidth * bitmapHeight;\n    const bytesPerPixel = 4;\n    const array = new Uint8ClampedArray(pixelCount * bytesPerPixel);\n    for (let i = 0; i < pixelCount; i++) {\n      switch (format) {\n        case 2:\n          {\n            const blue = this.pdfiumModule.pdfium.getValue(bitmapBufferPtr + i * 3, "i8");\n            const green = this.pdfiumModule.pdfium.getValue(bitmapBufferPtr + i * 3 + 1, "i8");\n            const red = this.pdfiumModule.pdfium.getValue(bitmapBufferPtr + i * 3 + 2, "i8");\n            array[i * bytesPerPixel] = red;\n            array[i * bytesPerPixel + 1] = green;\n            array[i * bytesPerPixel + 2] = blue;\n            array[i * bytesPerPixel + 3] = 100;\n          }\n          break;\n      }\n    }\n    const imageDataLike = {\n      data: array,\n      width: bitmapWidth,\n      height: bitmapHeight\n    };\n    const matrix = this.readPdfPageObjectTransformMatrix(imageObjectPtr);\n    return {\n      type: PdfPageObjectType.IMAGE,\n      imageData: imageDataLike,\n      matrix\n    };\n  }\n  /**\n   * Read form object from pdf document\n   * @param formObjectPtr  - pointer to pdf form object in page\n   * @returns pdf form object\n   *\n   * @private\n   */\n  readFormObject(formObjectPtr) {\n    const objectCount = this.pdfiumModule.FPDFFormObj_CountObjects(formObjectPtr);\n    const objects = [];\n    for (let i = 0; i < objectCount; i++) {\n      const pageObjectPtr = this.pdfiumModule.FPDFFormObj_GetObject(formObjectPtr, i);\n      const pageObj = this.readPdfPageObject(pageObjectPtr);\n      if (pageObj) {\n        objects.push(pageObj);\n      }\n    }\n    const matrix = this.readPdfPageObjectTransformMatrix(formObjectPtr);\n    return {\n      type: PdfPageObjectType.FORM,\n      objects,\n      matrix\n    };\n  }\n  /**\n   * Read pdf object in pdf page\n   * @param pageObjectPtr  - pointer to pdf object in page\n   * @returns pdf object in page\n   *\n   * @private\n   */\n  readPdfPageObjectTransformMatrix(pageObjectPtr) {\n    const matrixPtr = this.memoryManager.malloc(4 * 6);\n    if (this.pdfiumModule.FPDFPageObj_GetMatrix(pageObjectPtr, matrixPtr)) {\n      const a = this.pdfiumModule.pdfium.getValue(matrixPtr, "float");\n      const b = this.pdfiumModule.pdfium.getValue(matrixPtr + 4, "float");\n      const c = this.pdfiumModule.pdfium.getValue(matrixPtr + 8, "float");\n      const d = this.pdfiumModule.pdfium.getValue(matrixPtr + 12, "float");\n      const e = this.pdfiumModule.pdfium.getValue(matrixPtr + 16, "float");\n      const f = this.pdfiumModule.pdfium.getValue(matrixPtr + 20, "float");\n      this.memoryManager.free(matrixPtr);\n      return { a, b, c, d, e, f };\n    }\n    this.memoryManager.free(matrixPtr);\n    return { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0 };\n  }\n  /**\n   * Read contents of a stamp annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @returns contents of the stamp annotation\n   *\n   * @private\n   */\n  readStampAnnotationContents(annotationPtr) {\n    const contents = [];\n    const objectCount = this.pdfiumModule.FPDFAnnot_GetObjectCount(annotationPtr);\n    for (let i = 0; i < objectCount; i++) {\n      const annotationObjectPtr = this.pdfiumModule.FPDFAnnot_GetObject(annotationPtr, i);\n      const pageObj = this.readPdfPageObject(annotationObjectPtr);\n      if (pageObj) {\n        contents.push(pageObj);\n      }\n    }\n    return contents;\n  }\n  /**\n   * Return the stroke-width declared in the annotation’s /Border or /BS entry.\n   * Falls back to 1 pt when nothing is defined.\n   *\n   * @param annotationPtr - pointer to pdf annotation\n   * @returns stroke-width\n   *\n   * @private\n   */\n  getStrokeWidth(annotationPtr) {\n    const hPtr = this.memoryManager.malloc(4);\n    const vPtr = this.memoryManager.malloc(4);\n    const wPtr = this.memoryManager.malloc(4);\n    const ok = this.pdfiumModule.FPDFAnnot_GetBorder(annotationPtr, hPtr, vPtr, wPtr);\n    const width = ok ? this.pdfiumModule.pdfium.getValue(wPtr, "float") : 1;\n    this.memoryManager.free(hPtr);\n    this.memoryManager.free(vPtr);\n    this.memoryManager.free(wPtr);\n    return width;\n  }\n  /**\n   * Fetches the `/F` flag bit-field from an annotation.\n   *\n   * @param annotationPtr pointer to an `FPDF_ANNOTATION`\n   * @returns `{ raw, flags }`\n   *          • `raw`   – the 32-bit integer returned by PDFium\n   *          • `flags` – object with individual booleans\n   */\n  getAnnotationFlags(annotationPtr) {\n    const rawFlags = this.pdfiumModule.FPDFAnnot_GetFlags(annotationPtr);\n    return flagsToNames(rawFlags);\n  }\n  setAnnotationFlags(annotationPtr, flags) {\n    const rawFlags = namesToFlags(flags);\n    return this.pdfiumModule.FPDFAnnot_SetFlags(annotationPtr, rawFlags);\n  }\n  /**\n   * Read circle annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf circle annotation\n   *\n   * @private\n   */\n  readPdfCircleAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const interiorColor = this.getAnnotationColor(\n      annotationPtr,\n      PdfAnnotationColorType.InteriorColor\n    );\n    const strokeColor = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    let { style: strokeStyle, width: strokeWidth } = this.getBorderStyle(annotationPtr);\n    let strokeDashArray;\n    if (strokeStyle === PdfAnnotationBorderStyle.DASHED) {\n      const { ok, pattern } = this.getBorderDashPattern(annotationPtr);\n      if (ok) {\n        strokeDashArray = pattern;\n      }\n    }\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.CIRCLE,\n      flags,\n      color: interiorColor ?? "transparent",\n      opacity,\n      contents,\n      strokeWidth,\n      strokeColor: strokeColor ?? "#FF0000",\n      strokeStyle,\n      rect,\n      author,\n      modified,\n      created,\n      ...strokeDashArray !== void 0 && { strokeDashArray }\n    };\n  }\n  /**\n   * Read square annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf square annotation\n   *\n   * @private\n   */\n  readPdfSquareAnno(page, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const flags = this.getAnnotationFlags(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const contents = this.getAnnotString(annotationPtr, "Contents") || "";\n    const interiorColor = this.getAnnotationColor(\n      annotationPtr,\n      PdfAnnotationColorType.InteriorColor\n    );\n    const strokeColor = this.getAnnotationColor(annotationPtr);\n    const opacity = this.getAnnotationOpacity(annotationPtr);\n    let { style: strokeStyle, width: strokeWidth } = this.getBorderStyle(annotationPtr);\n    let strokeDashArray;\n    if (strokeStyle === PdfAnnotationBorderStyle.DASHED) {\n      const { ok, pattern } = this.getBorderDashPattern(annotationPtr);\n      if (ok) {\n        strokeDashArray = pattern;\n      }\n    }\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      type: PdfAnnotationSubtype.SQUARE,\n      flags,\n      color: interiorColor ?? "transparent",\n      opacity,\n      contents,\n      strokeColor: strokeColor ?? "#FF0000",\n      strokeWidth,\n      strokeStyle,\n      rect,\n      author,\n      modified,\n      created,\n      ...strokeDashArray !== void 0 && { strokeDashArray }\n    };\n  }\n  /**\n   * Read basic info of unsupported pdf annotation\n   * @param page  - pdf page infor\n   * @param type - type of annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @param index  - index of annotation in the pdf page\n   * @returns pdf annotation\n   *\n   * @private\n   */\n  readPdfAnno(page, type, annotationPtr, index) {\n    const custom = this.getAnnotCustom(annotationPtr);\n    const pageRect = this.readPageAnnoRect(annotationPtr);\n    const rect = this.convertPageRectToDeviceRect(page, pageRect);\n    const author = this.getAnnotString(annotationPtr, "T");\n    const modified = this.getAnnotationDate(annotationPtr, "M");\n    const created = this.getAnnotationDate(annotationPtr, "CreationDate");\n    const flags = this.getAnnotationFlags(annotationPtr);\n    return {\n      pageIndex: page.index,\n      custom,\n      id: index,\n      flags,\n      type,\n      rect,\n      author,\n      modified,\n      created\n    };\n  }\n  /**\n   * Resolve `/IRT` → parent-annotation index on the same page.\n   *\n   * @param pagePtr        - pointer to FPDF_PAGE\n   * @param annotationPtr  - pointer to FPDF_ANNOTATION\n   * @returns index (`0…count-1`) or `undefined` when the annotation is *not* a reply\n   *\n   * @private\n   */\n  getInReplyToId(annotationPtr) {\n    const parentPtr = this.pdfiumModule.FPDFAnnot_GetLinkedAnnot(annotationPtr, "IRT");\n    if (!parentPtr) return;\n    return this.getAnnotString(parentPtr, "NM");\n  }\n  /**\n   * Set the in reply to id of the annotation\n   *\n   * @param annotationPtr - pointer to an `FPDF_ANNOTATION`\n   * @param id - the id of the parent annotation\n   * @returns `true` on success\n   */\n  setInReplyToId(pagePtr, annotationPtr, id) {\n    const parentPtr = this.getAnnotationByName(pagePtr, id);\n    if (!parentPtr) return false;\n    return this.pdfiumModule.EPDFAnnot_SetLinkedAnnot(annotationPtr, "IRT", parentPtr);\n  }\n  /**\n   * Fetch a string value (`/T`, `/M`, `/State`, …) from an annotation.\n   *\n   * @returns decoded UTF-8 string or `undefined` when the key is absent\n   *\n   * @private\n   */\n  getAnnotString(annotationPtr, key) {\n    const len = this.pdfiumModule.FPDFAnnot_GetStringValue(annotationPtr, key, 0, 0);\n    if (len === 0) return;\n    const bytes = (len + 1) * 2;\n    const ptr = this.memoryManager.malloc(bytes);\n    this.pdfiumModule.FPDFAnnot_GetStringValue(annotationPtr, key, ptr, bytes);\n    const value = this.pdfiumModule.pdfium.UTF16ToString(ptr);\n    this.memoryManager.free(ptr);\n    return value || void 0;\n  }\n  /**\n   * Get a string value (`/T`, `/M`, `/State`, …) from an attachment.\n   *\n   * @returns decoded UTF-8 string or `undefined` when the key is absent\n   *\n   * @private\n   */\n  getAttachmentString(attachmentPtr, key) {\n    const len = this.pdfiumModule.FPDFAttachment_GetStringValue(attachmentPtr, key, 0, 0);\n    if (len === 0) return;\n    const bytes = (len + 1) * 2;\n    const ptr = this.memoryManager.malloc(bytes);\n    this.pdfiumModule.FPDFAttachment_GetStringValue(attachmentPtr, key, ptr, bytes);\n    const value = this.pdfiumModule.pdfium.UTF16ToString(ptr);\n    this.memoryManager.free(ptr);\n    return value || void 0;\n  }\n  /**\n   * Get a number value (`/Size`) from an attachment.\n   *\n   * @returns number or `null` when the key is absent\n   *\n   * @private\n   */\n  getAttachmentNumber(attachmentPtr, key) {\n    const outPtr = this.memoryManager.malloc(4);\n    try {\n      const ok = this.pdfiumModule.EPDFAttachment_GetIntegerValue(\n        attachmentPtr,\n        key,\n        // FPDF_BYTESTRING → ASCII JS string is fine in your glue\n        outPtr\n      );\n      if (!ok) return void 0;\n      return this.pdfiumModule.pdfium.getValue(outPtr, "i32") >>> 0;\n    } finally {\n      this.memoryManager.free(outPtr);\n    }\n  }\n  /**\n   * Get custom data of the annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @returns custom data of the annotation\n   *\n   * @private\n   */\n  getAnnotCustom(annotationPtr) {\n    const custom = this.getAnnotString(annotationPtr, "EPDFCustom");\n    if (!custom) return;\n    try {\n      return JSON.parse(custom);\n    } catch (error) {\n      console.warn("Failed to parse annotation custom data as JSON:", error);\n      console.warn("Invalid JSON string:", custom);\n      return void 0;\n    }\n  }\n  /**\n   * Sets custom data for an annotation by safely stringifying and storing JSON\n   * @private\n   */\n  setAnnotCustom(annotationPtr, data) {\n    if (data === void 0 || data === null) {\n      return this.setAnnotString(annotationPtr, "EPDFCustom", "");\n    }\n    try {\n      const jsonString = JSON.stringify(data);\n      return this.setAnnotString(annotationPtr, "EPDFCustom", jsonString);\n    } catch (error) {\n      console.warn("Failed to stringify annotation custom data as JSON:", error);\n      console.warn("Invalid data object:", data);\n      return false;\n    }\n  }\n  /**\n   * Fetches the /IT (Intent) name from an annotation as a UTF-8 JS string.\n   *\n   * Mirrors getAnnotString(): calls EPDFAnnot_GetIntent twice (length probe + copy).\n   * Returns `undefined` if no intent present.\n   */\n  getAnnotIntent(annotationPtr) {\n    const len = this.pdfiumModule.EPDFAnnot_GetIntent(annotationPtr, 0, 0);\n    if (len === 0) return;\n    const codeUnits = len + 1;\n    const bytes = codeUnits * 2;\n    const ptr = this.memoryManager.malloc(bytes);\n    this.pdfiumModule.EPDFAnnot_GetIntent(annotationPtr, ptr, bytes);\n    const value = this.pdfiumModule.pdfium.UTF16ToString(ptr);\n    this.memoryManager.free(ptr);\n    return value && value !== "undefined" ? value : void 0;\n  }\n  /**\n   * Write the `/IT` (Intent) name into an annotation dictionary.\n   *\n   * Mirrors EPDFAnnot_SetIntent in PDFium (expects a UTF‑8 FPDF_BYTESTRING).\n   *\n   * @param annotationPtr Pointer returned by FPDFPage_GetAnnot\n   * @param intent        Name without leading slash, e.g. `"PolygonCloud"`\n   *                      A leading “/” will be stripped for convenience.\n   * @returns             true on success, false otherwise\n   */\n  setAnnotIntent(annotationPtr, intent) {\n    return this.pdfiumModule.EPDFAnnot_SetIntent(annotationPtr, intent);\n  }\n  /**\n   * Returns the rich‑content string stored in the annotation’s `/RC` entry.\n   *\n   * Works like `getAnnotIntent()`: first probe for length, then copy.\n   * `undefined` when the annotation has no rich content.\n   */\n  getAnnotRichContent(annotationPtr) {\n    const len = this.pdfiumModule.EPDFAnnot_GetRichContent(annotationPtr, 0, 0);\n    if (len === 0) return;\n    const codeUnits = len + 1;\n    const bytes = codeUnits * 2;\n    const ptr = this.memoryManager.malloc(bytes);\n    this.pdfiumModule.EPDFAnnot_GetRichContent(annotationPtr, ptr, bytes);\n    const value = this.pdfiumModule.pdfium.UTF16ToString(ptr);\n    this.memoryManager.free(ptr);\n    return value || void 0;\n  }\n  /**\n   * Get annotation by name\n   * @param pagePtr - pointer to pdf page object\n   * @param name - name of annotation\n   * @returns pointer to pdf annotation\n   *\n   * @private\n   */\n  getAnnotationByName(pagePtr, name) {\n    return this.withWString(name, (wNamePtr) => {\n      return this.pdfiumModule.EPDFPage_GetAnnotByName(pagePtr, wNamePtr);\n    });\n  }\n  /**\n   * Remove annotation by name\n   * @param pagePtr - pointer to pdf page object\n   * @param name - name of annotation\n   * @returns true on success\n   *\n   * @private\n   */\n  removeAnnotationByName(pagePtr, name) {\n    return this.withWString(name, (wNamePtr) => {\n      return this.pdfiumModule.EPDFPage_RemoveAnnotByName(pagePtr, wNamePtr);\n    });\n  }\n  /**\n   * Set a string value (`/T`, `/M`, `/State`, …) to an annotation.\n   *\n   * @returns `true` if the operation was successful\n   *\n   * @private\n   */\n  setAnnotString(annotationPtr, key, value) {\n    return this.withWString(value, (wValPtr) => {\n      return this.pdfiumModule.FPDFAnnot_SetStringValue(annotationPtr, key, wValPtr);\n    });\n  }\n  /**\n   * Set a string value (`/T`, `/M`, `/State`, …) to an attachment.\n   *\n   * @returns `true` if the operation was successful\n   *\n   * @private\n   */\n  setAttachmentString(attachmentPtr, key, value) {\n    return this.withWString(value, (wValPtr) => {\n      return this.pdfiumModule.FPDFAttachment_SetStringValue(attachmentPtr, key, wValPtr);\n    });\n  }\n  /**\n   * Read vertices of pdf annotation\n   * @param page  - pdf page infor\n   * @param annotationPtr - pointer to pdf annotation\n   * @returns vertices of pdf annotation\n   *\n   * @private\n   */\n  readPdfAnnoVertices(page, annotationPtr) {\n    const vertices = [];\n    const count = this.pdfiumModule.FPDFAnnot_GetVertices(annotationPtr, 0, 0);\n    const pointMemorySize = 8;\n    const pointsPtr = this.memoryManager.malloc(count * pointMemorySize);\n    this.pdfiumModule.FPDFAnnot_GetVertices(annotationPtr, pointsPtr, count);\n    for (let i = 0; i < count; i++) {\n      const pointX = this.pdfiumModule.pdfium.getValue(pointsPtr + i * pointMemorySize, "float");\n      const pointY = this.pdfiumModule.pdfium.getValue(\n        pointsPtr + i * pointMemorySize + 4,\n        "float"\n      );\n      const { x, y } = this.convertPagePointToDevicePoint(page, {\n        x: pointX,\n        y: pointY\n      });\n      const last = vertices[vertices.length - 1];\n      if (!last || last.x !== x || last.y !== y) {\n        vertices.push({ x, y });\n      }\n    }\n    this.memoryManager.free(pointsPtr);\n    return vertices;\n  }\n  /**\n   * Sync the vertices of a polygon or polyline annotation.\n   *\n   * @param page  - pdf page infor\n   * @param annotPtr - pointer to pdf annotation\n   * @param vertices - the vertices to be set\n   * @returns true on success\n   *\n   * @private\n   */\n  setPdfAnnoVertices(page, annotPtr, vertices) {\n    const pdf = this.pdfiumModule.pdfium;\n    const FS_POINTF_SIZE = 8;\n    const buf = this.memoryManager.malloc(FS_POINTF_SIZE * vertices.length);\n    vertices.forEach((v, i) => {\n      const pagePt = this.convertDevicePointToPagePoint(page, v);\n      pdf.setValue(buf + i * FS_POINTF_SIZE + 0, pagePt.x, "float");\n      pdf.setValue(buf + i * FS_POINTF_SIZE + 4, pagePt.y, "float");\n    });\n    const ok = this.pdfiumModule.EPDFAnnot_SetVertices(annotPtr, buf, vertices.length);\n    this.memoryManager.free(buf);\n    return ok;\n  }\n  /**\n   * Read the target of pdf bookmark\n   * @param docPtr - pointer to pdf document object\n   * @param getActionPtr - callback function to retrive the pointer of action\n   * @param getDestinationPtr - callback function to retrive the pointer of destination\n   * @returns target of pdf bookmark\n   *\n   * @private\n   */\n  readPdfBookmarkTarget(docPtr, getActionPtr, getDestinationPtr) {\n    const actionPtr = getActionPtr();\n    if (actionPtr) {\n      const action = this.readPdfAction(docPtr, actionPtr);\n      return {\n        type: "action",\n        action\n      };\n    } else {\n      const destinationPtr = getDestinationPtr();\n      if (destinationPtr) {\n        const destination = this.readPdfDestination(docPtr, destinationPtr);\n        return {\n          type: "destination",\n          destination\n        };\n      }\n    }\n  }\n  /**\n   * Read field of pdf widget annotation\n   * @param formHandle - form handle\n   * @param annotationPtr - pointer to pdf annotation\n   * @returns field of pdf widget annotation\n   *\n   * @private\n   */\n  readPdfWidgetAnnoField(formHandle, annotationPtr) {\n    const flag = this.pdfiumModule.FPDFAnnot_GetFormFieldFlags(\n      formHandle,\n      annotationPtr\n    );\n    const type = this.pdfiumModule.FPDFAnnot_GetFormFieldType(\n      formHandle,\n      annotationPtr\n    );\n    const name = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFAnnot_GetFormFieldName(\n          formHandle,\n          annotationPtr,\n          buffer,\n          bufferLength\n        );\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const alternateName = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFAnnot_GetFormFieldAlternateName(\n          formHandle,\n          annotationPtr,\n          buffer,\n          bufferLength\n        );\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const value = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFAnnot_GetFormFieldValue(\n          formHandle,\n          annotationPtr,\n          buffer,\n          bufferLength\n        );\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const options = [];\n    if (type === PDF_FORM_FIELD_TYPE.COMBOBOX || type === PDF_FORM_FIELD_TYPE.LISTBOX) {\n      const count = this.pdfiumModule.FPDFAnnot_GetOptionCount(formHandle, annotationPtr);\n      for (let i = 0; i < count; i++) {\n        const label = readString(\n          this.pdfiumModule.pdfium,\n          (buffer, bufferLength) => {\n            return this.pdfiumModule.FPDFAnnot_GetOptionLabel(\n              formHandle,\n              annotationPtr,\n              i,\n              buffer,\n              bufferLength\n            );\n          },\n          this.pdfiumModule.pdfium.UTF16ToString\n        );\n        const isSelected = this.pdfiumModule.FPDFAnnot_IsOptionSelected(\n          formHandle,\n          annotationPtr,\n          i\n        );\n        options.push({\n          label,\n          isSelected\n        });\n      }\n    }\n    let isChecked = false;\n    if (type === PDF_FORM_FIELD_TYPE.CHECKBOX || type === PDF_FORM_FIELD_TYPE.RADIOBUTTON) {\n      isChecked = this.pdfiumModule.FPDFAnnot_IsChecked(formHandle, annotationPtr);\n    }\n    return {\n      flag,\n      type,\n      name,\n      alternateName,\n      value,\n      isChecked,\n      options\n    };\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.renderAnnotation}\n   *\n   * @public\n   */\n  renderPageAnnotationRaw(doc, page, annotation, options) {\n    const {\n      scaleFactor = 1,\n      rotation = Rotation.Degree0,\n      dpr = 1,\n      mode = AppearanceMode.Normal\n    } = options ?? {};\n    this.logger.debug(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      "renderPageAnnotation",\n      doc,\n      page,\n      annotation,\n      options\n    );\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderPageAnnotation`,\n      "Begin",\n      `${doc.id}-${page.index}-${annotation.id}`\n    );\n    const task = new Task();\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `RenderPageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}-${annotation.id}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const pageCtx = ctx.acquirePage(page.index);\n    const annotPtr = this.getAnnotationByName(pageCtx.pagePtr, annotation.id);\n    if (!annotPtr) {\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `RenderPageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}-${annotation.id}`\n      );\n      pageCtx.release();\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: "annotation not found" });\n    }\n    const finalScale = Math.max(0.01, scaleFactor * dpr);\n    const rect = toIntRect(annotation.rect);\n    const devRect = toIntRect(transformRect(page.size, rect, rotation, finalScale));\n    const wDev = Math.max(1, devRect.size.width);\n    const hDev = Math.max(1, devRect.size.height);\n    const stride = wDev * 4;\n    const bytes = stride * hDev;\n    const heapPtr = this.memoryManager.malloc(bytes);\n    const bitmapPtr = this.pdfiumModule.FPDFBitmap_CreateEx(\n      wDev,\n      hDev,\n      4,\n      heapPtr,\n      stride\n    );\n    this.pdfiumModule.FPDFBitmap_FillRect(bitmapPtr, 0, 0, wDev, hDev, 0);\n    const M = buildUserToDeviceMatrix(\n      rect,\n      // {origin:{L,B}, size:{W,H}}\n      rotation,\n      wDev,\n      hDev\n    );\n    const mPtr = this.memoryManager.malloc(6 * 4);\n    const mView = new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer, mPtr, 6);\n    mView.set([M.a, M.b, M.c, M.d, M.e, M.f]);\n    const FLAGS = 16;\n    let ok = false;\n    try {\n      ok = !!this.pdfiumModule.EPDF_RenderAnnotBitmap(\n        bitmapPtr,\n        pageCtx.pagePtr,\n        annotPtr,\n        mode,\n        mPtr,\n        FLAGS\n      );\n    } finally {\n      this.memoryManager.free(mPtr);\n      this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n      this.pdfiumModule.FPDFPage_CloseAnnot(annotPtr);\n      pageCtx.release();\n    }\n    if (!ok) {\n      this.memoryManager.free(heapPtr);\n      this.logger.perf(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `RenderPageAnnotation`,\n        "End",\n        `${doc.id}-${page.index}-${annotation.id}`\n      );\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: "EPDF_RenderAnnotBitmap failed"\n      });\n    }\n    const data = this.pdfiumModule.pdfium.HEAPU8.subarray(heapPtr, heapPtr + bytes);\n    const imageDataLike = {\n      data: new Uint8ClampedArray(data),\n      width: wDev,\n      height: hDev\n    };\n    task.resolve(imageDataLike);\n    this.memoryManager.free(heapPtr);\n    return task;\n  }\n  renderRectEncoded(doc, page, rect, options) {\n    const task = new Task();\n    const rotation = (options == null ? void 0 : options.rotation) ?? Rotation.Degree0;\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "document does not open"\n      });\n    }\n    const scale = Math.max(0.01, (options == null ? void 0 : options.scaleFactor) ?? 1);\n    const dpr = Math.max(1, (options == null ? void 0 : options.dpr) ?? 1);\n    const finalScale = scale * dpr;\n    const baseW = rect.size.width;\n    const baseH = rect.size.height;\n    const swap2 = (rotation & 1) === 1;\n    const wDev = Math.max(1, Math.round((swap2 ? baseH : baseW) * finalScale));\n    const hDev = Math.max(1, Math.round((swap2 ? baseW : baseH) * finalScale));\n    const stride = wDev * 4;\n    const bytes = stride * hDev;\n    const pageCtx = ctx.acquirePage(page.index);\n    const shouldRenderForms = (options == null ? void 0 : options.withForms) ?? false;\n    const formHandle = shouldRenderForms ? pageCtx.getFormHandle() : void 0;\n    const heapPtr = this.memoryManager.malloc(bytes);\n    const bitmapPtr = this.pdfiumModule.FPDFBitmap_CreateEx(\n      wDev,\n      hDev,\n      4,\n      heapPtr,\n      stride\n    );\n    this.pdfiumModule.FPDFBitmap_FillRect(bitmapPtr, 0, 0, wDev, hDev, 4294967295);\n    const M = buildUserToDeviceMatrix(rect, rotation, wDev, hDev);\n    const mPtr = this.memoryManager.malloc(6 * 4);\n    const mView = new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer, mPtr, 6);\n    mView.set([M.a, M.b, M.c, M.d, M.e, M.f]);\n    const clipPtr = this.memoryManager.malloc(4 * 4);\n    const clipView = new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer, clipPtr, 4);\n    clipView.set([0, 0, wDev, hDev]);\n    let flags = 16;\n    if ((options == null ? void 0 : options.withAnnotations) ?? false) flags |= 1;\n    try {\n      this.pdfiumModule.FPDF_RenderPageBitmapWithMatrix(\n        bitmapPtr,\n        pageCtx.pagePtr,\n        mPtr,\n        clipPtr,\n        flags\n      );\n      if (formHandle !== void 0) {\n        const formParams = computeFormDrawParams(M, rect, page.size, rotation);\n        const { startX, startY, formsWidth, formsHeight, scaleX, scaleY } = formParams;\n        this.pdfiumModule.FPDF_FFLDraw(\n          formHandle,\n          bitmapPtr,\n          pageCtx.pagePtr,\n          startX,\n          startY,\n          formsWidth,\n          formsHeight,\n          rotation,\n          flags\n        );\n      }\n    } finally {\n      pageCtx.release();\n      this.memoryManager.free(mPtr);\n      this.memoryManager.free(clipPtr);\n    }\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderRectEncodedData`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const data = this.pdfiumModule.pdfium.HEAPU8.subarray(heapPtr, heapPtr + bytes);\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderRectEncodedData`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderRectEncodedImageData`,\n      "Begin",\n      `${doc.id}-${page.index}`\n    );\n    const imageDataLike = {\n      data: new Uint8ClampedArray(data),\n      width: wDev,\n      height: hDev\n    };\n    this.logger.perf(\n      LOG_SOURCE$1,\n      LOG_CATEGORY$1,\n      `RenderRectEncodedImageData`,\n      "End",\n      `${doc.id}-${page.index}`\n    );\n    task.resolve(imageDataLike);\n    this.pdfiumModule.FPDFBitmap_Destroy(bitmapPtr);\n    this.memoryManager.free(heapPtr);\n    return task;\n  }\n  /**\n   * Read the target of pdf link annotation\n   * @param docPtr - pointer to pdf document object\n   * @param getActionPtr - callback function to retrive the pointer of action\n   * @param getDestinationPtr - callback function to retrive the pointer of destination\n   * @returns target of link\n   *\n   * @private\n   */\n  readPdfLinkAnnoTarget(docPtr, getActionPtr, getDestinationPtr) {\n    const destinationPtr = getDestinationPtr();\n    if (destinationPtr) {\n      const destination = this.readPdfDestination(docPtr, destinationPtr);\n      return {\n        type: "destination",\n        destination\n      };\n    } else {\n      const actionPtr = getActionPtr();\n      if (actionPtr) {\n        const action = this.readPdfAction(docPtr, actionPtr);\n        return {\n          type: "action",\n          action\n        };\n      }\n    }\n  }\n  createLocalDestPtr(docPtr, dest) {\n    var _a, _b;\n    const pagePtr = this.pdfiumModule.FPDF_LoadPage(docPtr, dest.pageIndex);\n    if (!pagePtr) return 0;\n    try {\n      if (dest.zoom.mode === PdfZoomMode.XYZ) {\n        const { x, y, zoom } = dest.zoom.params;\n        return this.pdfiumModule.EPDFDest_CreateXYZ(\n          pagePtr,\n          /*has_left*/\n          true,\n          x,\n          /*has_top*/\n          true,\n          y,\n          /*has_zoom*/\n          true,\n          zoom\n        );\n      }\n      let viewEnum;\n      let params = [];\n      switch (dest.zoom.mode) {\n        case PdfZoomMode.FitPage:\n          viewEnum = PdfZoomMode.FitPage;\n          break;\n        case PdfZoomMode.FitHorizontal:\n          viewEnum = PdfZoomMode.FitHorizontal;\n          params = [((_a = dest.view) == null ? void 0 : _a[0]) ?? 0];\n          break;\n        case PdfZoomMode.FitVertical:\n          viewEnum = PdfZoomMode.FitVertical;\n          params = [((_b = dest.view) == null ? void 0 : _b[0]) ?? 0];\n          break;\n        case PdfZoomMode.FitRectangle:\n          {\n            const v = dest.view ?? [];\n            params = [v[0] ?? 0, v[1] ?? 0, v[2] ?? 0, v[3] ?? 0];\n            viewEnum = PdfZoomMode.FitRectangle;\n          }\n          break;\n        case PdfZoomMode.Unknown:\n        default:\n          return 0;\n      }\n      return this.withFloatArray(\n        params,\n        (ptr, count) => this.pdfiumModule.EPDFDest_CreateView(pagePtr, viewEnum, ptr, count)\n      );\n    } finally {\n      this.pdfiumModule.FPDF_ClosePage(pagePtr);\n    }\n  }\n  applyBookmarkTarget(docPtr, bmPtr, target) {\n    if (target.type === "destination") {\n      const destPtr = this.createLocalDestPtr(docPtr, target.destination);\n      if (!destPtr) return false;\n      const ok = this.pdfiumModule.EPDFBookmark_SetDest(docPtr, bmPtr, destPtr);\n      return !!ok;\n    }\n    const action = target.action;\n    switch (action.type) {\n      case PdfActionType.Goto: {\n        const destPtr = this.createLocalDestPtr(docPtr, action.destination);\n        if (!destPtr) return false;\n        const actPtr = this.pdfiumModule.EPDFAction_CreateGoTo(docPtr, destPtr);\n        if (!actPtr) return false;\n        return !!this.pdfiumModule.EPDFBookmark_SetAction(docPtr, bmPtr, actPtr);\n      }\n      case PdfActionType.URI: {\n        const actPtr = this.pdfiumModule.EPDFAction_CreateURI(docPtr, action.uri);\n        if (!actPtr) return false;\n        return !!this.pdfiumModule.EPDFBookmark_SetAction(docPtr, bmPtr, actPtr);\n      }\n      case PdfActionType.LaunchAppOrOpenFile: {\n        const actPtr = this.withWString(\n          action.path,\n          (wptr) => this.pdfiumModule.EPDFAction_CreateLaunch(docPtr, wptr)\n        );\n        if (!actPtr) return false;\n        return !!this.pdfiumModule.EPDFBookmark_SetAction(docPtr, bmPtr, actPtr);\n      }\n      case PdfActionType.RemoteGoto:\n        return false;\n      case PdfActionType.Unsupported:\n      default:\n        return false;\n    }\n  }\n  /**\n   * Read pdf action from pdf document\n   * @param docPtr - pointer to pdf document object\n   * @param actionPtr - pointer to pdf action object\n   * @returns pdf action object\n   *\n   * @private\n   */\n  readPdfAction(docPtr, actionPtr) {\n    const actionType = this.pdfiumModule.FPDFAction_GetType(actionPtr);\n    let action;\n    switch (actionType) {\n      case PdfActionType.Unsupported:\n        action = {\n          type: PdfActionType.Unsupported\n        };\n        break;\n      case PdfActionType.Goto:\n        {\n          const destinationPtr = this.pdfiumModule.FPDFAction_GetDest(docPtr, actionPtr);\n          if (destinationPtr) {\n            const destination = this.readPdfDestination(docPtr, destinationPtr);\n            action = {\n              type: PdfActionType.Goto,\n              destination\n            };\n          } else {\n            action = {\n              type: PdfActionType.Unsupported\n            };\n          }\n        }\n        break;\n      case PdfActionType.RemoteGoto:\n        {\n          action = {\n            type: PdfActionType.Unsupported\n          };\n        }\n        break;\n      case PdfActionType.URI:\n        {\n          const uri = readString(\n            this.pdfiumModule.pdfium,\n            (buffer, bufferLength) => {\n              return this.pdfiumModule.FPDFAction_GetURIPath(\n                docPtr,\n                actionPtr,\n                buffer,\n                bufferLength\n              );\n            },\n            this.pdfiumModule.pdfium.UTF8ToString\n          );\n          action = {\n            type: PdfActionType.URI,\n            uri\n          };\n        }\n        break;\n      case PdfActionType.LaunchAppOrOpenFile:\n        {\n          const path = readString(\n            this.pdfiumModule.pdfium,\n            (buffer, bufferLength) => {\n              return this.pdfiumModule.FPDFAction_GetFilePath(actionPtr, buffer, bufferLength);\n            },\n            this.pdfiumModule.pdfium.UTF8ToString\n          );\n          action = {\n            type: PdfActionType.LaunchAppOrOpenFile,\n            path\n          };\n        }\n        break;\n    }\n    return action;\n  }\n  /**\n   * Read pdf destination object\n   * @param docPtr - pointer to pdf document object\n   * @param destinationPtr - pointer to pdf destination\n   * @returns pdf destination object\n   *\n   * @private\n   */\n  readPdfDestination(docPtr, destinationPtr) {\n    const pageIndex = this.pdfiumModule.FPDFDest_GetDestPageIndex(docPtr, destinationPtr);\n    const maxParmamsCount = 4;\n    const paramsCountPtr = this.memoryManager.malloc(maxParmamsCount);\n    const paramsPtr = this.memoryManager.malloc(maxParmamsCount * 4);\n    const zoomMode = this.pdfiumModule.FPDFDest_GetView(\n      destinationPtr,\n      paramsCountPtr,\n      paramsPtr\n    );\n    const paramsCount = this.pdfiumModule.pdfium.getValue(paramsCountPtr, "i32");\n    const view = [];\n    for (let i = 0; i < paramsCount; i++) {\n      const paramPtr = paramsPtr + i * 4;\n      view.push(this.pdfiumModule.pdfium.getValue(paramPtr, "float"));\n    }\n    this.memoryManager.free(paramsCountPtr);\n    this.memoryManager.free(paramsPtr);\n    if (zoomMode === PdfZoomMode.XYZ) {\n      const hasXPtr = this.memoryManager.malloc(1);\n      const hasYPtr = this.memoryManager.malloc(1);\n      const hasZPtr = this.memoryManager.malloc(1);\n      const xPtr = this.memoryManager.malloc(4);\n      const yPtr = this.memoryManager.malloc(4);\n      const zPtr = this.memoryManager.malloc(4);\n      const isSucceed = this.pdfiumModule.FPDFDest_GetLocationInPage(\n        destinationPtr,\n        hasXPtr,\n        hasYPtr,\n        hasZPtr,\n        xPtr,\n        yPtr,\n        zPtr\n      );\n      if (isSucceed) {\n        const hasX = this.pdfiumModule.pdfium.getValue(hasXPtr, "i8");\n        const hasY = this.pdfiumModule.pdfium.getValue(hasYPtr, "i8");\n        const hasZ = this.pdfiumModule.pdfium.getValue(hasZPtr, "i8");\n        const x = hasX ? this.pdfiumModule.pdfium.getValue(xPtr, "float") : 0;\n        const y = hasY ? this.pdfiumModule.pdfium.getValue(yPtr, "float") : 0;\n        const zoom = hasZ ? this.pdfiumModule.pdfium.getValue(zPtr, "float") : 0;\n        this.memoryManager.free(hasXPtr);\n        this.memoryManager.free(hasYPtr);\n        this.memoryManager.free(hasZPtr);\n        this.memoryManager.free(xPtr);\n        this.memoryManager.free(yPtr);\n        this.memoryManager.free(zPtr);\n        return {\n          pageIndex,\n          zoom: {\n            mode: zoomMode,\n            params: {\n              x,\n              y,\n              zoom\n            }\n          },\n          view\n        };\n      }\n      this.memoryManager.free(hasXPtr);\n      this.memoryManager.free(hasYPtr);\n      this.memoryManager.free(hasZPtr);\n      this.memoryManager.free(xPtr);\n      this.memoryManager.free(yPtr);\n      this.memoryManager.free(zPtr);\n      return {\n        pageIndex,\n        zoom: {\n          mode: zoomMode,\n          params: {\n            x: 0,\n            y: 0,\n            zoom: 0\n          }\n        },\n        view\n      };\n    }\n    return {\n      pageIndex,\n      zoom: {\n        mode: zoomMode\n      },\n      view\n    };\n  }\n  /**\n   * Read attachmet from pdf document\n   * @param docPtr - pointer to pdf document object\n   * @param index - index of attachment\n   * @returns attachment content\n   *\n   * @private\n   */\n  readPdfAttachment(docPtr, index) {\n    const attachmentPtr = this.pdfiumModule.FPDFDoc_GetAttachment(docPtr, index);\n    const name = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFAttachment_GetName(attachmentPtr, buffer, bufferLength);\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const description = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.EPDFAttachment_GetDescription(attachmentPtr, buffer, bufferLength);\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const mimeType = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFAttachment_GetSubtype(attachmentPtr, buffer, bufferLength);\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const creationDate = this.getAttachmentDate(attachmentPtr, "CreationDate");\n    const checksum = readString(\n      this.pdfiumModule.pdfium,\n      (buffer, bufferLength) => {\n        return this.pdfiumModule.FPDFAttachment_GetStringValue(\n          attachmentPtr,\n          "Checksum",\n          buffer,\n          bufferLength\n        );\n      },\n      this.pdfiumModule.pdfium.UTF16ToString\n    );\n    const size = this.getAttachmentNumber(attachmentPtr, "Size");\n    return {\n      index,\n      name,\n      description,\n      mimeType,\n      size,\n      creationDate,\n      checksum\n    };\n  }\n  /**\n   * Convert coordinate of point from device coordinate to page coordinate\n   * @param page  - pdf page infor\n   * @param position - position of point\n   * @returns converted position\n   *\n   * @private\n   */\n  convertDevicePointToPagePoint(page, position) {\n    const DW = page.size.width;\n    const DH = page.size.height;\n    const r = page.rotation & 3;\n    if (r === 0) {\n      return { x: position.x, y: DH - position.y };\n    }\n    if (r === 1) {\n      return { x: position.y, y: position.x };\n    }\n    if (r === 2) {\n      return { x: DW - position.x, y: position.y };\n    }\n    {\n      return { x: DH - position.y, y: DW - position.x };\n    }\n  }\n  /**\n   * Convert coordinate of point from page coordinate to device coordinate\n   * @param page  - pdf page infor\n   * @param position - position of point\n   * @returns converted position\n   *\n   * @private\n   */\n  convertPagePointToDevicePoint(page, position) {\n    const DW = page.size.width;\n    const DH = page.size.height;\n    const r = page.rotation & 3;\n    if (r === 0) {\n      return { x: position.x, y: DH - position.y };\n    }\n    if (r === 1) {\n      return { x: position.y, y: position.x };\n    }\n    if (r === 2) {\n      return { x: DW - position.x, y: position.y };\n    }\n    {\n      return { x: DW - position.y, y: DH - position.x };\n    }\n  }\n  /**\n   * Convert coordinate of rectangle from page coordinate to device coordinate\n   * @param page  - pdf page infor\n   * @param pagePtr - pointer to pdf page object\n   * @param pageRect - rectangle that needs to be converted\n   * @returns converted rectangle\n   *\n   * @private\n   */\n  convertPageRectToDeviceRect(page, pageRect) {\n    const { x, y } = this.convertPagePointToDevicePoint(page, {\n      x: pageRect.left,\n      y: pageRect.top\n    });\n    const rect = {\n      origin: {\n        x,\n        y\n      },\n      size: {\n        width: Math.abs(pageRect.right - pageRect.left),\n        height: Math.abs(pageRect.top - pageRect.bottom)\n      }\n    };\n    return rect;\n  }\n  /**\n   * Read the appearance stream of annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @param mode - appearance mode\n   * @returns appearance stream\n   *\n   * @private\n   */\n  readPageAnnoAppearanceStreams(annotationPtr) {\n    return {\n      normal: this.readPageAnnoAppearanceStream(annotationPtr, AppearanceMode.Normal),\n      rollover: this.readPageAnnoAppearanceStream(annotationPtr, AppearanceMode.Rollover),\n      down: this.readPageAnnoAppearanceStream(annotationPtr, AppearanceMode.Down)\n    };\n  }\n  /**\n   * Read the appearance stream of annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @param mode - appearance mode\n   * @returns appearance stream\n   *\n   * @private\n   */\n  readPageAnnoAppearanceStream(annotationPtr, mode = AppearanceMode.Normal) {\n    const utf16Length = this.pdfiumModule.FPDFAnnot_GetAP(annotationPtr, mode, 0, 0);\n    const bytesCount = (utf16Length + 1) * 2;\n    const bufferPtr = this.memoryManager.malloc(bytesCount);\n    this.pdfiumModule.FPDFAnnot_GetAP(annotationPtr, mode, bufferPtr, bytesCount);\n    const ap = this.pdfiumModule.pdfium.UTF16ToString(bufferPtr);\n    this.memoryManager.free(bufferPtr);\n    return ap;\n  }\n  /**\n   * Set the appearance stream of annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @param mode - appearance mode\n   * @param apContent - appearance stream content (null to remove)\n   * @returns whether the appearance stream was set successfully\n   *\n   * @private\n   */\n  setPageAnnoAppearanceStream(annotationPtr, mode = AppearanceMode.Normal, apContent) {\n    const bytes = 2 * (apContent.length + 1);\n    const ptr = this.memoryManager.malloc(bytes);\n    try {\n      this.pdfiumModule.pdfium.stringToUTF16(apContent, ptr, bytes);\n      const ok = this.pdfiumModule.FPDFAnnot_SetAP(annotationPtr, mode, ptr);\n      return !!ok;\n    } finally {\n      this.memoryManager.free(ptr);\n    }\n  }\n  /**\n   * Set the rect of specified annotation\n   * @param page - page info that the annotation is belonged to\n   * @param annotationPtr - pointer to annotation object\n   * @param rect - target rectangle\n   * @returns whether the rect is setted\n   *\n   * @private\n   */\n  setPageAnnoRect(page, annotPtr, rect) {\n    const x0d = Math.floor(rect.origin.x);\n    const y0d = Math.floor(rect.origin.y);\n    const x1d = Math.floor(rect.origin.x + rect.size.width);\n    const y1d = Math.floor(rect.origin.y + rect.size.height);\n    const TL = this.convertDevicePointToPagePoint(page, { x: x0d, y: y0d });\n    const TR = this.convertDevicePointToPagePoint(page, { x: x1d, y: y0d });\n    const BR = this.convertDevicePointToPagePoint(page, { x: x1d, y: y1d });\n    const BL = this.convertDevicePointToPagePoint(page, { x: x0d, y: y1d });\n    let left = Math.min(TL.x, TR.x, BR.x, BL.x);\n    let right = Math.max(TL.x, TR.x, BR.x, BL.x);\n    let bottom = Math.min(TL.y, TR.y, BR.y, BL.y);\n    let top = Math.max(TL.y, TR.y, BR.y, BL.y);\n    if (left > right) [left, right] = [right, left];\n    if (bottom > top) [bottom, top] = [top, bottom];\n    const ptr = this.memoryManager.malloc(16);\n    const pdf = this.pdfiumModule.pdfium;\n    pdf.setValue(ptr + 0, left, "float");\n    pdf.setValue(ptr + 4, top, "float");\n    pdf.setValue(ptr + 8, right, "float");\n    pdf.setValue(ptr + 12, bottom, "float");\n    const ok = this.pdfiumModule.FPDFAnnot_SetRect(annotPtr, ptr);\n    this.memoryManager.free(ptr);\n    return !!ok;\n  }\n  /**\n   * Read the rectangle of annotation\n   * @param annotationPtr - pointer to pdf annotation\n   * @returns rectangle of annotation\n   *\n   * @private\n   */\n  readPageAnnoRect(annotationPtr) {\n    const pageRectPtr = this.memoryManager.malloc(4 * 4);\n    const pageRect = {\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0\n    };\n    if (this.pdfiumModule.FPDFAnnot_GetRect(annotationPtr, pageRectPtr)) {\n      pageRect.left = this.pdfiumModule.pdfium.getValue(pageRectPtr, "float");\n      pageRect.top = this.pdfiumModule.pdfium.getValue(pageRectPtr + 4, "float");\n      pageRect.right = this.pdfiumModule.pdfium.getValue(pageRectPtr + 8, "float");\n      pageRect.bottom = this.pdfiumModule.pdfium.getValue(pageRectPtr + 12, "float");\n    }\n    this.memoryManager.free(pageRectPtr);\n    return pageRect;\n  }\n  /**\n   * Get highlight rects for a specific character range (for search highlighting)\n   * @param page - pdf page info\n   * @param pagePtr - pointer to pdf page\n   * @param textPagePtr - pointer to pdf text page\n   * @param startIndex - starting character index\n   * @param charCount - number of characters in the range\n   * @returns array of rectangles for highlighting the specified character range\n   *\n   * @private\n   */\n  getHighlightRects(page, textPagePtr, startIndex, charCount) {\n    const rectsCount = this.pdfiumModule.FPDFText_CountRects(textPagePtr, startIndex, charCount);\n    const highlightRects = [];\n    const l = this.memoryManager.malloc(8);\n    const t = this.memoryManager.malloc(8);\n    const r = this.memoryManager.malloc(8);\n    const b = this.memoryManager.malloc(8);\n    for (let i = 0; i < rectsCount; i++) {\n      const ok = this.pdfiumModule.FPDFText_GetRect(textPagePtr, i, l, t, r, b);\n      if (!ok) continue;\n      const left = this.pdfiumModule.pdfium.getValue(l, "double");\n      const top = this.pdfiumModule.pdfium.getValue(t, "double");\n      const right = this.pdfiumModule.pdfium.getValue(r, "double");\n      const bottom = this.pdfiumModule.pdfium.getValue(b, "double");\n      const p1 = this.convertPagePointToDevicePoint(page, { x: left, y: top });\n      const p2 = this.convertPagePointToDevicePoint(page, { x: right, y: top });\n      const p3 = this.convertPagePointToDevicePoint(page, { x: right, y: bottom });\n      const p4 = this.convertPagePointToDevicePoint(page, { x: left, y: bottom });\n      const xs = [p1.x, p2.x, p3.x, p4.x];\n      const ys = [p1.y, p2.y, p3.y, p4.y];\n      const x = Math.min(...xs);\n      const y = Math.min(...ys);\n      const width = Math.max(...xs) - x;\n      const height = Math.max(...ys) - y;\n      highlightRects.push({\n        origin: { x, y },\n        size: { width: Math.ceil(width), height: Math.ceil(height) }\n      });\n    }\n    this.memoryManager.free(l);\n    this.memoryManager.free(t);\n    this.memoryManager.free(r);\n    this.memoryManager.free(b);\n    return highlightRects;\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.searchAllPages}\n   *\n   * Runs inside the worker.\n   * Emits per-page progress: { page, results }\n   *\n   * @public\n   */\n  searchInPage(doc, page, keyword, flags) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "searchInPage", doc, page, keyword, flags);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `SearchInPage`, "Begin", `${doc.id}-${page.index}`);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "Document is not open"\n      });\n    }\n    const length = 2 * (keyword.length + 1);\n    const keywordPtr = this.memoryManager.malloc(length);\n    this.pdfiumModule.pdfium.stringToUTF16(keyword, keywordPtr, length);\n    try {\n      const results = this.searchAllInPage(ctx, page, keywordPtr, flags);\n      return PdfTaskHelper.resolve(results);\n    } finally {\n      this.memoryManager.free(keywordPtr);\n    }\n  }\n  /**\n   * Get annotations for multiple pages in a single batch.\n   * Emits progress per page for streaming updates.\n   *\n   * @param doc - PDF document\n   * @param pages - Array of pages to process\n   * @returns Task with results keyed by page index, with per-page progress\n   *\n   * @public\n   */\n  getAnnotationsBatch(doc, pages) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "getAnnotationsBatch", doc.id, pages.length);\n    const task = new Task();\n    queueMicrotask(() => {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetAnnotationsBatch", "Begin", doc.id);\n      const ctx = this.cache.getContext(doc.id);\n      if (!ctx) {\n        task.reject({ code: PdfErrorCode.DocNotOpen, message: "Document is not open" });\n        return;\n      }\n      const results = {};\n      const total = pages.length;\n      for (let i = 0; i < pages.length; i++) {\n        const page = pages[i];\n        const annotations = this.readPageAnnotationsRaw(ctx, page);\n        results[page.index] = annotations;\n        task.progress({\n          pageIndex: page.index,\n          result: annotations,\n          completed: i + 1,\n          total\n        });\n      }\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "GetAnnotationsBatch", "End", doc.id);\n      task.resolve(results);\n    });\n    return task;\n  }\n  /**\n   * Search across multiple pages in a single batch.\n   * Emits progress per page for streaming updates.\n   *\n   * @param doc - PDF document\n   * @param pages - Array of pages to search\n   * @param keyword - Search keyword\n   * @param flags - Search flags\n   * @returns Task with results keyed by page index, with per-page progress\n   *\n   * @public\n   */\n  searchBatch(doc, pages, keyword, flags) {\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "searchBatch", doc.id, pages.length, keyword);\n    const task = new Task();\n    queueMicrotask(() => {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "SearchBatch", "Begin", doc.id);\n      const ctx = this.cache.getContext(doc.id);\n      if (!ctx) {\n        task.reject({ code: PdfErrorCode.DocNotOpen, message: "Document is not open" });\n        return;\n      }\n      const length = 2 * (keyword.length + 1);\n      const keywordPtr = this.memoryManager.malloc(length);\n      this.pdfiumModule.pdfium.stringToUTF16(keyword, keywordPtr, length);\n      try {\n        const results = {};\n        const total = pages.length;\n        for (let i = 0; i < pages.length; i++) {\n          const page = pages[i];\n          const pageResults = this.searchAllInPage(ctx, page, keywordPtr, flags);\n          results[page.index] = pageResults;\n          task.progress({\n            pageIndex: page.index,\n            result: pageResults,\n            completed: i + 1,\n            total\n          });\n        }\n        this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, "SearchBatch", "End", doc.id);\n        task.resolve(results);\n      } finally {\n        this.memoryManager.free(keywordPtr);\n      }\n    });\n    return task;\n  }\n  /**\n   * Extract word-aligned context for a search hit.\n   *\n   * @param fullText      full UTF-16 page text (fetch this once per page!)\n   * @param start         index of 1st char that matched\n   * @param count         number of chars in the match\n   * @param windowChars   minimum context chars to keep left & right\n   */\n  buildContext(fullText, start, count, windowChars = 30) {\n    const WORD_BREAK = /[\\s\\u00A0.,;:!?()\\[\\]{}<>/\\\\\\-"\'`"”\\u2013\\u2014]/;\n    const findWordStart = (index) => {\n      while (index > 0 && !WORD_BREAK.test(fullText[index - 1])) index--;\n      return index;\n    };\n    const findWordEnd = (index) => {\n      while (index < fullText.length && !WORD_BREAK.test(fullText[index])) index++;\n      return index;\n    };\n    let left = start;\n    while (left > 0 && WORD_BREAK.test(fullText[left - 1])) left--;\n    let collected = 0;\n    while (left > 0 && collected < windowChars) {\n      left--;\n      if (!WORD_BREAK.test(fullText[left])) collected++;\n    }\n    left = findWordStart(left);\n    let right = start + count;\n    while (right < fullText.length && WORD_BREAK.test(fullText[right])) right++;\n    collected = 0;\n    while (right < fullText.length && collected < windowChars) {\n      if (!WORD_BREAK.test(fullText[right])) collected++;\n      right++;\n    }\n    right = findWordEnd(right);\n    const before = fullText.slice(left, start).replace(/\\s+/g, " ").trimStart();\n    const match = fullText.slice(start, start + count);\n    const after = fullText.slice(start + count, right).replace(/\\s+/g, " ").trimEnd();\n    return {\n      before: this.tidy(before),\n      match: this.tidy(match),\n      after: this.tidy(after),\n      truncatedLeft: left > 0,\n      truncatedRight: right < fullText.length\n    };\n  }\n  /**\n   * Tidy the text to remove any non-printable characters and whitespace\n   * @param s - text to tidy\n   * @returns tidied text\n   *\n   * @private\n   */\n  tidy(s) {\n    return s.replace(/-\\uFFFE\\s*/g, "").replace(/[\\uFFFE\\u00AD\\u200B\\u2060\\uFEFF]/g, "").replace(/\\s+/g, " ");\n  }\n  /**\n   * Search for all occurrences of a keyword on a single page\n   * This method efficiently loads the page only once and finds all matches\n   *\n   * @param docPtr - pointer to pdf document\n   * @param page - pdf page object\n   * @param pageIndex - index of the page\n   * @param keywordPtr - pointer to the search keyword\n   * @param flag - search flags\n   * @returns array of search results on this page\n   *\n   * @private\n   */\n  searchAllInPage(ctx, page, keywordPtr, flag) {\n    return ctx.borrowPage(page.index, (pageCtx) => {\n      const textPagePtr = pageCtx.getTextPage();\n      const total = this.pdfiumModule.FPDFText_CountChars(textPagePtr);\n      const bufPtr = this.memoryManager.malloc(2 * (total + 1));\n      this.pdfiumModule.FPDFText_GetText(textPagePtr, 0, total, bufPtr);\n      const fullText = this.pdfiumModule.pdfium.UTF16ToString(bufPtr);\n      this.memoryManager.free(bufPtr);\n      const pageResults = [];\n      const searchHandle = this.pdfiumModule.FPDFText_FindStart(\n        textPagePtr,\n        keywordPtr,\n        flag,\n        0\n        // Start from the beginning of the page\n      );\n      while (this.pdfiumModule.FPDFText_FindNext(searchHandle)) {\n        const charIndex = this.pdfiumModule.FPDFText_GetSchResultIndex(searchHandle);\n        const charCount = this.pdfiumModule.FPDFText_GetSchCount(searchHandle);\n        const rects = this.getHighlightRects(page, textPagePtr, charIndex, charCount);\n        const context = this.buildContext(fullText, charIndex, charCount);\n        pageResults.push({\n          pageIndex: page.index,\n          charIndex,\n          charCount,\n          rects,\n          context\n        });\n      }\n      this.pdfiumModule.FPDFText_FindClose(searchHandle);\n      return pageResults;\n    });\n  }\n  /**\n   * {@inheritDoc @embedpdf/models!PdfEngine.preparePrintDocument}\n   *\n   * Prepares a PDF document for printing with specified options.\n   * Creates a new document with selected pages and optionally removes annotations\n   * for optimal printing performance.\n   *\n   * @public\n   */\n  preparePrintDocument(doc, options) {\n    const { includeAnnotations = true, pageRange = null } = options ?? {};\n    this.logger.debug(LOG_SOURCE$1, LOG_CATEGORY$1, "preparePrintDocument", doc, options);\n    this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "Begin", doc.id);\n    const ctx = this.cache.getContext(doc.id);\n    if (!ctx) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.DocNotOpen,\n        message: "Document is not open"\n      });\n    }\n    const printDocPtr = this.pdfiumModule.FPDF_CreateNewDocument();\n    if (!printDocPtr) {\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.CantCreateNewDoc,\n        message: "Cannot create print document"\n      });\n    }\n    try {\n      const sanitizedPageRange = this.sanitizePageRange(pageRange, doc.pageCount);\n      if (!this.pdfiumModule.FPDF_ImportPages(\n        printDocPtr,\n        ctx.docPtr,\n        sanitizedPageRange ?? "",\n        0\n        // Insert at beginning\n      )) {\n        this.pdfiumModule.FPDF_CloseDocument(printDocPtr);\n        this.logger.error(LOG_SOURCE$1, LOG_CATEGORY$1, "Failed to import pages for printing");\n        this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n        return PdfTaskHelper.reject({\n          code: PdfErrorCode.CantImportPages,\n          message: "Failed to import pages for printing"\n        });\n      }\n      if (!includeAnnotations) {\n        const removalResult = this.removeAnnotationsFromPrintDocument(printDocPtr);\n        if (!removalResult.success) {\n          this.pdfiumModule.FPDF_CloseDocument(printDocPtr);\n          this.logger.error(\n            LOG_SOURCE$1,\n            LOG_CATEGORY$1,\n            `Failed to remove annotations: ${removalResult.error}`\n          );\n          this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n          return PdfTaskHelper.reject({\n            code: PdfErrorCode.Unknown,\n            message: `Failed to prepare print document: ${removalResult.error}`\n          });\n        }\n        this.logger.debug(\n          LOG_SOURCE$1,\n          LOG_CATEGORY$1,\n          `Removed ${removalResult.annotationsRemoved} annotations from ${removalResult.pagesProcessed} pages`\n        );\n      }\n      const buffer = this.saveDocument(printDocPtr);\n      this.pdfiumModule.FPDF_CloseDocument(printDocPtr);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n      return PdfTaskHelper.resolve(buffer);\n    } catch (error) {\n      if (printDocPtr) {\n        this.pdfiumModule.FPDF_CloseDocument(printDocPtr);\n      }\n      this.logger.error(LOG_SOURCE$1, LOG_CATEGORY$1, "preparePrintDocument failed", error);\n      this.logger.perf(LOG_SOURCE$1, LOG_CATEGORY$1, `PreparePrintDocument`, "End", doc.id);\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.Unknown,\n        message: error instanceof Error ? error.message : "Failed to prepare print document"\n      });\n    }\n  }\n  /**\n   * Removes all annotations from a print document using fast raw annotation functions.\n   * This method is optimized for performance by avoiding full page loading.\n   *\n   * @param printDocPtr - Pointer to the print document\n   * @returns Result object with success status and statistics\n   *\n   * @private\n   */\n  removeAnnotationsFromPrintDocument(printDocPtr) {\n    let totalAnnotationsRemoved = 0;\n    let pagesProcessed = 0;\n    try {\n      const pageCount = this.pdfiumModule.FPDF_GetPageCount(printDocPtr);\n      for (let pageIndex = 0; pageIndex < pageCount; pageIndex++) {\n        const annotCount = this.pdfiumModule.EPDFPage_GetAnnotCountRaw(printDocPtr, pageIndex);\n        if (annotCount <= 0) {\n          pagesProcessed++;\n          continue;\n        }\n        let annotationsRemovedFromPage = 0;\n        for (let annotIndex = annotCount - 1; annotIndex >= 0; annotIndex--) {\n          const removed = this.pdfiumModule.EPDFPage_RemoveAnnotRaw(\n            printDocPtr,\n            pageIndex,\n            annotIndex\n          );\n          if (removed) {\n            annotationsRemovedFromPage++;\n            totalAnnotationsRemoved++;\n          } else {\n            this.logger.warn(\n              LOG_SOURCE$1,\n              LOG_CATEGORY$1,\n              `Failed to remove annotation ${annotIndex} from page ${pageIndex}`\n            );\n          }\n        }\n        if (annotationsRemovedFromPage > 0) {\n          const pagePtr = this.pdfiumModule.FPDF_LoadPage(printDocPtr, pageIndex);\n          if (pagePtr) {\n            this.pdfiumModule.FPDFPage_GenerateContent(pagePtr);\n            this.pdfiumModule.FPDF_ClosePage(pagePtr);\n          }\n        }\n        pagesProcessed++;\n      }\n      return {\n        success: true,\n        annotationsRemoved: totalAnnotationsRemoved,\n        pagesProcessed\n      };\n    } catch (error) {\n      return {\n        success: false,\n        annotationsRemoved: totalAnnotationsRemoved,\n        pagesProcessed,\n        error: error instanceof Error ? error.message : "Unknown error during annotation removal"\n      };\n    }\n  }\n  /**\n   * Sanitizes and validates a page range string.\n   * Ensures page numbers are within valid bounds and properly formatted.\n   *\n   * @param pageRange - Page range string (e.g., "1,3,5-7") or null for all pages\n   * @param totalPages - Total number of pages in the document\n   * @returns Sanitized page range string or null for all pages\n   *\n   * @private\n   */\n  sanitizePageRange(pageRange, totalPages) {\n    if (!pageRange || pageRange.trim() === "") {\n      return null;\n    }\n    try {\n      const sanitized = [];\n      const parts = pageRange.split(",");\n      for (const part of parts) {\n        const trimmed = part.trim();\n        if (trimmed.includes("-")) {\n          const [startStr, endStr] = trimmed.split("-").map((s) => s.trim());\n          const start = parseInt(startStr, 10);\n          const end = parseInt(endStr, 10);\n          if (isNaN(start) || isNaN(end)) {\n            this.logger.warn(LOG_SOURCE$1, LOG_CATEGORY$1, `Invalid range: ${trimmed}`);\n            continue;\n          }\n          const validStart = Math.max(1, Math.min(start, totalPages));\n          const validEnd = Math.max(1, Math.min(end, totalPages));\n          for (let i = validStart; i <= validEnd; i++) {\n            if (!sanitized.includes(i)) {\n              sanitized.push(i);\n            }\n          }\n        } else {\n          const pageNum = parseInt(trimmed, 10);\n          if (isNaN(pageNum)) {\n            this.logger.warn(LOG_SOURCE$1, LOG_CATEGORY$1, `Invalid page number: ${trimmed}`);\n            continue;\n          }\n          const validPageNum = Math.max(1, Math.min(pageNum, totalPages));\n          if (!sanitized.includes(validPageNum)) {\n            sanitized.push(validPageNum);\n          }\n        }\n      }\n      if (sanitized.length === 0) {\n        this.logger.warn(LOG_SOURCE$1, LOG_CATEGORY$1, "No valid pages in range, using all pages");\n        return null;\n      }\n      sanitized.sort((a, b) => a - b);\n      const optimized = [];\n      let rangeStart = sanitized[0];\n      let rangeEnd = sanitized[0];\n      for (let i = 1; i < sanitized.length; i++) {\n        if (sanitized[i] === rangeEnd + 1) {\n          rangeEnd = sanitized[i];\n        } else {\n          if (rangeStart === rangeEnd) {\n            optimized.push(rangeStart.toString());\n          } else if (rangeEnd - rangeStart === 1) {\n            optimized.push(rangeStart.toString());\n            optimized.push(rangeEnd.toString());\n          } else {\n            optimized.push(`${rangeStart}-${rangeEnd}`);\n          }\n          rangeStart = sanitized[i];\n          rangeEnd = sanitized[i];\n        }\n      }\n      if (rangeStart === rangeEnd) {\n        optimized.push(rangeStart.toString());\n      } else if (rangeEnd - rangeStart === 1) {\n        optimized.push(rangeStart.toString());\n        optimized.push(rangeEnd.toString());\n      } else {\n        optimized.push(`${rangeStart}-${rangeEnd}`);\n      }\n      const result = optimized.join(",");\n      this.logger.debug(\n        LOG_SOURCE$1,\n        LOG_CATEGORY$1,\n        `Sanitized page range: "${pageRange}" -> "${result}"`\n      );\n      return result;\n    } catch (error) {\n      this.logger.error(LOG_SOURCE$1, LOG_CATEGORY$1, `Error sanitizing page range: ${error}`);\n      return null;\n    }\n  }\n}\nconst LOG_SOURCE = "PdfiumNativeRunner";\nconst LOG_CATEGORY = "Worker";\nclass PdfiumNativeRunner {\n  constructor(logger) {\n    this.native = null;\n    this.activeTasks = /* @__PURE__ */ new Map();\n    this.logger = logger ?? new NoopLogger();\n    this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "PdfiumNativeRunner created");\n  }\n  /**\n   * Initialize PDFium with WASM binary\n   */\n  async prepare(wasmBinary, logger) {\n    this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "Preparing PDFium...");\n    try {\n      const module = await init({ wasmBinary });\n      this.native = new PdfiumNative(module, { logger: logger ?? this.logger });\n      this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "PDFium initialized successfully");\n    } catch (error) {\n      this.logger.error(LOG_SOURCE, LOG_CATEGORY, "Failed to initialize PDFium:", error);\n      throw error;\n    }\n  }\n  /**\n   * Start listening for messages\n   */\n  listen() {\n    self.onmessage = (evt) => {\n      this.handle(evt);\n    };\n    this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "Listening for messages");\n  }\n  /**\n   * Handle incoming messages\n   */\n  handle(evt) {\n    const request = evt.data;\n    this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "Received message:", request.type);\n    try {\n      switch (request.type) {\n        case "init":\n          this.handleInit(request);\n          break;\n        case "execute":\n          this.handleExecute(request);\n          break;\n        default:\n          this.logger.warn(LOG_SOURCE, LOG_CATEGORY, "Unknown message type:", request.type);\n      }\n    } catch (error) {\n      this.logger.error(LOG_SOURCE, LOG_CATEGORY, "Error handling message:", error);\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.Unknown, message: String(error) }\n        }\n      });\n    }\n  }\n  /**\n   * Handle initialization request\n   */\n  async handleInit(request) {\n    if (!request.wasmUrl) {\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.Unknown, message: "Missing wasmUrl" }\n        }\n      });\n      return;\n    }\n    try {\n      const response = await fetch(request.wasmUrl);\n      const wasmBinary = await response.arrayBuffer();\n      await this.prepare(wasmBinary);\n      this.respond({\n        id: request.id,\n        type: "ready"\n      });\n    } catch (error) {\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.Unknown, message: String(error) }\n        }\n      });\n    }\n  }\n  /**\n   * Handle method execution request\n   */\n  async handleExecute(request) {\n    if (!this.native) {\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.NotReady, message: "PDFium not initialized" }\n        }\n      });\n      return;\n    }\n    if (!request.method) {\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.Unknown, message: "Missing method name" }\n        }\n      });\n      return;\n    }\n    const method = request.method;\n    const args = request.args ?? [];\n    if (!(method in this.native) || typeof this.native[method] !== "function") {\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.NotSupport, message: `Method ${method} not supported` }\n        }\n      });\n      return;\n    }\n    try {\n      this.logger.debug(LOG_SOURCE, LOG_CATEGORY, `Executing method: ${method}`);\n      const result = this.native[method](...args);\n      if (result && typeof result === "object" && "wait" in result) {\n        const task = result;\n        this.activeTasks.set(request.id, task);\n        task.onProgress((progress) => {\n          this.respond({\n            id: request.id,\n            type: "progress",\n            progress\n          });\n        });\n        task.wait(\n          (data) => {\n            this.logger.debug(LOG_SOURCE, LOG_CATEGORY, `Method ${method} resolved`);\n            this.respond({\n              id: request.id,\n              type: "result",\n              data\n            });\n            this.activeTasks.delete(request.id);\n          },\n          (error) => {\n            this.logger.debug(LOG_SOURCE, LOG_CATEGORY, `Method ${method} failed:`, error);\n            this.respond({\n              id: request.id,\n              type: "error",\n              error\n            });\n            this.activeTasks.delete(request.id);\n          }\n        );\n      } else {\n        this.respond({\n          id: request.id,\n          type: "result",\n          data: result\n        });\n      }\n    } catch (error) {\n      this.logger.error(LOG_SOURCE, LOG_CATEGORY, `Error executing ${method}:`, error);\n      this.respond({\n        id: request.id,\n        type: "error",\n        error: {\n          type: "reject",\n          reason: { code: PdfErrorCode.Unknown, message: String(error) }\n        }\n      });\n    }\n  }\n  /**\n   * Send response back to main thread\n   */\n  respond(response) {\n    this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "Sending response:", response.type);\n    self.postMessage(response);\n  }\n  /**\n   * Ready notification\n   */\n  ready() {\n    this.listen();\n    this.respond({\n      id: "0",\n      type: "ready"\n    });\n    this.logger.debug(LOG_SOURCE, LOG_CATEGORY, "Runner is ready");\n  }\n}\nclass PdfiumEngineRunner extends PdfiumNativeRunner {\n  /**\n   * Create an instance of PdfiumEngineRunner\n   * @param wasmBinary - wasm binary that contains the pdfium wasm file\n   * @param logger - optional logger instance\n   * @param fontFallback - optional font fallback configuration\n   */\n  constructor(wasmBinary, logger, fontFallback) {\n    super(logger);\n    this.wasmBinary = wasmBinary;\n    this.fontFallback = fontFallback;\n  }\n  /**\n   * Initialize runner\n   */\n  async prepare() {\n    const wasmBinary = this.wasmBinary;\n    const wasmModule = await init({ wasmBinary });\n    this.native = new PdfiumNative(wasmModule, {\n      logger: this.logger,\n      fontFallback: this.fontFallback\n    });\n    this.ready();\n  }\n}\nconst fonts$6 = [\n  { file: "NotoSansJP-Thin.otf", weight: 100 },\n  { file: "NotoSansJP-Light.otf", weight: 300 },\n  { file: "NotoSansJP-DemiLight.otf", weight: 350 },\n  { file: "NotoSansJP-Regular.otf", weight: 400 },\n  { file: "NotoSansJP-Medium.otf", weight: 500 },\n  { file: "NotoSansJP-Bold.otf", weight: 700 },\n  { file: "NotoSansJP-Black.otf", weight: 900 }\n];\nconst fonts$5 = [\n  { file: "NotoSansKR-Thin.otf", weight: 100 },\n  { file: "NotoSansKR-Light.otf", weight: 300 },\n  { file: "NotoSansKR-DemiLight.otf", weight: 350 },\n  { file: "NotoSansKR-Regular.otf", weight: 400 },\n  { file: "NotoSansKR-Medium.otf", weight: 500 },\n  { file: "NotoSansKR-Bold.otf", weight: 700 },\n  { file: "NotoSansKR-Black.otf", weight: 900 }\n];\nconst fonts$4 = [\n  { file: "NotoSansHans-Light.otf", weight: 300 },\n  { file: "NotoSansHans-DemiLight.otf", weight: 350 },\n  { file: "NotoSansHans-Regular.otf", weight: 400 },\n  { file: "NotoSansHans-Medium.otf", weight: 500 },\n  { file: "NotoSansHans-Bold.otf", weight: 700 }\n];\nconst fonts$3 = [\n  { file: "NotoSansHant-Thin.otf", weight: 100 },\n  { file: "NotoSansHant-Light.otf", weight: 300 },\n  { file: "NotoSansHant-DemiLight.otf", weight: 350 },\n  { file: "NotoSansHant-Regular.otf", weight: 400 },\n  { file: "NotoSansHant-Medium.otf", weight: 500 },\n  { file: "NotoSansHant-Bold.otf", weight: 700 },\n  { file: "NotoSansHant-Black.otf", weight: 900 }\n];\nconst fonts$2 = [\n  { file: "NotoNaskhArabic-Regular.ttf", weight: 400 },\n  { file: "NotoNaskhArabic-Bold.ttf", weight: 700 }\n];\nconst fonts$1 = [\n  { file: "NotoSansHebrew-Regular.ttf", weight: 400 },\n  { file: "NotoSansHebrew-Bold.ttf", weight: 700 }\n];\nconst fonts = [\n  // Thin (100)\n  { file: "NotoSans-Thin.ttf", weight: 100 },\n  { file: "NotoSans-ThinItalic.ttf", weight: 100, italic: true },\n  // ExtraLight (200)\n  { file: "NotoSans-ExtraLight.ttf", weight: 200 },\n  { file: "NotoSans-ExtraLightItalic.ttf", weight: 200, italic: true },\n  // Light (300)\n  { file: "NotoSans-Light.ttf", weight: 300 },\n  { file: "NotoSans-LightItalic.ttf", weight: 300, italic: true },\n  // Regular (400)\n  { file: "NotoSans-Regular.ttf", weight: 400 },\n  { file: "NotoSans-Italic.ttf", weight: 400, italic: true },\n  // Medium (500)\n  { file: "NotoSans-Medium.ttf", weight: 500 },\n  { file: "NotoSans-MediumItalic.ttf", weight: 500, italic: true },\n  // SemiBold (600)\n  { file: "NotoSans-SemiBold.ttf", weight: 600 },\n  { file: "NotoSans-SemiBoldItalic.ttf", weight: 600, italic: true },\n  // Bold (700)\n  { file: "NotoSans-Bold.ttf", weight: 700 },\n  { file: "NotoSans-BoldItalic.ttf", weight: 700, italic: true },\n  // ExtraBold (800)\n  { file: "NotoSans-ExtraBold.ttf", weight: 800 },\n  { file: "NotoSans-ExtraBoldItalic.ttf", weight: 800, italic: true },\n  // Black (900)\n  { file: "NotoSans-Black.ttf", weight: 900 },\n  { file: "NotoSans-BlackItalic.ttf", weight: 900, italic: true }\n];\nfunction buildCdnUrls(version = "latest") {\n  return {\n    jp: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-jp@${version}/fonts`,\n    kr: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-kr@${version}/fonts`,\n    sc: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-sc@${version}/fonts`,\n    tc: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-tc@${version}/fonts`,\n    arabic: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-arabic@${version}/fonts`,\n    hebrew: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-hebrew@${version}/fonts`,\n    latin: `https://cdn.jsdelivr.net/npm/@embedpdf/fonts-latin@${version}/fonts`\n  };\n}\nfunction toFontVariants(fonts2, baseUrl) {\n  return fonts2.map((f) => ({\n    url: `${baseUrl}/${f.file}`,\n    weight: f.weight,\n    italic: f.italic\n  }));\n}\nfunction buildCdnFontConfig(urls) {\n  return {\n    fonts: {\n      [FontCharset.SHIFTJIS]: toFontVariants(fonts$6, urls.jp),\n      [FontCharset.HANGEUL]: toFontVariants(fonts$5, urls.kr),\n      [FontCharset.GB2312]: toFontVariants(fonts$4, urls.sc),\n      [FontCharset.CHINESEBIG5]: toFontVariants(fonts$3, urls.tc),\n      [FontCharset.ARABIC]: toFontVariants(fonts$2, urls.arabic),\n      [FontCharset.HEBREW]: toFontVariants(fonts$1, urls.hebrew),\n      [FontCharset.CYRILLIC]: toFontVariants(fonts, urls.latin),\n      [FontCharset.GREEK]: toFontVariants(fonts, urls.latin),\n      [FontCharset.VIETNAMESE]: toFontVariants(fonts, urls.latin)\n    }\n  };\n}\nconst FONT_CDN_URLS = buildCdnUrls("latest");\nconst cdnFontConfig = buildCdnFontConfig(FONT_CDN_URLS);\nlet runner = null;\nself.onmessage = async (event) => {\n  const { type, wasmUrl, logger: serializedLogger, fontFallback } = event.data;\n  if (type === "wasmInit" && wasmUrl && !runner) {\n    try {\n      const response = await fetch(wasmUrl);\n      const wasmBinary = await response.arrayBuffer();\n      const logger = serializedLogger ? deserializeLogger(serializedLogger) : void 0;\n      const effectiveFontFallback = fontFallback === null ? void 0 : fontFallback ?? cdnFontConfig;\n      runner = new PdfiumEngineRunner(wasmBinary, logger, effectiveFontFallback);\n      await runner.prepare();\n    } catch (error) {\n      const message = error instanceof Error ? error.message : String(error);\n      self.postMessage({ type: "wasmError", error: message });\n    }\n  }\n};\n'],{type:"application/javascript"})),{type:"module"}),d=new l(s,{wasmUrl:e,logger:r,fontFallback:i}),c=URL.createObjectURL(new Blob(['async function encodeImage(imageData, imageType, quality) {\n  if (typeof OffscreenCanvas === "undefined") {\n    throw new Error("OffscreenCanvas is not available in this worker environment");\n  }\n  const { data, width, height } = imageData;\n  const imgData = new ImageData(new Uint8ClampedArray(data), width, height);\n  const canvas = new OffscreenCanvas(width, height);\n  const ctx = canvas.getContext("2d");\n  if (!ctx) {\n    throw new Error("Failed to get 2D context from OffscreenCanvas");\n  }\n  ctx.putImageData(imgData, 0, 0);\n  return canvas.convertToBlob({ type: imageType, quality });\n}\nself.onmessage = async (event) => {\n  const request = event.data;\n  if (request.type !== "encode") {\n    return;\n  }\n  try {\n    const { imageData, imageType, quality } = request.data;\n    const blob = await encodeImage(imageData, imageType, quality);\n    const response = {\n      id: request.id,\n      type: "result",\n      data: blob\n    };\n    self.postMessage(response);\n  } catch (error) {\n    const response = {\n      id: request.id,\n      type: "error",\n      data: {\n        message: error instanceof Error ? error.message : String(error)\n      }\n    };\n    self.postMessage(response);\n  }\n};\n'],{type:"application/javascript"})),m=new u(a??2,c,r);return new o.P(d,{imageConverter:(0,o.c)(m),logger:r})}},580(e,t,n){n.d(t,{P:()=>u,b:()=>p,c:()=>h});var o=n(754);const r="TaskQueue",a="Queue";var i,s=((i=s||{})[i.CRITICAL=3]="CRITICAL",i[i.HIGH=2]="HIGH",i[i.MEDIUM=1]="MEDIUM",i[i.LOW=0]="LOW",i);class l{constructor(e={}){this.queue=[],this.running=0,this.resultTasks=new Map,this.idleListeners=new Set;const{concurrency:t=1,comparator:n,ranker:r,onIdle:a,maxQueueSize:i,autoStart:s=!0,logger:l}=e;this.logger=l??new o.N,this.opts={concurrency:Math.max(1,t),comparator:n,ranker:r,onIdle:a??(()=>{}),maxQueueSize:i??Number.POSITIVE_INFINITY,autoStart:s}}setComparator(e){this.opts.comparator=e}setRanker(e){this.opts.ranker=e}size(){return this.queue.length}inFlight(){return this.running}isIdle(){return 0===this.queue.length&&0===this.running}async drain(){this.isIdle()||await new Promise(e=>{const t=()=>{this.isIdle()&&(this.offIdle(t),e())};this.onIdle(t)})}notifyIdle(){this.isIdle()&&([...this.idleListeners].forEach(e=>e()),this.idleListeners.clear(),this.opts.onIdle())}onIdle(e){this.idleListeners.add(e)}offIdle(e){this.idleListeners.delete(e)}enqueue(e,t={}){const n=this.generateId(),i=t.priority??1,s=new o.T;if(this.queue.length>=this.opts.maxQueueSize){const e=new Error("Queue is full (maxQueueSize reached).");return s.reject(e),s}this.resultTasks.set(n,s);const l={id:n,priority:i,meta:t.meta??e.meta,executeFactory:e.execute};this.queue.push(l),this.logger.debug(r,a,`Task enqueued: ${n} | Priority: ${i} | Running: ${this.running} | Queued: ${this.queue.length}`);const d=s.abort.bind(s);return s.abort=e=>{this.logger.debug(r,a,`Task aborted: ${n}`),this.cancel(n),d(e)},this.opts.autoStart&&this.process(!0===t.fifo),s}cancel(e){const t=this.queue.length;this.queue=this.queue.filter(t=>t.id!==e||(t.cancelled=!0,!1)),this.resultTasks.delete(e),t!==this.queue.length&&(this.logger.debug(r,a,`Task cancelled and removed: ${e}`),this.kick())}kick(){queueMicrotask(()=>this.process())}async process(e=!1){for(this.logger.debug(r,a,`process() called | Running: ${this.running} | Concurrency: ${this.opts.concurrency} | Queued: ${this.queue.length}`);this.running<this.opts.concurrency&&this.queue.length>0;){this.logger.debug(r,a,`Starting new task | Running: ${this.running} | Queued: ${this.queue.length}`),e||this.sortQueue();const t=this.queue.shift();if(t.cancelled){this.logger.debug(r,a,`Skipping cancelled task: ${t.id}`);continue}const n=this.resultTasks.get(t.id);n&&(this.running++,(async()=>{let e=null;try{if(e=t.executeFactory(),!e)throw new Error("Task factory returned null/undefined");e.wait(e=>{0===n.state.stage&&n.resolve(e)},e=>{0===n.state.stage&&("abort"===e.type?n.abort(e.reason):n.reject(e.reason))}),e.onProgress(e=>{n.progress(e)}),await e.toPromise()}catch(e){0===n.state.stage&&n.reject(e)}finally{this.resultTasks.delete(t.id),this.running--,this.logger.debug(r,a,`Task completed: ${t.id} | Running: ${this.running} | Queued: ${this.queue.length}`),this.isIdle()?this.notifyIdle():this.queue.length>0&&this.kick()}})().catch(e=>{this.logger.error(r,a,"Unhandled error in task execution wrapper:",e),this.running=Math.max(0,this.running-1),this.isIdle()?this.notifyIdle():this.queue.length>0&&this.kick()}))}}sortQueue(){const{comparator:e,ranker:t}=this.opts;if(e)return void this.queue.sort(e);const n=new Map,o=e=>t?(n.has(e.id)||n.set(e.id,t(e)),n.get(e.id)):this.defaultRank(e);this.queue.sort((e,t)=>{if(e.priority!==t.priority)return t.priority-e.priority;const n=o(e),r=o(t);return n!==r?r-n:this.extractTime(e.id)-this.extractTime(t.id)})}defaultRank(e){return 0}generateId(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2)}`}extractTime(e){const t=Number(e.split("-")[0]);return Number.isFinite(t)?t:0}}const d="PdfEngine",c="Orchestrator";class u{constructor(e,t){this.executor=e,this.logger=t.logger??new o.N,this.options={imageConverter:t.imageConverter,fetcher:t.fetcher??("undefined"!=typeof fetch?(e,t)=>fetch(e,t):void 0),logger:this.logger},this.workerQueue=new l({concurrency:1,autoStart:!0,logger:this.logger}),this.logger.debug(d,c,"PdfEngine orchestrator created")}chunkArray(e,t){const n=[];for(let o=0;o<e.length;o+=t)n.push(e.slice(o,o+t));return n}isSupport(e){const t=new o.T;return t.resolve([o.G.Create,o.G.Read,o.G.Update,o.G.Delete]),t}destroy(){const e=new o.T;try{this.executor.destroy(),e.resolve(!0)}catch(t){e.reject({code:o.P.Unknown,message:String(t)})}return e}openDocumentUrl(e,t){const n=new o.T;return(async()=>{try{if(!this.options.fetcher)throw new Error("Fetcher is not set");const o=await this.options.fetcher(e.url,null==t?void 0:t.requestOptions),r=await o.arrayBuffer(),a={id:e.id,content:r};this.openDocumentBuffer(a,{password:null==t?void 0:t.password}).wait(e=>n.resolve(e),e=>n.fail(e))}catch(e){n.reject({code:o.P.Unknown,message:String(e)})}})(),n}openDocumentBuffer(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.openDocumentBuffer(e,t),meta:{docId:e.id,operation:"openDocumentBuffer"}},{priority:s.CRITICAL})}getMetadata(e){return this.workerQueue.enqueue({execute:()=>this.executor.getMetadata(e),meta:{docId:e.id,operation:"getMetadata"}},{priority:s.MEDIUM})}setMetadata(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.setMetadata(e,t),meta:{docId:e.id,operation:"setMetadata"}},{priority:s.MEDIUM})}getDocPermissions(e){return this.workerQueue.enqueue({execute:()=>this.executor.getDocPermissions(e),meta:{docId:e.id,operation:"getDocPermissions"}},{priority:s.MEDIUM})}getDocUserPermissions(e){return this.workerQueue.enqueue({execute:()=>this.executor.getDocUserPermissions(e),meta:{docId:e.id,operation:"getDocUserPermissions"}},{priority:s.MEDIUM})}getSignatures(e){return this.workerQueue.enqueue({execute:()=>this.executor.getSignatures(e),meta:{docId:e.id,operation:"getSignatures"}},{priority:s.MEDIUM})}getBookmarks(e){return this.workerQueue.enqueue({execute:()=>this.executor.getBookmarks(e),meta:{docId:e.id,operation:"getBookmarks"}},{priority:s.MEDIUM})}setBookmarks(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.setBookmarks(e,t),meta:{docId:e.id,operation:"setBookmarks"}},{priority:s.MEDIUM})}deleteBookmarks(e){return this.workerQueue.enqueue({execute:()=>this.executor.deleteBookmarks(e),meta:{docId:e.id,operation:"deleteBookmarks"}},{priority:s.MEDIUM})}renderPage(e,t,n){return this.renderWithEncoding(()=>this.executor.renderPageRaw(e,t,n),n,e.id,t.index,s.CRITICAL)}renderPageRect(e,t,n,o){return this.renderWithEncoding(()=>this.executor.renderPageRect(e,t,n,o),o,e.id,t.index,s.HIGH)}renderThumbnail(e,t,n){return this.renderWithEncoding(()=>this.executor.renderThumbnailRaw(e,t,n),n,e.id,t.index,s.MEDIUM)}renderPageAnnotation(e,t,n,o){return this.renderWithEncoding(()=>this.executor.renderPageAnnotationRaw(e,t,n,o),o,e.id,t.index,s.MEDIUM)}renderWithEncoding(e,t,n,r,a=s.CRITICAL){const i=new o.T,l=this.workerQueue.enqueue({execute:()=>e(),meta:{docId:n,pageIndex:r,operation:"render"}},{priority:a}),d=i.abort.bind(i);return i.abort=e=>{l.abort(e),d(e)},l.wait(e=>{0===i.state.stage&&this.encodeImage(e,t,i)},e=>{0===i.state.stage&&i.fail(e)}),i}encodeImage(e,t,n){const r=(null==t?void 0:t.imageType)??"image/webp",a=null==t?void 0:t.quality,i={data:new Uint8ClampedArray(e.data),width:e.width,height:e.height};this.options.imageConverter(()=>i,r,a).then(e=>n.resolve(e)).catch(e=>n.reject({code:o.P.Unknown,message:String(e)}))}getPageAnnotations(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.getPageAnnotations(e,t),meta:{docId:e.id,pageIndex:t.index,operation:"getPageAnnotations"}},{priority:s.MEDIUM})}createPageAnnotation(e,t,n,o){return this.workerQueue.enqueue({execute:()=>this.executor.createPageAnnotation(e,t,n,o),meta:{docId:e.id,pageIndex:t.index,operation:"createPageAnnotation"}},{priority:s.MEDIUM})}updatePageAnnotation(e,t,n){return this.workerQueue.enqueue({execute:()=>this.executor.updatePageAnnotation(e,t,n),meta:{docId:e.id,pageIndex:t.index,operation:"updatePageAnnotation"}},{priority:s.MEDIUM})}removePageAnnotation(e,t,n){return this.workerQueue.enqueue({execute:()=>this.executor.removePageAnnotation(e,t,n),meta:{docId:e.id,pageIndex:t.index,operation:"removePageAnnotation"}},{priority:s.MEDIUM})}getAllAnnotations(e){const t=this.chunkArray(e.pages,500);this.logger.debug(d,c,`getAllAnnotations: ${e.pages.length} pages in ${t.length} chunks`);const n=new o.H({aggregate:e=>Object.assign({},...e)});return t.forEach((t,o)=>{const r=this.workerQueue.enqueue({execute:()=>this.executor.getAnnotationsBatch(e,t),meta:{docId:e.id,operation:"getAnnotationsBatch",chunkSize:t.length}},{priority:s.LOW});r.onProgress(e=>{n.progress({page:e.pageIndex,result:e.result})}),n.addChild(r,o)}),n.finalize(),n}getPageTextRects(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.getPageTextRects(e,t),meta:{docId:e.id,pageIndex:t.index,operation:"getPageTextRects"}},{priority:s.MEDIUM})}searchAllPages(e,t,n){const r=Array.isArray(null==n?void 0:n.flags)?n.flags.reduce((e,t)=>e|t,0):(null==n?void 0:n.flags)??0,a=this.chunkArray(e.pages,25);this.logger.debug(d,c,`searchAllPages: ${e.pages.length} pages in ${a.length} chunks`);const i=new o.H({aggregate:e=>{const t=e.flatMap(e=>Object.values(e).flat());return{results:t,total:t.length}}});return a.forEach((n,o)=>{const a=this.workerQueue.enqueue({execute:()=>this.executor.searchBatch(e,n,t,r),meta:{docId:e.id,operation:"searchBatch",chunkSize:n.length}},{priority:s.LOW});a.onProgress(e=>{i.progress({page:e.pageIndex,results:e.result})}),i.addChild(a,o)}),i.finalize(),i}getAttachments(e){return this.workerQueue.enqueue({execute:()=>this.executor.getAttachments(e),meta:{docId:e.id,operation:"getAttachments"}},{priority:s.MEDIUM})}addAttachment(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.addAttachment(e,t),meta:{docId:e.id,operation:"addAttachment"}},{priority:s.MEDIUM})}removeAttachment(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.removeAttachment(e,t),meta:{docId:e.id,operation:"removeAttachment"}},{priority:s.MEDIUM})}readAttachmentContent(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.readAttachmentContent(e,t),meta:{docId:e.id,operation:"readAttachmentContent"}},{priority:s.MEDIUM})}setFormFieldValue(e,t,n,o){return this.workerQueue.enqueue({execute:()=>this.executor.setFormFieldValue(e,t,n,o),meta:{docId:e.id,pageIndex:t.index,operation:"setFormFieldValue"}},{priority:s.MEDIUM})}flattenPage(e,t,n){return this.workerQueue.enqueue({execute:()=>this.executor.flattenPage(e,t,n),meta:{docId:e.id,pageIndex:t.index,operation:"flattenPage"}},{priority:s.MEDIUM})}extractPages(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.extractPages(e,t),meta:{docId:e.id,pageIndexes:t,operation:"extractPages"}},{priority:s.MEDIUM})}extractText(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.extractText(e,t),meta:{docId:e.id,pageIndexes:t,operation:"extractText"}},{priority:s.MEDIUM})}redactTextInRects(e,t,n,o){return this.workerQueue.enqueue({execute:()=>this.executor.redactTextInRects(e,t,n,o),meta:{docId:e.id,pageIndex:t.index,operation:"redactTextInRects"}},{priority:s.MEDIUM})}getTextSlices(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.getTextSlices(e,t),meta:{docId:e.id,slices:t,operation:"getTextSlices"}},{priority:s.MEDIUM})}getPageGlyphs(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.getPageGlyphs(e,t),meta:{docId:e.id,pageIndex:t.index,operation:"getPageGlyphs"}},{priority:s.MEDIUM})}getPageGeometry(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.getPageGeometry(e,t),meta:{docId:e.id,pageIndex:t.index,operation:"getPageGeometry"}},{priority:s.MEDIUM})}merge(e){return this.workerQueue.enqueue({execute:()=>this.executor.merge(e),meta:{docId:e.map(e=>e.id).join(","),operation:"merge"}},{priority:s.MEDIUM})}mergePages(e){return this.workerQueue.enqueue({execute:()=>this.executor.mergePages(e),meta:{docId:e.map(e=>e.docId).join(","),operation:"mergePages"}},{priority:s.MEDIUM})}preparePrintDocument(e,t){return this.workerQueue.enqueue({execute:()=>this.executor.preparePrintDocument(e,t),meta:{docId:e.id,operation:"preparePrintDocument"}},{priority:s.MEDIUM})}saveAsCopy(e){return this.workerQueue.enqueue({execute:()=>this.executor.saveAsCopy(e),meta:{docId:e.id,operation:"saveAsCopy"}},{priority:s.MEDIUM})}closeDocument(e){return this.workerQueue.enqueue({execute:()=>this.executor.closeDocument(e),meta:{docId:e.id,operation:"closeDocument"}},{priority:s.MEDIUM})}closeAllDocuments(){return this.workerQueue.enqueue({execute:()=>this.executor.closeAllDocuments(),meta:{operation:"closeAllDocuments"}},{priority:s.MEDIUM})}}class m extends Error{constructor(e){super(e),this.name="ImageConverterError"}}const p=(e,t="image/webp",n)=>{if("undefined"==typeof document)return Promise.reject(new m("document is not available. This converter requires a browser environment."));const o=e(),r=new ImageData(o.data,o.width,o.height);return new Promise((e,o)=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").putImageData(r,0,0),a.toBlob(t=>{t?e(t):o(new m("Canvas toBlob returned null"))},t,n)})};function h(e){return async(t,n="image/webp",o)=>{try{const r=t(),a=new Uint8ClampedArray(r.data);return await e.encode({data:a,width:r.width,height:r.height},n,o)}catch(e){return console.warn("Worker encoding failed, falling back to main-thread Canvas:",e),p(t,n,o)}}}},754(e,t,n){function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function r(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,l,"next",e)}function l(e){r(i,o,a,s,l,"throw",e)}s(void 0)})}}function i(e,t,n){return t=u(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,p()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,y(o.key),o)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=x(e))||t){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function c(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(p=function(){return!!e})()}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var l=o&&o.prototype instanceof s?o:s,d=Object.create(l.prototype);return P(d,"_invoke",function(n,o,r){var a,s,l,d=0,c=r||[],u=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,s=0,l=e,m.n=n,i}};function p(n,o){for(s=n,l=o,t=0;!u&&d&&!r&&t<c.length;t++){var r,a=c[t],p=m.p,h=a[2];n>3?(r=h===o)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=n<2&&p<a[1])?(s=0,m.v=o,m.n=a[1]):p<h&&(r=n<3||a[0]>o||o>h)&&(a[4]=n,a[5]=o,m.n=h,s=0))}if(r||n>1)return i;throw u=!0,o}return function(r,c,h){if(d>1)throw TypeError("Generator is already running");for(u&&1===c&&p(c,h),s=c,l=h;(t=s<2?e:l)||!u;){a||(s?s<3?(s>1&&(m.n=-1),p(s,l)):m.n=l:m.v=l);try{if(d=2,a){if(s||(r="next"),t=a[r]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);a=e}else if((t=(u=m.n<0)?l:n.call(o,m))!==i)break}catch(t){a=e,s=1,l=t}finally{d=1}}return{value:t,done:u}}}(n,r,a),!0),d}var i={};function s(){}function l(){}function d(){}t=Object.getPrototypeOf;var c=[][o]?t(t([][o]())):(P(t={},o,function(){return this}),t),u=d.prototype=s.prototype=Object.create(c);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,P(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=d,P(u,"constructor",d),P(d,"constructor",l),l.displayName="GeneratorFunction",P(d,r,"GeneratorFunction"),P(u),P(u,r,"Generator"),P(u,o,function(){return this}),P(u,"toString",function(){return"[object Generator]"}),(F=function(){return{w:a,m}})()}function P(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}P=function(e,t,n,o){function a(t,n){P(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},P(e,t,n,o)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,s=[],l=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(l=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){d=!0,r=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw r}}return s}}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function x(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}n.d(t,{A:()=>Ct,B:()=>at,C:()=>st,D:()=>_t,E:()=>St,F:()=>qt,G:()=>jt,H:()=>vn,K:()=>IF,N:()=>lt,O:()=>ir,P:()=>Ut,Q:()=>hi,R:()=>He,T:()=>ft,a:()=>Wt,b:()=>Et,c:()=>$t,d:()=>bt,e:()=>Mt,f:()=>Ot,g:()=>It,h:()=>kt,i:()=>bn,j:()=>wt,k:()=>vt,l:()=>Ht,m:()=>Yt,n:()=>Xt,o:()=>yt,p:()=>Kt,q:()=>Ze,r:()=>Qe,s:()=>Fn,t:()=>Rt,u:()=>_n,v:()=>Nt,w:()=>Vt,x:()=>zt,y:()=>Tt,z:()=>qe});var A,w,S,E,C,M,k,T,I,O,R,G,L={},N=[],z=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,j=Array.isArray;function B(e,t){for(var n in t)e[n]=t[n];return e}function $(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function U(e,t,n){var o,r,a,i={};for(a in t)"key"==a?o=t[a]:"ref"==a?r=t[a]:i[a]=t[a];if(arguments.length>2&&(i.children=arguments.length>3?A.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===i[a]&&(i[a]=e.defaultProps[a]);return W(e,i,o,r,null)}function W(e,t,n,o,r){var a={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==r?++S:r,__i:-1,__u:0};return null==r&&null!=w.vnode&&w.vnode(a),a}function H(e){return e.children}function V(e,t){this.props=e,this.context=t}function Y(e,t){if(null==t)return e.__?Y(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?Y(e):null}function q(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return q(e)}}function K(e){(!e.__d&&(e.__d=!0)&&E.push(e)&&!X.__r++||C!=w.debounceRendering)&&((C=w.debounceRendering)||M)(X)}function X(){for(var e,t,n,o,r,a,i,s=1;E.length;)E.length>s&&E.sort(k),e=E.shift(),s=E.length,e.__d&&(n=void 0,o=void 0,r=(o=(t=e).__v).__e,a=[],i=[],t.__P&&((n=B({},o)).__v=o.__v+1,w.vnode&&w.vnode(n),re(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[r]:null,a,null==r?Y(o):r,!!(32&o.__u),i),n.__v=o.__v,n.__.__k[n.__i]=n,ie(a,n,i),o.__e=o.__=null,n.__e!=r&&q(n)));X.__r=0}function Z(e,t,n,o,r,a,i,s,l,d,c){var u,m,p,h,g,f,F,P=o&&o.__k||N,b=t.length;for(l=function(e,t,n,o,r){var a,i,s,l,d,c=n.length,u=c,m=0;for(e.__k=new Array(r),a=0;a<r;a++)null!=(i=t[a])&&"boolean"!=typeof i&&"function"!=typeof i?("string"==typeof i||"number"==typeof i||"bigint"==typeof i||i.constructor==String?i=e.__k[a]=W(null,i,null,null,null):j(i)?i=e.__k[a]=W(H,{children:i},null,null,null):null==i.constructor&&i.__b>0?i=e.__k[a]=W(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):e.__k[a]=i,l=a+m,i.__=e,i.__b=e.__b+1,-1!=(d=i.__i=ee(i,n,l,u))&&(u--,(s=n[d])&&(s.__u|=2)),null==s||null==s.__v?(-1==d&&(r>c?m--:r<c&&m++),"function"!=typeof i.type&&(i.__u|=4)):d!=l&&(d==l-1?m--:d==l+1?m++:(d>l?m--:m++,i.__u|=4))):e.__k[a]=null;if(u)for(a=0;a<c;a++)null!=(s=n[a])&&!(2&s.__u)&&(s.__e==o&&(o=Y(s)),ce(s,s));return o}(n,t,P,l,b),u=0;u<b;u++)null!=(p=n.__k[u])&&(m=-1==p.__i?L:P[p.__i]||L,p.__i=u,f=re(e,p,m,r,a,i,s,l,d,c),h=p.__e,p.ref&&m.ref!=p.ref&&(m.ref&&de(m.ref,null,p),c.push(p.ref,p.__c||h,p)),null==g&&null!=h&&(g=h),(F=!!(4&p.__u))||m.__k===p.__k?l=Q(p,l,e,F):"function"==typeof p.type&&void 0!==f?l=f:h&&(l=h.nextSibling),p.__u&=-7);return n.__e=g,l}function Q(e,t,n,o){var r,a;if("function"==typeof e.type){for(r=e.__k,a=0;r&&a<r.length;a++)r[a]&&(r[a].__=e,t=Q(r[a],t,n,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=Y(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function J(e,t){return t=t||[],null==e||"boolean"==typeof e||(j(e)?e.some(function(e){J(e,t)}):t.push(e)),t}function ee(e,t,n,o){var r,a,i,s=e.key,l=e.type,d=t[n],c=null!=d&&!(2&d.__u);if(null===d&&null==s||c&&s==d.key&&l==d.type)return n;if(o>(c?1:0))for(r=n-1,a=n+1;r>=0||a<t.length;)if(null!=(d=t[i=r>=0?r--:a++])&&!(2&d.__u)&&s==d.key&&l==d.type)return i;return-1}function te(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||z.test(t)?n:n+"px"}function ne(e,t,n,o,r){var a,i;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof o&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||te(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||te(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])a=t!=(t=t.replace(T,"$1")),i=t.toLowerCase(),t=i in e||"onFocusOut"==t||"onFocusIn"==t?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?o?n.u=o.u:(n.u=I,e.addEventListener(t,a?R:O,a)):e.removeEventListener(t,a?R:O,a);else{if("http://www.w3.org/2000/svg"==r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function oe(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=I++;else if(t.t<n.u)return;return n(w.event?w.event(t):t)}}}function re(e,t,n,o,r,a,i,s,l,d){var c,u,m,p,h,g,f,F,P,b,_,v,y,D,x,A,S,E=t.type;if(null!=t.constructor)return null;128&n.__u&&(l=!!(32&n.__u),a=[s=t.__e=n.__e]),(c=w.__b)&&c(t);e:if("function"==typeof E)try{if(F=t.props,P="prototype"in E&&E.prototype.render,b=(c=E.contextType)&&o[c.__c],_=c?b?b.props.value:c.__:o,n.__c?f=(u=t.__c=n.__c).__=u.__E:(P?t.__c=u=new E(F,_):(t.__c=u=new V(F,_),u.constructor=E,u.render=ue),b&&b.sub(u),u.state||(u.state={}),u.__n=o,m=u.__d=!0,u.__h=[],u._sb=[]),P&&null==u.__s&&(u.__s=u.state),P&&null!=E.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=B({},u.__s)),B(u.__s,E.getDerivedStateFromProps(F,u.__s))),p=u.props,h=u.state,u.__v=t,m)P&&null==E.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),P&&null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(P&&null==E.getDerivedStateFromProps&&F!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(F,_),t.__v==n.__v||!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(F,u.__s,_)){for(t.__v!=n.__v&&(u.props=F,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(e){e&&(e.__=t)}),v=0;v<u._sb.length;v++)u.__h.push(u._sb[v]);u._sb=[],u.__h.length&&i.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(F,u.__s,_),P&&null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(p,h,g)})}if(u.context=_,u.props=F,u.__P=e,u.__e=!1,y=w.__r,D=0,P){for(u.state=u.__s,u.__d=!1,y&&y(t),c=u.render(u.props,u.state,u.context),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[]}else do{u.__d=!1,y&&y(t),c=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++D<25);u.state=u.__s,null!=u.getChildContext&&(o=B(B({},o),u.getChildContext())),P&&!m&&null!=u.getSnapshotBeforeUpdate&&(g=u.getSnapshotBeforeUpdate(p,h)),A=c,null!=c&&c.type===H&&null==c.key&&(A=se(c.props.children)),s=Z(e,j(A)?A:[A],t,n,o,r,a,i,s,l,d),u.base=t.__e,t.__u&=-161,u.__h.length&&i.push(u),f&&(u.__E=u.__=null)}catch(e){if(t.__v=null,l||null!=a)if(e.then){for(t.__u|=l?160:128;s&&8==s.nodeType&&s.nextSibling;)s=s.nextSibling;a[a.indexOf(s)]=null,t.__e=s}else{for(S=a.length;S--;)$(a[S]);ae(t)}else t.__e=n.__e,t.__k=n.__k,e.then||ae(t);w.__e(e,t,n)}else null==a&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):s=t.__e=le(n.__e,t,n,o,r,a,i,l,d);return(c=w.diffed)&&c(t),128&t.__u?void 0:s}function ae(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(ae)}function ie(e,t,n){for(var o=0;o<n.length;o++)de(n[o],n[++o],n[++o]);w.__c&&w.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){w.__e(e,t.__v)}})}function se(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:j(e)?e.map(se):B({},e)}function le(e,t,n,o,r,a,i,s,l){var d,c,u,m,p,h,g,f=n.props||L,F=t.props,P=t.type;if("svg"==P?r="http://www.w3.org/2000/svg":"math"==P?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),null!=a)for(d=0;d<a.length;d++)if((p=a[d])&&"setAttribute"in p==!!P&&(P?p.localName==P:3==p.nodeType)){e=p,a[d]=null;break}if(null==e){if(null==P)return document.createTextNode(F);e=document.createElementNS(r,P,F.is&&F),s&&(w.__m&&w.__m(t,a),s=!1),a=null}if(null==P)f===F||s&&e.data==F||(e.data=F);else{if(a=a&&A.call(e.childNodes),!s&&null!=a)for(f={},d=0;d<e.attributes.length;d++)f[(p=e.attributes[d]).name]=p.value;for(d in f)if(p=f[d],"children"==d);else if("dangerouslySetInnerHTML"==d)u=p;else if(!(d in F)){if("value"==d&&"defaultValue"in F||"checked"==d&&"defaultChecked"in F)continue;ne(e,d,null,p,r)}for(d in F)p=F[d],"children"==d?m=p:"dangerouslySetInnerHTML"==d?c=p:"value"==d?h=p:"checked"==d?g=p:s&&"function"!=typeof p||f[d]===p||ne(e,d,p,f[d],r);if(c)s||u&&(c.__html==u.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),t.__k=[];else if(u&&(e.innerHTML=""),Z("template"==t.type?e.content:e,j(m)?m:[m],t,n,o,"foreignObject"==P?"http://www.w3.org/1999/xhtml":r,a,i,a?a[0]:n.__k&&Y(n,0),s,l),null!=a)for(d=a.length;d--;)$(a[d]);s||(d="value","progress"==P&&null==h?e.removeAttribute("value"):null!=h&&(h!==e[d]||"progress"==P&&!h||"option"==P&&h!=f[d])&&ne(e,d,h,f[d],r),d="checked",null!=g&&g!=e[d]&&ne(e,d,g,f[d],r))}return e}function de(e,t,n){try{if("function"==typeof e){var o="function"==typeof e.__u;o&&e.__u(),o&&null==t||(e.__u=e(t))}else e.current=t}catch(e){w.__e(e,n)}}function ce(e,t,n){var o,r;if(w.unmount&&w.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||de(o,null,t)),null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){w.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(r=0;r<o.length;r++)o[r]&&ce(o[r],t,n||"function"!=typeof e.type);n||$(e.__e),e.__c=e.__=e.__e=void 0}function ue(e,t,n){return this.constructor(e,n)}function me(e,t,n){var o,r,a;t==document&&(t=document.documentElement),w.__&&w.__(e,t),o=t.__k,r=[],a=[],re(t,e=t.__k=U(H,null,[e]),o||L,L,t.namespaceURI,o?null:t.firstChild?A.call(t.childNodes):null,r,o?o.__e:t.firstChild,!1,a),ie(r,e,a)}function pe(e){function t(e){var n,o;return this.getChildContext||(n=new Set,(o={})[t.__c]=this,this.getChildContext=function(){return o},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(e){this.props.value!=e.value&&n.forEach(function(e){e.__e=!0,K(e)})},this.sub=function(e){n.add(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n&&n.delete(e),t&&t.call(e)}}),e.children}return t.__c="__cC"+G++,t.__=e,t.Provider=t.__l=(t.Consumer=function(e,t){return e.children(t)}).contextType=t,t}A=N.slice,w={__e:function(e,t,n,o){for(var r,a,i;t=t.__;)if((r=t.__c)&&!r.__)try{if((a=r.constructor)&&null!=a.getDerivedStateFromError&&(r.setState(a.getDerivedStateFromError(e)),i=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,o||{}),i=r.__d),i)return r.__E=r}catch(t){e=t}throw e}},S=0,V.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=B({},this.state),"function"==typeof e&&(e=e(B({},n),this.props)),e&&B(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),K(this))},V.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),K(this))},V.prototype.render=H,E=[],M="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,k=function(e,t){return e.__v.__b-t.__v.__b},X.__r=0,T=/(PointerCapture)$|Capture$/i,I=0,O=oe(!1),R=oe(!0),G=0;var he,ge,fe,Fe,Pe=0,be=[],_e=w,ve=_e.__b,ye=_e.__r,De=_e.diffed,xe=_e.__c,Ae=_e.unmount,we=_e.__;function Se(e,t){_e.__h&&_e.__h(ge,e,Pe||t),Pe=0;var n=ge.__H||(ge.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function Ee(e){return Pe=1,Ce($e,e)}function Ce(e,t,n){var o=Se(he++,2);if(o.t=e,!o.__c&&(o.__=[n?n(t):$e(void 0,t),function(e){var t=o.__N?o.__N[0]:o.__[0],n=o.t(t,e);t!==n&&(o.__N=[n,o.__[1]],o.__c.setState({}))}],o.__c=ge,!ge.__f)){var r=function(e,t,n){if(!o.__c.__H)return!0;var r=o.__c.__H.__.filter(function(e){return!!e.__c});if(r.every(function(e){return!e.__N}))return!a||a.call(this,e,t,n);var i=o.__c.props!==e;return r.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(i=!0)}}),a&&a.call(this,e,t,n)||i};ge.__f=!0;var a=ge.shouldComponentUpdate,i=ge.componentWillUpdate;ge.componentWillUpdate=function(e,t,n){if(this.__e){var o=a;a=void 0,r(e,t,n),a=o}i&&i.call(this,e,t,n)},ge.shouldComponentUpdate=r}return o.__N||o.__}function Me(e,t){var n=Se(he++,3);!_e.__s&&Be(n.__H,t)&&(n.__=e,n.u=t,ge.__H.__h.push(n))}function ke(e,t){var n=Se(he++,4);!_e.__s&&Be(n.__H,t)&&(n.__=e,n.u=t,ge.__h.push(n))}function Te(e){return Pe=5,Ie(function(){return{current:e}},[])}function Ie(e,t){var n=Se(he++,7);return Be(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Oe(e,t){return Pe=8,Ie(function(){return e},t)}function Re(e){var t=ge.context[e.__c],n=Se(he++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(ge)),t.props.value):e.__}function Ge(){for(var e;e=be.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ze),e.__H.__h.forEach(je),e.__H.__h=[]}catch(t){e.__H.__h=[],_e.__e(t,e.__v)}}_e.__b=function(e){ge=null,ve&&ve(e)},_e.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),we&&we(e,t)},_e.__r=function(e){ye&&ye(e),he=0;var t=(ge=e.__c).__H;t&&(fe===ge?(t.__h=[],ge.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(ze),t.__h.forEach(je),t.__h=[],he=0)),fe=ge},_e.diffed=function(e){De&&De(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==be.push(t)&&Fe===_e.requestAnimationFrame||((Fe=_e.requestAnimationFrame)||Ne)(Ge)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),fe=ge=null},_e.__c=function(e,t){t.some(function(e){try{e.__h.forEach(ze),e.__h=e.__h.filter(function(e){return!e.__||je(e)})}catch(n){t.some(function(e){e.__h&&(e.__h=[])}),t=[],_e.__e(n,e.__v)}}),xe&&xe(e,t)},_e.unmount=function(e){Ae&&Ae(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{ze(e)}catch(e){t=e}}),n.__H=void 0,t&&_e.__e(t,n.__v))};var Le="function"==typeof requestAnimationFrame;function Ne(e){var t,n=function(){clearTimeout(o),Le&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);Le&&(t=requestAnimationFrame(n))}function ze(e){var t=ge,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),ge=t}function je(e){var t=ge;e.__c=e.__(),ge=t}function Be(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function $e(e,t){return"function"==typeof t?t(e):t}var Ue=0;function We(e,t,n,o,r,a){t||(t={});var i,s,l=t;if("ref"in l)for(s in l={},t)"ref"==s?i=t[s]:l[s]=t[s];var d={type:e,props:l,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ue,__i:-1,__u:0,__source:r,__self:a};if("function"==typeof e&&(i=e.defaultProps))for(s in i)void 0===l[s]&&(l[s]=i[s]);return w.vnode&&w.vnode(d),d}var He=(e=>(e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270",e))(He||{});function Ve(e){return{x:Math.floor(e.x),y:Math.floor(e.y)}}function Ye(e){return{width:Math.ceil(e.width),height:Math.ceil(e.height)}}function qe(e){return{origin:Ve(e.origin),size:Ye(e.size)}}function Ke(e){const{width:t,height:n}=e;return{width:n,height:t}}function Xe(e,t,n){return{width:(e=t%2==0?e:Ke(e)).width*n,height:e.height*n}}function Ze(e){const t=[e.p1.x,e.p2.x,e.p3.x,e.p4.x],n=[e.p1.y,e.p2.y,e.p3.y,e.p4.y];return{origin:{x:Math.min(...t),y:Math.min(...n)},size:{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}}}function Qe(e){return{p1:{x:e.origin.x,y:e.origin.y},p2:{x:e.origin.x+e.size.width,y:e.origin.y},p3:{x:e.origin.x+e.size.width,y:e.origin.y+e.size.height},p4:{x:e.origin.x,y:e.origin.y+e.size.height}}}function Je(e,t,n){let o=t.x,r=t.y;switch(n){case 0:o=t.x,r=t.y;break;case 1:o=e.height-t.y,r=t.x;break;case 2:o=e.width-t.x,r=e.height-t.y;break;case 3:o=t.y,r=e.width-t.x}return{x:o,y:r}}function et(e,t){return{x:e.x*t,y:e.y*t}}function tt(e){if(0===e.length)return{origin:{x:0,y:0},size:{width:0,height:0}};const t=e.map(e=>e.x),n=e.map(e=>e.y),o=Math.min(...t),r=Math.min(...n);return{origin:{x:o,y:r},size:{width:Math.max(...t)-o,height:Math.max(...n)-r}}}function nt(e,t){return{origin:{x:e.origin.x-t,y:e.origin.y-t},size:{width:e.size.width+2*t,height:e.size.height+2*t}}}function ot(e,t,n){let o=t.origin.x,r=t.origin.y,a=t.size;switch(n){case 0:break;case 1:o=e.height-t.origin.y-t.size.height,r=t.origin.x,a=Ke(t.size);break;case 2:o=e.width-t.origin.x-t.size.width,r=e.height-t.origin.y-t.size.height;break;case 3:o=t.origin.y,r=e.width-t.origin.x-t.size.width,a=Ke(t.size)}return{origin:{x:o,y:r},size:{width:a.width,height:a.height}}}function rt(e,t){return{origin:{x:e.origin.x*t,y:e.origin.y*t},size:{width:e.size.width*t,height:e.size.height*t}}}function at(e,t,n,o){return rt(ot(e,t,n),o)}function it(e){if(0===e.length)return null;let t=e[0].origin.x,n=e[0].origin.y,o=e[0].origin.x+e[0].size.width,r=e[0].origin.y+e[0].size.height;for(const a of e)t=Math.min(t,a.origin.x),n=Math.min(n,a.origin.y),o=Math.max(o,a.origin.x+a.size.width),r=Math.max(r,a.origin.y+a.size.height);return{origin:{x:t,y:n},size:{width:o-t,height:r-n}}}function st(e,t,n,o){const r=e.origin.x,a=e.origin.y,i=e.size.width,s=e.size.height,l=n/i,d=o/s,c=n/s,u=o/i;switch(t){case 0:return{a:l,b:0,c:0,d,e:-l*r,f:-d*a};case 3:return{a:0,b:-u,c,d:0,e:-c*a,f:u*(r+i)};case 2:return{a:-l,b:0,c:0,d:-d,e:l*(r+i),f:d*(a+s)};case 1:return{a:0,b:u,c:-c,d:0,e:c*(a+s),f:-u*r}}}class lt{isEnabled(){return!1}debug(){}info(){}warn(){}error(){}perf(){}}class dt{isEnabled(){return!0}debug(e,t,...n){console.debug(`${e}.${t}`,...n)}info(e,t,...n){console.info(`${e}.${t}`,...n)}warn(e,t,...n){console.warn(`${e}.${t}`,...n)}error(e,t,...n){console.error(`${e}.${t}`,...n)}perf(e,t,n,o,...r){console.info(`${e}.${t}.${n}.${o}`,...r)}}class ct{constructor(e,t){this.logger=e,this.level=t}isEnabled(e){return this.level<={debug:0,info:1,warn:2,error:3}[e]}debug(e,t,...n){this.level<=0&&this.logger.debug(e,t,...n)}info(e,t,...n){this.level<=1&&this.logger.info(e,t,...n)}warn(e,t,...n){this.level<=2&&this.logger.warn(e,t,...n)}error(e,t,...n){this.level<=3&&this.logger.error(e,t,...n)}perf(e,t,n,o,...r){this.logger.perf(e,t,n,o,...r)}}class ut{constructor(){this.marks=new Map}isEnabled(){return!1}debug(e,t,...n){}info(e,t,...n){}warn(e,t,...n){}error(e,t,...n){}perf(e,t,n,o,r,...a){const i=`${e}.${t}.${n}.${o}.${r}`;switch(o){case"Begin":globalThis.performance.mark(i,{detail:a}),this.marks.set(`${e}.${t}.${n}.${r}`,Date.now());break;case"End":globalThis.performance.mark(i,{detail:a});const o=`${e}.${t}.${n}.Measure.${r}`,s=`${e}.${t}.${n}.Begin.${r}`;globalThis.performance.measure(o,s,i);const l=this.marks.get(`${e}.${t}.${n}.${r}`);if(l){const o=Date.now()-l;console.info(`⏱️ ${e}.${t}.${n}.${r}: ${o}ms`),this.marks.delete(`${e}.${t}.${n}.${r}`)}}}}class mt{constructor(e){this.loggers=e}isEnabled(e){return this.loggers.some(t=>t.isEnabled(e))}debug(e,t,...n){for(const o of this.loggers)o.debug(e,t,...n)}info(e,t,...n){for(const o of this.loggers)o.info(e,t,...n)}warn(e,t,...n){for(const o of this.loggers)o.warn(e,t,...n)}error(e,t,...n){for(const o of this.loggers)o.error(e,t,...n)}perf(e,t,n,o,...r){for(const a of this.loggers)a.perf(e,t,n,o,...r)}}var pt=(e=>(e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected",e[e.Aborted=3]="Aborted",e))(pt||{});class ht extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError",this.reason=e}}class gt extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError",this.reason=e}}class ft{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null,this.progressCbs=[]}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new ht(e.reason)):t(new gt(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}onProgress(e){this.progressCbs.push(e)}progress(e){for(const t of this.progressCbs)t(e)}static all(e){const t=new ft;if(0===e.length)return t.resolve([]),t;const n=new Array(e.length);let o=0,r=!1;return e.forEach((a,i)=>{a.wait(a=>{r||(n[i]=a,o++,o===e.length&&(r=!0,t.resolve(n)))},e=>{r||(r=!0,"abort"===e.type?t.abort(e.reason):t.reject(e.reason))})}),t}static allSettled(e){const t=new ft;if(0===e.length)return t.resolve([]),t;const n=new Array(e.length);let o=0;return e.forEach((r,a)=>{r.wait(r=>{n[a]={status:"resolved",value:r},o++,o===e.length&&t.resolve(n)},r=>{n[a]={status:"abort"===r.type?"aborted":"rejected",reason:r.reason},o++,o===e.length&&t.resolve(n)})}),t}static race(e){const t=new ft;if(0===e.length)return t.reject("No tasks provided"),t;let n=!1;return e.forEach(e=>{e.wait(e=>{n||(n=!0,t.resolve(e))},e=>{n||(n=!0,"abort"===e.type?t.abort(e.reason):t.reject(e.reason))})}),t}static withProgress(e,t){const n=ft.all(e);if(t){let n=0;e.forEach(o=>{o.wait(()=>{n++,t(n,e.length)},()=>{n++,t(n,e.length)})})}return n}}const Ft=Object.freeze(["­","​","⁠","\ufeff","￾","￿"]),Pt=new RegExp(`[${Ft.join("")}]`,"g");function bt(e){return e.replace(Pt,"")}var _t=(e=>(e[e.Unknown=0]="Unknown",e[e.XYZ=1]="XYZ",e[e.FitPage=2]="FitPage",e[e.FitHorizontal=3]="FitHorizontal",e[e.FitVertical=4]="FitVertical",e[e.FitRectangle=5]="FitRectangle",e[e.FitBoundingBox=6]="FitBoundingBox",e[e.FitBoundingBoxHorizontal=7]="FitBoundingBoxHorizontal",e[e.FitBoundingBoxVertical=8]="FitBoundingBoxVertical",e))(_t||{}),vt=(e=>(e[e.NotSet=0]="NotSet",e[e.True=1]="True",e[e.False=2]="False",e[e.Unknown=3]="Unknown",e))(vt||{}),yt=(e=>(e[e.Unknown=-1]="Unknown",e[e.Courier=0]="Courier",e[e.Courier_Bold=1]="Courier_Bold",e[e.Courier_BoldOblique=2]="Courier_BoldOblique",e[e.Courier_Oblique=3]="Courier_Oblique",e[e.Helvetica=4]="Helvetica",e[e.Helvetica_Bold=5]="Helvetica_Bold",e[e.Helvetica_BoldOblique=6]="Helvetica_BoldOblique",e[e.Helvetica_Oblique=7]="Helvetica_Oblique",e[e.Times_Roman=8]="Times_Roman",e[e.Times_Bold=9]="Times_Bold",e[e.Times_BoldItalic=10]="Times_BoldItalic",e[e.Times_Italic=11]="Times_Italic",e[e.Symbol=12]="Symbol",e[e.ZapfDingbats=13]="ZapfDingbats",e))(yt||{}),Dt=(e=>(e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e))(Dt||{}),xt=(e=>(e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom",e))(xt||{}),At=(e=>(e[e.Normal=0]="Normal",e[e.Multiply=1]="Multiply",e[e.Screen=2]="Screen",e[e.Overlay=3]="Overlay",e[e.Darken=4]="Darken",e[e.Lighten=5]="Lighten",e[e.ColorDodge=6]="ColorDodge",e[e.ColorBurn=7]="ColorBurn",e[e.HardLight=8]="HardLight",e[e.SoftLight=9]="SoftLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e))(At||{}),wt=(e=>(e[e.Contain=0]="Contain",e[e.Cover=1]="Cover",e[e.Stretch=2]="Stretch",e))(wt||{}),St=(e=>(e[e.Unsupported=0]="Unsupported",e[e.Goto=1]="Goto",e[e.RemoteGoto=2]="RemoteGoto",e[e.URI=3]="URI",e[e.LaunchAppOrOpenFile=4]="LaunchAppOrOpenFile",e))(St||{}),Et=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.LINK=2]="LINK",e[e.FREETEXT=3]="FREETEXT",e[e.LINE=4]="LINE",e[e.SQUARE=5]="SQUARE",e[e.CIRCLE=6]="CIRCLE",e[e.POLYGON=7]="POLYGON",e[e.POLYLINE=8]="POLYLINE",e[e.HIGHLIGHT=9]="HIGHLIGHT",e[e.UNDERLINE=10]="UNDERLINE",e[e.SQUIGGLY=11]="SQUIGGLY",e[e.STRIKEOUT=12]="STRIKEOUT",e[e.STAMP=13]="STAMP",e[e.CARET=14]="CARET",e[e.INK=15]="INK",e[e.POPUP=16]="POPUP",e[e.FILEATTACHMENT=17]="FILEATTACHMENT",e[e.SOUND=18]="SOUND",e[e.MOVIE=19]="MOVIE",e[e.WIDGET=20]="WIDGET",e[e.SCREEN=21]="SCREEN",e[e.PRINTERMARK=22]="PRINTERMARK",e[e.TRAPNET=23]="TRAPNET",e[e.WATERMARK=24]="WATERMARK",e[e.THREED=25]="THREED",e[e.RICHMEDIA=26]="RICHMEDIA",e[e.XFAWIDGET=27]="XFAWIDGET",e[e.REDACT=28]="REDACT",e))(Et||{}),Ct=(e=>(e[e.Normal=0]="Normal",e[e.Rollover=1]="Rollover",e[e.Down=2]="Down",e))(Ct||{}),Mt=(e=>(e[e.Unknown=-1]="Unknown",e[e.Comment=0]="Comment",e[e.Key=1]="Key",e[e.Note=2]="Note",e[e.Help=3]="Help",e[e.NewParagraph=4]="NewParagraph",e[e.Paragraph=5]="Paragraph",e[e.Insert=6]="Insert",e[e.Graph=7]="Graph",e[e.PushPin=8]="PushPin",e[e.Paperclip=9]="Paperclip",e[e.Tag=10]="Tag",e[e.Speaker=11]="Speaker",e[e.Mic=12]="Mic",e[e.Approved=13]="Approved",e[e.Experimental=14]="Experimental",e[e.NotApproved=15]="NotApproved",e[e.AsIs=16]="AsIs",e[e.Expired=17]="Expired",e[e.NotForPublicRelease=18]="NotForPublicRelease",e[e.Confidential=19]="Confidential",e[e.Final=20]="Final",e[e.Sold=21]="Sold",e[e.Departmental=22]="Departmental",e[e.ForComment=23]="ForComment",e[e.TopSecret=24]="TopSecret",e[e.Draft=25]="Draft",e[e.ForPublicRelease=26]="ForPublicRelease",e))(Mt||{}),kt=(e=>(e[e.None=0]="None",e[e.Square=1]="Square",e[e.Circle=2]="Circle",e[e.Diamond=3]="Diamond",e[e.OpenArrow=4]="OpenArrow",e[e.ClosedArrow=5]="ClosedArrow",e[e.Butt=6]="Butt",e[e.ROpenArrow=7]="ROpenArrow",e[e.RClosedArrow=8]="RClosedArrow",e[e.Slash=9]="Slash",e[e.Unknown=10]="Unknown",e))(kt||{}),Tt=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.PUSHBUTTON=1]="PUSHBUTTON",e[e.CHECKBOX=2]="CHECKBOX",e[e.RADIOBUTTON=3]="RADIOBUTTON",e[e.COMBOBOX=4]="COMBOBOX",e[e.LISTBOX=5]="LISTBOX",e[e.TEXTFIELD=6]="TEXTFIELD",e[e.SIGNATURE=7]="SIGNATURE",e[e.XFA=8]="XFA",e[e.XFA_CHECKBOX=9]="XFA_CHECKBOX",e[e.XFA_COMBOBOX=10]="XFA_COMBOBOX",e[e.XFA_IMAGEFIELD=11]="XFA_IMAGEFIELD",e[e.XFA_LISTBOX=12]="XFA_LISTBOX",e[e.XFA_PUSHBUTTON=13]="XFA_PUSHBUTTON",e[e.XFA_SIGNATURE=14]="XFA_SIGNATURE",e[e.XFA_TEXTFIELD=15]="XFA_TEXTFIELD",e))(Tt||{}),It=(e=>(e[e.Color=0]="Color",e[e.InteriorColor=1]="InteriorColor",e))(It||{}),Ot=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.SOLID=1]="SOLID",e[e.DASHED=2]="DASHED",e[e.BEVELED=3]="BEVELED",e[e.INSET=4]="INSET",e[e.UNDERLINE=5]="UNDERLINE",e[e.CLOUDY=6]="CLOUDY",e))(Ot||{}),Rt=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.PATH=2]="PATH",e[e.IMAGE=3]="IMAGE",e[e.SHADING=4]="SHADING",e[e.FORM=5]="FORM",e))(Rt||{});const Gt=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"}),Lt=Object.entries(Gt).reduce((e,[t,n])=>(e[n]=Number(t),e),{});function Nt(e){return Object.keys(Gt).filter(t=>0!==(e&t)).map(e=>Gt[e])}function zt(e){return e.reduce((e,t)=>e|Lt[t],0)}var jt=(e=>(e[e.Create=0]="Create",e[e.Read=1]="Read",e[e.Update=2]="Update",e[e.Delete=3]="Delete",e))(jt||{}),Bt=(e=>(e[e.None=0]="None",e[e.MatchCase=1]="MatchCase",e[e.MatchWholeWord=2]="MatchWholeWord",e[e.MatchConsecutive=4]="MatchConsecutive",e))(Bt||{}),$t=(e=>(e[e.Display=0]="Display",e[e.Print=1]="Print",e))($t||{}),Ut=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e[e.CantSetAnnotString=29]="CantSetAnnotString",e))(Ut||{});class Wt{static create(){return new ft}static resolve(e){const t=new ft;return t.resolve(e),t}static reject(e){const t=new ft;return t.reject(e),t}static abort(e){const t=new ft;return t.reject(e),t}}function Ht(e){const t=e=>(e=>Math.max(0,Math.min(255,e)))(e).toString(16).padStart(2,"0");return`#${t(e.red)}${t(e.green)}${t(e.blue)}`}function Vt(e){/^#?[0-9a-f]{3}$/i.test(e)&&(e=e.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i,"#$1$1$2$2$3$3").toLowerCase());const[,t,n,o]=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e)??(()=>{throw new Error(`Invalid hex colour: "${e}"`)})();return{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(o,16)}}function Yt(e){return(e=>Math.max(0,Math.min(255,e)))(e)/255}function qt(e){return((e,t=255)=>Math.max(0,Math.min(t,e)))(Math.round(255*e))}function Kt(e){if(!(null==e?void 0:e.startsWith("D:"))||e.length<16)return;const t=+e.slice(2,6),n=+e.slice(6,8)-1,o=+e.slice(8,10),r=+e.slice(10,12),a=+e.slice(12,14),i=+e.slice(14,16);return new Date(Date.UTC(t,n,o,r,a,i))}function Xt(e=new Date){const t=(e,t=2)=>e.toString().padStart(t,"0");return`D:${e.getUTCFullYear()}${t(e.getUTCMonth()+1)}${t(e.getUTCDate())}${t(e.getUTCHours())}${t(e.getUTCMinutes())}${t(e.getUTCSeconds())}`}const Zt=Object.freeze([{id:Dt.Left,label:"Left",css:"left"},{id:Dt.Center,label:"Center",css:"center"},{id:Dt.Right,label:"Right",css:"right"}]),Qt=Zt.reduce((e,t)=>(e[t.id]=t,e),{});function Jt(e){return function(e){return Qt[e]??Qt[Dt.Left]}(e).css}Zt.reduce((e,t)=>(e[t.css]=t.id,e),{}),Zt.map(e=>({value:e.id,label:e.label}));var en=(e=>(e.Courier="Courier",e.Helvetica="Helvetica",e.Times="Times",e.Symbol="Symbol",e.ZapfDingbats="ZapfDingbats",e.Unknown="Unknown",e))(en||{});const tn=yt.Helvetica,nn={id:yt.Helvetica,family:"Helvetica",bold:!1,italic:!1,label:"Helvetica",css:"Helvetica, Arial, sans-serif"},on=Object.freeze([{id:yt.Courier,family:"Courier",bold:!1,italic:!1,label:"Courier",css:"Courier, monospace"},{id:yt.Courier_Bold,family:"Courier",bold:!0,italic:!1,label:"Courier Bold",css:'"Courier-Bold", Courier, monospace'},{id:yt.Courier_BoldOblique,family:"Courier",bold:!0,italic:!0,label:"Courier Bold Oblique",css:'"Courier-BoldOblique", Courier, monospace'},{id:yt.Courier_Oblique,family:"Courier",bold:!1,italic:!0,label:"Courier Oblique",css:'"Courier-Oblique", Courier, monospace'},nn,{id:yt.Helvetica_Bold,family:"Helvetica",bold:!0,italic:!1,label:"Helvetica Bold",css:'"Helvetica-Bold", Arial, sans-serif'},{id:yt.Helvetica_BoldOblique,family:"Helvetica",bold:!0,italic:!0,label:"Helvetica Bold Oblique",css:'"Helvetica-BoldOblique", Arial, sans-serif'},{id:yt.Helvetica_Oblique,family:"Helvetica",bold:!1,italic:!0,label:"Helvetica Oblique",css:'"Helvetica-Oblique", Arial, sans-serif'},{id:yt.Times_Roman,family:"Times",bold:!1,italic:!1,label:"Times Roman",css:'"Times New Roman", Times, serif'},{id:yt.Times_Bold,family:"Times",bold:!0,italic:!1,label:"Times Bold",css:'"Times New Roman Bold", Times, serif'},{id:yt.Times_BoldItalic,family:"Times",bold:!0,italic:!0,label:"Times Bold Italic",css:'"Times New Roman Bold Italic", Times, serif'},{id:yt.Times_Italic,family:"Times",bold:!1,italic:!0,label:"Times Italic",css:'"Times New Roman Italic", Times, serif'},{id:yt.Symbol,family:"Symbol",bold:!1,italic:!1,label:"Symbol",css:"Symbol"},{id:yt.ZapfDingbats,family:"ZapfDingbats",bold:!1,italic:!1,label:"Zapf Dingbats",css:"ZapfDingbats"}]),rn=on.reduce((e,t)=>(e[t.id]=t,e),{}),an=new Map;for(const e of on)an.set(`${e.family}_${e.bold}_${e.italic}`,e.id);function sn(e){return rn[e]??nn}function ln(e){return sn(e).bold}function dn(e){return sn(e).italic}function cn(e,{bold:t,italic:n}){return an.get(`${e}_${t}_${n}`)??tn}Object.values(en).filter(e=>"Unknown"!==e).map(e=>({value:e,label:e}));const un=[...new Set(on.map(e=>e.family))];function mn(e){switch(e){case"Courier":return"Courier";case"Helvetica":default:return"Helvetica";case"Times":return"Times";case"Symbol":return"Symbol";case"ZapfDingbats":return"ZapfDingbats"}}const pn=Object.freeze([{id:At.Normal,label:"Normal",css:"normal"},{id:At.Multiply,label:"Multiply",css:"multiply"},{id:At.Screen,label:"Screen",css:"screen"},{id:At.Overlay,label:"Overlay",css:"overlay"},{id:At.Darken,label:"Darken",css:"darken"},{id:At.Lighten,label:"Lighten",css:"lighten"},{id:At.ColorDodge,label:"Color Dodge",css:"color-dodge"},{id:At.ColorBurn,label:"Color Burn",css:"color-burn"},{id:At.HardLight,label:"Hard Light",css:"hard-light"},{id:At.SoftLight,label:"Soft Light",css:"soft-light"},{id:At.Difference,label:"Difference",css:"difference"},{id:At.Exclusion,label:"Exclusion",css:"exclusion"},{id:At.Hue,label:"Hue",css:"hue"},{id:At.Saturation,label:"Saturation",css:"saturation"},{id:At.Color,label:"Color",css:"color"},{id:At.Luminosity,label:"Luminosity",css:"luminosity"}]),hn=pn.reduce((e,t)=>(e[t.id]=t,e),{});function gn(e){return function(e){return hn[e]??hn[At.Normal]}(e).css}pn.reduce((e,t)=>(e[t.css]=t.id,e),{}),pn.map(e=>({value:e.id,label:e.label}));const fn=pn.map(e=>e.id);function Fn(e){if(e instanceof lt)return{type:"noop"};if(e instanceof dt)return{type:"console"};if(e instanceof ut)return{type:"perf"};if(e instanceof ct){const t=e;return{type:"level",config:{level:t.level,logger:Fn(t.logger)}}}return e instanceof mt?{type:"all",config:{loggers:e.loggers.map(Fn)}}:{type:"noop"}}const Pn=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function bn(e){return Pn.test(e)}function _n(){var e;if("function"==typeof(null==(e=globalThis.crypto)?void 0:e.randomUUID))return globalThis.crypto.randomUUID();const t=function(){var e;if("function"==typeof(null==(e=globalThis.crypto)?void 0:e.getRandomValues))return globalThis.crypto.getRandomValues(new Uint8Array(16));if("function"==typeof require)try{const{randomBytes:e}=require("crypto");return e(16)}catch{}const t=new Uint8Array(16);for(let e=0;e<16;e++)t[e]=Math.floor(256*Math.random());return t}();t[6]=15&t[6]|64,t[8]=63&t[8]|128;const n=Array.from(t,e=>e.toString(16).padStart(2,"0")).join("");return`${n.slice(0,8)}-${n.slice(8,12)}-${n.slice(12,16)}-${n.slice(16,20)}-${n.slice(20)}`}class vn extends ft{constructor(e={}){super(),this.children=new Map,this.childResults=[],this.completedCount=0,this.expectedCount=0,this.isFinalized=!1,this.config={aggregate:e.aggregate??(e=>e),onChildComplete:e.onChildComplete??(()=>{}),failFast:e.failFast??!0}}addChild(e,t){if(this.state.stage!==pt.Pending)return this.state.stage===pt.Aborted&&e.abort(this.state.reason),this;const n=t??this.expectedCount;return this.expectedCount=Math.max(this.expectedCount,n+1),this.children.set(e,n),e.wait(t=>this.handleChildSuccess(e,t,n),t=>this.handleChildError(e,t,n)),this}finalize(){return this.isFinalized||(this.isFinalized=!0,0===this.expectedCount&&this.resolve(this.config.aggregate([]))),this}handleChildSuccess(e,t,n){if(this.state.stage!==pt.Pending)return;this.childResults[n]=t,this.completedCount++,this.children.delete(e);const o=this.config.onChildComplete(this.completedCount,this.expectedCount,t,n);if(void 0!==o&&this.progress(o),this.completedCount===this.expectedCount){const e=this.config.aggregate(this.childResults);this.resolve(e)}}handleChildError(e,t,n){if(this.state.stage===pt.Pending)if(this.children.delete(e),this.config.failFast){for(const[e]of this.children)e.abort("Sibling task failed");this.children.clear(),this.fail(t)}else if(this.childResults[n]=void 0,this.completedCount++,this.completedCount===this.expectedCount){const e=this.config.aggregate(this.childResults);this.resolve(e)}}abort(e){for(const[t]of this.children)t.abort(e);this.children.clear(),super.abort(e)}reject(e){for(const[t]of this.children)t.abort(e);this.children.clear(),super.reject(e)}getPendingCount(){return this.children.size}getCompletedCount(){return this.completedCount}static gather(e){const t=new vn({aggregate:e=>e,onChildComplete:(e,t)=>({completed:e,total:t})});return e.forEach((e,n)=>t.addChild(e,n)),t.finalize(),t}static gatherIndexed(e){const t=new vn({aggregate:e=>{const t={};return e.forEach((e,n)=>{t[n]=e}),t},onChildComplete:(e,t,n,o)=>({page:o,result:n})});return e.forEach((e,n)=>t.addChild(e,n)),t.finalize(),t}static gatherFrom(e,t){const n=new vn(t);return e.forEach((e,t)=>n.addChild(e,t)),n.finalize(),n}static first(e){let t=!1;const n=new vn({aggregate:e=>e[0],failFast:!1});return n.handleChildSuccess=(e,o)=>{if(!t){t=!0;for(const[t]of n.children)t!==e&&t.abort("Race won by sibling");n.resolve(o)}},e.forEach((e,t)=>n.addChild(e,t)),n.finalize(),n}}function yn(){}class Dn{constructor(){this.dependencyGraph=new Map}addNode(e,t=[]){this.dependencyGraph.set(e,new Set(t))}hasCircularDependencies(){const e=new Set,t=new Set,n=o=>{e.add(o),t.add(o);const r=this.dependencyGraph.get(o)||new Set;for(const o of r)if(e.has(o)){if(t.has(o))return!0}else if(n(o))return!0;return t.delete(o),!1};for(const t of this.dependencyGraph.keys())if(!e.has(t)&&n(t))return!0;return!1}resolveLoadOrder(){if(this.hasCircularDependencies())throw new Error("Circular dependencies detected");const e=[],t=new Set,n=new Set,o=r=>{if(n.has(r))throw new Error("Circular dependency");if(t.has(r))return;n.add(r);const a=this.dependencyGraph.get(r)||new Set;for(const e of a)o(e);n.delete(r),t.add(r),e.push(r)};for(const e of this.dependencyGraph.keys())t.has(e)||o(e);return e}}class xn extends Error{constructor(e){super(e),this.name="PluginRegistrationError"}}class An extends Error{constructor(e){super(e),this.name="PluginNotFoundError"}}class wn extends Error{constructor(e){super(e),this.name="CircularDependencyError"}}class Sn extends Error{constructor(e){super(e),this.name="PluginConfigurationError"}}class En{constructor(e,t){this.store=e,this.pluginId=t}getState(){return this.store.getState().plugins[this.pluginId]}dispatch(e){return this.store.dispatchToPlugin(this.pluginId,e)}subscribeToState(e){return this.store.subscribeToPlugin(this.pluginId,(t,n,o)=>{e(t,n,o)})}onAction(e,t){return this.store.onAction(e,(e,n,o)=>{t(e,n.plugins[this.pluginId],o.plugins[this.pluginId])})}}const Cn="START_LOADING_DOCUMENT",Mn="UPDATE_DOCUMENT_LOADING_PROGRESS",kn="SET_DOCUMENT_LOADED",Tn="SET_DOCUMENT_ERROR",In="RETRY_LOADING_DOCUMENT",On="CLOSE_DOCUMENT",Rn="SET_ACTIVE_DOCUMENT",Gn="REORDER_DOCUMENTS",Ln="MOVE_DOCUMENT",Nn="REFRESH_PAGES",zn="SET_SCALE",jn="SET_ROTATION",Bn=[Cn,Mn,kn,On,Rn,Tn,In,"REFRESH_DOCUMENT",Nn,"SET_PAGES",zn,jn,"SET_DEFAULT_SCALE","SET_DEFAULT_ROTATION",Gn,Ln],$n=(e,t,n,o,r,a)=>({type:Cn,payload:{documentId:e,name:t,scale:n,rotation:o,passwordProvided:r,autoActivate:a}}),Un=(e,t)=>({type:On,payload:{documentId:e,nextActiveDocumentId:t}}),Wn=(e,t)=>({type:Nn,payload:{documentId:e,pageIndexes:t}}),Hn=(e,t)=>({type:jn,payload:{rotation:e,documentId:t}});class Vn{constructor(e,t){this.initialCoreState=t,this.pluginReducers={},this.listeners=[],this.pluginListeners={},this.isDispatching=!1,this.state={core:t,plugins:{}},this.coreReducer=e}addPluginReducer(e,t,n){this.state.plugins[e]=n,this.pluginReducers[e]=t}dispatchToCore(e){if(!this.coreReducer)return this.getState();if(this.isDispatching)throw new Error("Reducers may not dispatch actions. To trigger cascading actions, dispatch from a listener callback instead.");const t=this.getState();try{this.isDispatching=!0,this.state.core=this.coreReducer(this.state.core,e)}finally{this.isDispatching=!1}return this.listeners.forEach(n=>{const o=this.getState();n(e,o,t)}),this.getState()}dispatchToPlugin(e,t,n=!0){if(this.isDispatching)throw new Error("Reducers may not dispatch actions. To trigger cascading actions, dispatch from a listener callback instead.");const o=this.getState(),r=this.pluginReducers[e];if(!r)return o.plugins[e];const a=o.plugins[e];try{this.isDispatching=!0;const n=r(a,t);this.state.plugins[e]=n}finally{this.isDispatching=!1}return n&&this.listeners.forEach(e=>{const n=this.getState();e(t,n,o)}),this.pluginListeners[e]&&this.pluginListeners[e].forEach(n=>{const o=this.getState().plugins[e];n(t,o,a)}),this.getState().plugins[e]}dispatch(e){if(this.isDispatching)throw new Error("Reducers may not dispatch actions. To trigger cascading actions, dispatch from a listener callback instead.");const t=this.getState();try{this.isDispatching=!0,this.isCoreAction(e)&&(this.state.core=this.coreReducer(this.state.core,e));for(const n in this.pluginReducers){const o=this.pluginReducers[n],r=t.plugins[n];o&&(this.state.plugins[n]=o(r,e))}}finally{this.isDispatching=!1}return this.listeners.forEach(n=>{const o=this.getState();n(e,o,t)}),this.getState()}getState(){if(this.isDispatching)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return{core:{...this.state.core},plugins:{...this.state.plugins}}}subscribe(e){if(this.isDispatching)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state.");return this.listeners.push(e),()=>{if(this.isDispatching)throw new Error("You may not unsubscribe from a store listener while the reducer is executing.");this.listeners=this.listeners.filter(t=>t!==e)}}subscribeToPlugin(e,t){if(!(e in this.state.plugins))throw new Error(`Plugin state not found for plugin "${e}". Did you forget to call addPluginReducer?`);if(this.isDispatching)throw new Error("You may not call store.subscribeToPlugin() while the reducer is executing.");return this.pluginListeners[e]||(this.pluginListeners[e]=[]),this.pluginListeners[e].push(t),()=>{if(this.isDispatching)throw new Error("You may not unsubscribe from a store listener while the reducer is executing.");this.pluginListeners[e]=this.pluginListeners[e].filter(e=>e!==t),0===this.pluginListeners[e].length&&delete this.pluginListeners[e]}}onAction(e,t){return this.subscribe((n,o,r)=>{n.type===e&&t(n,o,r)})}getPluginStore(e){if(!(e in this.state.plugins))throw new Error(`Plugin state not found for plugin "${e}". Did you forget to call addPluginReducer?`);return new En(this,e)}isCoreAction(e){return Bn.includes(e.type)}destroy(){var e,t;this.listeners.length=0;for(const n in this.pluginListeners)null==(t=null==(e=this.pluginListeners[n])?void 0:e.splice)||t.call(e,0);this.pluginListeners={},this.pluginReducers={},this.state.plugins={},this.state.core={...this.initialCoreState}}}function Yn(e,t,n){const o=e.activeDocumentId;if(o!==t)return o;if(void 0!==n)return n&&e.documents[n]?n:null;const r=e.documentOrder.indexOf(t);return-1===r?null:r>0?e.documentOrder[r-1]:r<e.documentOrder.length-1?e.documentOrder[r+1]:null}const qn=(e,t)=>{switch(t.type){case Cn:{const{documentId:n,name:o,scale:r,rotation:a,passwordProvided:i,autoActivate:s=!0}=t.payload,l={id:n,name:o,status:"loading",loadingProgress:0,error:null,document:null,scale:r??e.defaultScale,rotation:a??e.defaultRotation,passwordProvided:i??!1,pageRefreshVersions:{},loadStartedAt:Date.now()};return{...e,documents:{...e.documents,[n]:l},documentOrder:[...e.documentOrder,n],activeDocumentId:s||!e.activeDocumentId?n:e.activeDocumentId}}case Mn:{const{documentId:n,progress:o}=t.payload,r=e.documents[n];return r&&"loading"===r.status?{...e,documents:{...e.documents,[n]:{...r,loadingProgress:o}}}:e}case kn:{const{documentId:n,document:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,status:"loaded",document:o,error:null,errorCode:void 0,errorDetails:void 0,passwordProvided:void 0,loadedAt:Date.now()}}}:e}case Tn:{const{documentId:n,error:o,errorCode:r,errorDetails:a}=t.payload,i=e.documents[n];return i?{...e,documents:{...e.documents,[n]:{...i,status:"error",error:o,errorCode:r,errorDetails:a}}}:e}case In:{const{documentId:n,passwordProvided:o}=t.payload,r=e.documents[n];return r&&"error"===r.status?{...e,documents:{...e.documents,[n]:{...r,status:"loading",loadingProgress:0,error:null,errorCode:void 0,errorDetails:void 0,passwordProvided:o??!1,loadStartedAt:Date.now()}}}:e}case On:{const{documentId:n,nextActiveDocumentId:o}=t.payload,{[n]:r,...a}=e.documents;return{...e,documents:a,documentOrder:e.documentOrder.filter(e=>e!==n),activeDocumentId:Yn(e,n,o)}}case Ln:{const{documentId:n,toIndex:o}=t.payload,r=function(e,t,n){const o=e.indexOf(t);if(-1===o)return null;if(n<0||n>=e.length)return null;if(o===n)return null;const r=[...e];return r.splice(o,1),r.splice(n,0,t),r}(e.documentOrder,n,o);return r?{...e,documentOrder:r}:e}case Gn:return{...e,documentOrder:t.payload};case Rn:return{...e,activeDocumentId:t.payload};case zn:{const{scale:n,documentId:o}=t.payload,r=o??e.activeDocumentId;if(!r)return e;const a=e.documents[r];return a?{...e,documents:{...e.documents,[r]:{...a,scale:n}}}:e}case jn:{const{rotation:n,documentId:o}=t.payload,r=o??e.activeDocumentId;if(!r)return e;const a=e.documents[r];return a?{...e,documents:{...e.documents,[r]:{...a,rotation:n}}}:e}case Nn:{const{documentId:n,pageIndexes:o}=t.payload,r=e.documents[n];if(!r)return e;const a={...r.pageRefreshVersions};for(const e of o)a[e]=(a[e]||0)+1;return{...e,documents:{...e.documents,[n]:{...r,pageRefreshVersions:a}}}}default:return e}};class Kn{constructor(e,t){this.plugins=new Map,this.manifests=new Map,this.capabilities=new Map,this.status=new Map,this.configurations=new Map,this.initPromise=null,this.pendingRegistrations=[],this.processingRegistrations=[],this.initialized=!1,this.isInitializing=!1,this.pluginsReadyPromise=null,this.destroyed=!1,this.resolver=new Dn,this.engine=e,this.initialCoreState=(e=>({documents:{},documentOrder:[],activeDocumentId:null,defaultScale:(null==e?void 0:e.defaultScale)??1,defaultRotation:(null==e?void 0:e.defaultRotation)??He.Degree0}))(t),this.store=new Vn(qn,this.initialCoreState),this.logger=(null==t?void 0:t.logger)??new lt}getLogger(){return this.logger}registerPlugin(e,t){if(this.initialized&&!this.isInitializing)throw new xn("Cannot register plugins after initialization");this.validateManifest(e.manifest),this.store.addPluginReducer(e.manifest.id,e.reducer,"function"==typeof e.initialState?e.initialState(this.initialCoreState,{...e.manifest.defaultConfig,...t}):e.initialState),this.pendingRegistrations.push({package:e,config:t})}getStore(){return this.store}getEngine(){return this.engine}pluginsReady(){return this.pluginsReadyPromise||(this.pluginsReadyPromise=(async()=>{this.initialized||await this.initialize();const e=Array.from(this.plugins.values()).map(e=>"function"==typeof e.ready?e.ready():Promise.resolve());await Promise.all(e)})()),this.pluginsReadyPromise}async initialize(){if(this.destroyed)throw new xn("Registry has been destroyed");return this.initPromise||(this.initPromise=(async()=>{if(this.initialized)throw new xn("Registry is already initialized");this.isInitializing=!0;try{if(this.destroyed)return;for(;this.pendingRegistrations.length>0;){if(this.destroyed)return;this.processingRegistrations=[...this.pendingRegistrations],this.pendingRegistrations=[];for(const e of this.processingRegistrations){const t=new Set,n=[...e.package.manifest.requires,...e.package.manifest.optional];for(const e of n){const n=this.processingRegistrations.find(t=>t.package.manifest.provides.includes(e));n&&t.add(n.package.manifest.id)}this.resolver.addNode(e.package.manifest.id,[...t])}const e=this.resolver.resolveLoadOrder();for(const t of e){const e=this.processingRegistrations.find(e=>e.package.manifest.id===t);this.instantiatePlugin(e.package.manifest,e.package.create,e.config)}for(const t of e)await this.runPluginInitialization(t);this.processingRegistrations=[],this.resolver=new Dn}this.initialized=!0}catch(e){if(e instanceof Error)throw new wn(`Failed to resolve plugin dependencies: ${e.message}`);throw e}finally{this.isInitializing=!1}})()),this.initPromise}instantiatePlugin(e,t,n){const o={...e.defaultConfig,...n};this.validateConfig(e.id,o,e.defaultConfig);const r=t(this,o);this.validatePlugin(r);for(const t of e.provides){if(this.capabilities.has(t))throw new xn(`Capability ${t} is already provided by plugin ${this.capabilities.get(t)}`);this.capabilities.set(t,e.id)}this.plugins.set(e.id,r),this.manifests.set(e.id,e),this.status.set(e.id,"registered"),this.configurations.set(e.id,o)}async runPluginInitialization(e){const t=this.plugins.get(e);if(!t)return;const n=this.manifests.get(e),o=this.configurations.get(e);for(const t of n.requires)if(!this.capabilities.has(t))throw new xn(`Missing required capability: ${t} for plugin ${e}`);this.logger.debug("PluginRegistry","InitializePlugin",`Initializing plugin ${e}`);try{t.initialize&&await t.initialize(o),this.status.set(e,"active"),this.logger.info("PluginRegistry","PluginInitialized",`Plugin ${e} initialized successfully`)}catch(t){throw this.status.set(e,"error"),this.logger.error("PluginRegistry","InitializationFailed",`Plugin ${e} initialization failed`,{error:t}),t}}getPluginConfig(e){const t=this.configurations.get(e);if(!t)throw new An(`Configuration for plugin ${e} not found`);return t}validateConfig(e,t,n){const o=Object.keys(n).filter(e=>!t.hasOwnProperty(e));if(o.length>0)throw new Sn(`Missing required configuration keys for plugin ${e}: ${o.join(", ")}`)}async updatePluginConfig(e,t){const n=this.getPlugin(e);if(!n)throw new An(`Plugin ${e} not found`);const o=this.manifests.get(e),r=this.configurations.get(e);if(!o||!r)throw new An(`Plugin ${e} not found`);const a={...r,...t};this.validateConfig(e,a,o.defaultConfig),this.configurations.set(e,a),n.initialize&&await n.initialize(a)}registerPluginBatch(e){for(const t of e)this.registerPlugin(t.package,t.config)}async unregisterPlugin(e){const t=this.plugins.get(e);if(!t)throw new An(`Plugin ${e} is not registered`);const n=this.manifests.get(e);if(!n)throw new An(`Manifest for plugin ${e} not found`);for(const[t,o]of this.manifests.entries())if(t!==e&&[...o.requires,...o.optional].some(e=>n.provides.includes(e)))throw new xn(`Cannot unregister plugin ${e}: plugin ${t} depends on it`);try{t.destroy&&await t.destroy();for(const e of n.provides)this.capabilities.delete(e);this.plugins.delete(e),this.manifests.delete(e),this.status.delete(e)}catch(t){if(t instanceof Error)throw new Error(`Failed to unregister plugin ${e}: ${t.message}`);throw t}}getPlugin(e){return this.plugins.get(e)||null}getCapabilityProvider(e){const t=this.capabilities.get(e);return t?this.getPlugin(t):null}hasCapability(e){return this.capabilities.has(e)}getAllPlugins(){return Array.from(this.plugins.values())}getPluginStatus(e){const t=this.status.get(e);if(!t)throw new An(`Plugin ${e} not found`);return t}validatePlugin(e){if(!e.id)throw new xn("Plugin must have an id")}validateManifest(e){if(!e.id)throw new xn("Manifest must have an id");if(!e.name)throw new xn("Manifest must have a name");if(!e.version)throw new xn("Manifest must have a version");if(!Array.isArray(e.provides))throw new xn("Manifest must have a provides array");if(!Array.isArray(e.requires))throw new xn("Manifest must have a requires array");if(!Array.isArray(e.optional))throw new xn("Manifest must have an optional array")}isDestroyed(){return this.destroyed}async destroy(){var e;if(this.destroyed)throw new xn("Registry has already been destroyed");this.destroyed=!0;try{await this.initPromise}catch{}for(const t of Array.from(this.plugins.values()).reverse())await(null==(e=t.destroy)?void 0:e.call(t));this.store.destroy(),this.plugins.clear(),this.manifests.clear(),this.capabilities.clear(),this.status.clear(),this.pendingRegistrations.length=0,this.processingRegistrations.length=0}}function Xn(e,t){return{package:e,config:t}}function Zn(e){return"autoMountElements"in e&&"function"==typeof e.autoMountElements}class Qn{constructor(e,t){if(this.id=e,this.registry=t,this.cooldownActions={},this.debouncedTimeouts={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,this.unsubscribeFromStartLoadingDocument=null,this.unsubscribeFromSetDocumentLoaded=null,this.unsubscribeFromCloseDocument=null,this.unsubscribeFromSetScale=null,this.unsubscribeFromSetRotation=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.engine=this.registry.getEngine(),this.logger=this.registry.getLogger(),this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,n)=>{this.onStoreUpdated(n,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,n)=>{this.onCoreStoreUpdated(n,t),t.core.activeDocumentId!==n.core.activeDocumentId&&this.onActiveDocumentChanged(n.core.activeDocumentId,t.core.activeDocumentId)}),this.unsubscribeFromStartLoadingDocument=this.coreStore.onAction(Cn,e=>{this.onDocumentLoadingStarted(e.payload.documentId)}),this.unsubscribeFromSetDocumentLoaded=this.coreStore.onAction(kn,e=>{this.onDocumentLoaded(e.payload.documentId)}),this.unsubscribeFromCloseDocument=this.coreStore.onAction(On,e=>{this.onDocumentClosed(e.payload.documentId)}),this.unsubscribeFromSetScale=this.coreStore.onAction(zn,(e,t)=>{const n=e.payload.documentId??t.core.activeDocumentId;n&&this.onScaleChanged(n,e.payload.scale)}),this.unsubscribeFromSetRotation=this.coreStore.onAction(jn,(e,t)=>{const n=e.payload.documentId??t.core.activeDocumentId;n&&this.onRotationChanged(n,e.payload.rotation)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}cooldownDispatch(e,t=100){const n=Date.now();return n-(this.cooldownActions[e.type]||0)>=t&&(this.cooldownActions[e.type]=n,this.dispatch(e),!0)}debouncedDispatch(e,t=100){const n=e.type;this.debouncedTimeouts[n]&&clearTimeout(this.debouncedTimeouts[n]),this.debouncedTimeouts[n]=setTimeout(()=>{this.dispatch(e),delete this.debouncedTimeouts[n]},t)}cancelDebouncedDispatch(e){this.debouncedTimeouts[e]&&(clearTimeout(this.debouncedTimeouts[e]),delete this.debouncedTimeouts[e])}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}onDocumentLoadingStarted(e){}onDocumentLoaded(e){}onDocumentClosed(e){}onActiveDocumentChanged(e,t){}onScaleChanged(e,t){}onRotationChanged(e,t){}destroy(){Object.values(this.debouncedTimeouts).forEach(e=>{clearTimeout(e)}),this.debouncedTimeouts={},this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null),this.unsubscribeFromStartLoadingDocument&&(this.unsubscribeFromStartLoadingDocument(),this.unsubscribeFromStartLoadingDocument=null),this.unsubscribeFromSetDocumentLoaded&&(this.unsubscribeFromSetDocumentLoaded(),this.unsubscribeFromSetDocumentLoaded=null),this.unsubscribeFromCloseDocument&&(this.unsubscribeFromCloseDocument(),this.unsubscribeFromCloseDocument=null),this.unsubscribeFromSetScale&&(this.unsubscribeFromSetScale(),this.unsubscribeFromSetScale=null),this.unsubscribeFromSetRotation&&(this.unsubscribeFromSetRotation(),this.unsubscribeFromSetRotation=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}getActiveDocumentId(){const e=this.coreState.core.activeDocumentId;if(!e)throw new Error("No active document");return e}getActiveDocumentIdOrNull(){return this.coreState.core.activeDocumentId}getCoreDocument(e){const t=e??this.getActiveDocumentIdOrNull();return t?this.coreState.core.documents[t]??null:null}getCoreDocumentOrThrow(e){const t=this.getCoreDocument(e);if(!t)throw new Error(`Document not found: ${e??"active"}`);return t}}class Jn{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),n=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===n&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}}class eo{constructor(e,t){this.handler=e,this.options=t,this.controls=new Map,this.handle=e=>{const t=String(this.options.keyExtractor(e));let n=this.controls.get(t);n||(n=new Jn(this.handler,this.baseOptions),this.controls.set(t,n)),n.handle(e)},this.baseOptions={mode:t.mode,wait:t.wait,..."throttle"===t.mode&&"throttleMode"in t?{throttleMode:t.throttleMode}:{}}}destroy(){for(const e of this.controls.values())e.destroy();this.controls.clear()}}function to(e){return"keyExtractor"in e}function no(e,t,n){return e<t?t:e>n?n:e}function oo(e,t,n){if(e===t)return!0;if(null==e||null==t)return e===t;const o=typeof e;if(o!==typeof t)return!1;if("object"===o){n||(n=new Set);const o=function(e,t){return`${io(e)}__${io(t)}`}(e,t);if(n.has(o))return!0;n.add(o);const r=Array.isArray(e),a=Array.isArray(t);return r&&a?function(e,t,n){if(e.length!==t.length)return!1;const o=new Array(t.length).fill(!1);e:for(let r=0;r<e.length;r++){const a=e[r];for(let e=0;e<t.length;e++)if(!o[e]&&oo(a,t[e],n)){o[e]=!0;continue e}return!1}return!0}(e,t,n):!r&&!a&&function(e,t,n){const o=Object.keys(e).sort(),r=Object.keys(t).sort();if(o.length!==r.length)return!1;for(let e=0;e<o.length;e++)if(o[e]!==r[e])return!1;for(const r of o)if(!oo(e[r],t[r],n))return!1;return!0}(e,t,n)}return!1}let ro=0;const ao=new WeakMap;function io(e){return ao.has(e)||ao.set(e,++ro),ao.get(e)}function so(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function lo(e,t=oo){const n=new Set,o=new Map;let r=e;const a=(e,t)=>{let a=e,i=()=>{};if(t){if(to(t)){const n=new eo(e,t);a=n.handle,i=()=>n.destroy()}else{const n=new Jn(e,t);a=n.handle,i=()=>n.destroy()}o.set(e,{wrapped:a,destroy:i})}return void 0!==r&&a(r),n.add(a),()=>{n.delete(a),i(),o.delete(e)}};return{get value(){return r},emit(e=void 0){void 0!==r&&t(r,e)||(r=e,(e=>{n.forEach(t=>t(e))})(e))},on:a,off(e){const t=o.get(e);t?(n.delete(t.wrapped),t.destroy(),o.delete(e)):n.delete(e)},clear(){n.clear(),o.forEach(e=>e.destroy()),o.clear()},select:(e,t=oo)=>(n,o)=>{let i;if(void 0!==r){const t=e(r);i=t,n(t)}return a(o=>{const r=e(o);void 0!==i&&t(i,r)||(i=r,n(r))},o)}}}function co(e,t){const n=(null==t?void 0:t.cache)??!0,o=(null==t?void 0:t.equality)??oo,r=new Map,a=new Map,i=new Map,s=new Set,l=new Map,d=e=>String(e);return{emit(t,i){const l=d(t);if(n){const e=r.get(l);if(void 0!==e&&o(e,i))return;r.set(l,i)}const c=a.get(l);c&&c.forEach(e=>e(i));const u=e(t,i);s.forEach(e=>e(u))},forScope(e){const t=d(e);return(e,o)=>{const s=(e=>{let t=a.get(e);return t||(t=new Set,a.set(e,t)),t})(t),l=(e=>{let t=i.get(e);return t||(t=new Map,i.set(e,t)),t})(t);let d=e,c=()=>{};if(o){if(to(o)){const t=new eo(e,o);d=t.handle,c=()=>t.destroy()}else{const t=new Jn(e,o);d=t.handle,c=()=>t.destroy()}l.set(e,{wrapped:d,destroy:c})}if(n){const e=r.get(t);void 0!==e&&d(e)}return s.add(d),()=>{s.delete(d),c(),l.delete(e),0===s.size&&a.delete(t),0===l.size&&i.delete(t)}}},onGlobal:(e,t)=>{let n=e,o=()=>{};if(t){if(to(t)){const r=new eo(e,t);n=r.handle,o=()=>r.destroy()}else{const r=new Jn(e,t);n=r.handle,o=()=>r.destroy()}l.set(e,{wrapped:n,destroy:o})}return s.add(n),()=>{s.delete(n),o(),l.delete(e)}},getValue:e=>n?r.get(d(e)):void 0,getScopes:()=>n?Array.from(r.keys()):Array.from(a.keys()),clearScope(e){const t=d(e);n&&r.delete(t);const o=a.get(t);o&&(o.clear(),a.delete(t));const s=i.get(t);s&&(s.forEach(e=>e.destroy()),s.clear(),i.delete(t))},clear(){n&&r.clear(),a.forEach(e=>e.clear()),a.clear(),i.forEach(e=>{e.forEach(e=>e.destroy()),e.clear()}),i.clear(),s.clear(),l.forEach(e=>e.destroy()),l.clear()}}}class uo{constructor(e){this.autoMountElements=[],this.package=e}addUtility(e){return this.autoMountElements.push({component:e,type:"utility"}),this}addWrapper(e){return this.autoMountElements.push({component:e,type:"wrapper"}),this}build(){return{...this.package,autoMountElements:()=>this.autoMountElements}}}function mo(e){return new uo(e)}const po=pe({registry:null,coreState:null,isInitializing:!0,pluginsReady:!1,activeDocumentId:null,activeDocument:null,documents:{},documentStates:[]});function ho({plugins:e,children:t}){const{utilities:n,wrappers:o}=Ie(()=>{const t=[],n=[];for(const o of e){const e=o.package;if(Zn(e)){const o=e.autoMountElements()||[];for(const e of o)"utility"===e.type?t.push(e.component):"wrapper"===e.type&&n.push(e.component)}}return{utilities:t,wrappers:n}},[e]);return We(H,{children:[o.reduce((e,t)=>We(t,{children:e}),t),n.map((e,t)=>We(e,{},`utility-${t}`))]})}function go({engine:e,logger:t,onInitialized:n,plugins:o,children:r,autoMountDomElements:a=!0}){const[i,s]=Ee(null),[l,d]=Ee(null),[c,u]=Ee(!0),[m,p]=Ee(!1),h=Te(n);Me(()=>{h.current=n},[n]),Me(()=>{const n=new Kn(e,{logger:t});let r;return n.registerPluginBatch(o),(async()=>{var e;if(await n.initialize(),n.isDestroyed())return;const t=n.getStore();d(t.getState().core);const o=t.subscribe((e,n,o)=>{t.isCoreAction(e)&&n.core!==o.core&&d(n.core)});if(await(null==(e=h.current)?void 0:e.call(h,n)),!n.isDestroyed())return n.pluginsReady().then(()=>{n.isDestroyed()||p(!0)}),s(n),u(!1),o;o()})().then(e=>{r=e}).catch(console.error),()=>{null==r||r(),n.destroy(),s(null),d(null),u(!0),p(!1)}},[e,o]);const g=Ie(()=>{const e=(null==l?void 0:l.activeDocumentId)??null,t=(null==l?void 0:l.documents)??{},n=(null==l?void 0:l.documentOrder)??[],o=e&&t[e]?t[e]:null,r=n.map(e=>t[e]).filter(e=>null!=e);return{registry:i,coreState:l,isInitializing:c,pluginsReady:m,activeDocumentId:e,activeDocument:o,documents:t,documentStates:r}},[i,l,c,m]),f="function"==typeof r?r(g):r;return We(po.Provider,{value:g,children:m&&a?We(ho,{plugins:o,children:f}):f})}function fo(e){const{registry:t}=function(){const e=Re(po);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:n}=e;if(n)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const n=t.getPlugin(e);if(!n)throw new Error(`Plugin ${e} not found`);return{plugin:n,isLoading:!1,ready:n.ready()}}function Fo(e){const{plugin:t,isLoading:n,ready:o}=fo(e);if(!t)return{provides:null,isLoading:n,ready:o};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:n,ready:o}}function Po(){const{coreState:e}=Re(po);return e}function bo(e){const t=Po();return Ie(()=>t&&e?t.documents[e]??null:null,[t,e])}const _o="https://cdn.jsdelivr.net/npm/@embedpdf/pdfium@2.1.2/dist/pdfium.wasm";pe(void 0);const vo="viewport",yo={id:vo,name:"Viewport Plugin",version:"1.0.0",provides:["viewport"],requires:[],optional:[],defaultConfig:{viewportGap:10,scrollEndDelay:300}},Do="INIT_VIEWPORT_STATE",xo="CLEANUP_VIEWPORT_STATE",Ao="REGISTER_VIEWPORT",wo="UNREGISTER_VIEWPORT",So="SET_VIEWPORT_METRICS",Eo="SET_VIEWPORT_SCROLL_METRICS",Co="SET_VIEWPORT_GAP",Mo="SET_SCROLL_ACTIVITY",ko="SET_SMOOTH_SCROLL_ACTIVITY",To="ADD_VIEWPORT_GATE",Io="REMOVE_VIEWPORT_GATE";function Oo(e,t){return{type:ko,payload:{documentId:e,isSmoothScrolling:t}}}const Ro={viewportMetrics:{width:0,height:0,scrollTop:0,scrollLeft:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0,clientLeft:0,clientTop:0,relativePosition:{x:0,y:0}},isScrolling:!1,isSmoothScrolling:!1,gates:new Set},Go={viewportGap:0,documents:{},activeViewports:new Set,activeDocumentId:null},Lo=class extends Qn{constructor(e,t,n){var o;super(e,t),this.id=e,this.viewportResize$=lo(),this.viewportMetrics$=lo(),this.scrollMetrics$=lo(),this.scrollActivity$=lo(),this.gateState$=lo(),this.scrollRequests$=new Map,n.viewportGap&&this.dispatch((o=n.viewportGap,{type:Co,payload:o})),this.scrollEndDelay=n.scrollEndDelay||100}onDocumentLoadingStarted(e){this.dispatch(function(e){return{type:Do,payload:{documentId:e}}}(e)),this.scrollRequests$.set(e,so()),this.logger.debug("ViewportPlugin","DocumentOpened",`Initialized viewport state for document: ${e}`)}onDocumentClosed(e){var t;this.dispatch(function(e){return{type:xo,payload:{documentId:e}}}(e)),null==(t=this.scrollRequests$.get(e))||t.clear(),this.scrollRequests$.delete(e),this.logger.debug("ViewportPlugin","DocumentClosed",`Cleaned up viewport state for document: ${e}`)}buildCapability(){return{getViewportGap:()=>this.state.viewportGap,getMetrics:()=>this.getMetrics(),scrollTo:e=>this.scrollTo(e),isScrolling:()=>this.isScrolling(),isSmoothScrolling:()=>this.isSmoothScrolling(),isGated:e=>this.isGated(e),hasGate:(e,t)=>this.hasGate(e,t),getGates:e=>this.getGates(e),forDocument:e=>this.createViewportScope(e),gate:(e,t)=>this.gate(e,t),releaseGate:(e,t)=>this.releaseGate(e,t),isViewportMounted:e=>this.state.activeViewports.has(e),onViewportChange:this.viewportMetrics$.on,onViewportResize:this.viewportResize$.on,onScrollChange:this.scrollMetrics$.on,onScrollActivity:this.scrollActivity$.on,onGateChange:this.gateState$.on}}createViewportScope(e){return{getMetrics:()=>this.getMetrics(e),scrollTo:t=>this.scrollTo(t,e),isScrolling:()=>this.isScrolling(e),isSmoothScrolling:()=>this.isSmoothScrolling(e),isGated:()=>this.isGated(e),hasGate:t=>this.hasGate(t,e),getGates:()=>this.getGates(e),gate:t=>this.gate(t,e),releaseGate:t=>this.releaseGate(t,e),onViewportChange:t=>this.viewportMetrics$.on(n=>{n.documentId===e&&t(n.metrics)}),onScrollChange:t=>this.scrollMetrics$.on(n=>{n.documentId===e&&t(n.scrollMetrics)}),onScrollActivity:t=>this.scrollActivity$.on(n=>{n.documentId===e&&t(n.activity)}),onGateChange:t=>this.gateState$.on(n=>{(null==n?void 0:n.documentId)===e&&t(n)})}}registerViewport(e){if(!this.state.documents[e])throw new Error(`Cannot register viewport for ${e}: document state not found. Document must be opened before registering viewport.`);this.state.activeViewports.has(e)||(this.dispatch(function(e){return{type:Ao,payload:{documentId:e}}}(e)),this.logger.debug("ViewportPlugin","RegisterViewport",`Registered viewport (DOM mounted) for document: ${e}`))}unregisterViewport(e){this.registry.isDestroyed()||this.state.activeViewports.has(e)&&(this.dispatch(function(e){return{type:wo,payload:{documentId:e}}}(e)),this.logger.debug("ViewportPlugin","UnregisterViewport",`Unregistered viewport (DOM unmounted) for document: ${e}. State preserved.`))}setViewportResizeMetrics(e,t){if(this.registry.isDestroyed())return;this.dispatch(function(e,t){return{type:So,payload:{documentId:e,metrics:t}}}(e,t));const n=this.state.documents[e];n&&this.viewportResize$.emit({documentId:e,metrics:n.viewportMetrics})}setViewportScrollMetrics(e,t){if(this.registry.isDestroyed())return;const n=this.state.documents[e];n&&(t.scrollTop===n.viewportMetrics.scrollTop&&t.scrollLeft===n.viewportMetrics.scrollLeft||(this.dispatch(function(e,t){return{type:Eo,payload:{documentId:e,scrollMetrics:t}}}(e,t)),this.bumpScrollActivity(e),this.scrollMetrics$.emit({documentId:e,scrollMetrics:t})))}onScrollRequest(e,t){const n=this.scrollRequests$.get(e);if(!n)throw new Error(`Cannot subscribe to scroll requests for ${e}: document state not initialized`);return n.on(t)}gate(e,t){const n=this.state.documents[t];n?n.gates.has(e)||(this.dispatch(function(e,t){return{type:To,payload:{documentId:e,key:t}}}(t,e)),this.logger.debug("ViewportPlugin","GateAdded",`Added gate '${e}' for document: ${t}. Total gates: ${n.gates.size+1}`)):this.logger.warn("ViewportPlugin","GateViewport",`Cannot gate viewport for ${t}: document not found`)}releaseGate(e,t){const n=this.state.documents[t];n?n.gates.has(e)&&(this.dispatch(function(e,t){return{type:Io,payload:{documentId:e,key:t}}}(t,e)),this.logger.debug("ViewportPlugin","GateReleased",`Released gate '${e}' for document: ${t}. Remaining gates: ${n.gates.size-1}`)):this.logger.warn("ViewportPlugin","ReleaseGate",`Cannot release gate for ${t}: document not found`)}getViewportState(e){const t=e??this.getActiveDocumentId(),n=this.state.documents[t];if(!n)throw new Error(`Viewport state not found for document: ${t}`);return n}getMetrics(e){return this.getViewportState(e).viewportMetrics}isScrolling(e){return this.getViewportState(e).isScrolling}isSmoothScrolling(e){return this.getViewportState(e).isSmoothScrolling}isGated(e){return this.getViewportState(e).gates.size>0}hasGate(e,t){return this.getViewportState(t).gates.has(e)}getGates(e){const t=this.getViewportState(e);return Array.from(t.gates)}scrollTo(e,t){const n=t??this.getActiveDocumentId(),o=this.getViewportState(n),{x:r,y:a,alignX:i,alignY:s,behavior:l="auto"}=e;"smooth"===l&&this.dispatch(Oo(n,!0));const d=o.viewportMetrics;let c=r,u=a;void 0!==i&&(c=r-d.clientWidth*(i/100)),void 0!==s&&(u=a-d.clientHeight*(s/100));const m=this.scrollRequests$.get(n);m&&m.emit({x:c,y:u,behavior:l})}bumpScrollActivity(e){this.debouncedDispatch(function(e){return{type:Mo,payload:{documentId:e,isScrolling:!1}}}(e),this.scrollEndDelay),this.debouncedDispatch(Oo(e,!1),this.scrollEndDelay)}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];if(o!==r&&(this.viewportMetrics$.emit({documentId:n,metrics:r.viewportMetrics}),!o||o.isScrolling===r.isScrolling&&o.isSmoothScrolling===r.isSmoothScrolling||this.scrollActivity$.emit({documentId:n,activity:{isScrolling:r.isScrolling,isSmoothScrolling:r.isSmoothScrolling}}),o&&o.gates!==r.gates)){const e=Array.from(o.gates),t=Array.from(r.gates),a=t.find(t=>!e.includes(t)),i=e.find(e=>!t.includes(e));this.gateState$.emit({documentId:n,isGated:r.gates.size>0,gates:t,addedGate:a,removedGate:i}),this.logger.debug("ViewportPlugin","GateStateChanged",`Gate state changed for document ${n}. Gates: [${t.join(", ")}], Gated: ${r.gates.size>0}`)}}}async initialize(e){this.logger.info("ViewportPlugin","Initialize","Viewport plugin initialized")}async destroy(){this.viewportMetrics$.clear(),this.viewportResize$.clear(),this.scrollMetrics$.clear(),this.scrollActivity$.clear(),this.gateState$.clear(),this.scrollRequests$.forEach(e=>e.clear()),this.scrollRequests$.clear(),super.destroy()}};Lo.id="viewport";let No=Lo;const zo={manifest:yo,create:(e,t)=>new No(vo,e,t),reducer:(e=Go,t)=>{switch(t.type){case Do:{const{documentId:n}=t.payload;return{...e,documents:{...e.documents,[n]:{...Ro,gates:new Set}}}}case xo:{const{documentId:n}=t.payload,{[n]:o,...r}=e.documents,a=new Set(e.activeViewports);return a.delete(n),{...e,documents:r,activeViewports:a,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case Ao:{const{documentId:n}=t.payload,o=new Set(e.activeViewports);return o.add(n),{...e,activeViewports:o,activeDocumentId:e.activeDocumentId??n}}case wo:{const{documentId:n}=t.payload,o=new Set(e.activeViewports);return o.delete(n),{...e,activeViewports:o}}case"SET_ACTIVE_VIEWPORT_DOCUMENT":return{...e,activeDocumentId:t.payload};case Co:return{...e,viewportGap:t.payload};case So:{const{documentId:n,metrics:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,viewportMetrics:{width:o.width,height:o.height,scrollTop:o.scrollTop,scrollLeft:o.scrollLeft,clientWidth:o.clientWidth,clientHeight:o.clientHeight,scrollWidth:o.scrollWidth,scrollHeight:o.scrollHeight,clientLeft:o.clientLeft,clientTop:o.clientTop,relativePosition:{x:o.scrollWidth<=o.clientWidth?0:o.scrollLeft/(o.scrollWidth-o.clientWidth),y:o.scrollHeight<=o.clientHeight?0:o.scrollTop/(o.scrollHeight-o.clientHeight)}}}}}:e}case Eo:{const{documentId:n,scrollMetrics:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,viewportMetrics:{...r.viewportMetrics,scrollTop:o.scrollTop,scrollLeft:o.scrollLeft},isScrolling:!0}}}:e}case Mo:{const{documentId:n,isScrolling:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,isScrolling:o}}}:e}case ko:{const{documentId:n,isSmoothScrolling:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,isSmoothScrolling:o}}}:e}case To:{const{documentId:n,key:o}=t.payload,r=e.documents[n];if(!r)return e;const a=new Set(r.gates);return a.add(o),{...e,documents:{...e.documents,[n]:{...r,gates:a}}}}case Io:{const{documentId:n,key:o}=t.payload,r=e.documents[n];if(!r)return e;const a=new Set(r.gates);return a.delete(o),{...e,documents:{...e.documents,[n]:{...r,gates:a}}}}default:return e}},initialState:Go},jo=pe(null),Bo=()=>Fo(No.id);function $o({children:e,documentId:t,...n}){const[o,r]=Ee(0),a=function(e){const{plugin:t}=fo(No.id),n=Te(null);return ke(()=>{if(!t)return;const o=n.current;if(!o)return;try{t.registerViewport(e)}catch(t){return void console.error(`Failed to register viewport for document ${e}:`,t)}const r=()=>{t.setViewportScrollMetrics(e,{scrollTop:o.scrollTop,scrollLeft:o.scrollLeft})};o.addEventListener("scroll",r);const a=new ResizeObserver(()=>{t.setViewportResizeMetrics(e,{width:o.offsetWidth,height:o.offsetHeight,clientWidth:o.clientWidth,clientHeight:o.clientHeight,scrollTop:o.scrollTop,scrollLeft:o.scrollLeft,scrollWidth:o.scrollWidth,scrollHeight:o.scrollHeight,clientLeft:o.clientLeft,clientTop:o.clientTop})});a.observe(o);const i=t.onScrollRequest(e,({x:e,y:t,behavior:n="auto"})=>{requestAnimationFrame(()=>{o.scrollTo({left:e,top:t,behavior:n})})});return()=>{t.unregisterViewport(e),a.disconnect(),o.removeEventListener("scroll",r),i()}},[t,e]),n}(t),{provides:i}=Bo(),s=(e=>{const{provides:t}=Bo(),[n,o]=Ee((null==t?void 0:t.isGated(e))??!1);return Me(()=>{if(t)return o(t.isGated(e)),t.onGateChange(t=>{t.documentId===e&&o(t.isGated)})},[t,e]),n})(t);Me(()=>{i&&r(i.getViewportGap())},[i]);const{style:l,...d}=n;return We(jo.Provider,{value:a,children:We("div",{...d,ref:a,style:{width:"100%",height:"100%",overflow:"auto",..."object"==typeof l?l:{},padding:`${o}px`},children:!s&&e})})}var Uo=(e=>(e.Vertical="vertical",e.Horizontal="horizontal",e))(Uo||{});class Wo{constructor(e){this.pageGap=e.pageGap??20,this.viewportGap=e.viewportGap??20,this.bufferSize=e.bufferSize??2}getVisibleRange(e,t,n){const o=this.getScrollOffset(e),r=o,a=o+this.getClientSize(e);let i=0;for(;i<t.length&&(t[i].offset+t[i].height)*n<=r;)i++;let s=i;for(;s<t.length&&t[s].offset*n<=a;)s++;return{start:Math.max(0,i-this.bufferSize),end:Math.min(t.length-1,s+this.bufferSize-1)}}handleScroll(e,t,n){const o=this.getVisibleRange(e,t,n),r=t.slice(o.start,o.end+1),a=this.calculatePageVisibility(r,e,n),i=a.map(e=>e.pageNumber),s=t.slice(o.start,o.end+1).flatMap(e=>e.index),l=this.determineCurrentPage(a),d=t[o.start],c=t[o.end],u=d?d.offset*n:0,m=c?(t[t.length-1].offset+t[t.length-1].height)*n-(c.offset+c.height)*n:0;return{currentPage:l,visiblePages:i,pageVisibilityMetrics:a,renderedPageIndexes:s,scrollOffset:{x:e.scrollLeft,y:e.scrollTop},startSpacing:u,endSpacing:m}}calculatePageVisibility(e,t,n){const o=[];return e.forEach(e=>{e.pageLayouts.forEach(r=>{const a=e.x*n,i=e.y*n,s=a+r.x*n,l=i+r.y*n,d=r.rotatedWidth*n,c=r.rotatedHeight*n,u=t.scrollLeft,m=t.scrollTop,p=u+t.clientWidth,h=m+t.clientHeight,g=Math.max(s,u),f=Math.max(l,m),F=Math.min(s+d,p),P=Math.min(l+c,h);if(g<F&&f<P){const e=F-g,t=P-f,a=d*c,i=e*t;o.push({pageNumber:r.pageNumber,viewportX:g-u,viewportY:f-m,visiblePercentage:i/a*100,original:{pageX:(g-s)/n,pageY:(f-l)/n,visibleWidth:e/n,visibleHeight:t/n,scale:1},scaled:{pageX:g-s,pageY:f-l,visibleWidth:e,visibleHeight:t,scale:n}})}})}),o}determineCurrentPage(e){if(0===e.length)return 1;const t=Math.max(...e.map(e=>e.visiblePercentage)),n=e.filter(e=>e.visiblePercentage===t);return 1===n.length?n[0].pageNumber:n.sort((e,t)=>e.pageNumber-t.pageNumber)[0].pageNumber}getRectLocationForPage(e,t,n){const o=t.find(t=>t.pageNumbers.includes(e));if(!o)return null;const r=o.pageLayouts.find(t=>t.pageNumber===e);if(!r)return null;let a=0;if(n){const e=n.width;o.width<e&&(a=(e-o.width)/2)}return{origin:{x:o.x+r.x+a,y:o.y+r.y},size:{width:r.width,height:r.height}}}getScrollPositionForPage(e,t,n,o,r){const a=this.getTotalContentSize(t),i=this.getRectLocationForPage(e,t,a);if(!i)return null;const s=et(i.origin,n);if(r){const e=function(e,t,n,o){return et(Je(e,t,n),o)}({width:i.size.width,height:i.size.height},{x:r.x,y:r.y},o,n);return{x:s.x+e.x+this.viewportGap,y:s.y+e.y+this.viewportGap}}return{x:s.x+this.viewportGap,y:s.y+this.viewportGap}}getRectPositionForPage(e,t,n,o,r){const a=this.getTotalContentSize(t),i=this.getRectLocationForPage(e,t,a);if(!i)return null;const s=et(i.origin,n),l=at({width:i.size.width,height:i.size.height},r,o,n);return{origin:{x:s.x+l.origin.x,y:s.y+l.origin.y},size:l.size}}}class Ho extends Wo{constructor(e){super(e)}createVirtualItems(e){let t=0;return e.map((e,n)=>{let o=0;const r=e.map(e=>{const t={pageNumber:e.index+1,pageIndex:e.index,x:o,y:0,width:e.size.width,height:e.size.height,rotatedWidth:e.rotatedSize.width,rotatedHeight:e.rotatedSize.height};return o+=e.rotatedSize.width+this.pageGap,t}),a=e.reduce((t,n,o)=>t+n.rotatedSize.width+(o<e.length-1?this.pageGap:0),0),i=Math.max(...e.map(e=>e.rotatedSize.height)),s={id:`item-${n}`,x:0,y:t,offset:t,width:a,height:i,pageLayouts:r,pageNumbers:e.map(e=>e.index+1),index:n};return t+=i+this.pageGap,s})}getTotalContentSize(e){return 0===e.length?{width:0,height:0}:{width:Math.max(...e.map(e=>e.width)),height:e[e.length-1].y+e[e.length-1].height}}getScrollOffset(e){return e.scrollTop}getClientSize(e){return e.clientHeight}}class Vo extends Wo{constructor(e){super(e)}createVirtualItems(e){let t=0;return e.map((e,n)=>{let o=0;const r=e.map(e=>{const t={pageNumber:e.index+1,pageIndex:e.index,x:o,y:0,width:e.size.width,height:e.size.height,rotatedWidth:e.rotatedSize.width,rotatedHeight:e.rotatedSize.height};return o+=e.rotatedSize.width+this.pageGap,t}),a=e.reduce((t,n,o)=>t+n.rotatedSize.width+(o<e.length-1?this.pageGap:0),0),i=Math.max(...e.map(e=>e.rotatedSize.height)),s={id:`item-${n}`,x:t,y:0,offset:t,width:a,height:i,pageLayouts:r,pageNumbers:e.map(e=>e.index+1),index:n};return t+=a+this.pageGap,s})}getTotalContentSize(e){return 0===e.length?{width:0,height:0}:{width:e[e.length-1].x+e[e.length-1].width,height:Math.max(...e.map(e=>e.height))}}getScrollOffset(e){return e.scrollLeft}getClientSize(e){return e.clientWidth}}const Yo="INIT_SCROLL_STATE",qo="CLEANUP_SCROLL_STATE",Ko="UPDATE_DOCUMENT_SCROLL_STATE",Xo="SET_SCROLL_STRATEGY";function Zo(e,t){return{type:Ko,payload:{documentId:e,state:t}}}const Qo={isChanging:!1,targetPage:1,fromPage:1,startTime:0},Jo=class extends Qn{constructor(e,t,n){var o,r;super(e,t),this.id=e,this.config=n,this.strategies=new Map,this.layoutReady=new Set,this.initialLayoutFired=new Set,this.scrollerLayoutEmitters=new Map,this.pageChange$=lo(),this.scroll$=lo(),this.layoutChange$=lo(),this.pageChangeState$=lo(),this.layoutReady$=lo(),this.state$=lo(),this.viewport=this.registry.getPlugin("viewport").provides(),this.spread=(null==(o=this.registry.getPlugin("spread"))?void 0:o.provides())??null,this.viewport.onScrollActivity(e=>{const t=this.getDocumentState(e.documentId);(null==t?void 0:t.pageChangeState.isChanging)&&!e.activity.isSmoothScrolling&&this.completePageChange(e.documentId)}),null==(r=this.spread)||r.onSpreadChange(e=>{this.refreshDocumentLayout(e.documentId)}),this.viewport.onViewportChange(e=>{const t=this.getDocumentState(e.documentId);if(!t)return;const n=this.computeMetrics(e.documentId,e.metrics);this.layoutReady.has(e.documentId)?this.commitMetrics(e.documentId,n):this.commitMetrics(e.documentId,{...n,scrollOffset:t.scrollOffset})})}onDocumentLoadingStarted(e){const t=this.getCoreDocument(e);if(!t)return;const n=this.createDocumentState(t);this.dispatch(function(e,t){return{type:Yo,payload:{documentId:e,state:t}}}(e,n));const o=this.createStrategy(n.strategy);this.strategies.set(e,o),this.scrollerLayoutEmitters.set(e,lo())}onDocumentLoaded(e){var t;const n=this.getCoreDocument(e);n&&(this.dispatch(Zo(e,{totalPages:(null==(t=n.document)?void 0:t.pageCount)??0})),this.refreshDocumentLayout(e),this.logger.debug("ScrollPlugin","DocumentOpened",`Initialized scroll state for document: ${e}`))}onDocumentClosed(e){this.strategies.delete(e),this.layoutReady.delete(e),this.initialLayoutFired.delete(e);const t=this.scrollerLayoutEmitters.get(e);t&&(t.clear(),this.scrollerLayoutEmitters.delete(e)),this.dispatch(function(e){return{type:qo,payload:e}}(e)),this.logger.debug("ScrollPlugin","DocumentClosed",`Cleaned up scroll state for document: ${e}`)}onScaleChanged(e){const t=this.coreState.core.documents[e];if(!t||"loaded"!==t.status)return;const n=this.viewport.forDocument(e),o=this.computeMetrics(e,n.getMetrics());this.commitMetrics(e,o)}onRotationChanged(e){this.refreshDocumentLayout(e)}onScrollerData(e,t){const n=this.scrollerLayoutEmitters.get(e);if(!n)throw new Error(`No scroller layout emitter found for document: ${e}`);return n.on(t)}getScrollerLayout(e){const t=this.getDocumentState(e),n=this.getCoreDocumentOrThrow(e);if(!t||!n)throw new Error(`Cannot get scroller layout for document: ${e}`);return o=t,r=n.scale,{startSpacing:o.startSpacing,endSpacing:o.endSpacing,totalWidth:o.totalContentSize.width*r,totalHeight:o.totalContentSize.height*r,pageGap:o.pageGap*r,strategy:o.strategy,items:o.renderedPageIndexes.map(e=>({...o.virtualItems[e],pageLayouts:o.virtualItems[e].pageLayouts.map(e=>({...e,rotatedWidth:e.rotatedWidth*r,rotatedHeight:e.rotatedHeight*r,width:e.width*r,height:e.height*r}))}))};var o,r}setLayoutReady(e){if(this.layoutReady.has(e))return;const t=this.getDocumentState(e);if(!t)return;this.layoutReady.add(e);const n=!this.initialLayoutFired.has(e);n&&this.initialLayoutFired.add(e),this.viewport.forDocument(e).scrollTo({...t.scrollOffset,behavior:"instant"}),this.layoutReady$.emit({documentId:e,isInitial:n,pageNumber:t.currentPage,totalPages:t.totalPages})}clearLayoutReady(e){this.layoutReady.delete(e)}buildCapability(){return{getCurrentPage:()=>this.getCurrentPage(),getTotalPages:()=>this.getTotalPages(),getPageChangeState:()=>this.getPageChangeState(),scrollToPage:e=>this.scrollToPage(e),scrollToNextPage:e=>this.scrollToNextPage(e),scrollToPreviousPage:e=>this.scrollToPreviousPage(e),getMetrics:e=>this.getMetrics(e),getLayout:()=>this.getLayout(),getRectPositionForPage:(e,t,n,o)=>this.getRectPositionForPage(e,t,n,o),forDocument:e=>this.createScrollScope(e),setScrollStrategy:(e,t)=>this.setScrollStrategyForDocument(e,t),getPageGap:()=>this.state.defaultPageGap,onPageChange:this.pageChange$.on,onScroll:this.scroll$.on,onLayoutChange:this.layoutChange$.on,onLayoutReady:this.layoutReady$.on,onPageChangeState:this.pageChangeState$.on,onStateChange:this.state$.on}}createScrollScope(e){return{getCurrentPage:()=>this.getCurrentPage(e),getTotalPages:()=>this.getTotalPages(e),getPageChangeState:()=>this.getPageChangeState(e),scrollToPage:t=>this.scrollToPage(t,e),scrollToNextPage:t=>this.scrollToNextPage(t,e),scrollToPreviousPage:t=>this.scrollToPreviousPage(t,e),getSpreadPagesWithRotatedSize:()=>this.getSpreadPagesWithRotatedSize(e),getMetrics:t=>this.getMetrics(t,e),getLayout:()=>this.getLayout(e),getRectPositionForPage:(t,n,o,r)=>this.getRectPositionForPage(t,n,o,r,e),setScrollStrategy:t=>this.setScrollStrategyForDocument(t,e),onPageChange:t=>this.pageChange$.on(n=>{n.documentId===e&&t(n)}),onScroll:t=>this.scroll$.on(n=>{n.documentId===e&&t(n.metrics)}),onLayoutChange:t=>this.layoutChange$.on(n=>{n.documentId===e&&t(n.layout)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Scroll state not found for document: ${e??"active"}`);return t}getStrategy(e){const t=e??this.getActiveDocumentId(),n=this.strategies.get(t);if(!n)throw new Error(`Strategy not found for document: ${t}`);return n}createStrategy(e){const t={pageGap:this.state.defaultPageGap,viewportGap:this.viewport.getViewportGap(),bufferSize:this.state.defaultBufferSize};return e===Uo.Horizontal?new Vo(t):new Ho(t)}createDocumentState(e){var t;return{virtualItems:[],totalPages:(null==(t=e.document)?void 0:t.pageCount)??0,currentPage:1,totalContentSize:{width:0,height:0},strategy:this.state.defaultStrategy,pageGap:this.state.defaultPageGap,visiblePages:[],pageVisibilityMetrics:[],renderedPageIndexes:[],scrollOffset:{x:0,y:0},startSpacing:0,endSpacing:0,pageChangeState:Qo}}startPageChange(e,t,n="smooth"){const o=this.getDocumentState(e);if(!o)return;const r={isChanging:!0,targetPage:t,fromPage:o.currentPage,startTime:Date.now()};this.dispatch(Zo(e,{pageChangeState:r})),"instant"===n&&this.completePageChange(e)}completePageChange(e){const t=this.getDocumentState(e);if(!t||!t.pageChangeState.isChanging)return;const n={isChanging:!1,targetPage:t.pageChangeState.targetPage,fromPage:t.pageChangeState.fromPage,startTime:t.pageChangeState.startTime};this.dispatch(Zo(e,{pageChangeState:n}))}computeLayout(e,t){const n=this.getStrategy(e),o=n.createVirtualItems(t);return{virtualItems:o,totalContentSize:n.getTotalContentSize(o)}}computeMetrics(e,t,n){const o=this.getCoreDocumentOrThrow(e),r=this.getDocumentState(e),a=this.getStrategy(e);if(!r)throw new Error(`Document state not found: ${e}`);return a.handleScroll(t,n??r.virtualItems,o.scale)}commitMetrics(e,t){const n=this.getDocumentState(e);n&&(this.dispatch(Zo(e,t)),this.scroll$.emit({documentId:e,metrics:t}),t.currentPage!==n.currentPage&&this.pageChange$.emit({documentId:e,pageNumber:t.currentPage,totalPages:n.totalPages}),this.pushScrollerLayout(e))}pushScrollerLayout(e){const t=this.scrollerLayoutEmitters.get(e);if(t)try{const n=this.getScrollerLayout(e);t.emit(n)}catch(e){}}refreshDocumentLayout(e){const t=this.coreState.core.documents[e],n=this.getDocumentState(e);if(!t||!n||"loaded"!==t.status)return;const o=this.getSpreadPagesWithRotatedSize(e),r=this.computeLayout(e,o),a=this.viewport.forDocument(e),i=this.computeMetrics(e,a.getMetrics(),r.virtualItems);this.dispatch(Zo(e,{...r,...i})),this.layoutChange$.emit({documentId:e,layout:r}),this.pushScrollerLayout(e)}getSpreadPagesWithRotatedSize(e){var t,n;const o=e??this.getActiveDocumentId(),r=this.coreState.core.documents[o];if(!r)throw new Error(`Document ${o} not loaded`);return((null==(t=this.spread)?void 0:t.forDocument(o).getSpreadPages())||(null==(n=r.document)?void 0:n.pages.map(e=>[e]))||[]).map(e=>e.map(e=>({...e,rotatedSize:Xe(e.size,r.rotation,1)})))}getCurrentPage(e){return this.getDocumentStateOrThrow(e).currentPage}getTotalPages(e){return this.getDocumentStateOrThrow(e).totalPages}getPageChangeState(e){return this.getDocumentStateOrThrow(e).pageChangeState}scrollToPage(e,t){const n=t??this.getActiveDocumentId(),o=this.getDocumentStateOrThrow(n),r=this.getStrategy(n),a=this.getCoreDocumentOrThrow(n),{pageNumber:i,behavior:s="smooth",pageCoordinates:l,alignX:d,alignY:c}=e;this.startPageChange(n,i,s);const u=r.getScrollPositionForPage(i,o.virtualItems,a.scale,a.rotation,l);u?this.viewport.forDocument(n).scrollTo({...u,behavior:s,alignX:d,alignY:c}):this.completePageChange(n)}scrollToNextPage(e="smooth",t){const n=t??this.getActiveDocumentId(),o=this.getDocumentStateOrThrow(n),r=this.getStrategy(n),a=this.getCoreDocumentOrThrow(n),i=o.virtualItems.findIndex(e=>e.pageNumbers.includes(o.currentPage));if(i>=0&&i<o.virtualItems.length-1){const t=o.virtualItems[i+1].pageNumbers[0];this.startPageChange(n,t,e);const s=r.getScrollPositionForPage(t,o.virtualItems,a.scale,a.rotation);s?this.viewport.forDocument(n).scrollTo({...s,behavior:e}):this.completePageChange(n)}}scrollToPreviousPage(e="smooth",t){const n=t??this.getActiveDocumentId(),o=this.getDocumentStateOrThrow(n),r=this.getStrategy(n),a=this.coreState.core.documents[n],i=o.virtualItems.findIndex(e=>e.pageNumbers.includes(o.currentPage));if(i>0){const t=o.virtualItems[i-1].pageNumbers[0];this.startPageChange(n,t,e);const s=r.getScrollPositionForPage(t,o.virtualItems,a.scale,a.rotation);s?this.viewport.forDocument(n).scrollTo({...s,behavior:e}):this.completePageChange(n)}}getMetrics(e,t){const n=t??this.getActiveDocumentId();if(e)return this.computeMetrics(n,e);const o=this.viewport.forDocument(n);return this.computeMetrics(n,o.getMetrics())}getLayout(e){const t=this.getDocumentStateOrThrow(e);return{virtualItems:t.virtualItems,totalContentSize:t.totalContentSize}}getRectPositionForPage(e,t,n,o,r){const a=r??this.getActiveDocumentId(),i=this.getDocumentStateOrThrow(a),s=this.getStrategy(a),l=this.getCoreDocumentOrThrow(a);return s.getRectPositionForPage(e+1,i.virtualItems,n??l.scale,o??l.rotation,t)}setScrollStrategyForDocument(e,t){const n=t??this.getActiveDocumentId(),o=this.getDocumentState(n);if(!o||o.strategy===e)return;const r=this.createStrategy(e);this.strategies.set(n,r),this.dispatch(function(e,t){return{type:Xo,payload:{documentId:e,strategy:t}}}(n,e)),this.refreshDocumentLayout(n)}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o!==r&&(this.state$.emit(r),(null==o?void 0:o.pageChangeState)!==r.pageChangeState&&this.pageChangeState$.emit({documentId:n,state:r.pageChangeState}),this.pushScrollerLayout(n))}}async initialize(){this.logger.info("ScrollPlugin","Initialize","Scroll plugin initialized")}async destroy(){this.strategies.clear(),this.layoutReady.clear(),this.initialLayoutFired.clear();for(const e of this.scrollerLayoutEmitters.values())e.clear();this.scrollerLayoutEmitters.clear(),this.pageChange$.clear(),this.scroll$.clear(),this.layoutChange$.clear(),this.pageChangeState$.clear(),this.layoutReady$.clear(),this.state$.clear(),super.destroy()}};Jo.id="scroll";let er=Jo;const tr="scroll",nr={manifest:{id:tr,name:"Scroll Plugin",version:"1.0.0",provides:["scroll"],requires:["viewport"],optional:["spread"],defaultConfig:{defaultPageGap:10,defaultBufferSize:4,defaultStrategy:Uo.Vertical}},create:(e,t)=>new er(tr,e,t),reducer:(e,t)=>{switch(t.type){case Yo:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o}}}case qo:{const{[t.payload]:n,...o}=e.documents;return{...e,documents:o}}case Ko:{const{documentId:n,state:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,...o}}}:e}case Xo:{const{documentId:n,strategy:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,strategy:o}}}:e}default:return e}},initialState:(e,t)=>((e,t)=>({defaultStrategy:t.defaultStrategy??Uo.Vertical,defaultPageGap:t.defaultPageGap??10,defaultBufferSize:t.defaultBufferSize??2,documents:{}}))(0,t)},or=()=>Fo(er.id),rr=e=>{const{provides:t}=or(),[n,o]=Ee(1),[r,a]=Ee(1);return Me(()=>{if(!t||!e)return;const n=t.forDocument(e);return o(n.getCurrentPage()),a(n.getTotalPages()),t.onPageChange(t=>{t.documentId===e&&(o(t.pageNumber),a(t.totalPages))})},[t,e]),{provides:(null==t?void 0:t.forDocument(e))??null,state:{currentPage:n,totalPages:r}}};function ar({documentId:e,renderPage:t,...n}){const{plugin:o}=fo(er.id),[r,a]=Ee({layout:null,docId:null});Me(()=>{if(!o||!e)return;const t=o.onScrollerData(e,t=>{a({layout:t,docId:e})});return()=>{t(),a({layout:null,docId:null}),o.clearLayoutReady(e)}},[o,e]);const i=r.docId===e?r.layout:null;return ke(()=>{o&&e&&i&&o.setLayoutReady(e)},[o,e,i]),i?We("div",{...n,style:{width:`${i.totalWidth}px`,height:`${i.totalHeight}px`,position:"relative",boxSizing:"border-box",margin:"0 auto",...i.strategy===Uo.Horizontal&&{display:"flex",flexDirection:"row"}},children:[We("div",{style:{...i.strategy===Uo.Horizontal?{width:i.startSpacing,height:"100%",flexShrink:0}:{height:i.startSpacing,width:"100%"}}}),We("div",{style:{gap:i.pageGap,display:"flex",alignItems:"center",position:"relative",boxSizing:"border-box",...i.strategy===Uo.Horizontal?{flexDirection:"row",minHeight:"100%"}:{flexDirection:"column",minWidth:"fit-content"}},children:i.items.map(e=>We("div",{style:{display:"flex",justifyContent:"center",gap:i.pageGap},children:e.pageLayouts.map(e=>We("div",{style:{width:`${e.rotatedWidth}px`,height:`${e.rotatedHeight}px`},children:t({...e})},e.pageNumber))},e.pageNumbers[0]))}),We("div",{style:{...i.strategy===Uo.Horizontal?{width:i.endSpacing,height:"100%",flexShrink:0}:{height:i.endSpacing,width:"100%"}}})]}):null}var ir=(e=>(e.None="none",e.Odd="odd",e.Even="even",e))(ir||{});const sr="SPREAD/INIT_STATE",lr="SPREAD/CLEANUP_STATE",dr="SPREAD/SET_SPREAD_MODE",cr="SPREAD/SET_PAGE_GROUPING";function ur(e,t){return{type:cr,payload:{documentId:e,grouping:t}}}const mr=class extends Qn{constructor(e,t,n){var o;super(e,t),this.spreadEmitter$=lo(),this.defaultSpreadMode=n.defaultSpreadMode??ir.None,this.viewport=(null==(o=t.getPlugin("viewport"))?void 0:o.provides())??null}onDocumentLoadingStarted(e){var t;const n={spreadMode:this.defaultSpreadMode};this.dispatch(function(e,t){return{type:sr,payload:{documentId:e,state:t}}}(e,n)),null==(t=this.viewport)||t.gate("spread",e),this.logger.debug("SpreadPlugin","DocumentOpened",`Initialized spread state for document: ${e}`)}onDocumentLoaded(e){var t;const n=this.coreState.core.documents[e];if(null==n?void 0:n.document){const t=this.calculatePageGrouping(e,n.document.pages.length);this.dispatch(ur(e,t))}null==(t=this.viewport)||t.releaseGate("spread",e)}onDocumentClosed(e){this.dispatch(function(e){return{type:lr,payload:e}}(e)),this.logger.debug("SpreadPlugin","DocumentClosed",`Cleaned up spread state for document: ${e}`)}buildCapability(){return{setSpreadMode:e=>this.setSpreadModeForDocument(e),getSpreadMode:()=>this.getSpreadModeForDocument(),getSpreadPages:()=>this.getSpreadPages(),forDocument:e=>this.createSpreadScope(e),onSpreadChange:this.spreadEmitter$.on}}createSpreadScope(e){return{setSpreadMode:t=>this.setSpreadModeForDocument(t,e),getSpreadMode:()=>this.getSpreadModeForDocument(e),getSpreadPages:()=>this.getSpreadPages(e),onSpreadChange:t=>this.spreadEmitter$.on(n=>{n.documentId===e&&t(n.spreadMode)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Spread state not found for document: ${e??"active"}`);return t}setSpreadModeForDocument(e,t){const n=t??this.getActiveDocumentId(),o=this.getDocumentStateOrThrow(n),r=this.coreState.core.documents[n];if(!(null==r?void 0:r.document))throw new Error(`Document ${n} not loaded`);if(o.spreadMode!==e){this.dispatch(function(e,t){return{type:dr,payload:{documentId:e,spreadMode:t}}}(n,e));const t=this.calculatePageGrouping(n,r.document.pages.length);this.dispatch(ur(n,t)),this.spreadEmitter$.emit({documentId:n,spreadMode:e})}}getSpreadModeForDocument(e){return this.getDocumentStateOrThrow(e).spreadMode}calculatePageGrouping(e,t){switch(this.getDocumentStateOrThrow(e).spreadMode){case ir.None:return Array.from({length:t},(e,t)=>[t]);case ir.Odd:return Array.from({length:Math.ceil(t/2)},(e,n)=>{const o=[2*n];return 2*n+1<t&&o.push(2*n+1),o});case ir.Even:return[[0],...Array.from({length:Math.ceil((t-1)/2)},(e,n)=>{const o=[1+2*n];return 1+2*n+1<t&&o.push(1+2*n+1),o})];default:return Array.from({length:t},(e,t)=>[t])}}getSpreadPages(e){const t=e??this.getActiveDocumentId(),n=this.coreState.core.documents[t],o=this.getDocumentStateOrThrow(t);if(!(null==n?void 0:n.document))throw new Error(`Document ${t} not loaded`);const r=o.pageGrouping??[],a=n.document.pages;return r.map(e=>e.map(e=>a[e]).filter(Boolean))}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];(null==o?void 0:o.spreadMode)!==r.spreadMode&&this.logger.debug("SpreadPlugin","SpreadModeChanged",`Spread mode changed for document ${n}: ${(null==o?void 0:o.spreadMode)??ir.None} -> ${r.spreadMode}`)}}async initialize(e){this.logger.info("SpreadPlugin","Initialize","Spread plugin initialized")}async destroy(){this.spreadEmitter$.clear(),super.destroy()}};mr.id="spread";let pr=mr;const hr="spread",gr={id:hr,name:"Spread Plugin",version:"1.0.0",provides:["spread"],requires:[],optional:["viewport"],defaultConfig:{}};ir.None;const fr={documents:{},activeDocumentId:null},Fr={manifest:gr,create:(e,t)=>new pr(hr,e,t),reducer:(e=fr,t)=>{switch(t.type){case sr:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case lr:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"SPREAD/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case dr:{const{documentId:n,spreadMode:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,spreadMode:o}}}:e}case cr:{const{documentId:n,grouping:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,pageGrouping:o}}}:e}default:return e}},initialState:fr},Pr="ui",br={id:Pr,name:"UI Plugin",version:"1.0.0",provides:["ui"],requires:["commands"],optional:["i18n"],defaultConfig:{schema:{id:"empty",version:"1.0.0",toolbars:{},menus:{},sidebars:{},modals:{},selectionMenus:{}}}},_r="UI/INIT_STATE",vr="UI/CLEANUP_STATE",yr="UI/SET_ACTIVE_TOOLBAR",Dr="UI/CLOSE_TOOLBAR_SLOT",xr="UI/SET_ACTIVE_SIDEBAR",Ar="UI/CLOSE_SIDEBAR_SLOT",wr="UI/SET_SIDEBAR_TAB",Sr="UI/OPEN_MODAL",Er="UI/CLOSE_MODAL",Cr="UI/CLEAR_MODAL",Mr="UI/OPEN_MENU",kr="UI/CLOSE_MENU",Tr="UI/CLOSE_ALL_MENUS",Ir="UI/SET_DISABLED_CATEGORIES",Or="UI/SET_HIDDEN_ITEMS",Rr=(e,t,n,o,r)=>({type:xr,payload:{documentId:e,placement:t,slot:n,sidebarId:o,activeTab:r}}),Gr=(e,t,n)=>({type:Ar,payload:{documentId:e,placement:t,slot:n}}),Lr=(e,t)=>({type:Mr,payload:{documentId:e,menuState:t}}),Nr=(e,t)=>({type:kr,payload:{documentId:e,menuId:t}}),zr=e=>({type:Ir,payload:{categories:e}}),jr=e=>({type:Or,payload:{hiddenItems:e}});function Br(e,t){if(!t)return e;const n={...e};for(const[e,o]of Object.entries(t))n[e]?n[e]={...n[e],...o,items:o.items??n[e].items,responsive:o.responsive??n[e].responsive}:n[e]=o;return n}function $r(e,t){if(!t)return e;const n={...e};for(const[e,o]of Object.entries(t))n[e]?n[e]={...n[e],...o,items:o.items??n[e].items}:n[e]=o;return n}function Ur(e,t){if(!t)return e;const n={...e};for(const[e,o]of Object.entries(t))n[e]?n[e]={...n[e],...o,content:o.content??n[e].content}:n[e]=o;return n}function Wr(e,t){var n;if(!(null==(n=e.responsive)?void 0:n.breakpoints))return null;const o=function(e,t,n){if(!n||!(null==t?void 0:t.groups))return e;const o=t.groups.find(e=>e.locales.includes(n));if(!o)return e;const r={};for(const[t,n]of Object.entries(e)){const e=o.breakpoints[t];r[t]=e?{minWidth:n.minWidth,maxWidth:n.maxWidth,hide:e.replaceHide?e.replaceHide:[...n.hide||[],...e.hide||[]],show:e.replaceShow?e.replaceShow:[...n.show||[],...e.show||[]]}:n}return r}(e.responsive.breakpoints,e.responsive.localeOverrides,t),r=new Map,a=new Map;for(const[e,t]of Object.entries(o))a.set(e,{minWidth:t.minWidth,maxWidth:t.maxWidth});const i=new Set,s=e=>{e.forEach(e=>{i.add(e.id),"group"===e.type&&e.items&&s(e.items),"tab-group"===e.type&&e.tabs&&s(e.tabs),"section"===e.type&&e.items&&s(e.items)})};s(e.items);for(const e of i){const t=[];let n=!0;const a=Array.from(Object.entries(o)).sort((e,t)=>(e[1].minWidth??0)-(t[1].minWidth??0));a.forEach(([o,r],a)=>{var i,s;const l=null==(i=r.hide)?void 0:i.includes(e),d=null==(s=r.show)?void 0:s.includes(e);(l||d)&&(t.push({breakpointId:o,minWidth:r.minWidth,maxWidth:r.maxWidth,visible:d||!l,priority:a}),0===a&&(n=d||!l))}),t.length>0&&r.set(e,{itemId:e,shouldRender:!0,visibilityRules:t,defaultVisible:n})}return{items:r,breakpoints:a}}const Hr="data-epdf",Vr="data-epdf-s",Yr="data-epdf-i",qr="data-epdf-cat",Kr="data-epdf-dis",Xr="data-epdf-hid",Zr={ROOT:`[${Hr}]`,STYLES:`[${Vr}]`,ITEM:e=>`[${Yr}="${e}"]`,CATEGORIES:e=>`[${qr}~="${e}"]`,DISABLED_CATEGORY:e=>`[${Kr}~="${e}"]`,HIDDEN_ITEM:e=>`[${Xr}~="${e}"]`},Qr={useContainerQueries:!0};function Jr(e,t){const n=new Set(t),o=[];return e.forEach((e,t)=>{e.some(e=>n.has(e))&&o.push(t)}),o}function ea(e,t){const n=new Set,o=new Map,r=[],a=new Map,i=new Map;for(const[s,l]of Object.entries(e.menus))ta(s,l,n,o,r,a,i,t);for(const[a,s]of Object.entries(e.toolbars))aa(a,s,n,o,r,i,t);for(const[t,a]of Object.entries(e.sidebars))la(t,a,n,o,r);for(const[a,s]of Object.entries(e.selectionMenus||{}))da(a,s,n,o,r,i,t);return{categories:n,itemCategories:o,dependencies:r,menuBreakpoints:a,responsiveItems:i}}function ta(e,t,n,o,r,a,i,s){ua(e,t.categories,t.visibilityDependsOn,n,o,r),na(t.items,n,o,r);const l=Wr(t,s);l&&l.items.forEach((e,t)=>{i.set(t,e)});const d=function(e,t,n){var o;const r=[],a=Wr(e,n);if((null==(o=e.responsive)?void 0:o.breakpoints)&&a){const e=Array.from(a.breakpoints.entries()).sort((e,t)=>(e[1].minWidth??0)-(t[1].minWidth??0));for(const[n,o]of e){const e=ra(a,o),n=new Set;for(const o of e){const e=t.get(o);e&&e.forEach(e=>n.add(e))}r.push({minWidth:o.minWidth,maxWidth:o.maxWidth,visibleItemIds:e,visibleCategories:n})}}else{const n=[],o=new Set;oa(e.items,t,n,o),r.push({visibleItemIds:n,visibleCategories:o})}return r}(t,o,s);a.set(e,d)}function na(e,t,n,o){for(const r of e)ua(r.id,r.categories,r.visibilityDependsOn,t,n,o),"section"===r.type&&na(r.items,t,n,o)}function oa(e,t,n,o){for(const r of e){n.push(r.id);const e=t.get(r.id);e&&e.forEach(e=>o.add(e)),"section"===r.type&&oa(r.items,t,n,o)}}function ra(e,t){const n=[];return e.items.forEach((e,o)=>{let r=e.defaultVisible;for(const n of e.visibilityRules)(void 0===n.minWidth||void 0!==t.minWidth&&t.minWidth>=n.minWidth)&&(void 0===n.maxWidth||void 0!==t.maxWidth&&t.maxWidth<=n.maxWidth)&&(r=n.visible);r&&n.push(o)}),n}function aa(e,t,n,o,r,a,i){ua(e,t.categories,t.visibilityDependsOn,n,o,r);const s=Wr(t,i);s&&s.items.forEach((e,t)=>{a.set(t,e)}),ia(t.items,n,o,r)}function ia(e,t,n,o){for(const r of e)ua(r.id,r.categories,r.visibilityDependsOn,t,n,o),"group"===r.type&&r.items&&ia(r.items,t,n,o),"tab-group"===r.type&&r.tabs&&sa(r.tabs,t,n,o)}function sa(e,t,n,o){for(const r of e)ua(r.id,r.categories,r.visibilityDependsOn,t,n,o)}function la(e,t,n,o,r){if(ua(e,t.categories,t.visibilityDependsOn,n,o,r),"tabs"===t.content.type)for(const e of t.content.tabs)ua(e.id,e.categories,e.visibilityDependsOn,n,o,r)}function da(e,t,n,o,r,a,i){if(ua(e,t.categories,t.visibilityDependsOn,n,o,r),t.responsive){const e=Wr(t,i);e&&e.items.forEach((e,t)=>{a.set(t,e)})}ca(t.items,n,o,r)}function ca(e,t,n,o){for(const r of e)ua(r.id,r.categories,r.visibilityDependsOn,t,n,o),"group"===r.type&&r.items&&ca(r.items,t,n,o)}function ua(e,t,n,o,r,a){var i;(null==t?void 0:t.length)&&(t.forEach(e=>o.add(e)),r.set(e,t)),n&&(n.menuId||(null==(i=n.itemIds)?void 0:i.length))&&a.push({itemId:e,dependsOnMenuId:n.menuId,dependsOnItemIds:n.itemIds})}function ma(e,t,n,o){var r;const a=[];if(e.dependsOnMenuId){const o=t.menuBreakpoints.get(e.dependsOnMenuId);if(o&&o.length>0){a.push(`/* "${e.itemId}" depends on menu "${e.dependsOnMenuId}" */`);for(const t of o){if(0===t.visibleItemIds.length)continue;const o=t.visibleItemIds.sort().map(e=>Zr.HIDDEN_ITEM(e)).join(""),r=`${Zr.ROOT}${o} ${Zr.ITEM(e.itemId)} {\n  display: none !important;\n}`,i=[];void 0!==t.minWidth&&i.push(`(min-width: ${t.minWidth}px)`),void 0!==t.maxWidth&&i.push(`(max-width: ${t.maxWidth}px)`),i.length>0?a.push(`${n} ${i.join(" and ")} {\n  ${r}\n}`):a.push(r)}}}if(null==(r=e.dependsOnItemIds)?void 0:r.length){a.push(`/* "${e.itemId}" depends on items: ${e.dependsOnItemIds.join(", ")} */`);const t=e.dependsOnItemIds.sort().map(e=>Zr.HIDDEN_ITEM(e)).join("");a.push(`${Zr.ROOT}${t} ${Zr.ITEM(e.itemId)} {\n  display: none !important;\n}`)}return a}function pa(e,t){var n;return{[Yr]:e.id,[qr]:(null==(n=e.categories)?void 0:n.join(" "))||void 0,...t}}const ha=class extends Qn{constructor(e,t,n){var o,r;if(super(e,t),this.cachedStylesheet=null,this.cachedLocale=null,this.i18n=null,this.i18nCleanup=null,this.categoryChanged$=lo(),this.stylesheetInvalidated$=so(),this.toolbarChanged$=co((e,t)=>({documentId:e,...t}),{cache:!1}),this.sidebarChanged$=co((e,t)=>({documentId:e,...t}),{cache:!1}),this.modalChanged$=co((e,t)=>({documentId:e,...t}),{cache:!1}),this.menuChanged$=co((e,t)=>({documentId:e,...t}),{cache:!1}),this.schema=n.schema,this.stylesheetConfig=n.stylesheetConfig||{},this.itemCategories=ea(this.schema).itemCategories,null==(o=n.disabledCategories)?void 0:o.length){this.dispatch(zr(n.disabledCategories));const e=Jr(this.itemCategories,n.disabledCategories);this.dispatch(jr(e))}this.i18n=(null==(r=t.getPlugin("i18n"))?void 0:r.provides())??null,this.i18n&&(this.i18nCleanup=this.i18n.onLocaleChange(({currentLocale:e})=>{this.handleLocaleChange(e)}),this.cachedLocale=this.i18n.getLocale())}async initialize(){this.logger.info("UIPlugin","Initialize","UI plugin initialized")}async destroy(){this.i18nCleanup&&(this.i18nCleanup(),this.i18nCleanup=null),this.toolbarChanged$.clear(),this.sidebarChanged$.clear(),this.modalChanged$.clear(),this.menuChanged$.clear(),this.stylesheetInvalidated$.clear(),super.destroy()}onDocumentLoadingStarted(e){this.dispatch(((e,t)=>({type:_r,payload:{documentId:e,schema:t}}))(e,this.schema))}onDocumentClosed(e){this.dispatch((e=>({type:vr,payload:{documentId:e}}))(e)),this.toolbarChanged$.clearScope(e),this.sidebarChanged$.clearScope(e),this.modalChanged$.clearScope(e),this.menuChanged$.clearScope(e)}handleLocaleChange(e){this.cachedLocale!==e&&(this.logger.debug("UIPlugin","LocaleChange",`Locale changed: ${this.cachedLocale} -> ${e}`),this.cachedLocale=e,this.invalidateStylesheet(),this.stylesheetInvalidated$.emit())}getStylesheet(){var e;const t=(null==(e=this.i18n)?void 0:e.getLocale())??null;return this.cachedStylesheet&&this.cachedLocale===t||(this.cachedStylesheet=function(e,t={}){const n={...Qr,...t.config},o=t.locale,r=ea(e,o),a=[];a.push(function(e){return`/* ═══════════════════════════════════════════════════════════════════════════ */\n/* EmbedPDF UI Stylesheet - Auto-generated${e?` (locale: ${e})`:""}                         */\n/* DO NOT EDIT MANUALLY - This file is generated from your UI schema            */\n/* ═══════════════════════════════════════════════════════════════════════════ */`}(o));const i=function(e,t){const n=[],o=t.useContainerQueries?"@container":"@media",r=new Set;return e.responsiveItems.forEach((e,t)=>{if(r.has(t))return;r.add(t);const a=function(e,t,n){if(0===t.visibilityRules.length)return null;const o=[],r=Zr.ITEM(e);t.defaultVisible||o.push(`${r} { display: none; }`);for(const e of t.visibilityRules){const t=[];if(void 0!==e.minWidth&&t.push(`(min-width: ${e.minWidth}px)`),void 0!==e.maxWidth&&t.push(`(max-width: ${e.maxWidth}px)`),t.length>0){const a=e.visible?"flex":"none";o.push(`${n} ${t.join(" and ")} {\n  ${r} { display: ${a}; }\n}`)}}return o.length>0?o.join("\n"):null}(t,e,o);a&&n.push(a)}),0===n.length?"":`/* ─── Responsive Visibility Rules ─── */\n/* Items show/hide based on container width */\n\n${n.join("\n\n")}`}(r,n);i&&a.push(i);const s=function(e){if(0===e.categories.size)return"";const t=[],n=Array.from(e.categories).sort();for(const e of n)t.push(`${Zr.ROOT}[${Kr}~="${e}"] [${qr}~="${e}"] {\n  display: none !important;\n}`);return`/* ─── Category Visibility Rules ─── */\n/* Items hide when ANY of their categories is disabled */\n/* Use: data-disabled-categories="category1 category2" on root element */\n\n${t.join("\n\n")}`}(r);s&&a.push(s);const l=function(e,t){if(0===e.dependencies.length)return"";const n=[],o=t.useContainerQueries?"@container":"@media";for(const t of e.dependencies){const r=ma(t,e,o);r.length>0&&n.push(...r)}return 0===n.length?"":`/* ─── Dependency Visibility Rules ─── */\n/* Container elements hide when all their dependencies are hidden */\n\n${n.join("\n\n")}`}(r,n);return l&&a.push(l),a.filter(e=>e.trim()).join("\n\n")}(this.schema,{config:this.stylesheetConfig,locale:t??void 0}),this.cachedLocale=t),this.cachedStylesheet}getLocale(){var e;return(null==(e=this.i18n)?void 0:e.getLocale())??null}invalidateStylesheet(){this.cachedStylesheet=null}onStylesheetInvalidated(e){return this.stylesheetInvalidated$.on(e)}disableCategoryImpl(e){const t=new Set(this.state.disabledCategories);if(!t.has(e)){t.add(e);const n=Array.from(t);this.dispatch(zr(n));const o=Jr(this.itemCategories,n);this.dispatch(jr(o)),this.categoryChanged$.emit({disabledCategories:n,hiddenItems:o})}}enableCategoryImpl(e){const t=new Set(this.state.disabledCategories);if(t.has(e)){t.delete(e);const n=Array.from(t);this.dispatch(zr(n));const o=Jr(this.itemCategories,n);this.dispatch(jr(o)),this.categoryChanged$.emit({disabledCategories:n,hiddenItems:o})}}toggleCategoryImpl(e){this.state.disabledCategories.includes(e)?this.enableCategoryImpl(e):this.disableCategoryImpl(e)}setDisabledCategoriesImpl(e){this.dispatch(zr(e));const t=Jr(this.itemCategories,e);this.dispatch(jr(t)),this.categoryChanged$.emit({disabledCategories:e,hiddenItems:t})}buildCapability(){return{setActiveToolbar:(e,t,n,o)=>this.setToolbarForDocument(e,t,n,o),setActiveSidebar:(e,t,n,o,r)=>this.setSidebarForDocument(e,t,n,o,r),toggleSidebar:(e,t,n,o,r)=>this.toggleSidebarForDocument(e,t,n,o,r),openModal:(e,t)=>this.openModalForDocument(e,t),openMenu:(e,t,n,o)=>this.openMenuForDocument(e,t,n,o),toggleMenu:(e,t,n,o)=>this.toggleMenuForDocument(e,t,n,o),forDocument:e=>this.createUIScope(e),getSchema:()=>this.schema,mergeSchema:e=>{var t,n;this.schema=(t=this.schema,n=e,{...t,...n,toolbars:Br(t.toolbars,n.toolbars),menus:$r(t.menus,n.menus),sidebars:Ur(t.sidebars,n.sidebars)})},disableCategory:e=>this.disableCategoryImpl(e),enableCategory:e=>this.enableCategoryImpl(e),toggleCategory:e=>this.toggleCategoryImpl(e),setDisabledCategories:e=>this.setDisabledCategoriesImpl(e),getDisabledCategories:()=>this.state.disabledCategories,isCategoryDisabled:e=>this.state.disabledCategories.includes(e),getHiddenItems:()=>this.state.hiddenItems,onToolbarChanged:this.toolbarChanged$.onGlobal,onSidebarChanged:this.sidebarChanged$.onGlobal,onModalChanged:this.modalChanged$.onGlobal,onMenuChanged:this.menuChanged$.onGlobal,onCategoryChanged:this.categoryChanged$.on}}createUIScope(e){return{setActiveToolbar:(t,n,o)=>this.setToolbarForDocument(t,n,o,e),getActiveToolbar:(t,n)=>this.getToolbarForDocument(t,n,e),closeToolbarSlot:(t,n)=>this.closeToolbarForDocument(t,n,e),isToolbarOpen:(t,n,o)=>this.isToolbarOpenForDocument(t,n,o,e),setActiveSidebar:(t,n,o,r)=>this.setSidebarForDocument(t,n,o,e,r),getActiveSidebar:(t,n)=>this.getSidebarForDocument(t,n,e),closeSidebarSlot:(t,n)=>this.closeSidebarForDocument(t,n,e),toggleSidebar:(t,n,o,r)=>this.toggleSidebarForDocument(t,n,o,e,r),isSidebarOpen:(t,n,o)=>this.isSidebarOpenForDocument(t,n,o,e),setSidebarTab:(t,n)=>this.setSidebarTabForDocument(t,n,e),getSidebarTab:t=>this.getSidebarTabForDocument(t,e),openModal:t=>this.openModalForDocument(t,e),closeModal:()=>this.closeModalForDocument(e),clearModal:()=>this.clearModalForDocument(e),getActiveModal:()=>this.getActiveModalForDocument(e),isModalOpen:()=>this.isModalOpenForDocument(e),openMenu:(t,n,o)=>this.openMenuForDocument(t,n,o,e),closeMenu:t=>this.closeMenuForDocument(t,e),toggleMenu:(t,n,o)=>this.toggleMenuForDocument(t,n,o,e),closeAllMenus:()=>this.closeAllMenusForDocument(e),isMenuOpen:t=>this.isMenuOpenForDocument(t,e),getOpenMenus:()=>this.getOpenMenusForDocument(e),getSchema:()=>this.schema,getState:()=>this.getDocumentStateOrThrow(e),onToolbarChanged:this.toolbarChanged$.forScope(e),onSidebarChanged:this.sidebarChanged$.forScope(e),onModalChanged:this.modalChanged$.forScope(e),onMenuChanged:this.menuChanged$.forScope(e)}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`UI state not found for document: ${e??"active"}`);return t}setToolbarForDocument(e,t,n,o){const r=o??this.getActiveDocumentId();this.dispatch(((e,t,n,o)=>({type:yr,payload:{documentId:e,placement:t,slot:n,toolbarId:o}}))(r,e,t,n)),this.toolbarChanged$.emit(r,{placement:e,slot:t,toolbarId:n})}getToolbarForDocument(e,t,n){const o=`${e}-${t}`,r=this.getDocumentStateOrThrow(n).activeToolbars[o];return(null==r?void 0:r.isOpen)?r.toolbarId:null}closeToolbarForDocument(e,t,n){const o=n??this.getActiveDocumentId();this.dispatch(((e,t,n)=>({type:Dr,payload:{documentId:e,placement:t,slot:n}}))(o,e,t)),this.toolbarChanged$.emit(o,{placement:e,slot:t,toolbarId:""})}isToolbarOpenForDocument(e,t,n,o){const r=`${e}-${t}`,a=this.getDocumentStateOrThrow(o).activeToolbars[r];return!(!a||!a.isOpen||n&&a.toolbarId!==n)}setSidebarForDocument(e,t,n,o,r){const a=o??this.getActiveDocumentId();this.dispatch(Rr(a,e,t,n,r)),this.sidebarChanged$.emit(a,{placement:e,slot:t,sidebarId:n})}getSidebarForDocument(e,t,n){const o=`${e}-${t}`,r=this.getDocumentStateOrThrow(n).activeSidebars[o];return(null==r?void 0:r.isOpen)?r.sidebarId:null}closeSidebarForDocument(e,t,n){const o=n??this.getActiveDocumentId();this.dispatch(Gr(o,e,t)),this.sidebarChanged$.emit(o,{placement:e,slot:t,sidebarId:""})}toggleSidebarForDocument(e,t,n,o,r){const a=o??this.getActiveDocumentId(),i=`${e}-${t}`,s=this.getDocumentStateOrThrow(a).activeSidebars[i];(null==s?void 0:s.sidebarId)===n&&(null==s?void 0:s.isOpen)?(this.dispatch(Gr(a,e,t)),this.sidebarChanged$.emit(a,{placement:e,slot:t,sidebarId:""})):(this.dispatch(Rr(a,e,t,n,r)),this.sidebarChanged$.emit(a,{placement:e,slot:t,sidebarId:n}))}isSidebarOpenForDocument(e,t,n,o){const r=`${e}-${t}`,a=this.getDocumentStateOrThrow(o).activeSidebars[r];return!(!a||!a.isOpen||n&&a.sidebarId!==n)}setSidebarTabForDocument(e,t,n){const o=n??this.getActiveDocumentId();this.dispatch(((e,t,n)=>({type:wr,payload:{documentId:e,sidebarId:t,tabId:n}}))(o,e,t))}getSidebarTabForDocument(e,t){return this.getDocumentStateOrThrow(t).sidebarTabs[e]??null}openModalForDocument(e,t){const n=t??this.getActiveDocumentId();this.dispatch(((e,t)=>({type:Sr,payload:{documentId:e,modalId:t}}))(n,e)),this.modalChanged$.emit(n,{modalId:e,isOpen:!0})}closeModalForDocument(e){const t=e??this.getActiveDocumentId(),n=this.getDocumentStateOrThrow(t).activeModal;this.dispatch((e=>({type:Er,payload:{documentId:e}}))(t)),this.modalChanged$.emit(t,{modalId:(null==n?void 0:n.modalId)??null,isOpen:!1})}clearModalForDocument(e){const t=e??this.getActiveDocumentId();this.dispatch((e=>({type:Cr,payload:{documentId:e}}))(t))}getActiveModalForDocument(e){return this.getDocumentStateOrThrow(e).activeModal}isModalOpenForDocument(e){const t=this.getDocumentStateOrThrow(e).activeModal;return(null==t?void 0:t.isOpen)??!1}openMenuForDocument(e,t,n,o){const r=o??this.getActiveDocumentId();this.dispatch(Lr(r,{menuId:e,triggeredByCommandId:t,triggeredByItemId:n})),this.menuChanged$.emit(r,{menuId:e,isOpen:!0})}closeMenuForDocument(e,t){const n=t??this.getActiveDocumentId();this.dispatch(Nr(n,e)),this.menuChanged$.emit(n,{menuId:e,isOpen:!1})}toggleMenuForDocument(e,t,n,o){const r=o??this.getActiveDocumentId();this.getDocumentStateOrThrow(r).openMenus[e]?(this.dispatch(Nr(r,e)),this.menuChanged$.emit(r,{menuId:e,isOpen:!1})):(this.dispatch(Lr(r,{menuId:e,triggeredByCommandId:t,triggeredByItemId:n})),this.menuChanged$.emit(r,{menuId:e,isOpen:!0}))}closeAllMenusForDocument(e){const t=e??this.getActiveDocumentId();this.dispatch((e=>({type:Tr,payload:{documentId:e}}))(t))}isMenuOpenForDocument(e,t){return!!this.getDocumentStateOrThrow(t).openMenus[e]}getOpenMenusForDocument(e){return Object.values(this.getDocumentStateOrThrow(e).openMenus)}};ha.id="ui";let ga=ha;const fa={activeToolbars:{},activeSidebars:{},activeModal:null,openMenus:{},sidebarTabs:{}},Fa={documents:{},disabledCategories:[],hiddenItems:[]};function Pa(e,t){const n=function(e){return e.ui??null}(e);return(null==n?void 0:n.documents[t])??null}function ba(e,t){return`${e}-${t}`}function _a(e,t,n,o,r){const a=function(e,t,n,o){const r=Pa(e,t);return r?r.activeToolbars[ba(n,o)]??null:null}(e,t,n,o);return!(!a||!a.isOpen||r&&a.toolbarId!==r)}function va(e,t,n,o,r){const a=function(e,t,n,o){const r=Pa(e,t);return r?r.activeSidebars[ba(n,o)]??null:null}(e,t,n,o);return!(!a||!a.isOpen||r&&a.sidebarId!==r)}const ya={manifest:br,create:(e,t)=>new ga(Pr,e,t),reducer:(e=Fa,t)=>{var n;switch(t.type){case _r:{const{documentId:n,schema:o}=t.payload,r={};return Object.values(o.toolbars).forEach(e=>{if(e.permanent&&e.position){const t=`${e.position.placement}-${e.position.slot}`;r[t]={toolbarId:e.id,isOpen:!0}}}),{...e,documents:{...e.documents,[n]:{...fa,activeToolbars:r}}}}case vr:{const{documentId:n}=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r}}case yr:{const{documentId:n,placement:o,slot:r,toolbarId:a}=t.payload,i=e.documents[n]||fa,s=`${o}-${r}`;return{...e,documents:{...e.documents,[n]:{...i,activeToolbars:{...i.activeToolbars,[s]:{toolbarId:a,isOpen:!0}}}}}}case Dr:{const{documentId:n,placement:o,slot:r}=t.payload,a=e.documents[n];if(!a)return e;const i=`${o}-${r}`,s=a.activeToolbars[i];return s?{...e,documents:{...e.documents,[n]:{...a,activeToolbars:{...a.activeToolbars,[i]:{...s,isOpen:!1}}}}}:e}case xr:{const{documentId:n,placement:o,slot:r,sidebarId:a,activeTab:i}=t.payload,s=e.documents[n]||fa,l=`${o}-${r}`;return{...e,documents:{...e.documents,[n]:{...s,activeSidebars:{...s.activeSidebars,[l]:{sidebarId:a,isOpen:!0}},...i&&{sidebarTabs:{...s.sidebarTabs,[a]:i}}}}}}case Ar:{const{documentId:n,placement:o,slot:r}=t.payload,a=e.documents[n];if(!a)return e;const i=`${o}-${r}`,s=a.activeSidebars[i];return s?{...e,documents:{...e.documents,[n]:{...a,activeSidebars:{...a.activeSidebars,[i]:{...s,isOpen:!1}}}}}:e}case wr:{const{documentId:n,sidebarId:o,tabId:r}=t.payload,a=e.documents[n]||fa;return{...e,documents:{...e.documents,[n]:{...a,sidebarTabs:{...a.sidebarTabs,[o]:r}}}}}case Sr:{const{documentId:n,modalId:o}=t.payload,r=e.documents[n]||fa;return{...e,documents:{...e.documents,[n]:{...r,activeModal:{modalId:o,isOpen:!0},openMenus:{}}}}}case Er:{const{documentId:n}=t.payload,o=e.documents[n];return(null==o?void 0:o.activeModal)?{...e,documents:{...e.documents,[n]:{...o,activeModal:{...o.activeModal,isOpen:!1}}}}:e}case Cr:{const{documentId:o}=t.payload,r=e.documents[o];return r?(null==(n=r.activeModal)?void 0:n.isOpen)?e:{...e,documents:{...e.documents,[o]:{...r,activeModal:null}}}:e}case Mr:{const{documentId:n,menuState:o}=t.payload,r=e.documents[n]||fa;return{...e,documents:{...e.documents,[n]:{...r,openMenus:{[o.menuId]:o}}}}}case kr:{const{documentId:n,menuId:o}=t.payload,r=e.documents[n];if(!r)return e;const{[o]:a,...i}=r.openMenus;return{...e,documents:{...e.documents,[n]:{...r,openMenus:i}}}}case Tr:{const{documentId:n}=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,openMenus:{}}}}:e}case Ir:return{...e,disabledCategories:t.payload.categories};case Or:return{...e,hiddenItems:t.payload.hiddenItems};default:return e}},initialState:Fa},Da=()=>Fo(ga.id),xa=e=>{const{provides:t}=Da(),[n,o]=Ee(null);return Me(()=>{if(!t)return;const n=t.forDocument(e);o(n.getState());const r=n.onToolbarChanged(()=>o(n.getState())),a=n.onSidebarChanged(()=>o(n.getState())),i=n.onModalChanged(()=>o(n.getState())),s=n.onMenuChanged(()=>o(n.getState()));return()=>{r(),a(),i(),s()}},[t,e]),n},Aa=pe(null);function wa(){const e=Re(Aa);if(!e)throw new Error("useUIContainer must be used within a UIProvider");return e}const Sa=pe(null);function Ea({children:e}){const t=Te(new Map),n={register:Oe((e,n,o)=>{const r=`${e}:${n}`;t.current.set(r,o)},[]),unregister:Oe((e,n)=>{const o=`${e}:${n}`;t.current.delete(o)},[]),getAnchor:Oe((e,n)=>{const o=`${e}:${n}`;return t.current.get(o)||null},[])};return We(Sa.Provider,{value:n,children:e})}function Ca(){const e=Re(Sa);if(!e)throw new Error("useAnchorRegistry must be used within UIProvider");return e}function Ma(e,t){const n=Ca(),o=Te(null),r=Te(e),a=Te(t);return r.current=e,a.current=t,Oe(e=>{const t=o.current;o.current=e,e?e!==t&&n.register(r.current,a.current,e):t&&n.unregister(r.current,a.current)},[n])}const ka=pe(null);function Ta({children:e,initialComponents:t={}}){const n=Te(new Map(Object.entries(t))),o={register:Oe((e,t)=>{n.current.set(e,t)},[]),unregister:Oe(e=>{n.current.delete(e)},[]),get:Oe(e=>n.current.get(e),[]),has:Oe(e=>n.current.has(e),[]),getRegisteredIds:Oe(()=>Array.from(n.current.keys()),[])};return We(ka.Provider,{value:o,children:e})}function Ia(){const e=function(){const e=Re(ka);if(!e)throw new Error("useComponentRegistry must be used within UIProvider");return e}();return{renderCustomComponent:(t,n,o)=>{const r=e.get(t);return r?We(r,{documentId:n,...o||{}}):(console.error(`Component "${t}" not found in registry`),null)}}}const Oa=pe(null);function Ra({children:e,renderers:t}){return We(Oa.Provider,{value:t,children:e})}function Ga(){const e=Re(Oa);if(!e)throw new Error("useRenderers must be used within UIProvider");return e}function La(e,t){var n;const{provides:o}=Da(),r=Ga(),a=Oe(n=>{var a;const i=null==o?void 0:o.getSchema(),s=null==(a=null==i?void 0:i.selectionMenus)?void 0:a[e];return s&&n.selected?We(r.selectionMenu,{schema:s,documentId:t,props:n}):null},[o,r,e,t]),i=null==o?void 0:o.getSchema();if(null==(n=null==i?void 0:i.selectionMenus)?void 0:n[e])return a}function Na({container:e,documentId:t}){const n=xa(t),{provides:o}=Da(),r=Ca(),a=Ga(),[i,s]=Ee(null),l=(null==n?void 0:n.openMenus)||{},d=null==o?void 0:o.getSchema();if(Me(()=>{const e=Object.keys(l);if(e.length>0){const n=e[0];if(!n)return void s(null);const o=l[n];if(o&&o.triggeredByItemId){const e=r.getAnchor(t,o.triggeredByItemId);s({menuId:n,anchorEl:e})}else s(null)}else s(null)},[l,r,t]),!i||!d)return null;const c=d.menus[i.menuId];return c?We(a.menu,{schema:c,documentId:t,anchorEl:i.anchorEl,onClose:()=>{i&&(null==o||o.forDocument(t).closeMenu(i.menuId))},container:e}):(console.warn(`Menu "${i.menuId}" not found in schema`),null)}function za({children:e,style:t,...n}){const{plugin:o}=fo(ga.id),{provides:r}=Da(),[a,i]=Ee([]),[s,l]=Ee([]),d=Te(null),c=Te(null),u=Te(null),m=Te(null),p=Ie(()=>({containerRef:m,getContainer:()=>m.current}),[]),h=Oe(e=>{const t=u.current;if(u.current=e,m.current=e,e&&e!==t&&o){const t=function(e){const t=e.getRootNode();return t instanceof ShadowRoot?t:document.head}(e);c.current=t;const n=t.querySelector(Zr.STYLES);if(n)return d.current=n,void(n.textContent=o.getStylesheet());const r=o.getStylesheet(),a=document.createElement("style");a.setAttribute(Vr,""),a.textContent=r,t instanceof ShadowRoot?t.insertBefore(a,t.firstChild):t.appendChild(a),d.current=a}},[o]);Me(()=>()=>{var e;(null==(e=d.current)?void 0:e.parentNode)&&!u.current&&d.current.remove(),d.current=null,c.current=null},[]),Me(()=>{if(o)return o.onStylesheetInvalidated(()=>{d.current&&(d.current.textContent=o.getStylesheet())})},[o]),Me(()=>{if(r)return i(r.getDisabledCategories()),l(r.getHiddenItems()),r.onCategoryChanged(({disabledCategories:e,hiddenItems:t})=>{i(e),l(t)})},[r]);const g=Ie(()=>a.length>0?a.join(" "):void 0,[a]),f=Ie(()=>s.length>0?s.join(" "):void 0,[s]),F=Ie(()=>{const e={containerType:"inline-size"};return t&&"object"==typeof t?{...e,...t}:e},[t]),P={[Hr]:"",[Kr]:g,[Xr]:f};return We(Aa.Provider,{value:p,children:We("div",{ref:h,...P,...n,style:F,children:e})})}function ja({children:e,documentId:t,components:n={},renderers:o,menuContainer:r,...a}){return We(Ea,{children:We(Ta,{initialComponents:n,children:We(Ra,{renderers:o,children:We(za,{...a,children:[e,We(Na,{documentId:t,container:r})]})})})})}const Ba=class extends Qn{constructor(e,t,n){super(e,t),this.id=e,this.documentOpened$=lo(),this.documentClosed$=lo(),this.activeDocumentChanged$=lo(),this.documentError$=lo(),this.documentOrderChanged$=lo(),this.openFileRequest$=so(),this.loadOptions=new Map,this.maxDocuments=null==n?void 0:n.maxDocuments}buildCapability(){return{openFileDialog:e=>this.openFileDialog(e),openDocumentUrl:e=>this.openDocumentUrl(e),openDocumentBuffer:e=>this.openDocumentBuffer(e),retryDocument:(e,t)=>this.retryDocument(e,t),closeDocument:e=>this.closeDocument(e),closeAllDocuments:()=>this.closeAllDocuments(),setActiveDocument:e=>{if(!this.isDocumentOpen(e))throw new Error(`Cannot set active document: ${e} is not open`);this.dispatchCoreAction((e=>({type:Rn,payload:e}))(e))},getActiveDocumentId:()=>this.coreState.core.activeDocumentId,getActiveDocument:()=>{var e;const t=this.coreState.core.activeDocumentId;return t?(null==(e=this.coreState.core.documents[t])?void 0:e.document)??null:null},getDocumentOrder:()=>this.coreState.core.documentOrder,moveDocument:(e,t)=>{this.dispatchCoreAction(((e,t)=>({type:Ln,payload:{documentId:e,toIndex:t}}))(e,t))},swapDocuments:(e,t)=>{const n=this.coreState.core.documentOrder,o=n.indexOf(e),r=n.indexOf(t);if(-1===o||-1===r)throw new Error("One or both documents not found in order");const a=[...n];[a[o],a[r]]=[a[r],a[o]],this.dispatchCoreAction((e=>({type:Gn,payload:e}))(a))},getDocument:e=>{var t;return(null==(t=this.coreState.core.documents[e])?void 0:t.document)??null},getDocumentState:e=>this.coreState.core.documents[e]??null,getOpenDocuments:()=>this.coreState.core.documentOrder.map(e=>this.coreState.core.documents[e]).filter(e=>null!==e),isDocumentOpen:e=>this.isDocumentOpen(e),getDocumentCount:()=>Object.keys(this.coreState.core.documents).length,getDocumentIndex:e=>this.coreState.core.documentOrder.indexOf(e),onDocumentOpened:this.documentOpened$.on,onDocumentClosed:this.documentClosed$.on,onDocumentError:this.documentError$.on,onActiveDocumentChanged:this.activeDocumentChanged$.on,onDocumentOrderChanged:this.documentOrderChanged$.on}}isDocumentOpen(e){return!!this.coreState.core.documents[e]}onDocumentLoaded(e){const t=this.coreState.core.documents[e];t&&"loaded"===t.status&&(this.loadOptions.delete(e),this.documentOpened$.emit(t),this.logger.info("DocumentManagerPlugin","DocumentOpened",`Document ${e} opened successfully`,{name:t.name}))}onDocumentClosed(e){this.loadOptions.delete(e),this.documentClosed$.emit(e),this.logger.info("DocumentManagerPlugin","DocumentClosed",`Document ${e} closed`)}onActiveDocumentChanged(e,t){this.activeDocumentChanged$.emit({previousDocumentId:e,currentDocumentId:t}),this.logger.info("DocumentManagerPlugin","ActiveDocumentChanged",`Active document changed from ${e} to ${t}`)}onCoreStoreUpdated(e,t){e.core.documentOrder!==t.core.documentOrder&&this.documentOrderChanged$.emit({order:t.core.documentOrder})}onOpenFileRequest(e){return this.openFileRequest$.on(e)}openDocumentUrl(e){const t=new ft,n=e.documentId||this.generateDocumentId(),o=this.checkDocumentLimit();if(o)return t.reject(o),t;const r=e.name??this.extractNameFromUrl(e.url);this.loadOptions.set(n,e),this.dispatchCoreAction($n(n,r,e.scale,e.rotation,!!e.password,e.autoActivate)),this.logger.info("DocumentManagerPlugin","OpenDocumentUrl",`Starting to load document from URL: ${e.url}`,{documentId:n,passwordProvided:!!e.password});const a={id:n,url:e.url},i=this.engine.openDocumentUrl(a,{password:e.password,mode:e.mode,requestOptions:e.requestOptions});return t.resolve({documentId:n,task:i}),this.handleLoadTask(n,i,"OpenDocumentUrl"),t}openDocumentBuffer(e){const t=new ft,n=this.checkDocumentLimit();if(n)return t.reject(n),t;const o=e.documentId||this.generateDocumentId();this.loadOptions.set(o,e),this.dispatchCoreAction($n(o,e.name,e.scale,e.rotation,!!e.password,e.autoActivate)),this.logger.info("DocumentManagerPlugin","OpenDocumentBuffer",`Starting to load document from buffer: ${e.name}`,{documentId:o,passwordProvided:!!e.password});const r={id:o,content:e.buffer},a=this.engine.openDocumentBuffer(r,{password:e.password});return t.resolve({documentId:o,task:a}),this.handleLoadTask(o,a,"OpenDocumentBuffer"),t}retryDocument(e,t){const n=new ft,o=this.validateRetry(e);if(!o.valid)return n.reject(o.error),n;const r={...this.loadOptions.get(e),...(null==t?void 0:t.password)&&{password:t.password}};this.loadOptions.set(e,r),this.dispatchCoreAction(((e,t)=>({type:In,payload:{documentId:e,passwordProvided:t}}))(e,!!(null==t?void 0:t.password))),this.logger.info("DocumentManagerPlugin","RetryDocument",`Retrying to load document ${e}`,{passwordProvided:!!(null==t?void 0:t.password)});const a="url"in r?this.retryUrlDocument(e,r):this.retryBufferDocument(e,r);return n.resolve({documentId:e,task:a}),this.handleLoadTask(e,a,"RetryDocument"),n}openFileDialog(e){const t=new ft;return this.openFileRequest$.emit({task:t,options:e}),t}closeDocument(e){const t=new ft,n=this.coreState.core.documents[e];return n?("loaded"===n.status&&n.document?this.engine.closeDocument(n.document).wait(()=>{this.dispatchCoreAction(Un(e)),t.resolve()},n=>{this.logger.error("DocumentManagerPlugin","CloseDocument",`Failed to close document ${e}`,n),t.fail(n)}):(this.logger.info("DocumentManagerPlugin","CloseDocument",`Closing document ${e} in ${n.status} state (skipping engine close)`),this.dispatchCoreAction(Un(e)),t.resolve()),t):(this.logger.warn("DocumentManagerPlugin","CloseDocument",`Cannot close document ${e}: not found in state`),t.resolve(),t)}closeAllDocuments(){const e=Object.keys(this.coreState.core.documents),t=e.map(e=>this.closeDocument(e));return this.logger.info("DocumentManagerPlugin","CloseAllDocuments",`Closing ${e.length} documents`),ft.all(t)}checkDocumentLimit(){return this.maxDocuments&&Object.keys(this.coreState.core.documents).length>=this.maxDocuments?{code:Ut.Unknown,message:`Maximum number of documents (${this.maxDocuments}) reached`}:null}validateRetry(e){const t=this.coreState.core.documents[e];return t?"loaded"===t.status?{valid:!1,error:{code:Ut.Unknown,message:`Document ${e} is already loaded successfully`}}:"error"!==t.status?{valid:!1,error:{code:Ut.Unknown,message:`Document ${e} is not in error state (current state: ${t.status})`}}:this.loadOptions.has(e)?{valid:!0}:{valid:!1,error:{code:Ut.Unknown,message:`No retry information available for document ${e}`}}:{valid:!1,error:{code:Ut.NotFound,message:`Document ${e} not found`}}}retryUrlDocument(e,t){const n={id:e,url:t.url};return this.engine.openDocumentUrl(n,{password:t.password,mode:t.mode,requestOptions:t.requestOptions})}retryBufferDocument(e,t){const n={id:e,content:t.buffer};return this.engine.openDocumentBuffer(n,{password:t.password})}handleLoadTask(e,t,n){t.wait(t=>{this.dispatchCoreAction(((e,t)=>({type:kn,payload:{documentId:e,document:t}}))(e,t))},t=>{this.handleLoadError(e,t,n)})}handleLoadError(e,t,n){var o,r,a;const i=(null==(o=t.reason)?void 0:o.message)||"Failed to load document";this.logger.error("DocumentManagerPlugin",n,"Failed to load document",t),this.dispatchCoreAction(((e,t,n,o)=>({type:Tn,payload:{documentId:e,error:t,errorCode:n,errorDetails:o}}))(e,i,null==(r=t.reason)?void 0:r.code,t.reason)),this.documentError$.emit({documentId:e,message:i,code:null==(a=t.reason)?void 0:a.code,reason:t.reason})}generateDocumentId(){return`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}extractNameFromUrl(e){try{const t=new URL(e).pathname.split("/").pop();if(!t)return;let n=decodeURIComponent(t);return n.toLowerCase().endsWith(".pdf")||(n+=".pdf"),n}catch{return}}async initialize(e){var t;if(this.logger.info("DocumentManagerPlugin","Initialize","Document Manager Plugin initialized",{maxDocuments:this.maxDocuments,initialDocumentsCount:(null==(t=e.initialDocuments)?void 0:t.length)??0}),e.initialDocuments&&e.initialDocuments.length>0)for(const t of e.initialDocuments)try{"buffer"in t?this.openDocumentBuffer(t):"url"in t&&this.openDocumentUrl(t)}catch(e){this.logger.error("DocumentManagerPlugin","Initialize","Failed to initiate initial document load",e)}}async destroy(){await this.closeAllDocuments().toPromise(),this.loadOptions.clear(),this.documentOpened$.clear(),this.documentClosed$.clear(),this.activeDocumentChanged$.clear(),this.documentOrderChanged$.clear(),this.documentError$.clear(),super.destroy()}};Ba.id="document-manager";let $a=Ba;const Ua="document-manager";function Wa({documentId:e,children:t}){const n=bo(e);return n?We(H,{children:t({documentState:n,isLoading:"loading"===n.status,isError:"error"===n.status,isLoaded:"loaded"===n.status})}):null}const Ha=()=>Fo($a.id),Va=mo({manifest:{id:Ua,name:"Document Manager Plugin",version:"1.0.0",provides:["document-manager"],requires:[],optional:[],defaultConfig:{maxDocuments:10}},create:(e,t)=>new $a(Ua,e,t),reducer:e=>e,initialState:{}}).addUtility(function(){const{plugin:e}=fo($a.id),{provides:t}=Ha(),n=Te(null),o=Te(null),r=Te(void 0);return Me(()=>{if(null==e?void 0:e.onOpenFileRequest)return e.onOpenFileRequest(({task:e,options:t})=>{var a;o.current=e,r.current=t,null==(a=n.current)||a.click()})},[e]),We("input",{ref:n,type:"file",accept:"application/pdf",style:{display:"none"},onChange:async e=>{var n,a,i,s,l;const d=null==(n=e.currentTarget.files)?void 0:n[0];if(!d||!t)return;const c=await d.arrayBuffer();t.openDocumentBuffer({name:d.name,buffer:c,documentId:null==(a=r.current)?void 0:a.documentId,scale:null==(i=r.current)?void 0:i.scale,rotation:null==(s=r.current)?void 0:s.rotation,autoActivate:null==(l=r.current)?void 0:l.autoActivate}).wait(e=>{var t;null==(t=o.current)||t.resolve(e)},e=>{var t;null==(t=o.current)||t.fail(e)})}})}).build(),Ya="commands",qa={id:Ya,name:"Commands Plugin",version:"1.0.0",provides:["commands"],requires:[],optional:["i18n"],defaultConfig:{commands:{}}},Ka="COMMANDS/SET_DISABLED_CATEGORIES",Xa=e=>({type:Ka,payload:e}),Za=class extends Qn{constructor(e,t,n){var o;super(e,t),this.commands=new Map,this.i18n=null,this.shortcutMap=new Map,this.commandExecuted$=so(),this.commandStateChanged$=so(),this.shortcutExecuted$=so(),this.categoryChanged$=lo(),this.previousStates=new Map;const r=t.getPlugin("i18n");this.i18n=(null==r?void 0:r.provides())??null,(null==(o=n.disabledCategories)?void 0:o.length)&&this.dispatch(Xa(n.disabledCategories)),Object.values(n.commands).forEach(e=>{this.registerCommand(e)}),this.registry.getStore().subscribe((e,t)=>{this.onGlobalStoreChange(t)})}onDocumentClosed(e){this.previousStates.delete(e),this.logger.debug("CommandsPlugin","DocumentClosed",`Cleaned up command state cache for document: ${e}`)}async initialize(){this.logger.info("CommandsPlugin","Initialize","Commands plugin initialized")}async destroy(){this.commandExecuted$.clear(),this.commandStateChanged$.clear(),this.shortcutExecuted$.clear(),this.categoryChanged$.clear(),this.commands.clear(),this.shortcutMap.clear(),this.previousStates.clear(),super.destroy()}disableCategoryImpl(e){const t=new Set(this.state.disabledCategories);t.has(e)||(t.add(e),this.dispatch(Xa(Array.from(t))),this.categoryChanged$.emit({disabledCategories:Array.from(t)}))}enableCategoryImpl(e){const t=new Set(this.state.disabledCategories);t.has(e)&&(t.delete(e),this.dispatch(Xa(Array.from(t))),this.categoryChanged$.emit({disabledCategories:Array.from(t)}))}toggleCategoryImpl(e){this.state.disabledCategories.includes(e)?this.enableCategoryImpl(e):this.disableCategoryImpl(e)}setDisabledCategoriesImpl(e){this.dispatch(Xa(e)),this.categoryChanged$.emit({disabledCategories:e})}isCommandCategoryDisabled(e){var t;return!!(null==(t=e.categories)?void 0:t.length)&&e.categories.some(e=>this.state.disabledCategories.includes(e))}buildCapability(){return{resolve:(e,t)=>this.resolve(e,t),execute:(e,t,n="ui")=>this.execute(e,t,n),getAllCommands:e=>this.getAllCommands(e),getCommandsByCategory:(e,t)=>this.getCommandsByCategory(e,t),getCommandByShortcut:e=>this.getCommandByShortcut(e),getAllShortcuts:()=>new Map(this.shortcutMap),forDocument:e=>this.createCommandScope(e),registerCommand:e=>this.registerCommand(e),unregisterCommand:e=>this.unregisterCommand(e),disableCategory:e=>this.disableCategoryImpl(e),enableCategory:e=>this.enableCategoryImpl(e),toggleCategory:e=>this.toggleCategoryImpl(e),setDisabledCategories:e=>this.setDisabledCategoriesImpl(e),getDisabledCategories:()=>this.state.disabledCategories,isCategoryDisabled:e=>this.state.disabledCategories.includes(e),onCommandExecuted:this.commandExecuted$.on,onCommandStateChanged:this.commandStateChanged$.on,onShortcutExecuted:this.shortcutExecuted$.on,onCategoryChanged:this.categoryChanged$.on}}createCommandScope(e){return{resolve:t=>this.resolve(t,e),execute:(t,n="ui")=>this.execute(t,e,n),getAllCommands:()=>this.getAllCommands(e),getCommandsByCategory:t=>this.getCommandsByCategory(t,e),onCommandStateChanged:t=>this.commandStateChanged$.on(n=>{if(n.documentId===e){const{documentId:e,...o}=n;t(o)}})}}resolve(e,t){const n=t??this.getActiveDocumentId(),o=this.commands.get(e);if(!o)throw new Error(`Command not found: ${e}`);const r=this.registry.getStore().getState(),a=this.resolveLabel(o,r,n),i=o.shortcuts?Array.isArray(o.shortcuts)?o.shortcuts:[o.shortcuts]:void 0,s=this.resolveDynamic(o.disabled,r,n)??!1,l=this.isCommandCategoryDisabled(o),d=s||l;return{id:o.id,label:a,icon:this.resolveDynamic(o.icon,r,n),iconProps:this.resolveDynamic(o.iconProps,r,n),active:this.resolveDynamic(o.active,r,n)??!1,disabled:d,visible:this.resolveDynamic(o.visible,r,n)??!0,shortcuts:i,shortcutLabel:o.shortcutLabel,categories:o.categories,description:o.description,execute:()=>o.action({registry:this.registry,state:r,documentId:n})}}resolveLabel(e,t,n){if(e.labelKey&&this.i18n){const o=this.resolveDynamic(e.labelParams,t,n);return this.i18n.t(e.labelKey,{params:o,documentId:n})}return e.label?e.label:e.id}resolveDynamic(e,t,n){if(void 0!==e)return"function"==typeof e?e({state:t,documentId:n}):e}execute(e,t,n="ui"){const o=t??this.getActiveDocumentId(),r=this.resolve(e,o);r.disabled?this.logger.warn("CommandsPlugin","ExecutionBlocked",`Command '${e}' is disabled for document '${o}'`):r.visible?(r.execute(),this.commandExecuted$.emit({commandId:e,documentId:o,source:n}),this.logger.debug("CommandsPlugin","CommandExecuted",`Command '${e}' executed for document '${o}' (source: ${n})`)):this.logger.warn("CommandsPlugin","ExecutionBlocked",`Command '${e}' is not visible for document '${o}'`)}registerCommand(e){this.commands.has(e.id)&&this.logger.warn("CommandsPlugin","CommandOverwrite",`Command '${e.id}' already exists and will be overwritten`),this.commands.set(e.id,e),e.shortcuts&&(Array.isArray(e.shortcuts)?e.shortcuts:[e.shortcuts]).forEach(t=>{const n=this.normalizeShortcut(t);this.shortcutMap.set(n,e.id)}),this.logger.debug("CommandsPlugin","CommandRegistered",`Command '${e.id}' registered`)}unregisterCommand(e){const t=this.commands.get(e);t&&(t.shortcuts&&(Array.isArray(t.shortcuts)?t.shortcuts:[t.shortcuts]).forEach(e=>{const t=this.normalizeShortcut(e);this.shortcutMap.delete(t)}),this.commands.delete(e),this.logger.debug("CommandsPlugin","CommandUnregistered",`Command '${e}' unregistered`))}getCommandByShortcut(e){const t=this.normalizeShortcut(e),n=this.shortcutMap.get(t);return n?this.commands.get(n)??null:null}normalizeShortcut(e){return e.toLowerCase().split("+").sort().join("+")}getAllCommands(e){const t=e??this.getActiveDocumentId();return Array.from(this.commands.keys()).map(e=>this.resolve(e,t))}getCommandsByCategory(e,t){const n=t??this.getActiveDocumentId();return Array.from(this.commands.values()).filter(t=>{var n;return null==(n=t.categories)?void 0:n.includes(e)}).map(e=>this.resolve(e.id,n))}onGlobalStoreChange(e){Object.keys(e.core.documents).forEach(t=>{this.detectCommandChanges(t,e)})}detectCommandChanges(e,t){const n=this.previousStates.get(e)??new Map;this.commands.forEach((t,o)=>{const r=this.resolve(o,e),a=n.get(o);if(!a)return void n.set(o,r);const i={};a.active!==r.active&&(i.active=r.active),a.disabled!==r.disabled&&(i.disabled=r.disabled),a.visible!==r.visible&&(i.visible=r.visible),a.label!==r.label&&(i.label=r.label),oo(a.iconProps,r.iconProps)||(i.iconProps=r.iconProps),Object.keys(i).length>0&&(n.set(o,r),this.commandStateChanged$.emit({commandId:o,documentId:e,changes:i}))}),this.previousStates.set(e,n)}};Za.id="commands";let Qa=Za;const Ja={disabledCategories:[]},ei=()=>Fo(Qa.id),ti=(e,t)=>{const{provides:n}=ei(),[o,r]=Ee(()=>n?n.resolve(e,t):null);return Me(()=>{if(n)return r(n.resolve(e,t)),n.onCommandStateChanged(o=>{o.commandId===e&&o.documentId===t&&r(n.resolve(e,t))});r(null)},[n,e,t]),o},ni=mo({manifest:qa,create:(e,t)=>new Qa(Ya,e,t),reducer:(e=Ja,t)=>t.type===Ka?{...e,disabledCategories:t.payload}:e,initialState:Ja}).addUtility(function(){const{provides:e}=ei();return Me(()=>{if(!e)return;const t=function(e){return t=>{const n=t.composedPath()[0]||t.target;if("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable)return;const o=function(e){const t=[];e.ctrlKey&&t.push("ctrl"),e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.metaKey&&t.push("meta");const n=e.key.toLowerCase();return["control","shift","alt","meta"].includes(n)?null:[...t,n].sort().join("+")}(t);if(!o)return;const r=e.getCommandByShortcut(o);if(!r)return;const a=e.resolve(r.id);!a.disabled&&a.visible&&(t.preventDefault(),t.stopPropagation(),e.execute(r.id,void 0,"keyboard"))}}(e);return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[e]),null}).build(),oi="i18n",ri={id:oi,name:"I18n Plugin",version:"1.0.0",provides:["i18n"],requires:[],optional:[],defaultConfig:{defaultLocale:"en",locales:[{code:"en",name:"English",translations:{commands:{zoom:{in:"Zoom In",out:"Zoom Out",fitWidth:"Fit to Width",fitPage:"Fit to Page",automatic:"Automatic",level:"Zoom Level ({level}%)",inArea:"Zoom In Area"},fullscreen:{enter:"Enter Full Screen",exit:"Exit Full Screen"},rotate:{clockwise:"Rotate Clockwise",counterclockwise:"Rotate Counter-Clockwise"},menu:"Menu",sidebar:"Sidebar",search:"Search",comment:"Comment",download:"Download",print:"Print",openFile:"Open PDF",save:"Save",settings:"Settings",view:"View",annotate:"Annotate",shapes:"Shapes",redact:"Redact",fillAndSign:"Fill and Sign",form:"Form",pan:"Pan",pointer:"Pointer",undo:"Undo",redo:"Redo",copy:"Copy",screenshot:"Screenshot",nextPage:"Next Page",previousPage:"Previous Page"}}},{code:"es",name:"Español",translations:{commands:{zoom:{in:"Acercar",out:"Alejar",fitWidth:"Ajustar al ancho",fitPage:"Ajustar a la página",automatic:"Automático",level:"Nivel de zoom ({level}%)",inArea:"Acercar área"},fullscreen:{enter:"Pantalla completa",exit:"Salir de pantalla completa"},rotate:{clockwise:"Girar a la derecha",counterclockwise:"Girar a la izquierda"},menu:"Menú",sidebar:"Barra lateral",search:"Buscar",comment:"Comentario",download:"Descargar",print:"Imprimir",openFile:"Abrir PDF",save:"Guardar",settings:"Configuración",view:"Ver",annotate:"Anotar",shapes:"Formas",redact:"Redactar",fillAndSign:"Rellenar y firmar",form:"Formulario",pan:"Desplazar",pointer:"Puntero",undo:"Deshacer",redo:"Rehacer",copy:"Copiar",screenshot:"Captura de pantalla",nextPage:"Página siguiente",previousPage:"Página anterior"}}}]}},ai="I18N/SET_LOCALE",ii="I18N/REGISTER_LOCALE",si=e=>({type:ai,payload:e}),li=e=>({type:ii,payload:e}),di=class extends Qn{constructor(e,t,n){super(e,t),this.locales=new Map,this.paramResolvers=new Map,this.paramsCache=new Map,this.localeChange$=so(),this.paramsChanged$=co((e,t)=>({documentId:e,...t}),{cache:!1}),this.config=n,n.locales.forEach(e=>{this.locales.set(e.code,e),this.dispatch(li(e.code))}),n.paramResolvers&&Object.entries(n.paramResolvers).forEach(([e,t])=>{this.paramResolvers.set(e,t)}),this.dispatch(si(n.defaultLocale)),this.registry.getStore().subscribe((e,t)=>{this.detectParamChanges(t)})}async initialize(){this.logger.info("I18nPlugin","Initialize","I18n plugin initialized")}async destroy(){this.localeChange$.clear(),this.paramsChanged$.clear(),this.paramResolvers.clear(),this.paramsCache.clear(),super.destroy()}onDocumentClosed(e){this.paramsCache.delete(e),this.paramsChanged$.clearScope(e),this.logger.debug("I18nPlugin","DocumentClosed",`Cleaned up params cache for document: ${e}`)}buildCapability(){return{t:(e,t)=>this.translate(e,t),forDocument:e=>this.createI18nScope(e),registerParamResolver:(e,t)=>this.registerParamResolver(e,t),unregisterParamResolver:e=>this.unregisterParamResolver(e),setLocale:e=>this.setLocale(e),getLocale:()=>this.state.currentLocale,getAvailableLocales:()=>[...this.state.availableLocales],getLocaleInfo:e=>this.locales.get(e)??null,registerLocale:e=>this.registerLocale(e),hasLocale:e=>this.locales.has(e),onLocaleChange:this.localeChange$.on,onParamsChanged:this.paramsChanged$.onGlobal}}createI18nScope(e){return{t:(t,n)=>this.translate(t,{documentId:e,...n}),onParamsChanged:this.paramsChanged$.forScope(e)}}translate(e,t){const n=this.locales.get(this.state.currentLocale),o=this.config.fallbackLocale?this.locales.get(this.config.fallbackLocale):null;let r=this.getNestedValue(null==n?void 0:n.translations,e);if(!r&&o&&(r=this.getNestedValue(o.translations,e)),!r){if(!(null==t?void 0:t.fallback))return this.logger.warn("I18nPlugin","MissingTranslation",`Translation not found for key: ${e}`),e;r=t.fallback}let a=null==t?void 0:t.params;return!a&&this.paramResolvers.has(e)&&(a=this.resolveParams(e,null==t?void 0:t.documentId)),this.interpolate(r,a)}resolveParams(e,t){const n=this.paramResolvers.get(e);if(!n)return;const o=this.registry.getStore().getState();try{return n({state:o,documentId:t})}catch(t){return void this.logger.error("I18nPlugin","ParamResolverError",`Error resolving params for key "${e}":`,t)}}getNestedValue(e,t){if(!e)return;const n=t.split(".");let o=e;for(const e of n){if(null==o)return;o=o[e]}return"string"==typeof o?o:void 0}interpolate(e,t){return t?e.replace(/\{(\w+)\}/g,(e,n)=>{const o=t[n];return void 0!==o?String(o):e}):e}detectParamChanges(e){Object.keys(e.core.documents).forEach(t=>{this.detectDocumentParamChanges(t,e)})}detectDocumentParamChanges(e,t){const n=this.paramsCache.get(e),o=[];this.paramResolvers.forEach((r,a)=>{try{const i=r({state:t,documentId:e});oo(null==n?void 0:n.get(a),i)||(o.push(a),this.paramsCache.has(e)||this.paramsCache.set(e,new Map),this.paramsCache.get(e).set(a,i))}catch(e){this.logger.error("I18nPlugin","ParamDetectionError",`Error detecting param changes for key "${a}":`,e)}}),o.length>0&&(this.paramsChanged$.emit(e,{changedKeys:o}),this.logger.debug("I18nPlugin","ParamsChanged",`Translation params changed for document ${e}:`,o))}registerParamResolver(e,t){this.paramResolvers.has(e)&&this.logger.warn("I18nPlugin","ResolverOverwrite",`Param resolver for "${e}" already exists and will be overwritten`),this.paramResolvers.set(e,t),this.paramsCache.forEach(t=>{t.delete(e)}),this.logger.debug("I18nPlugin","ResolverRegistered",`Param resolver registered for: ${e}`)}unregisterParamResolver(e){this.paramResolvers.delete(e)&&(this.paramsCache.forEach(t=>{t.delete(e)}),this.logger.debug("I18nPlugin","ResolverUnregistered",`Param resolver unregistered for: ${e}`))}setLocale(e){if(!this.locales.has(e))return void this.logger.warn("I18nPlugin","LocaleNotFound",`Locale '${e}' is not registered`);const t=this.state.currentLocale;t!==e&&(this.dispatch(si(e)),this.localeChange$.emit({previousLocale:t,currentLocale:e}),this.logger.info("I18nPlugin","LocaleChanged",`Locale changed to: ${e}`))}registerLocale(e){this.locales.has(e.code)?this.logger.warn("I18nPlugin","LocaleAlreadyRegistered",`Locale '${e.code}' is already registered`):(this.locales.set(e.code,e),this.dispatch(li(e.code)),this.logger.info("I18nPlugin","LocaleRegistered",`Locale registered: ${e.code}`))}};di.id="i18n";let ci=di;const ui={currentLocale:"en",availableLocales:[]},mi={manifest:ri,create:(e,t)=>new ci(oi,e,t),reducer:(e=ui,t)=>{switch(t.type){case ai:{const n=t.payload;return e.availableLocales.includes(n)?{...e,currentLocale:n}:(console.warn(`I18nPlugin: Locale '${n}' not available`),e)}case ii:{const n=t.payload;return e.availableLocales.includes(n)?e:{...e,availableLocales:[...e.availableLocales,n]}}default:return e}},initialState:ui},pi=e=>{const{provides:t}=Fo(ci.id),[,n]=Ce(e=>e+1,0),o=Oe((n,o)=>t?t.t(n,{documentId:e,params:null==o?void 0:o.params,fallback:null==o?void 0:o.fallback}):(null==o?void 0:o.fallback)??n,[t,e]);return Me(()=>{if(!t)return;const o=t.onLocaleChange(()=>{n()}),r=e?t.forDocument(e).onParamsChanged(()=>{n()}):t.onParamsChanged(()=>{n()});return()=>{o(),r()}},[t,e]),{translate:o,locale:(null==t?void 0:t.getLocale())??"en"}};var hi=(e=>(e.Automatic="automatic",e.FitPage="fit-page",e.FitWidth="fit-width",e))(hi||{}),gi=(e=>(e[e.Center=0]="Center",e[e.Top=1]="Top",e))(gi||{});const fi="zoom",Fi={id:fi,name:"Zoom Plugin",version:"1.0.0",provides:["zoom"],requires:["viewport","scroll"],optional:["interaction-manager","spread"],defaultConfig:{defaultZoomLevel:hi.Automatic,minZoom:.2,maxZoom:60,zoomStep:.1,zoomRanges:[{min:.2,max:.5,step:.05},{min:.5,max:1,step:.1},{min:1,max:2,step:.2},{min:2,max:4,step:.4},{min:4,max:10,step:.8},{min:10,max:20,step:1.6},{min:20,max:40,step:3.2},{min:40,max:60,step:6.4}],presets:[{name:"Fit Page",value:hi.FitPage},{name:"Fit Width",value:hi.FitWidth},{name:"Automatic",value:hi.Automatic},{name:"25%",value:.25},{name:"50%",value:.5},{name:"100%",value:1},{name:"125%",value:1.25},{name:"150%",value:1.5},{name:"200%",value:2},{name:"400%",value:4},{name:"800%",value:8},{name:"1600%",value:16}]}},Pi="ZOOM/INIT_STATE",bi="ZOOM/CLEANUP_STATE",_i="ZOOM/SET_ZOOM_LEVEL",vi="ZOOM/SET_MARQUEE_ZOOM_ACTIVE",yi={zoomLevel:hi.Automatic,currentZoomLevel:1,isMarqueeZoomActive:!1},Di={documents:{},activeDocumentId:null},xi=class extends Qn{constructor(e,t,n){var o,r,a;super(e,t),this.zoom$=so(),this.state$=lo(),this.viewportPlugin=t.getPlugin("viewport"),this.viewport=this.viewportPlugin.provides(),this.scroll=t.getPlugin("scroll").provides();const i=t.getPlugin("interaction-manager");this.interactionManager=(null==i?void 0:i.provides())??null;const s=t.getPlugin("spread");this.spread=(null==s?void 0:s.provides())??null,this.minZoom=n.minZoom??.25,this.maxZoom=n.maxZoom??10,this.zoomStep=n.zoomStep??.1,this.defaultZoomLevel=n.defaultZoomLevel,this.presets=n.presets??[],this.zoomRanges=this.normalizeRanges(n.zoomRanges??[]),this.viewport.onViewportResize(e=>this.recalcAuto(e.documentId,gi.Top),{mode:"debounce",wait:150,keyExtractor:e=>e.documentId}),null==(o=this.spread)||o.onSpreadChange(e=>{this.recalcAuto(e.documentId,gi.Top)}),null==(r=this.interactionManager)||r.registerMode({id:"marqueeZoom",scope:"page",exclusive:!0,cursor:"zoom-in"}),null==(a=this.interactionManager)||a.onModeChange(e=>{const t="marqueeZoom"===e.activeMode,n=this.getDocumentState(e.documentId);var o;n&&n.isMarqueeZoomActive!==t&&this.dispatch((o=e.documentId,{type:vi,payload:{documentId:o,isActive:t}}))})}onDocumentLoadingStarted(e){this.viewport.gate("zoom",e);const t={...yi,zoomLevel:this.defaultZoomLevel};this.dispatch(function(e,t){return{type:Pi,payload:{documentId:e,state:t}}}(e,t)),this.logger.debug("ZoomPlugin","DocumentOpened",`Initialized zoom state for document: ${e}`)}onDocumentLoaded(e){this.recalcAuto(e,gi.Top)}onDocumentClosed(e){this.dispatch(function(e){return{type:bi,payload:e}}(e)),this.logger.debug("ZoomPlugin","DocumentClosed",`Cleaned up zoom state for document: ${e}`)}onRotationChanged(e){this.recalcAuto(e,gi.Top)}buildCapability(){return{requestZoom:(e,t)=>this.requestZoom(e,t),requestZoomBy:(e,t)=>this.requestZoomBy(e,t),zoomIn:()=>this.zoomIn(),zoomOut:()=>this.zoomOut(),zoomToArea:(e,t)=>this.zoomToArea(e,t),enableMarqueeZoom:()=>this.enableMarqueeZoom(),disableMarqueeZoom:()=>this.disableMarqueeZoom(),toggleMarqueeZoom:()=>this.toggleMarqueeZoom(),isMarqueeZoomActive:()=>this.isMarqueeZoomActive(),getState:()=>this.getDocumentStateOrThrow(),forDocument:e=>this.createZoomScope(e),registerMarqueeOnPage:e=>this.registerMarqueeOnPage(e),getPresets:()=>this.presets,onZoomChange:this.zoom$.on,onStateChange:this.state$.on}}createZoomScope(e){return{requestZoom:(t,n)=>this.requestZoom(t,n,e),requestZoomBy:(t,n)=>this.requestZoomBy(t,n,e),zoomIn:()=>this.zoomIn(e),zoomOut:()=>this.zoomOut(e),zoomToArea:(t,n)=>this.zoomToArea(t,n,e),enableMarqueeZoom:()=>this.enableMarqueeZoom(e),disableMarqueeZoom:()=>this.disableMarqueeZoom(e),toggleMarqueeZoom:()=>this.toggleMarqueeZoom(e),isMarqueeZoomActive:()=>this.isMarqueeZoomActive(e),getState:()=>this.getDocumentStateOrThrow(e),onZoomChange:t=>this.zoom$.on(n=>{n.documentId===e&&t(n)}),onStateChange:t=>this.state$.on(n=>{n.documentId===e&&t(n.state)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Zoom state not found for document: ${e??"active"}`);return t}requestZoom(e,t,n){this.handleRequest({level:e,center:t},n)}requestZoomBy(e,t,n){const o=n??this.getActiveDocumentId(),r=this.getDocumentStateOrThrow(o).currentZoomLevel,a=this.toZoom(r+e);this.handleRequest({level:a,center:t},o)}zoomIn(e){const t=e??this.getActiveDocumentId(),n=this.getDocumentStateOrThrow(t).currentZoomLevel;this.handleRequest({level:n,delta:this.stepFor(n)},t)}zoomOut(e){const t=e??this.getActiveDocumentId(),n=this.getDocumentStateOrThrow(t).currentZoomLevel;this.handleRequest({level:n,delta:-this.stepFor(n)},t)}zoomToArea(e,t,n){const o=n??this.getActiveDocumentId();this.handleZoomToArea(o,e,t)}enableMarqueeZoom(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManager)||t.forDocument(n).activate("marqueeZoom")}disableMarqueeZoom(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManager)||t.forDocument(n).activateDefaultMode()}toggleMarqueeZoom(e){var t;const n=e??this.getActiveDocumentId(),o=null==(t=this.interactionManager)?void 0:t.forDocument(n);"marqueeZoom"===(null==o?void 0:o.getActiveMode())?o.activateDefaultMode():null==o||o.activate("marqueeZoom")}isMarqueeZoomActive(e){var t;const n=e??this.getActiveDocumentId();return"marqueeZoom"===(null==(t=this.interactionManager)?void 0:t.forDocument(n).getActiveMode())}handleRequest({level:e,delta:t=0,center:n,focus:o=gi.Center,align:r="keep"},a){const i=a??this.getActiveDocumentId(),s=this.getDocumentStateOrThrow(i);if(!this.coreState.core.documents[i])return;const l=this.viewport.forDocument(i),d=l.getMetrics(),c=s.currentZoomLevel;if(0===d.clientWidth||0===d.clientHeight)return;const u="number"==typeof e?e:this.computeZoomForMode(i,e,d);if(!1===u)return;const m=no(u+t,this.minZoom,this.maxZoom),p=Math.floor(1e3*m)/1e3,h=n??{vx:d.clientWidth/2,vy:o===gi.Top?0:d.clientHeight/2},{desiredScrollLeft:g,desiredScrollTop:f}=this.computeScrollForZoomChange(i,d,c,p,h,r);isNaN(g)||isNaN(f)||this.viewportPlugin.setViewportScrollMetrics(i,{scrollLeft:g,scrollTop:f}),this.dispatch(function(e,t,n){return{type:_i,payload:{documentId:e,zoomLevel:t,currentZoomLevel:n}}}(i,"number"==typeof e?p:e,p)),this.dispatchCoreAction(((e,t)=>({type:zn,payload:{scale:e,documentId:t}}))(p,i)),this.viewport.isGated(i)&&this.viewport.releaseGate("zoom",i),l.scrollTo({x:g,y:f,behavior:"instant"});const F={documentId:i,oldZoom:c,newZoom:p,level:e,center:h,desiredScrollLeft:g,desiredScrollTop:f,viewport:d};this.zoom$.emit(F)}computeZoomForMode(e,t,n){if(!this.coreState.core.documents[e])return!1;const o=this.scroll.forDocument(e),r=o?this.scroll.getPageGap():0,a=this.viewport.getViewportGap(),i=o.getSpreadPagesWithRotatedSize();if(!i.length)return!1;if(0===n.clientWidth||0===n.clientHeight)return!1;const s=n.clientWidth-2*a,l=n.clientHeight-2*a;if(s<=0||l<=0)return!1;let d=0,c=0;switch(i.forEach(e=>{const t=e.reduce((e,t,n)=>e+t.rotatedSize.width+(n?r:0),0),n=Math.max(...e.map(e=>e.rotatedSize.height));d=Math.max(d,t),c=Math.max(c,n)}),t){case hi.FitWidth:return s/d;case hi.FitPage:return Math.min(s/d,l/c);case hi.Automatic:return Math.min(s/d,1);default:return 1}}computeScrollForZoomChange(e,t,n,o,r,a="keep"){const i=this.scroll.forDocument(e).getLayout(),s=this.viewport.getViewportGap(),l=i.totalContentSize.width,d=i.totalContentSize.height,c=t.clientWidth-2*s,u=t.clientHeight-2*s,m=(e,t,n)=>t*n<e?(e-t*n)/2:0,p=m(c,l,n),h=m(u,d,n),g=m(c,l,o),f=m(u,d,o),F=(t.scrollLeft+r.vx-s-p)/n*o+s+g,P=(t.scrollTop+r.vy-s-h)/n*o+s+f,b="center"===a?F-t.clientWidth/2:F-r.vx,_="center"===a?P-t.clientHeight/2:P-r.vy;return{desiredScrollLeft:Math.max(0,b),desiredScrollTop:Math.max(0,_)}}handleZoomToArea(e,t,n){const o=this.coreState.core.documents[e];if(!o)return;const r=o.rotation,a=this.viewport.forDocument(e).getMetrics(),i=this.viewport.getViewportGap(),s=this.getDocumentStateOrThrow(e).currentZoomLevel,l=a.clientWidth-2*i,d=a.clientHeight-2*i,c=this.scroll.forDocument(e).getLayout(),u=c.virtualItems.find(e=>e.pageLayouts.some(e=>e.pageIndex===t));if(!u)return;const m=u.pageLayouts.find(e=>e.pageIndex===t),p=ot({width:m.width,height:m.height},n,r),h=this.toZoom(Math.min(l/p.size.width,d/p.size.height)),g=u.x+m.x,f=u.y+m.y,F=g+p.origin.x+p.size.width/2,P=f+p.origin.y+p.size.height/2,b=(e,t,n)=>t*n<e?(e-t*n)/2:0,_=b(l,c.totalContentSize.width,s),v=b(d,c.totalContentSize.height,s),y=i+_+F*s-a.scrollLeft,D=i+v+P*s-a.scrollTop;this.handleRequest({level:h,center:{vx:y,vy:D},align:"center"},e)}recalcAuto(e,t){const n=this.getDocumentState(e);n&&(n.zoomLevel!==hi.Automatic&&n.zoomLevel!==hi.FitPage&&n.zoomLevel!==hi.FitWidth||this.handleRequest({level:n.zoomLevel,focus:t},e))}normalizeRanges(e){return[...e].filter(e=>e.step>0&&e.max>e.min).sort((e,t)=>e.min-t.min)}stepFor(e){const t=this.zoomRanges.find(t=>e>=t.min&&e<t.max);return t?t.step:this.zoomStep}toZoom(e){return parseFloat(no(e,this.minZoom,this.maxZoom).toFixed(2))}registerMarqueeOnPage(e){if(!this.interactionManager)return this.logger.warn("ZoomPlugin","MissingDependency","Interaction manager plugin not loaded, marquee zoom disabled"),()=>{};const t=this.coreState.core.documents[e.documentId];if(!t||!t.document)return this.logger.warn("ZoomPlugin","DocumentNotFound","Document not found"),()=>{};const n=t.document.pages[e.pageIndex];if(!n)return this.logger.warn("ZoomPlugin","PageNotFound",`Page ${e.pageIndex} not found`),()=>{};const o=function(e){const{pageSize:t,scale:n,minDragPx:o=5,onPreview:r,onCommit:a,onSmallDrag:i}=e;let s=null,l=null;return{onPointerDown:(e,t)=>{var n;s=e,l={origin:{x:e.x,y:e.y},size:{width:0,height:0}},null==r||r(l),null==(n=t.setPointerCapture)||n.call(t)},onPointerMove:e=>{if(!s)return;const n=no(e.x,0,t.width),o=no(e.y,0,t.height);l={origin:{x:Math.min(s.x,n),y:Math.min(s.y,o)},size:{width:Math.abs(n-s.x),height:Math.abs(o-s.y)}},null==r||r(l)},onPointerUp:(e,t)=>{var d;l&&(Math.max(l.size.width,l.size.height)*n>o?null==a||a(l):null==i||i()),s=null,l=null,null==r||r(null),null==(d=t.releasePointerCapture)||d.call(t)},onPointerCancel:(e,t)=>{var n;s=null,l=null,null==r||r(null),null==(n=t.releasePointerCapture)||n.call(t)}}}({pageSize:n.size,scale:e.scale,onPreview:e.callback.onPreview,onCommit:t=>{var n,o;this.zoomToArea(e.pageIndex,t,e.documentId),null==(o=(n=e.callback).onCommit)||o.call(n,t)},onSmallDrag:()=>{var t,n;this.zoomIn(e.documentId),null==(n=(t=e.callback).onSmallDrag)||n.call(t)}});return this.interactionManager.registerHandlers({documentId:e.documentId,modeId:"marqueeZoom",handlers:o,pageIndex:e.pageIndex})}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o&&r&&(o.currentZoomLevel!==r.currentZoomLevel||o.zoomLevel!==r.zoomLevel||o.isMarqueeZoomActive!==r.isMarqueeZoomActive)&&this.state$.emit({documentId:n,state:r})}}async initialize(){this.logger.info("ZoomPlugin","Initialize","Zoom plugin initialized")}async destroy(){this.zoom$.clear(),this.state$.clear(),super.destroy()}};xi.id="zoom";let Ai=xi;const wi={manifest:Fi,create:(e,t)=>new Ai(fi,e,t),reducer:(e=Di,t)=>{switch(t.type){case Pi:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case bi:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"ZOOM/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case _i:{const{documentId:n,zoomLevel:o,currentZoomLevel:r}=t.payload,a=e.documents[n];return a?{...e,documents:{...e.documents,[n]:{...a,zoomLevel:o,currentZoomLevel:r}}}:e}case vi:{const{documentId:n,isActive:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,isMarqueeZoomActive:o}}}:e}default:return e}},initialState:Di},Si=()=>Fo(Ai.id);function Ei(e){const[t,n]=[e[0],e[1]],o=n.clientX-t.clientX,r=n.clientY-t.clientY;return Math.hypot(o,r)}function Ci({children:e,documentId:t,style:n,enablePinch:o=!0,enableWheel:r=!0,...a}){const i=Ie(()=>({enablePinch:o,enableWheel:r}),[o,r]),{elementRef:s}=function(e,t={}){const{provides:n}=Fo("viewport"),{provides:o}=Si(),r=Re(jo),a=Te(null);return ke(()=>{const i=a.current,s=null==r?void 0:r.current;if(i&&s&&o)return function({element:e,container:t,documentId:n,zoomProvides:o,viewportGap:r=0,options:a={}}){const{enablePinch:i=!0,enableWheel:s=!0}=a;if("undefined"==typeof window)return()=>{};const l=o.forDocument(n),d=()=>l.getState();let c=0,u=1,m=!1,p=0,h=null,g=1,f=0,F=0,P=0,b=0,_=0,v=0,y=0,D=0,x=0,A=0,w=0,S=0,E=0;const C=(e,t,n)=>Math.min(Math.max(e,t),n),M=()=>{const n=t.clientWidth-2*r,o=e.offsetWidth,a=o<n?(n-o)/2:0;e.style.marginLeft=`${a}px`},k=e=>{const t=f*e,n=F*e;let o=x*(1-e);const r=D-t/2-P,a=A-E*e-P,i=Math.max(0,t-y),s=.3*y,l=Math.min(1,i/s);let d=r+(a-r)*l;return n>v-2*S&&(o=C(b+o,v-S-n,S)-b),t>_-2*S&&(d=C(P+d,_-S-t,S)-P),{tx:d,ty:o,blend:l,finalWidth:t}},T=t=>{u=t;const{tx:n,ty:o}=k(t);e.style.transformOrigin="0 0",e.style.transform=`translate(${n}px, ${o}px) scale(${t})`},I=()=>{e.style.transform="none",e.style.transformOrigin="0 0",u=1},O=()=>{const{tx:e,finalWidth:t}=k(u),n=(u-1)*c;let o,r=w;if(t<=y)o=D;else{const t=1-u;o=Math.abs(t)>.001?P+e/t:A}l.requestZoomBy(n,{vx:o,vy:r}),I(),c=0},R=(n,o)=>{const a=t.getBoundingClientRect(),i=e.getBoundingClientRect();S=r,f=i.width,F=i.height,P=i.left-a.left,b=i.top-a.top,_=a.width,v=a.height,y=t.clientWidth,D=t.clientLeft+y/2;const s=n-i.left;x=o-i.top,A=n-a.left,w=o-a.top,E=f<y?A*f/y:s},G=e=>{if(2!==e.touches.length)return;m=!0,c=d().currentZoomLevel,p=Ei(e.touches);const t=function(e){const[t,n]=[e[0],e[1]];return{x:(t.clientX+n.clientX)/2,y:(t.clientY+n.clientY)/2}}(e.touches);R(t.x,t.y),e.preventDefault()},L=e=>{if(!m||2!==e.touches.length)return;const t=Ei(e.touches);T(t/p),e.preventDefault()},N=e=>{m&&(e.touches.length>=2||(m=!1,O()))},z=e=>{if(!e.ctrlKey&&!e.metaKey)return;e.preventDefault(),null===h?(c=d().currentZoomLevel,g=1,R(e.clientX,e.clientY)):clearTimeout(h);const t=1-.01*e.deltaY;g*=t,g=Math.max(.1,Math.min(10,g)),T(g),h=setTimeout(()=>{h=null,O(),g=1},150)},j=l.onStateChange(()=>M()),B=new ResizeObserver(()=>M());return B.observe(e),B.observe(t),M(),i&&(t.addEventListener("touchstart",G,{passive:!1}),t.addEventListener("touchmove",L,{passive:!1}),t.addEventListener("touchend",N),t.addEventListener("touchcancel",N)),s&&t.addEventListener("wheel",z,{passive:!1}),()=>{i&&(t.removeEventListener("touchstart",G),t.removeEventListener("touchmove",L),t.removeEventListener("touchend",N),t.removeEventListener("touchcancel",N)),s&&t.removeEventListener("wheel",z),h&&clearTimeout(h),j(),B.disconnect(),I(),e.style.marginLeft=""}}({element:i,container:s,documentId:e,zoomProvides:o,viewportGap:(null==n?void 0:n.getViewportGap())||0,options:t})},[n,o,e,r,t.enablePinch,t.enableWheel]),{elementRef:a}}(t,i);return We("div",{ref:s,...a,style:{...n,display:"inline-block",overflow:"visible",boxSizing:"border-box"},children:e})}const Mi=({documentId:e,pageIndex:t,scale:n,className:o,stroke:r="rgba(33,150,243,0.8)",fill:a="rgba(33,150,243,0.15)"})=>{const{provides:i}=Si(),s=bo(e),[l,d]=Ee(null),c=Ie(()=>void 0!==n?n:(null==s?void 0:s.scale)??1,[n,null==s?void 0:s.scale]);return Me(()=>{if(i)return i.registerMarqueeOnPage({documentId:e,pageIndex:t,scale:c,callback:{onPreview:d}})},[i,e,t,c]),l?We("div",{style:{position:"absolute",pointerEvents:"none",left:l.origin.x*c,top:l.origin.y*c,width:l.size.width*c,height:l.size.height*c,border:`1px solid ${r}`,background:a,boxSizing:"border-box"},className:o}):null},ki=class extends Qn{constructor(e,t,n){super(e,t),this.config=n}buildCapability(){return{renderPage:e=>this.renderPage(e),renderPageRect:e=>this.renderPageRect(e),forDocument:e=>this.createRenderScope(e)}}createRenderScope(e){return{renderPage:t=>this.renderPage(t,e),renderPageRect:t=>this.renderPageRect(t,e)}}renderPage({pageIndex:e,options:t},n){const o=n??this.getActiveDocumentId(),r=this.coreState.core.documents[o];if(!(null==r?void 0:r.document))throw new Error(`Document ${o} not loaded`);const a=r.document.pages.find(t=>t.index===e);if(!a)throw new Error(`Page ${e} not found in document ${o}`);const i={...t??{},withForms:(null==t?void 0:t.withForms)??this.config.withForms??!1,withAnnotations:(null==t?void 0:t.withAnnotations)??this.config.withAnnotations??!1,imageType:(null==t?void 0:t.imageType)??this.config.defaultImageType??"image/png",imageQuality:(null==t?void 0:t.imageQuality)??this.config.defaultImageQuality??.92};return this.engine.renderPage(r.document,a,i)}renderPageRect({pageIndex:e,rect:t,options:n},o){const r=o??this.getActiveDocumentId(),a=this.coreState.core.documents[r];if(!(null==a?void 0:a.document))throw new Error(`Document ${r} not loaded`);const i=a.document.pages.find(t=>t.index===e);if(!i)throw new Error(`Page ${e} not found in document ${r}`);const s={...n??{},withForms:(null==n?void 0:n.withForms)??this.config.withForms??!1,withAnnotations:(null==n?void 0:n.withAnnotations)??this.config.withAnnotations??!1,imageType:(null==n?void 0:n.imageType)??this.config.defaultImageType??"image/png",imageQuality:(null==n?void 0:n.imageQuality)??this.config.defaultImageQuality??.92};return this.engine.renderPageRect(a.document,i,t,s)}async initialize(e){this.logger.info("RenderPlugin","Initialize","Render plugin initialized")}async destroy(){super.destroy()}};ki.id="render";let Ti=ki;const Ii="render",Oi={manifest:{id:Ii,name:"Render Plugin",version:"1.0.0",provides:["render"],requires:[],optional:[],defaultConfig:{}},create:(e,t)=>new Ti(Ii,e,t),reducer:()=>{},initialState:{}};function Ri({documentId:e,pageIndex:t,scale:n,dpr:o,style:r,...a}){const{provides:i}=Fo(Ti.id),s=bo(e),[l,d]=Ee(null),c=Te(null),u=Ie(()=>s&&s.pageRefreshVersions[t]||0,[s,t]),m=Ie(()=>void 0!==n?n:(null==s?void 0:s.scale)??1,[n,null==s?void 0:s.scale]),p=Ie(()=>void 0!==o?o:window.devicePixelRatio,[o]);return Me(()=>{if(!i)return;const n=i.forDocument(e).renderPage({pageIndex:t,options:{scaleFactor:m,dpr:p}});return n.wait(e=>{const t=URL.createObjectURL(e);d(t),c.current=t},yn),()=>{c.current?(URL.revokeObjectURL(c.current),c.current=null):n.abort({code:Ut.Cancelled,message:"canceled render task"})}},[e,t,m,p,i,u]),We(H,{children:l&&We("img",{src:l,onLoad:()=>{c.current&&(URL.revokeObjectURL(c.current),c.current=null)},...a,style:{width:"100%",height:"100%",...r||{}}})})}const Gi="rotate",Li={id:Gi,name:"Rotate Plugin",version:"1.0.0",provides:["rotate"],requires:[],optional:[],defaultConfig:{}},Ni="ROTATE/INIT_STATE",zi="ROTATE/CLEANUP_STATE",ji="ROTATE/SET_ROTATION",Bi=class extends Qn{constructor(e,t,n){super(e,t),this.rotate$=lo(),this.defaultRotation=n.defaultRotation??0}onDocumentLoadingStarted(e){const t={rotation:this.defaultRotation};this.dispatch(function(e,t){return{type:Ni,payload:{documentId:e,state:t}}}(e,t)),this.dispatchCoreAction(Hn(this.defaultRotation,e)),this.logger.debug("RotatePlugin","DocumentOpened",`Initialized rotation state for document: ${e}`)}onDocumentClosed(e){this.dispatch(function(e){return{type:zi,payload:e}}(e)),this.logger.debug("RotatePlugin","DocumentClosed",`Cleaned up rotation state for document: ${e}`)}buildCapability(){return{setRotation:e=>this.setRotationForDocument(e),getRotation:()=>this.getRotationForDocument(),rotateForward:()=>this.rotateForward(),rotateBackward:()=>this.rotateBackward(),forDocument:e=>this.createRotateScope(e),onRotateChange:this.rotate$.on}}createRotateScope(e){return{setRotation:t=>this.setRotationForDocument(t,e),getRotation:()=>this.getRotationForDocument(e),rotateForward:()=>this.rotateForward(e),rotateBackward:()=>this.rotateBackward(e),onRotateChange:t=>this.rotate$.on(n=>{n.documentId===e&&t(n.rotation)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Rotation state not found for document: ${e??"active"}`);return t}setRotationForDocument(e,t){const n=t??this.getActiveDocumentId(),o=this.coreState.core.documents[n];if(!(null==o?void 0:o.document))throw new Error(`Document ${n} not loaded`);this.dispatch(function(e,t){return{type:ji,payload:{documentId:e,rotation:t}}}(n,e)),this.dispatchCoreAction(Hn(e,n)),this.rotate$.emit({documentId:n,rotation:e})}getRotationForDocument(e){return this.getDocumentStateOrThrow(e).rotation}rotateForward(e){const t=e??this.getActiveDocumentId(),n=(this.getRotationForDocument(t)+1)%4;this.setRotationForDocument(n,t)}rotateBackward(e){const t=e??this.getActiveDocumentId(),n=(this.getRotationForDocument(t)+3)%4;this.setRotationForDocument(n,t)}getMatrixAsString(e){return function(e,t,n){const[o,r,a,i,s,l]=function(e,t,n){let o=1,r=0,a=0,i=1,s=0,l=0;switch(e){case 1:o=0,r=1,a=-1,i=0,s=n;break;case 2:o=-1,r=0,a=0,i=-1,s=t,l=n;break;case 3:o=0,r=-1,a=1,i=0,l=t}return[o,r,a,i,s,l]}(e,t,n);return`matrix(${o},${r},${a},${i},${s},${l})`}(e.rotation,e.width,e.height)}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];(null==o?void 0:o.rotation)!==r.rotation&&this.logger.debug("RotatePlugin","RotationChanged",`Rotation changed for document ${n}: ${(null==o?void 0:o.rotation)??0} -> ${r.rotation}`)}}async initialize(e){this.logger.info("RotatePlugin","Initialize","Rotate plugin initialized")}async destroy(){this.rotate$.clear(),super.destroy()}};Bi.id="rotate";let $i=Bi;const Ui={documents:{},activeDocumentId:null},Wi={manifest:Li,create:(e,t)=>new $i(Gi,e,t),reducer:(e=Ui,t)=>{switch(t.type){case Ni:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case zi:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"ROTATE/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case ji:{const{documentId:n,rotation:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,rotation:o}}}:e}default:return e}},initialState:Ui};function Hi({children:e,documentId:t,pageIndex:n,rotation:o,scale:r,style:a,...i}){var s,l,d,c;const{plugin:u}=fo($i.id),m=bo(t),p=null==(l=null==(s=null==m?void 0:m.document)?void 0:s.pages)?void 0:l[n],h=(null==(d=null==p?void 0:p.size)?void 0:d.width)??0,g=(null==(c=null==p?void 0:p.size)?void 0:c.height)??0,f=o??(null==m?void 0:m.rotation)??0,F=r??(null==m?void 0:m.scale)??1,P=(null==u?void 0:u.getMatrixAsString({width:h*F,height:g*F,rotation:f}))??"matrix(1, 0, 0, 1, 0, 0)";return p?We("div",{...i,style:{position:"absolute",transformOrigin:"0 0",transform:P,...a},children:e}):null}const Vi="SEARCH/INIT_STATE",Yi="SEARCH/CLEANUP_STATE",qi="SEARCH/START_SEARCH_SESSION",Ki="SEARCH/STOP_SEARCH_SESSION",Xi="SEARCH/SET_SEARCH_FLAGS",Zi="SEARCH/SET_SHOW_ALL_RESULTS",Qi="SEARCH/START_SEARCH",Ji="SEARCH/SET_SEARCH_RESULTS",es="SEARCH/APPEND_SEARCH_RESULTS",ts="SEARCH/SET_ACTIVE_RESULT_INDEX";function ns(e,t){return{type:Zi,payload:{documentId:e,showAll:t}}}function os(e,t,n,o){return{type:Ji,payload:{documentId:e,results:t,total:n,activeResultIndex:o}}}function rs(e,t){return{type:ts,payload:{documentId:e,index:t}}}const as={flags:[],results:[],total:0,activeResultIndex:-1,showAllResults:!0,query:"",loading:!1,active:!1},is={documents:{}},ss=(e,t,n)=>{const o=e.documents[t]||as;return{...e,documents:{...e.documents,[t]:{...o,...n}}}},ls=class extends Qn{constructor(e,t,n){super(e,t),this.searchStop$=lo(),this.searchStart$=lo(),this.searchResult$=lo(),this.searchActiveResultChange$=lo(),this.searchResultState$=lo(),this.searchState$=lo(),this.currentTask=new Map,this.pluginConfig=n}onDocumentLoadingStarted(e){const t={...as,flags:this.pluginConfig.flags||[],showAllResults:this.pluginConfig.showAllResults??!0};this.dispatch(function(e,t){return{type:Vi,payload:{documentId:e,state:t}}}(e,t))}onDocumentClosed(e){this.stopSearchSession(e),this.dispatch(function(e){return{type:Yi,payload:e}}(e)),this.currentTask.delete(e)}async initialize(){}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o!==r&&(this.searchState$.emit({documentId:n,state:r}),o&&o.results===r.results&&o.activeResultIndex===r.activeResultIndex&&o.showAllResults===r.showAllResults&&o.active===r.active||this.searchResultState$.emit({documentId:n,state:{results:r.results,activeResultIndex:r.activeResultIndex,showAllResults:r.showAllResults,active:r.active}}))}}buildCapability(){const e=e=>e??this.getActiveDocumentId(),t=t=>{const n=e(t),o=this.state.documents[n];if(!o)throw new Error(`Search state not found for document ${n}`);return o};return{startSearch:t=>this.startSearchSession(e(t)),stopSearch:t=>this.stopSearchSession(e(t)),searchAllPages:(t,n)=>this.searchAllPages(t,e(n)),nextResult:t=>this.nextResult(e(t)),previousResult:t=>this.previousResult(e(t)),goToResult:(t,n)=>this.goToResult(t,e(n)),setShowAllResults:(t,n)=>this.dispatch(ns(e(n),t)),getShowAllResults:e=>t(e).showAllResults,getFlags:e=>t(e).flags,setFlags:(t,n)=>this.setFlags(t,e(n)),getState:e=>t(e),forDocument:this.createSearchScope.bind(this),onSearchResult:this.searchResult$.on,onSearchStart:this.searchStart$.on,onSearchStop:this.searchStop$.on,onActiveResultChange:this.searchActiveResultChange$.on,onSearchResultStateChange:this.searchResultState$.on,onStateChange:this.searchState$.on}}createSearchScope(e){const t=()=>{const t=this.state.documents[e];if(!t)throw new Error(`Search state not found for document ${e}`);return t};return{startSearch:()=>this.startSearchSession(e),stopSearch:()=>this.stopSearchSession(e),searchAllPages:t=>this.searchAllPages(t,e),nextResult:()=>this.nextResult(e),previousResult:()=>this.previousResult(e),goToResult:t=>this.goToResult(t,e),setShowAllResults:t=>this.dispatch(ns(e,t)),getShowAllResults:()=>t().showAllResults,getFlags:()=>t().flags,setFlags:t=>this.setFlags(t,e),getState:t,onSearchResult:t=>this.searchResult$.on(n=>{n.documentId===e&&t(n.results)}),onSearchStart:t=>this.searchStart$.on(n=>{n.documentId===e&&t()}),onSearchStop:t=>this.searchStop$.on(n=>{n.documentId===e&&t()}),onActiveResultChange:t=>this.searchActiveResultChange$.on(n=>{n.documentId===e&&t(n.index)}),onSearchResultStateChange:t=>this.searchResultState$.on(n=>{n.documentId===e&&t(n.state)}),onStateChange:t=>this.searchState$.on(n=>{n.documentId===e&&t(n.state)})}}setFlags(e,t){this.dispatch(function(e,t){return{type:Xi,payload:{documentId:e,flags:t}}}(t,e));const n=this.state.documents[t];(null==n?void 0:n.active)&&this.searchAllPages(n.query,t,!0)}notifySearchStart(e){this.searchStart$.emit({documentId:e})}notifySearchStop(e){this.searchStop$.emit({documentId:e})}notifyActiveResultChange(e,t){this.searchActiveResultChange$.emit({documentId:e,index:t})}startSearchSession(e){this.getCoreDocument(e)&&(this.dispatch(function(e){return{type:qi,payload:{documentId:e}}}(e)),this.notifySearchStart(e))}stopSearchSession(e){var t;const n=this.state.documents[e];if(!(null==n?void 0:n.active))return;const o=this.currentTask.get(e);if(o){try{null==(t=o.abort)||t.call(o,{code:Ut.Cancelled,message:"search stopped"})}catch{}this.currentTask.delete(e)}this.dispatch(function(e){return{type:Ki,payload:{documentId:e}}}(e)),this.notifySearchStop(e)}searchAllPages(e,t,n=!1){var o;const r=this.state.documents[t];if(!r)return Wt.reject({code:Ut.NotFound,message:"Search state not initialized"});const a=this.getCoreDocument(t);if(!(null==a?void 0:a.document))return Wt.reject({code:Ut.NotFound,message:"Document not loaded"});const i=e.trim();if(r.query===i&&!n)return Wt.resolve({results:r.results,total:r.total});const s=this.currentTask.get(t);if(s){try{null==(o=s.abort)||o.call(s,{code:Ut.Cancelled,message:"new search"})}catch{}this.currentTask.delete(t)}if(this.dispatch(function(e,t){return{type:Qi,payload:{documentId:e,query:t}}}(t,i)),!i)return this.dispatch(os(t,[],0,-1)),Wt.resolve({results:[],total:0});r.active||this.startSearchSession(t);const l=this.engine.searchAllPages(a.document,i,{flags:r.flags});return this.currentTask.set(t,l),l.onProgress(e=>{var n;(null==(n=null==e?void 0:e.results)?void 0:n.length)&&this.currentTask.get(t)===l&&(this.dispatch(function(e,t){return{type:es,payload:{documentId:e,results:t}}}(t,e.results)),-1===this.state.documents[t].activeResultIndex&&(this.dispatch(rs(t,0)),this.notifyActiveResultChange(t,0)))}),l.wait(e=>{this.currentTask.delete(t);const n=e.total>0?0:-1;this.dispatch(os(t,e.results,e.total,n)),this.searchResult$.emit({documentId:t,results:e}),e.total>0&&this.notifyActiveResultChange(t,0)},e=>{var n;(null==(n=null==e?void 0:e.reason)?void 0:n.code)!==Ut.Cancelled&&(console.error("Error during search:",e),this.dispatch(os(t,[],0,-1))),this.currentTask.delete(t)}),l}nextResult(e){const t=this.state.documents[e];if(!t||0===t.results.length)return-1;const n=t.activeResultIndex>=t.results.length-1?0:t.activeResultIndex+1;return this.goToResult(n,e)}previousResult(e){const t=this.state.documents[e];if(!t||0===t.results.length)return-1;const n=t.activeResultIndex<=0?t.results.length-1:t.activeResultIndex-1;return this.goToResult(n,e)}goToResult(e,t){const n=this.state.documents[t];return!n||0===n.results.length||e<0||e>=n.results.length?-1:(this.dispatch(rs(t,e)),this.notifyActiveResultChange(t,e),e)}async destroy(){for(const e of Object.keys(this.state.documents))this.stopSearchSession(e);this.searchResult$.clear(),this.searchStart$.clear(),this.searchStop$.clear(),this.searchActiveResultChange$.clear(),this.searchResultState$.clear(),this.searchState$.clear(),super.destroy()}};ls.id="search";let ds=ls;const cs="search",us={manifest:{id:cs,name:"Search Plugin",version:"1.0.0",provides:["search"],requires:[],optional:[],defaultConfig:{flags:[]}},create:(e,t)=>new ds(cs,e,t),reducer:(e=is,t)=>{switch(t.type){case Vi:return{...e,documents:{...e.documents,[t.payload.documentId]:t.payload.state}};case Yi:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r}}case qi:return ss(e,t.payload.documentId,{active:!0});case Ki:return ss(e,t.payload.documentId,{results:[],total:0,activeResultIndex:-1,query:"",loading:!1,active:!1});case Xi:return ss(e,t.payload.documentId,{flags:t.payload.flags});case Zi:return ss(e,t.payload.documentId,{showAllResults:t.payload.showAll});case Qi:return ss(e,t.payload.documentId,{loading:!0,query:t.payload.query,results:[],total:0,activeResultIndex:-1});case es:{const{documentId:n,results:o}=t.payload,r=e.documents[n];if(!r)return e;const a=[...r.results,...o],i=-1===r.activeResultIndex&&a.length>0?0:r.activeResultIndex;return ss(e,n,{results:a,total:a.length,activeResultIndex:i,loading:!0})}case Ji:{const{documentId:n,results:o,total:r,activeResultIndex:a}=t.payload;return ss(e,n,{results:o,total:r,activeResultIndex:a,loading:!1})}case ts:return ss(e,t.payload.documentId,{activeResultIndex:t.payload.index});default:return e}},initialState:is},ms=()=>Fo(ds.id);function ps({documentId:e,pageIndex:t,scale:n,style:o,highlightColor:r="#FFFF00",activeHighlightColor:a="#FFBF00",...i}){const{provides:s}=ms(),[l,d]=Ee(null),c=bo(e),u=Ie(()=>null==s?void 0:s.forDocument(e),[s,e]),m=Ie(()=>void 0!==n?n:(null==c?void 0:c.scale)??1,[n,null==c?void 0:c.scale]);return Me(()=>{if(!u)return void d(null);const e=u.getState();return d({results:e.results,activeResultIndex:e.activeResultIndex,showAllResults:e.showAllResults,active:e.active}),u.onSearchResultStateChange(e=>{d(e)})},[u]),l&&l.active?We("div",{style:{...o,pointerEvents:"none"},...i,children:l.results.map((e,t)=>({result:e,originalIndex:t})).filter(({result:e})=>e.pageIndex===t).filter(({originalIndex:e})=>l.showAllResults||e===l.activeResultIndex).map(({result:e,originalIndex:t})=>e.rects.map((e,n)=>We("div",{style:{position:"absolute",top:e.origin.y*m,left:e.origin.x*m,width:e.size.width*m,height:e.size.height*m,backgroundColor:t===l.activeResultIndex?a:r,mixBlendMode:"multiply",transform:"scale(1.02)",transformOrigin:"center",transition:"opacity .3s ease-in-out",opacity:1}},`${t}-${n}`)))}):null}const hs="selection",gs={id:hs,name:"Selection Plugin",version:"1.0.0",provides:["selection"],requires:["interaction-manager"],optional:["viewport","scroll"],defaultConfig:{menuHeight:40}},fs="SELECTION/INIT_STATE",Fs="SELECTION/CLEANUP_STATE",Ps="SELECTION/CACHE_PAGE_GEOMETRY",bs="SELECTION/SET_SELECTION",_s="SELECTION/START_SELECTION",vs="SELECTION/END_SELECTION",ys="SELECTION/CLEAR_SELECTION",Ds="SELECTION/SET_RECTS",xs="SELECTION/SET_SLICES",As={geometry:{},rects:{},slices:{},selection:null,active:!1,selecting:!1},ws={documents:{}},Ss=(e,t,n)=>({...e,documents:{...e.documents,[t]:n}});function Es(e,t){return e.rects[t]??[]}function Cs(e,t){return it(Es(e,t))}function Ms(e){const t=[],n=e.rects;for(const e in n){const o=Number(e),r=it(n[o]);r&&t.push({page:o,rect:r})}return t}function ks(e,t){const n=e.rects[t]||[];if(0===n.length)return null;const o=Cs(e,t);return o?{pageIndex:t,rect:o,segmentRects:n}:null}function Ts(e){const t=[],n=Object.keys(e.rects).map(Number);for(const o of n){const n=e.rects[o]||[];if(0===n.length)continue;const r=Cs(e,o);r&&t.push({pageIndex:o,rect:r,segmentRects:n})}return t}function Is(e,t){for(const n of e.runs){if(!(t.y>=n.rect.y&&t.y<=n.rect.y+n.rect.height&&t.x>=n.rect.x&&t.x<=n.rect.x+n.rect.width))continue;const e=n.glyphs.findIndex(e=>t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height);if(-1!==e)return n.charStart+e}return-1}function Os(e,t,n){if(!e||!t)return null;if(n<e.start.page||n>e.end.page)return null;const o=n===e.start.page?e.start.index:0,r=t.runs[t.runs.length-1],a=r.charStart+r.glyphs.length-1;return{from:o,to:n===e.end.page?e.end.index:a}}function Rs(e,t,n,o=!0){const r=[];for(const o of e.runs){const e=o.charStart,a=e+o.glyphs.length-1;if(a<t||e>n)continue;const i=Math.max(t,e)-e,s=Math.min(n,a)-e;let l=1/0,d=-1/0,c=1/0,u=-1/0,m=0;for(let e=i;e<=s;e++){const t=o.glyphs[e];2!==t.flags&&(l=Math.min(l,t.x),d=Math.max(d,t.x+t.width),c=Math.min(c,t.y),u=Math.max(u,t.y+t.height),m++)}l!==1/0&&m>0&&r.push({rect:{origin:{x:l,y:c},size:{width:d-l,height:u-c}},charCount:m})}return o?function(e){const t=[];let n=null,o=null;for(const r of e)n&&o?Ns(n,r)?o=Gs(o,r.rect):(t.push(o),o=r.rect):o=r.rect,n=r;return o&&!Ls(o)&&t.push(o),t}(r):r.map(e=>e.rect)}function Gs(e,t){const n=Math.min(e.origin.x,t.origin.x),o=Math.min(e.origin.y,t.origin.y);return{origin:{x:n,y:o},size:{width:Math.max(e.origin.x+e.size.width,t.origin.x+t.size.width)-n,height:Math.max(e.origin.y+e.size.height,t.origin.y+t.size.height)-o}}}function Ls(e){return e.size.width<=0||e.size.height<=0}function Ns(e,t){const n=e.rect,o=t.rect;if(function(e,t){if(Ls(e)||Ls(t))return 0;const n=Gs(e,t);if(n.size.height===e.size.height||n.size.height===t.size.height)return 1;const o=function(e,t){const n=Math.max(e.origin.x,t.origin.x),o=Math.max(e.origin.y,t.origin.y),r=Math.min(e.origin.x+e.size.width,t.origin.x+t.size.width),a=Math.min(e.origin.y+e.size.height,t.origin.y+t.size.height);return{origin:{x:n,y:o},size:{width:Math.max(0,r-n),height:Math.max(0,a-o)}}}(e,t);return o.size.height/n.size.height}(n,o)<.8)return!1;const r=1*n.size.width/e.charCount,a=1*o.size.width/t.charCount,i=n.origin.x-r,s=n.origin.x+n.size.width+r,l=o.origin.x-a;return i<o.origin.x+o.size.width+a&&s>l}const zs=class extends Qn{constructor(e,t,n){var o,r,a;super(e,t),this.enabledModesPerDoc=new Map,this.selecting=new Map,this.anchor=new Map,this.pageCallbacks=new Map,this.menuPlacement$=co((e,t)=>({documentId:e,placement:t})),this.selChange$=co((e,t)=>({documentId:e,selection:t})),this.textRetrieved$=co((e,t)=>({documentId:e,text:t})),this.copyToClipboard$=co((e,t)=>({documentId:e,text:t}),{cache:!1}),this.beginSelection$=co((e,t)=>({documentId:e,page:t.page,index:t.index}),{cache:!1}),this.endSelection$=co(e=>({documentId:e}),{cache:!1}),this.viewportCapability=null,this.scrollCapability=null,this.menuHeight=n.menuHeight??40;const i=t.getPlugin("interaction-manager");if(!i)throw new Error("SelectionPlugin: InteractionManagerPlugin is required.");this.interactionManagerCapability=i.provides(),this.viewportCapability=(null==(o=t.getPlugin("viewport"))?void 0:o.provides())??null,this.scrollCapability=(null==(r=t.getPlugin("scroll"))?void 0:r.provides())??null,this.coreStore.onAction(Nn,e=>{const{documentId:t,pageIndexes:n}=e.payload,o=n.map(e=>this.getNewPageGeometryAndCache(t,e));ft.all(o).wait(()=>{n.forEach(e=>{this.notifyPage(t,e)})},yn)}),null==(a=this.viewportCapability)||a.onViewportChange(e=>{this.recalculateMenuPlacement(e.documentId)},{mode:"throttle",wait:100})}onDocumentLoadingStarted(e){this.dispatch(((e,t)=>({type:fs,payload:{documentId:e,state:t}}))(e,As)),this.enabledModesPerDoc.set(e,new Set(["pointerMode"])),this.pageCallbacks.set(e,new Map),this.selecting.set(e,!1),this.anchor.set(e,void 0)}onDocumentClosed(e){this.dispatch((e=>({type:Fs,payload:e}))(e)),this.enabledModesPerDoc.delete(e),this.pageCallbacks.delete(e),this.selecting.delete(e),this.anchor.delete(e),this.selChange$.clearScope(e),this.textRetrieved$.clearScope(e),this.copyToClipboard$.clearScope(e),this.beginSelection$.clearScope(e),this.endSelection$.clearScope(e),this.menuPlacement$.clearScope(e)}async initialize(){}async destroy(){this.selChange$.clear(),this.textRetrieved$.clear(),this.copyToClipboard$.clear(),this.beginSelection$.clear(),this.endSelection$.clear(),this.menuPlacement$.clear(),super.destroy()}buildCapability(){const e=e=>e??this.getActiveDocumentId();return{getFormattedSelection:t=>Ts(this.getDocumentState(e(t))),getFormattedSelectionForPage:(t,n)=>ks(this.getDocumentState(e(n)),t),getHighlightRectsForPage:(t,n)=>Es(this.getDocumentState(e(n)),t),getHighlightRects:t=>this.getDocumentState(e(t)).rects,getBoundingRectForPage:(t,n)=>Cs(this.getDocumentState(e(n)),t),getBoundingRects:t=>Ms(this.getDocumentState(e(t))),getSelectedText:t=>this.getSelectedText(e(t)),clear:t=>this.clearSelection(e(t)),copyToClipboard:t=>this.copyToClipboard(e(t)),getState:t=>this.getDocumentState(e(t)),enableForMode:(t,n)=>{var o;return null==(o=this.enabledModesPerDoc.get(e(n)))?void 0:o.add(t)},isEnabledForMode:(t,n)=>{var o;return(null==(o=this.enabledModesPerDoc.get(e(n)))?void 0:o.has(t))??!1},forDocument:this.createSelectionScope.bind(this),onCopyToClipboard:this.copyToClipboard$.onGlobal,onSelectionChange:this.selChange$.onGlobal,onTextRetrieved:this.textRetrieved$.onGlobal,onBeginSelection:this.beginSelection$.onGlobal,onEndSelection:this.endSelection$.onGlobal}}createSelectionScope(e){return{getFormattedSelection:()=>Ts(this.getDocumentState(e)),getFormattedSelectionForPage:t=>ks(this.getDocumentState(e),t),getHighlightRectsForPage:t=>Es(this.getDocumentState(e),t),getHighlightRects:()=>this.getDocumentState(e).rects,getBoundingRectForPage:t=>Cs(this.getDocumentState(e),t),getBoundingRects:()=>Ms(this.getDocumentState(e)),getSelectedText:()=>this.getSelectedText(e),clear:()=>this.clearSelection(e),copyToClipboard:()=>this.copyToClipboard(e),getState:()=>this.getDocumentState(e),onSelectionChange:this.selChange$.forScope(e),onTextRetrieved:this.textRetrieved$.forScope(e),onCopyToClipboard:this.copyToClipboard$.forScope(e),onBeginSelection:this.beginSelection$.forScope(e),onEndSelection:this.endSelection$.forScope(e)}}getDocumentState(e){const t=this.state.documents[e];if(!t)throw new Error(`Selection state not found for document: ${e}`);return t}onMenuPlacement(e,t){return this.menuPlacement$.forScope(e)(t)}registerSelectionOnPage(e){var t;const{documentId:n,pageIndex:o,onRectsChange:r}=e,a=this.state.documents[n];if(!a)return this.logger.warn("SelectionPlugin","RegisterFailed",`Cannot register selection on page ${o} for document ${n}: document state not initialized.`),()=>{};null==(t=this.pageCallbacks.get(n))||t.set(o,r);const i=this.getOrLoadGeometry(n,o),s=this.interactionManagerCapability.forDocument(n),l=this.enabledModesPerDoc.get(n);r({rects:Es(a,o),boundingRect:Cs(a,o)});const d={onPointerDown:(e,t,r)=>{if(!(null==l?void 0:l.has(r)))return;this.clearSelection(n);const a=this.getDocumentState(n).geometry[o];if(a){const t=Is(a,e);-1!==t&&this.beginSelection(n,o,t)}},onPointerMove:(e,t,r)=>{if(!(null==l?void 0:l.has(r)))return;const a=this.getDocumentState(n).geometry[o];if(a){const t=Is(a,e);-1!==t?s.setCursor("selection-text","text",10):s.removeCursor("selection-text"),this.selecting.get(n)&&-1!==t&&this.updateSelection(n,o,t)}},onPointerUp:(e,t,o)=>{(null==l?void 0:l.has(o))&&this.endSelection(n)},onHandlerActiveEnd:e=>{(null==l?void 0:l.has(e))&&this.clearSelection(n)}},c=this.interactionManagerCapability.registerAlways({scope:{type:"page",documentId:n,pageIndex:o},handlers:d});return()=>{var e;c(),null==(e=this.pageCallbacks.get(n))||e.delete(o),i.abort({code:Ut.Cancelled,message:"Cleanup"})}}getPlacementMetrics(e,t,n,o){var r;const a=null==(r=this.scrollCapability)?void 0:r.forDocument(e),i=null==a?void 0:a.getRectPositionForPage(t,n);if(!i)return null;const s=i.origin.y-o.scrollTop,l=i.origin.y+i.size.height-o.scrollTop;return{pageIndex:t,rect:n,spaceAbove:s,spaceBelow:o.clientHeight-l,isBottomVisible:l>0&&l<=o.clientHeight,isTopVisible:s>=0&&s<o.clientHeight}}recalculateMenuPlacement(e){const t=this.state.documents[e];if(!t)return;if(t.selecting||null===t.selection)return void this.menuPlacement$.emit(e,null);const n=Ms(t);if(0===n.length)return void this.menuPlacement$.emit(e,null);const o=n[n.length-1];if(!this.viewportCapability||!this.scrollCapability)return void this.menuPlacement$.emit(e,{pageIndex:o.page,rect:o.rect,spaceAbove:0,spaceBelow:1/0,suggestTop:!1,isVisible:!0});const r=this.viewportCapability.forDocument(e).getMetrics(),a=n[0],i=this.getPlacementMetrics(e,o.page,o.rect,r),s=this.getPlacementMetrics(e,a.page,a.rect,r);i&&i.isBottomVisible&&i.spaceBelow>this.menuHeight?this.menuPlacement$.emit(e,{...i,suggestTop:!1,isVisible:!0}):s&&s.isTopVisible?this.menuPlacement$.emit(e,{...s,suggestTop:!0,isVisible:!0}):i&&i.isBottomVisible?this.menuPlacement$.emit(e,{...i,suggestTop:!1,isVisible:!0}):this.menuPlacement$.emit(e,null)}notifyPage(e,t){var n;const o=null==(n=this.pageCallbacks.get(e))?void 0:n.get(t);if(o){const n=this.getDocumentState(e);o("pointerMode"===this.interactionManagerCapability.forDocument(e).getActiveMode()?{rects:Es(n,t),boundingRect:Cs(n,t)}:{rects:[],boundingRect:null})}}notifyAllPages(e){var t;null==(t=this.pageCallbacks.get(e))||t.forEach((t,n)=>{this.notifyPage(e,n)})}getNewPageGeometryAndCache(e,t){const n=this.getCoreDocument(e);if(!n||!n.document)return Wt.reject({code:Ut.NotFound,message:"Doc Not Found"});const o=n.document.pages.find(e=>e.index===t),r=this.engine.getPageGeometry(n.document,o);return r.wait(n=>{this.dispatch(((e,t,n)=>({type:Ps,payload:{documentId:e,page:t,geo:n}}))(e,t,n))},yn),r}getOrLoadGeometry(e,t){const n=this.getDocumentState(e).geometry[t];return n?Wt.resolve(n):this.getNewPageGeometryAndCache(e,t)}beginSelection(e,t,n){this.selecting.set(e,!0),this.anchor.set(e,{page:t,index:n}),this.dispatch((e=>({type:_s,payload:{documentId:e}}))(e)),this.beginSelection$.emit(e,{page:t,index:n}),this.recalculateMenuPlacement(e)}endSelection(e){this.selecting.set(e,!1),this.anchor.set(e,void 0),this.dispatch((e=>({type:vs,payload:{documentId:e}}))(e)),this.endSelection$.emit(e),this.recalculateMenuPlacement(e)}clearSelection(e){this.selecting.set(e,!1),this.anchor.set(e,void 0),this.dispatch((e=>({type:ys,payload:{documentId:e}}))(e)),this.selChange$.emit(e,null),this.menuPlacement$.emit(e,null),this.notifyAllPages(e)}updateSelection(e,t,n){if(!this.selecting.get(e)||!this.anchor.get(e))return;const o=this.anchor.get(e),r=t>o.page||t===o.page&&n>=o.index,a={start:r?o:{page:t,index:n},end:r?{page:t,index:n}:o};this.dispatch(((e,t)=>({type:bs,payload:{documentId:e,selection:t}}))(e,a)),this.updateRectsAndSlices(e,a),this.selChange$.emit(e,a);for(let t=a.start.page;t<=a.end.page;t++)this.notifyPage(e,t)}updateRectsAndSlices(e,t){const n=this.getDocumentState(e),o={},r={};for(let e=t.start.page;e<=t.end.page;e++){const a=n.geometry[e],i=Os(t,a,e);i&&(o[e]=Rs(a,i.from,i.to),r[e]={start:i.from,count:i.to-i.from+1})}this.dispatch(((e,t)=>({type:Ds,payload:{documentId:e,rects:t}}))(e,o)),this.dispatch(((e,t)=>({type:xs,payload:{documentId:e,slices:t}}))(e,r))}getSelectedText(e){const t=this.getCoreDocument(e),n=this.getDocumentState(e);if(!(null==t?void 0:t.document)||!n.selection)return Wt.reject({code:Ut.NotFound,message:"Doc Not Found or No Selection"});const o=n.selection,r=[];for(let e=o.start.page;e<=o.end.page;e++){const t=n.slices[e];t&&r.push({pageIndex:e,charIndex:t.start,charCount:t.count})}if(0===r.length)return Wt.resolve([]);const a=this.engine.getTextSlices(t.document,r);return a.wait(t=>{this.textRetrieved$.emit(e,t)},yn),a}copyToClipboard(e){this.getSelectedText(e).wait(t=>{this.copyToClipboard$.emit(e,t.join("\n"))},yn)}};zs.id="selection";let js=zs;const Bs={manifest:gs,create:(e,t)=>new js(hs,e,t),reducer:(e=ws,t)=>{switch(t.type){case fs:{const{documentId:n,state:o}=t.payload;return Ss(e,n,o)}case Fs:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r}}case Ps:{const{documentId:n,page:o,geo:r}=t.payload,a=e.documents[n];return a?Ss(e,n,{...a,geometry:{...a.geometry,[o]:r}}):e}case bs:{const{documentId:n,selection:o}=t.payload,r=e.documents[n];return r?Ss(e,n,{...r,selection:o,active:!0}):e}case _s:{const{documentId:n}=t.payload,o=e.documents[n];return o?Ss(e,n,{...o,selecting:!0,selection:null,rects:{}}):e}case vs:{const{documentId:n}=t.payload,o=e.documents[n];return o?Ss(e,n,{...o,selecting:!1}):e}case ys:{const{documentId:n}=t.payload,o=e.documents[n];return o?Ss(e,n,{...o,selecting:!1,selection:null,rects:{},active:!1}):e}case Ds:{const{documentId:n,rects:o}=t.payload,r=e.documents[n];return r?Ss(e,n,{...r,rects:o}):e}case xs:{const{documentId:n,slices:o}=t.payload,r=e.documents[n];return r?Ss(e,n,{...r,slices:o}):e}case"SELECTION/RESET":{const{documentId:n}=t.payload;return e.documents[n]?Ss(e,n,As):e}default:return e}},initialState:ws},$s="onDblClick";function Us({children:e,...t}){const{rect:n,rotation:o}=t,{matrix:r,width:a,height:i}=function(e,t){const{width:n,height:o}=e.size;switch(t%4){case 1:return{matrix:`matrix(0, -1, 1, 0, 0, ${o})`,width:o,height:n};case 2:return{matrix:`matrix(-1, 0, 0, -1, ${n}, ${o})`,width:n,height:o};case 3:return{matrix:`matrix(0, 1, -1, 0, ${n}, 0)`,width:o,height:n};default:return{matrix:"matrix(1, 0, 0, 1, 0, 0)",width:n,height:o}}}(n,o),s=Te(null);return Me(()=>{const e=s.current;if(!e)return;const t=e=>{e.stopPropagation()},n=e=>{e.stopPropagation()};return e.addEventListener("pointerdown",t,{capture:!0}),e.addEventListener("touchstart",n,{capture:!0}),()=>{e.removeEventListener("pointerdown",t,{capture:!0}),e.removeEventListener("touchstart",n,{capture:!0})}},[]),We(H,{children:e({menuWrapperProps:{style:{position:"absolute",left:n.origin.x,top:n.origin.y,transform:r,transformOrigin:"0 0",width:a,height:i,pointerEvents:"none",zIndex:3},ref:e=>{s.current=e}},matrix:r,rect:{origin:{x:n.origin.x,y:n.origin.y},size:{width:a,height:i}}})})}class Ws{constructor(e,t){this.config=e,this.onUpdate=t,this.state="idle",this.startPoint=null,this.startElement=null,this.activeHandle=null,this.currentPosition=null,this.activeVertexIndex=null,this.startVertices=[],this.currentVertices=[],this.currentVertices=e.vertices||[]}updateConfig(e){this.config={...this.config,...e},this.currentVertices=e.vertices||[]}startDrag(e,t){this.state="dragging",this.startPoint={x:e,y:t},this.startElement={...this.config.element},this.currentPosition={...this.config.element},this.onUpdate({state:"start",transformData:{type:"move",changes:{rect:this.startElement}}})}startResize(e,t,n){this.state="resizing",this.activeHandle=e,this.startPoint={x:t,y:n},this.startElement={...this.config.element},this.currentPosition={...this.config.element},this.onUpdate({state:"start",transformData:{type:"resize",changes:{rect:this.startElement},metadata:{handle:this.activeHandle,maintainAspectRatio:this.config.maintainAspectRatio}}})}startVertexEdit(e,t,n){this.currentVertices=[...this.config.vertices??this.currentVertices],e<0||e>=this.currentVertices.length||(this.state="vertex-editing",this.activeVertexIndex=e,this.startPoint={x:t,y:n},this.startVertices=[...this.currentVertices],this.onUpdate({state:"start",transformData:{type:"vertex-edit",changes:{vertices:this.startVertices},metadata:{vertexIndex:e}}}))}move(e,t){if("idle"!==this.state&&this.startPoint)if("dragging"===this.state&&this.startElement){const n=this.calculateDelta(e,t),o=this.calculateDragPosition(n);this.currentPosition=o,this.onUpdate({state:"move",transformData:{type:"move",changes:{rect:o}}})}else if("resizing"===this.state&&this.activeHandle&&this.startElement){const n=this.calculateDelta(e,t),o=this.calculateResizePosition(n,this.activeHandle);this.currentPosition=o,this.onUpdate({state:"move",transformData:{type:"resize",changes:{rect:o},metadata:{handle:this.activeHandle,maintainAspectRatio:this.config.maintainAspectRatio}}})}else if("vertex-editing"===this.state&&null!==this.activeVertexIndex){const n=this.calculateVertexPosition(e,t);this.currentVertices=n,this.onUpdate({state:"move",transformData:{type:"vertex-edit",changes:{vertices:n},metadata:{vertexIndex:this.activeVertexIndex}}})}}end(){if("idle"===this.state)return;const e=this.state,t=this.activeHandle,n=this.activeVertexIndex;if("vertex-editing"===e)this.onUpdate({state:"end",transformData:{type:"vertex-edit",changes:{vertices:this.currentVertices},metadata:{vertexIndex:n||void 0}}});else{const n=this.getCurrentPosition();this.onUpdate({state:"end",transformData:{type:"dragging"===e?"move":"resize",changes:{rect:n},metadata:"dragging"===e?void 0:{handle:t||void 0,maintainAspectRatio:this.config.maintainAspectRatio}}})}this.reset()}cancel(){"idle"!==this.state&&("vertex-editing"===this.state?this.onUpdate({state:"end",transformData:{type:"vertex-edit",changes:{vertices:this.startVertices},metadata:{vertexIndex:this.activeVertexIndex||void 0}}}):this.startElement&&this.onUpdate({state:"end",transformData:{type:"dragging"===this.state?"move":"resize",changes:{rect:this.startElement},metadata:"dragging"===this.state?void 0:{handle:this.activeHandle||void 0,maintainAspectRatio:this.config.maintainAspectRatio}}}),this.reset())}reset(){this.state="idle",this.startPoint=null,this.startElement=null,this.activeHandle=null,this.currentPosition=null,this.activeVertexIndex=null,this.startVertices=[]}getCurrentPosition(){return this.currentPosition||this.config.element}calculateDelta(e,t){if(!this.startPoint)return{x:0,y:0};const n={x:e-this.startPoint.x,y:t-this.startPoint.y};return this.transformDelta(n)}transformDelta(e){const{pageRotation:t=0,scale:n=1}=this.config,o=t*Math.PI/2,r=Math.cos(o),a=Math.sin(o),i=e.x/n,s=e.y/n;return{x:r*i+a*s,y:-a*i+r*s}}clampPoint(e){var t;const n=null==(t=this.config.constraints)?void 0:t.boundingBox;return n?{x:Math.max(0,Math.min(e.x,n.width)),y:Math.max(0,Math.min(e.y,n.height))}:e}calculateVertexPosition(e,t){if(null===this.activeVertexIndex)return this.startVertices;const n=this.calculateDelta(e,t),o=[...this.startVertices],r=o[this.activeVertexIndex],a={x:r.x+n.x,y:r.y+n.y};return o[this.activeVertexIndex]=this.clampPoint(a),o}calculateDragPosition(e){if(!this.startElement)return this.config.element;const t={origin:{x:this.startElement.origin.x+e.x,y:this.startElement.origin.y+e.y},size:{width:this.startElement.size.width,height:this.startElement.size.height}};return this.applyConstraints(t)}calculateResizePosition(e,t){if(!this.startElement)return this.config.element;const n=function(e){return{x:e.includes("e")?"left":e.includes("w")?"right":"center",y:e.includes("s")?"top":e.includes("n")?"bottom":"center"}}(t),o=this.startElement.size.width/this.startElement.size.height||1;let r=this.applyResizeDelta(e,n);return this.config.maintainAspectRatio&&(r=this.enforceAspectRatio(r,n,o)),r=this.clampToBounds(r,n,o),this.applyConstraints(r)}applyResizeDelta(e,t){const n=this.startElement;let o=n.origin.x,r=n.origin.y,a=n.size.width,i=n.size.height;return"left"===t.x?a+=e.x:"right"===t.x&&(o+=e.x,a-=e.x),"top"===t.y?i+=e.y:"bottom"===t.y&&(r+=e.y,i-=e.y),{origin:{x:o,y:r},size:{width:a,height:i}}}enforceAspectRatio(e,t,n){const o=this.startElement;let{x:r,y:a}=e.origin,{width:i,height:s}=e.size;return"center"===t.x||"center"===t.y?"center"===t.y?(s=i/n,a=o.origin.y+(o.size.height-s)/2):(i=s*n,r=o.origin.x+(o.size.width-i)/2):Math.abs(i-o.size.width)>=Math.abs(s-o.size.height)?s=i/n:i=s*n,"right"===t.x&&(r=o.origin.x+o.size.width-i),"bottom"===t.y&&(a=o.origin.y+o.size.height-s),{origin:{x:r,y:a},size:{width:i,height:s}}}clampToBounds(e,t,n){var o;const r=null==(o=this.config.constraints)?void 0:o.boundingBox;if(!r)return e;const a=this.startElement;let{x:i,y:s}=e.origin,{width:l,height:d}=e.size;l=Math.max(1,l),d=Math.max(1,d);const c="left"===t.x?a.origin.x:a.origin.x+a.size.width,u="top"===t.y?a.origin.y:a.origin.y+a.size.height,m="left"===t.x?r.width-c:"right"===t.x?c:2*Math.min(a.origin.x,r.width-a.origin.x-a.size.width)+a.size.width,p="top"===t.y?r.height-u:"bottom"===t.y?u:2*Math.min(a.origin.y,r.height-a.origin.y-a.size.height)+a.size.height;if(this.config.maintainAspectRatio){const e=l>m?m/l:1,t=d>p?p/d:1,n=Math.min(e,t);n<1&&(l*=n,d*=n)}else l=Math.min(l,m),d=Math.min(d,p);return i="left"===t.x?c:"right"===t.x?c-l:a.origin.x+(a.size.width-l)/2,s="top"===t.y?u:"bottom"===t.y?u-d:a.origin.y+(a.size.height-d)/2,i=Math.max(0,Math.min(i,r.width-l)),s=Math.max(0,Math.min(s,r.height-d)),{origin:{x:i,y:s},size:{width:l,height:d}}}applyConstraints(e){const{constraints:t}=this.config;if(!t)return e;let{origin:{x:n,y:o},size:{width:r,height:a}}=e;const i=t.minWidth??1,s=t.minHeight??1,l=t.maxWidth,d=t.maxHeight;if(this.config.maintainAspectRatio&&r>0&&a>0){const e=r/a;r<i&&(r=i,a=r/e),a<s&&(a=s,r=a*e),void 0!==l&&r>l&&(r=l,a=r/e),void 0!==d&&a>d&&(a=d,r=a*e)}else r=Math.max(i,r),a=Math.max(s,a),void 0!==l&&(r=Math.min(l,r)),void 0!==d&&(a=Math.min(d,a));return t.boundingBox&&(n=Math.max(0,Math.min(n,t.boundingBox.width-r)),o=Math.max(0,Math.min(o,t.boundingBox.height-a))),{origin:{x:n,y:o},size:{width:r,height:a}}}}function Hs(e,t){return"n"===e||"s"===e?"ns-resize":"e"===e||"w"===e?"ew-resize":t%2==0?{nw:"nwse-resize",ne:"nesw-resize",sw:"nesw-resize",se:"nwse-resize"}[e]:{nw:"nesw-resize",ne:"nwse-resize",sw:"nwse-resize",se:"nesw-resize"}[e]}function Vs(e,t,n){const o=-e/2;return"center"===n?o:"outside"===n?o-t:o+t}const Ys=()=>Fo(js.id);function qs({documentId:e,pageIndex:t,scale:n,rotation:o,background:r="rgba(33,150,243)",selectionMenu:a}){const{plugin:i}=fo(js.id),s=bo(e),[l,d]=Ee([]),[c,u]=Ee(null),[m,p]=Ee(null);Me(()=>{if(i&&e)return i.registerSelectionOnPage({documentId:e,pageIndex:t,onRectsChange:({rects:e,boundingRect:t})=>{d(e),u(t)}})},[i,e,t]),Me(()=>{if(i&&e)return i.onMenuPlacement(e,e=>{p(e)})},[i,e]);const h=Ie(()=>void 0!==n?n:(null==s?void 0:s.scale)??1,[n,null==s?void 0:s.scale]),g=Ie(()=>void 0!==o?o:(null==s?void 0:s.rotation)??He.Degree0,[o,null==s?void 0:s.rotation]),f=a&&m&&m.pageIndex===t&&m.isVisible;return c?We(H,{children:[We("div",{style:{position:"absolute",left:c.origin.x*h,top:c.origin.y*h,width:c.size.width*h,height:c.size.height*h,mixBlendMode:"multiply",isolation:"isolate",pointerEvents:"none"},children:l.map((e,t)=>We("div",{style:{position:"absolute",left:(e.origin.x-c.origin.x)*h,top:(e.origin.y-c.origin.y)*h,width:e.size.width*h,height:e.size.height*h,background:r}},t))}),f&&We(Us,{rect:{origin:{x:m.rect.origin.x*h,y:m.rect.origin.y*h},size:{width:m.rect.size.width*h,height:m.rect.size.height*h}},rotation:g,children:e=>a({...e,context:{type:"selection",pageIndex:t},selected:!0,placement:m})})]}):null}const Ks=mo(Bs).addUtility(function(){const{provides:e}=Ys();return Me(()=>{if(e)return e.onCopyToClipboard(({text:e})=>{navigator.clipboard.writeText(e)})},[e]),null}).build(),Xs="tiling",Zs={id:Xs,name:"Tiling Plugin",version:"1.0.0",provides:["tiling"],requires:["render","scroll","viewport"],optional:[],defaultConfig:{tileSize:768,overlapPx:2.5,extraRings:0}},Qs="TILING/INIT_STATE",Js="TILING/CLEANUP_STATE",el="TILING/UPDATE_VISIBLE_TILES",tl="TILING/MARK_TILE_STATUS",nl=(e,t)=>({type:el,payload:{documentId:e,tiles:t}}),ol=(e,t,n,o)=>({type:tl,payload:{documentId:e,pageIndex:t,tileId:n,status:o}}),rl={visibleTiles:{}};function al({tileSize:e=768,overlapPx:t=2.5,extraRings:n=0,scale:o,rotation:r,page:a,metric:i}){const s=a.size.width*o,l=a.size.height*o,d=e-t,c=function(e,t,n){return rt(ot(e,t,(4-n)%4),1)}(Xe(a.size,r,o),{origin:{x:i.scaled.pageX,y:i.scaled.pageY},size:{width:i.scaled.visibleWidth,height:i.scaled.visibleHeight}},r),u=c.origin.x,m=c.origin.y,p=u+c.size.width,h=m+c.size.height,g=Math.floor((s-1)/d),f=Math.floor((l-1)/d),F=Math.max(0,Math.floor(u/d)-n),P=Math.min(g,Math.floor((p-1)/d)+n),b=Math.max(0,Math.floor(m/d)-n),_=Math.min(f,Math.floor((h-1)/d)+n),v=[];for(let t=F;t<=P;t++){const n=t*d,r=Math.min(e,s-n),i=n/o,c=r/o;for(let s=b;s<=_;s++){const u=s*d,m=Math.min(e,l-u),p=u/o,h=m/o;v.push({id:`p${a.index}-${o}-x${n}-y${u}-w${r}-h${m}`,col:t,row:s,pageRect:{origin:{x:i,y:p},size:{width:c,height:h}},screenRect:{origin:{x:n,y:u},size:{width:r,height:m}},status:"queued",srcScale:o,isFallback:!1})}}return v}const il=class extends Qn{constructor(e,t,n){super(e,t),this.tileRendering$=lo(),this.config=n,this.renderCapability=this.registry.getPlugin("render").provides(),this.scrollCapability=this.registry.getPlugin("scroll").provides(),this.viewportCapability=this.registry.getPlugin("viewport").provides(),this.scrollCapability.onScroll(e=>this.calculateVisibleTiles(e.documentId,e.metrics),{mode:"throttle",wait:50,throttleMode:"trailing"}),this.coreStore.onAction(Nn,e=>this.recalculateTiles(e.payload))}onDocumentLoadingStarted(e){this.dispatch(((e,t)=>({type:Qs,payload:{documentId:e,state:t}}))(e,rl))}onDocumentClosed(e){this.dispatch((e=>({type:Js,payload:e}))(e))}onScaleChanged(e){this.recalculateTilesForDocument(e)}onRotationChanged(e){this.recalculateTilesForDocument(e)}recalculateTilesForDocument(e){const t=this.scrollCapability.forDocument(e),n=this.viewportCapability.forDocument(e),o=t.getMetrics(n.getMetrics());this.calculateVisibleTiles(e,o)}async recalculateTiles(e){const{documentId:t,pageIndexes:n}=e,o=this.getCoreDocument(t);if(!o||!o.document)return;const r=this.scrollCapability.forDocument(t),a=this.viewportCapability.forDocument(t),i=r.getMetrics(a.getMetrics()),s={},l=Date.now(),d=o.scale,c=o.rotation;for(const e of n){const t=i.pageVisibilityMetrics.find(t=>t.pageNumber===e+1);if(!t)continue;const n=o.document.pages[e];n&&(s[e]=al({page:n,metric:t,scale:d,rotation:c,tileSize:this.config.tileSize,overlapPx:this.config.overlapPx,extraRings:this.config.extraRings}).map(e=>({...e,id:`${e.id}-r${l}`})))}Object.keys(s).length>0&&this.dispatch(nl(t,s))}async initialize(){}calculateVisibleTiles(e,t){const n=this.getCoreDocument(e);if(!n||!n.document)return;const o=n.scale,r=n.rotation,a={};for(const e of t.pageVisibilityMetrics){const t=e.pageNumber-1,i=n.document.pages[t];if(!i)continue;const s=al({page:i,metric:e,scale:o,rotation:r,tileSize:this.config.tileSize,overlapPx:this.config.overlapPx,extraRings:this.config.extraRings});a[t]=s}this.dispatch(nl(e,a))}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o!==r&&this.tileRendering$.emit({documentId:n,tiles:r.visibleTiles})}}buildCapability(){return{renderTile:this.renderTile.bind(this),forDocument:this.createTilingScope.bind(this),onTileRendering:this.tileRendering$.on}}createTilingScope(e){return{renderTile:t=>this.renderTile(t,e),onTileRendering:t=>this.tileRendering$.on(n=>{n.documentId===e&&t(n.tiles)})}}renderTile(e,t){const n=t??this.getActiveDocumentId();if(!this.renderCapability)throw new Error("Render capability not available.");this.dispatch(ol(n,e.pageIndex,e.tile.id,"rendering"));const o=this.renderCapability.forDocument(n).renderPageRect({pageIndex:e.pageIndex,rect:e.tile.pageRect,options:{scaleFactor:e.tile.srcScale,dpr:e.dpr}});return o.wait(()=>{this.dispatch(ol(n,e.pageIndex,e.tile.id,"ready"))},yn),o}};il.id="tiling";let sl=il;const ll={manifest:Zs,create:(e,t)=>new sl(Xs,e,t),reducer:(e,t)=>((e,t)=>{var n,o;switch(t.type){case Qs:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o}}}case Js:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r}}case el:{const{documentId:o,tiles:r}=t.payload,a=e.documents[o];if(!a)return e;const i={...a.visibleTiles};for(const e in r){const t=Number(e),o=r[t],a=i[t]??[],s=null==(n=a.find(e=>!e.isFallback))?void 0:n.srcScale,l=o.length>0?o[0].srcScale:s;if(void 0!==s&&s!==l){const e=a.filter(e=>!e.isFallback&&"ready"===e.status).map(e=>({...e,isFallback:!0})),n=e.length>0?[]:a.filter(e=>e.isFallback);i[t]=[...n,...e,...o]}else{const e=new Set(o.map(e=>e.id)),n=[],r=new Set;for(const t of a)(t.isFallback||e.has(t.id))&&(n.push(t),r.add(t.id));for(const e of o)r.has(e.id)||n.push(e);i[t]=n}}return{...e,documents:{...e.documents,[o]:{...a,visibleTiles:i}}}}case tl:{const{documentId:n,pageIndex:r,tileId:a,status:i}=t.payload,s=e.documents[n];if(!s)return e;const l=(null==(o=s.visibleTiles[r])?void 0:o.map(e=>e.id===a?{...e,status:i}:e))??[],d=l.filter(e=>!e.isFallback),c=d.length>0&&d.every(e=>"ready"===e.status),u=c?d:l;return{...e,documents:{...e.documents,[n]:{...s,visibleTiles:{...s.visibleTiles,[r]:u}}}}}default:return e}})(e,t),initialState:{documents:{}}},dl=()=>Fo(sl.id);function cl({documentId:e,pageIndex:t,tile:n,dpr:o,scale:r}){const{provides:a}=dl(),i=Ie(()=>null==a?void 0:a.forDocument(e),[a,e]),[s,l]=Ee(),d=Te(null),c=r/n.srcScale;return Me(()=>{if("ready"===n.status&&d.current)return;if(!i)return;const e=i.renderTile({pageIndex:t,tile:n,dpr:o});return e.wait(e=>{const t=URL.createObjectURL(e);d.current=t,l(t)},yn),()=>{d.current?(URL.revokeObjectURL(d.current),d.current=null):e.abort({code:Ut.Cancelled,message:"canceled render task"})}},[i,t,n.id]),s?We("img",{src:s,onLoad:()=>{d.current&&(URL.revokeObjectURL(d.current),d.current=null)},style:{position:"absolute",left:n.screenRect.origin.x*c,top:n.screenRect.origin.y*c,width:n.screenRect.size.width*c,height:n.screenRect.size.height*c,display:"block"}}):null}function ul({documentId:e,pageIndex:t,scale:n,style:o,...r}){const{provides:a}=dl(),i=bo(e),[s,l]=Ee([]);Me(()=>{if(a)return a.onTileRendering(n=>{n.documentId===e&&l(n.tiles[t]??[])})},[a,e,t]);const d=Ie(()=>void 0!==n?n:(null==i?void 0:i.scale)??1,[n,null==i?void 0:i.scale]);return We("div",{style:{...o},...r,children:null==s?void 0:s.map(n=>We(cl,{documentId:e,pageIndex:t,tile:n,dpr:window.devicePixelRatio,scale:d},n.id))})}const ml="thumbnail",pl={id:ml,name:"Thumbnail Plugin",version:"1.0.0",provides:["thumbnail"],requires:["render"],optional:["scroll"],defaultConfig:{width:150,gap:10,buffer:3,labelHeight:16,autoScroll:!0,scrollBehavior:"smooth",imagePadding:0,paddingY:0}},hl="THUMBNAIL/INIT_STATE",gl="THUMBNAIL/CLEANUP_STATE",fl="THUMBNAIL/SET_WINDOW_STATE",Fl="THUMBNAIL/UPDATE_VIEWPORT_METRICS";function Pl(e,t){return{type:hl,payload:{documentId:e,state:t}}}const bl={thumbs:[],window:null,viewportH:0,scrollY:0},_l={documents:{},activeDocumentId:null},vl=class extends Qn{constructor(e,t,n){var o;super(e,t),this.cfg=n,this.scrollCapability=null,this.taskCaches=new Map,this.canAutoScroll=new Map,this.window$=co((e,t)=>({documentId:e,window:t})),this.scrollTo$=co((e,t)=>({documentId:e,options:t})),this.refreshPages$=co((e,t)=>({documentId:e,pages:t}),{cache:!1}),this.renderCapability=this.registry.getPlugin("render").provides(),this.scrollCapability=(null==(o=this.registry.getPlugin("scroll"))?void 0:o.provides())??null,this.coreStore.onAction(Nn,e=>{const t=e.payload.documentId??this.getActiveDocumentId(),n=e.payload.pageIndexes;this.refreshPages$.emit(t,n);const o=this.taskCaches.get(t);if(o)for(const e of n)o.delete(e)}),this.scrollCapability&&!1!==this.cfg.autoScroll&&(this.scrollCapability.onPageChangeState(({documentId:e,state:t})=>{this.canAutoScroll.set(e,!t.isChanging),t.isChanging||this.scrollToThumb(t.targetPage-1,e)}),this.scrollCapability.onPageChange(({documentId:e,pageNumber:t})=>{!1!==this.canAutoScroll.get(e)&&this.scrollToThumb(t-1,e)}))}onDocumentLoadingStarted(e){this.dispatch(Pl(e,{...bl})),this.taskCaches.set(e,new Map),this.canAutoScroll.set(e,!0),this.logger.debug("ThumbnailPlugin","DocumentOpened",`Initialized thumbnail state for document: ${e}`)}onDocumentLoaded(e){this.calculateWindowState(e)}onDocumentClosed(e){this.dispatch(function(e){return{type:gl,payload:e}}(e));const t=this.taskCaches.get(e);t&&(t.forEach(e=>{e.abort({code:"cancelled",message:"Document closed"})}),t.clear(),this.taskCaches.delete(e)),this.canAutoScroll.delete(e),this.window$.clearScope(e),this.scrollTo$.clearScope(e),this.refreshPages$.clearScope(e),this.logger.debug("ThumbnailPlugin","DocumentClosed",`Cleaned up thumbnail state for document: ${e}`)}onRotationChanged(e){this.calculateWindowState(e)}buildCapability(){return{scrollToThumb:e=>this.scrollToThumb(e),renderThumb:(e,t)=>this.renderThumb(e,t),updateWindow:(e,t)=>this.updateWindow(e,t),getWindow:()=>this.getWindow(),forDocument:e=>this.createThumbnailScope(e),onWindow:this.window$.onGlobal,onScrollTo:this.scrollTo$.onGlobal,onRefreshPages:this.refreshPages$.onGlobal}}createThumbnailScope(e){return{scrollToThumb:t=>this.scrollToThumb(t,e),renderThumb:(t,n)=>this.renderThumb(t,n,e),updateWindow:(t,n)=>this.updateWindow(t,n,e),getWindow:()=>this.getWindow(e),onWindow:this.window$.forScope(e),onScrollTo:this.scrollTo$.forScope(e),onRefreshPages:this.refreshPages$.forScope(e)}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}calculateWindowState(e){const t=this.coreState.core.documents[e];if(!(null==t?void 0:t.document))return;const n=this.cfg.width??120,o=this.cfg.labelHeight??16,r=this.cfg.gap??8,a=this.cfg.imagePadding??0,i=this.cfg.paddingY??0,s=Math.max(1,n-2*a);let l=i;const d=t.document.pages.map(e=>{const t=e.size.height/e.size.width,n=Math.round(s*t),i=a+n+a+o,d={pageIndex:e.index,width:s,height:n,wrapperHeight:i,top:l,labelHeight:o,padding:a};return l+=i+r,d}),c={start:-1,end:-1,items:[],totalHeight:l-r+i},u=this.getDocumentState(e);u&&(this.dispatch(Pl(e,{...u,thumbs:d,window:c})),u.viewportH>0?this.updateWindow(u.scrollY,u.viewportH,e):this.window$.emit(e,c))}updateWindow(e,t,n){const o=n??this.getActiveDocumentId(),r=this.getDocumentState(o);if(!r||!r.window||0===r.thumbs.length)return;const a=this.cfg.buffer??3;this.dispatch(function(e,t,n){return{type:Fl,payload:{documentId:e,scrollY:t,viewportH:n}}}(o,e,t));let i=0,s=r.thumbs.length-1,l=0;for(;i<=s;){const t=i+s>>1,n=r.thumbs[t];n.top+n.wrapperHeight<e?i=t+1:(l=t,s=t-1)}let d=l;const c=e+t;for(;d+1<r.thumbs.length&&r.thumbs[d].top<c;)d++;d=Math.min(r.thumbs.length-1,d+a);const u=Math.max(0,l-a);if(u===r.window.start&&d===r.window.end)return;const m={start:u,end:d,items:r.thumbs.slice(u,d+1),totalHeight:r.window.totalHeight};this.dispatch(function(e,t){return{type:fl,payload:{documentId:e,window:t}}}(o,m)),this.window$.emit(o,m)}getWindow(e){const t=this.getDocumentState(e);return(null==t?void 0:t.window)??null}scrollToThumb(e,t){const n=t??this.getActiveDocumentId(),o=this.getDocumentState(n);if(!o||!o.window)return;const r=o.thumbs[e];if(!r)return;const a=this.cfg.scrollBehavior??"smooth",i=this.cfg.paddingY??0;if(o.viewportH<=0){const e=Math.max(i,r.top-r.wrapperHeight);return void this.scrollTo$.emit(n,{top:e,behavior:a})}const s=r.top,l=r.top+r.wrapperHeight,d=s<o.scrollY+8+i,c=l>o.scrollY+o.viewportH-8;d?this.scrollTo$.emit(n,{top:Math.max(0,s-i),behavior:a}):c&&this.scrollTo$.emit(n,{top:Math.max(0,l-o.viewportH+i),behavior:a})}renderThumb(e,t,n){const o=n??this.getActiveDocumentId(),r=this.taskCaches.get(o);if(!r)throw new Error(`Task cache not found for document: ${o}`);if(r.has(e))return r.get(e);const a=this.coreState.core.documents[o];if(!(null==a?void 0:a.document))throw new Error(`Document not found: ${o}`);const i=a.document.pages[e];if(!i)throw new Error(`Page ${e} not found in document: ${o}`);const s=this.cfg.width??120,l=this.cfg.imagePadding??0,d=Math.max(1,s-2*l)/i.size.width,c=this.renderCapability.forDocument(o).renderPageRect({pageIndex:e,rect:{origin:{x:0,y:0},size:i.size},options:{scaleFactor:d,dpr:t}});return r.set(e,c),c.wait(yn,()=>r.delete(e)),c}async initialize(){this.logger.info("ThumbnailPlugin","Initialize","Thumbnail plugin initialized")}async destroy(){this.window$.clear(),this.refreshPages$.clear(),this.scrollTo$.clear(),this.taskCaches.forEach(e=>{e.forEach(e=>{e.abort({code:"cancelled",message:"Plugin destroyed"})}),e.clear()}),this.taskCaches.clear(),this.canAutoScroll.clear(),super.destroy()}};vl.id="thumbnail";let yl=vl;const Dl={manifest:pl,create:(e,t)=>new yl(ml,e,t),reducer:(e=_l,t)=>{switch(t.type){case hl:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case gl:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"THUMBNAIL/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case fl:{const{documentId:n,window:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,window:o}}}:e}case Fl:{const{documentId:n,scrollY:o,viewportH:r}=t.payload,a=e.documents[n];return a?{...e,documents:{...e.documents,[n]:{...a,scrollY:o,viewportH:r}}}:e}default:return e}},initialState:_l},xl=()=>fo(yl.id);function Al({documentId:e,style:t,children:n,...o}){const{plugin:r}=xl(),a=Te(null),[i,s]=Ee({window:null,docId:null}),l=i.docId===e?i.window:null;Me(()=>{if(!r)return;const t=r.provides().forDocument(e),n=t.getWindow();n&&s({window:n,docId:e});const o=t.onWindow(t=>{s({window:t,docId:e})});return()=>{o(),s({window:null,docId:null})}},[r,e]),Me(()=>{const t=a.current;if(!t||!r)return;const n=r.provides().forDocument(e),o=()=>n.updateWindow(t.scrollTop,t.clientHeight);return t.addEventListener("scroll",o),()=>t.removeEventListener("scroll",o)},[r,e]),Me(()=>{const t=a.current;if(!t||!r)return;const n=r.provides().forDocument(e),o=new ResizeObserver(()=>{n.updateWindow(t.scrollTop,t.clientHeight)});return o.observe(t),()=>o.disconnect()},[r,e]),Me(()=>{const t=a.current;t&&r&&r.provides().forDocument(e).updateWindow(t.scrollTop,t.clientHeight)},[l,r,e]),Me(()=>{const t=a.current;if(t&&r&&l)return r.provides().forDocument(e).onScrollTo(({top:e,behavior:n})=>{t.scrollTo({top:e,behavior:n})})},[r,e,!!l]);const d=(null==r?void 0:r.cfg.paddingY)??0;return We("div",{ref:a,style:{overflowY:"auto",position:"relative",paddingTop:d,paddingBottom:d,height:"100%",...t},...o,children:We("div",{style:{height:(null==l?void 0:l.totalHeight)??0,position:"relative"},children:null==l?void 0:l.items.map(e=>n(e))})})}function wl({documentId:e,meta:t,style:n,...o}){const{provides:r}=Fo(yl.id),{plugin:a}=xl(),[i,s]=Ee(),l=Te(null),[d,c]=Ee(0);return Me(()=>{if(a)return a.provides().forDocument(e).onRefreshPages(e=>{e.includes(t.pageIndex)&&c(e=>e+1)})},[a,e,t.pageIndex]),Me(()=>{const n=null==r?void 0:r.forDocument(e),o=null==n?void 0:n.renderThumb(t.pageIndex,window.devicePixelRatio);return null==o||o.wait(e=>{const t=URL.createObjectURL(e);l.current=t,s(t)},yn),()=>{l.current?(URL.revokeObjectURL(l.current),l.current=null):null==o||o.abort({code:Ut.Cancelled,message:"canceled render task"})}},[r,e,t.pageIndex,d]),i?We("img",{src:i,onLoad:()=>{l.current&&(URL.revokeObjectURL(l.current),l.current=null)},style:n,...o}):null}const Sl="annotation",El={id:Sl,name:"Annotation Plugin",version:"1.0.0",provides:["annotation"],requires:["interaction-manager","selection"],optional:["history"],defaultConfig:{autoCommit:!0,annotationAuthor:"Guest",deactivateToolAfterCreate:!1,selectAfterCreate:!0}},Cl="ANNOTATION/INIT_STATE",Ml="ANNOTATION/CLEANUP_STATE",kl="ANNOTATION/SET_ANNOTATIONS",Tl="ANNOTATION/SELECT_ANNOTATION",Il="ANNOTATION/DESELECT_ANNOTATION",Ol="ANNOTATION/SET_ACTIVE_TOOL_ID",Rl="ANNOTATION/CREATE_ANNOTATION",Gl="ANNOTATION/PATCH_ANNOTATION",Ll="ANNOTATION/DELETE_ANNOTATION",Nl="ANNOTATION/COMMIT",zl="ANNOTATION/PURGE_ANNOTATION",jl="ANNOTATION/ADD_COLOR_PRESET",Bl="ANNOTATION/SET_TOOL_DEFAULTS",$l="ANNOTATION/ADD_TOOL",Ul=e=>({type:Il,payload:{documentId:e}}),Wl=(e,t)=>({type:Ol,payload:{documentId:e,toolId:t}}),Hl=(e,t,n)=>({type:Rl,payload:{documentId:e,pageIndex:t,annotation:n}}),Vl=(e,t,n,o)=>({type:Gl,payload:{documentId:e,pageIndex:t,id:n,patch:o}}),Yl=(e,t,n)=>({type:Ll,payload:{documentId:e,pageIndex:t,id:n}}),ql=(e,t)=>({type:zl,payload:{documentId:e,uid:t}});function Kl(e){return e.object.type===Et.INK}function Xl(e){return e.object.type===Et.CIRCLE}function Zl(e){return e.object.type===Et.POLYGON}function Ql(e){return e.object.type===Et.SQUARE}function Jl(e){return e.object.type===Et.LINE}function ed(e){return e.object.type===Et.POLYLINE}function td(e){return e.object.type===Et.HIGHLIGHT}function nd(e){return e.object.type===Et.UNDERLINE}function od(e){return e.object.type===Et.STRIKEOUT}function rd(e){return e.object.type===Et.SQUIGGLY}function ad(e){return e.object.type===Et.FREETEXT}function id(e){return e.object.type===Et.STAMP}function sd(e){return e.object.type===Et.TEXT}function ld(e){return function(e){return td(e)||nd(e)||od(e)||rd(e)}(e)||Kl(e)||Ql(e)||Xl(e)||Zl(e)||Jl(e)||ed(e)||ad(e)||id(e)}const dd=(e,t)=>(e.pages[t]??[]).map(t=>e.byUid[t]),cd=(e,t)=>e.byUid[t]??null,ud=(e,t)=>e.selectedUid&&(e.pages[t]??[]).includes(e.selectedUid)?e.byUid[e.selectedUid]:null;function md(e,t){const n=e.tools.find(e=>e.id===t);return null==n?void 0:n.defaults}const pd=[{id:"highlight",name:"Highlight",matchScore:e=>e.type===Et.HIGHLIGHT?1:0,interaction:{exclusive:!1,textSelection:!0,isDraggable:!1,isResizable:!1},defaults:{type:Et.HIGHLIGHT,color:"#FFCD45",opacity:1,blendMode:At.Multiply}},{id:"underline",name:"Underline",matchScore:e=>e.type===Et.UNDERLINE?1:0,interaction:{exclusive:!1,textSelection:!0,isDraggable:!1,isResizable:!1},defaults:{type:Et.UNDERLINE,color:"#E44234",opacity:1}},{id:"strikeout",name:"Strikeout",matchScore:e=>e.type===Et.STRIKEOUT?1:0,interaction:{exclusive:!1,textSelection:!0},defaults:{type:Et.STRIKEOUT,color:"#E44234",opacity:1}},{id:"squiggly",name:"Squiggly",matchScore:e=>e.type===Et.SQUIGGLY?1:0,interaction:{exclusive:!1,textSelection:!0,isDraggable:!1,isResizable:!1},defaults:{type:Et.SQUIGGLY,color:"#E44234",opacity:1}},{id:"ink",name:"Pen",matchScore:e=>e.type===Et.INK&&"InkHighlight"!==e.intent?5:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!0,lockAspectRatio:!1},defaults:{type:Et.INK,color:"#E44234",opacity:1,strokeWidth:6}},{id:"inkHighlighter",name:"Ink Highlighter",matchScore:e=>e.type===Et.INK&&"InkHighlight"===e.intent?10:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!0,lockAspectRatio:!1},defaults:{type:Et.INK,intent:"InkHighlight",color:"#FFCD45",opacity:1,strokeWidth:14,blendMode:At.Multiply}},{id:"circle",name:"Circle",matchScore:e=>e.type===Et.CIRCLE?1:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!0,lockAspectRatio:!1},defaults:{type:Et.CIRCLE,color:"transparent",opacity:1,strokeWidth:6,strokeColor:"#E44234",strokeStyle:Ot.SOLID},clickBehavior:{enabled:!0,defaultSize:{width:100,height:100}}},{id:"square",name:"Square",matchScore:e=>e.type===Et.SQUARE?1:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!0,lockAspectRatio:!1},defaults:{type:Et.SQUARE,color:"transparent",opacity:1,strokeWidth:6,strokeColor:"#E44234",strokeStyle:Ot.SOLID},clickBehavior:{enabled:!0,defaultSize:{width:100,height:100}}},{id:"line",name:"Line",matchScore:e=>e.type===Et.LINE&&"LineArrow"!==e.intent?5:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!1,lockAspectRatio:!1},defaults:{type:Et.LINE,color:"transparent",opacity:1,strokeWidth:6,strokeColor:"#E44234"},clickBehavior:{enabled:!0,defaultLength:100,defaultAngle:0}},{id:"lineArrow",name:"Arrow",matchScore:e=>e.type===Et.LINE&&"LineArrow"===e.intent?10:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!1,lockAspectRatio:!1},defaults:{type:Et.LINE,intent:"LineArrow",color:"transparent",opacity:1,strokeWidth:6,strokeColor:"#E44234",lineEndings:{start:kt.None,end:kt.OpenArrow}},clickBehavior:{enabled:!0,defaultLength:100,defaultAngle:0}},{id:"polyline",name:"Polyline",matchScore:e=>e.type===Et.POLYLINE?1:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!1,lockAspectRatio:!1},defaults:{type:Et.POLYLINE,color:"transparent",opacity:1,strokeWidth:6,strokeColor:"#E44234"}},{id:"polygon",name:"Polygon",matchScore:e=>e.type===Et.POLYGON?1:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!1,lockAspectRatio:!1},defaults:{type:Et.POLYGON,color:"transparent",opacity:1,strokeWidth:6,strokeColor:"#E44234"}},{id:"freeText",name:"Free Text",matchScore:e=>e.type===Et.FREETEXT?1:0,interaction:{exclusive:!1,cursor:"crosshair",isDraggable:!0,isResizable:!0,lockAspectRatio:!1},defaults:{type:Et.FREETEXT,contents:"Insert text",fontSize:14,fontColor:"#E44234",fontFamily:yt.Helvetica,textAlign:Dt.Left,verticalAlign:xt.Top,backgroundColor:"transparent",opacity:1},clickBehavior:{enabled:!0,defaultSize:{width:100,height:20},defaultContent:"Insert text"}},{id:"stamp",name:"Image",matchScore:e=>e.type===Et.STAMP?1:0,interaction:{exclusive:!1,cursor:"copy",isDraggable:!0,isResizable:!0,lockAspectRatio:!0},defaults:{type:Et.STAMP}}],hd=["#E44234","#FF8D00","#FFCD45","#5CC96E","#25D2D1","#597CE2","#C544CE","#7D2E25","#000000","#FFFFFF"],gd=(e,t,n)=>{const o=e.byUid[t];return o?{...e,byUid:{...e.byUid,[t]:{...o,commitState:"synced"===o.commitState?"dirty":o.commitState,object:{...o.object,...n}}},hasPendingChanges:!0}:e};function fd(e){let t=e;return[()=>t,e=>{t=e}]}const Fd={annotationType:Et.INK,create(e){const{onCommit:t,onPreview:n,getTool:o,pageSize:r}=e,[a,i]=fd([]),[s,l]=fd(!1),d={current:null},c=e=>({x:no(e.x,0,r.width),y:no(e.y,0,r.height)}),u=()=>{const e=o();return e?{...e.defaults,strokeWidth:e.defaults.strokeWidth??1,color:e.defaults.color??"#000000",opacity:e.defaults.opacity??1,flags:e.defaults.flags??["print"]}:null},m=()=>{const e=a();if(0===e.length||0===e[0].points.length)return null;const t=u();if(!t)return null;const n=nt(tt(e.flatMap(e=>e.points)),t.strokeWidth/2);return{type:Et.INK,bounds:n,data:{...t,rect:n,inkList:e}}};return{onPointerDown:(e,t)=>{var o;const r=c(e);l(!0),d.current&&clearTimeout(d.current);const s=[...a(),{points:[r]}];i(s),n(m()),null==(o=t.setPointerCapture)||o.call(t)},onPointerMove:e=>{if(!s())return;const t=a();if(0===t.length)return;const o=c(e);t[t.length-1].points.push(o),i(t),n(m())},onPointerUp:(o,r)=>{var s;l(!1),null==(s=r.releasePointerCapture)||s.call(r),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{const o=a();if(o.length>0&&o[0].points.length>1){const n=u();if(!n)return;const r=o.flatMap(e=>e.points),a=nt(tt(r),n.strokeWidth/2);t({...n,inkList:o,rect:a,type:Et.INK,pageIndex:e.pageIndex,id:_n(),created:new Date})}i([]),n(null)},800)},onPointerCancel:(e,t)=>{var o;i([]),l(!1),n(null),d.current&&clearTimeout(d.current),null==(o=t.releasePointerCapture)||o.call(t)}}}};function Pd({threshold:e=5,getTool:t,onClickDetected:n}){const[o,r]=fd(null),[a,i]=fd(!1);return{onStart:e=>{r(e),i(!1)},onMove:t=>{const n=o();n&&!a()&&Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))>e&&i(!0)},onEnd:e=>{var s;if(o()&&!a()){const o=t();o&&"clickBehavior"in o&&(null==(s=o.clickBehavior)?void 0:s.enabled)&&n(e,o)}r(null),i(!1)},hasMoved:a,reset:()=>{r(null),i(!1)}}}const bd={annotationType:Et.FREETEXT,create(e){const{onCommit:t,onPreview:n,getTool:o,pageSize:r,pageIndex:a}=e,[i,s]=fd(null),l=e=>({x:no(e.x,0,r.width),y:no(e.y,0,r.height)}),d=()=>{const e=o();return e?{...e.defaults,fontColor:e.defaults.fontColor??"#000000",opacity:e.defaults.opacity??1,fontSize:e.defaults.fontSize??12,fontFamily:e.defaults.fontFamily??yt.Helvetica,backgroundColor:e.defaults.backgroundColor??"transparent",textAlign:e.defaults.textAlign??Dt.Left,verticalAlign:e.defaults.verticalAlign??xt.Top,contents:e.defaults.contents??"Insert text here",flags:e.defaults.flags??["print"]}:null},c=Pd({threshold:5,getTool:o,onClickDetected:(e,n)=>{const o=d();if(!o)return;const i=n.clickBehavior;if(!(null==i?void 0:i.enabled))return;const{width:s,height:l}=i.defaultSize,c=s/2,u=l/2,m={origin:{x:no(e.x-c,0,r.width-s),y:no(e.y-u,0,r.height-l)},size:{width:s,height:l}},p=i.defaultContent??o.contents,h={...o,contents:p,type:Et.FREETEXT,rect:m,pageIndex:a,id:_n(),created:new Date};t(h)}}),u=e=>{const t=i();if(!t)return null;const n=d();if(!n)return null;const o={origin:{x:Math.min(t.x,e.x),y:Math.min(t.y,e.y)},size:{width:Math.abs(t.x-e.x),height:Math.abs(t.y-e.y)}};return{type:Et.FREETEXT,bounds:o,data:{...n,rect:o}}};return{onPointerDown:(e,t)=>{var o;const r=l(e);s(r),c.onStart(r),n(u(r)),null==(o=t.setPointerCapture)||o.call(t)},onPointerMove:e=>{const t=l(e);c.onMove(t),i()&&c.hasMoved()&&n(u(t))},onPointerUp:(o,r)=>{var a;const u=i();if(!u)return;const m=d();if(!m)return;const p=l(o);if(c.hasMoved()){const n={origin:{x:Math.min(u.x,p.x),y:Math.min(u.y,p.y)},size:{width:Math.abs(u.x-p.x),height:Math.abs(u.y-p.y)}},o={...m,type:Et.FREETEXT,rect:n,pageIndex:e.pageIndex,id:_n(),created:new Date};t(o)}else c.onEnd(p);s(null),n(null),c.reset(),null==(a=r.releasePointerCapture)||a.call(r)},onPointerLeave:(e,t)=>{var o;s(null),n(null),c.reset(),null==(o=t.releasePointerCapture)||o.call(t)},onPointerCancel:(e,t)=>{var o;s(null),n(null),c.reset(),null==(o=t.releasePointerCapture)||o.call(t)}}}};function _d(e){const t=e=>{const t=9*e,n=Math.PI/6;return{x:-t*Math.cos(n),y:t*Math.sin(n)}};return{getSvgPath:n=>{const{x:o,y:r}=t(n);return e?`M 0 0 L ${o} ${r} L ${o} ${-r} Z`:`M ${o} ${r} L 0 0 L ${o} ${-r}`},getLocalPoints:e=>{const{x:n,y:o}=t(e);return[{x:0,y:0},{x:n,y:o},{x:n,y:-o}]},getRotation:e=>e,filled:e}}function vd(e,t){const n=t=>t*e/2;return{getSvgPath:e=>{const t=n(e);return`M ${-t} 0 L ${t} 0`},getLocalPoints:e=>{const t=n(e);return[{x:-t,y:0},{x:t,y:0}]},getRotation:t,filled:!1}}const yd=_d(!1),Dd=_d(!0),xd={[kt.OpenArrow]:yd,[kt.ClosedArrow]:Dd,[kt.ROpenArrow]:{...yd,getRotation:e=>e+Math.PI},[kt.RClosedArrow]:{...Dd,getRotation:e=>e+Math.PI},[kt.Circle]:{getSvgPath:e=>{const t=5*e/2;return`M ${t} 0 A ${t} ${t} 0 1 1 ${-t} 0 A ${t} ${t} 0 1 1 ${t} 0`},getLocalPoints:e=>{const t=5*e/2;return[{x:-t,y:-t},{x:t,y:t}]},getRotation:()=>0,filled:!0},[kt.Square]:{getSvgPath:e=>{const t=6*e/2;return`M ${-t} ${-t} L ${t} ${-t} L ${t} ${t} L ${-t} ${t} Z`},getLocalPoints:e=>{const t=6*e/2;return[{x:-t,y:-t},{x:t,y:-t},{x:t,y:t},{x:-t,y:t}]},getRotation:e=>e,filled:!0},[kt.Diamond]:{getSvgPath:e=>{const t=6*e/2;return`M 0 ${-t} L ${t} 0 L 0 ${t} L ${-t} 0 Z`},getLocalPoints:e=>{const t=6*e/2;return[{x:0,y:-t},{x:t,y:0},{x:0,y:t},{x:-t,y:0}]},getRotation:e=>e,filled:!0},[kt.Butt]:vd(6,e=>e+Math.PI/2),[kt.Slash]:vd(18,e=>e+Math.PI/1.5)};function Ad(e,t,n){if(!e||0===e.length)return{origin:{x:0,y:0},size:{width:0,height:0}};const o=[...e],r=(e,t)=>Math.atan2(t.y-e.y,t.x-e.x),a=(e,n,r)=>{if(!e)return;const a=xd[e];if(!a)return;const i=a.getLocalPoints(t),s=a.getRotation(r),l=i.map(e=>function(e,t,n){const o=Math.cos(t),r=Math.sin(t),a=e.x*o-e.y*r,i=e.x*r+e.y*o;return{x:a+n.x,y:i+n.y}}(e,s,n));o.push(...l)};if(e.length>=2){const t=r(e[1],e[0]);a(null==n?void 0:n.start,e[0],t);const o=e.length-1,i=r(e[o-1],e[o]);a(null==n?void 0:n.end,e[o],i)}if(o.length<=1){const n=e[0]||{x:0,y:0},o=t;return{origin:{x:n.x-o,y:n.y-o},size:{width:2*o,height:2*o}}}return nt(tt(o),t/2+1.2*t)}class wd{constructor(){this.patches=new Map}register(e,t){this.patches.set(e,t)}transform(e,t){const n=this.patches.get(e.type);return n?n(e,t):t.changes}}const Sd=new wd,Ed=Object.freeze(Object.defineProperty({__proto__:null,LINE_ENDING_HANDLERS:xd,PatchRegistry:wd,createEnding:function(e,t,n,o,r){if(!e)return null;const a=xd[e];if(!a)return null;const i=a.getRotation(n);return{d:a.getSvgPath(t),transform:`translate(${o} ${r}) rotate(${(e=>180*e/Math.PI)(i)})`,filled:a.filled}},lineRectWithEndings:Ad,patchRegistry:Sd},Symbol.toStringTag,{value:"Module"})),Cd={annotationType:Et.LINE,create(e){const{pageIndex:t,onCommit:n,onPreview:o,getTool:r,pageSize:a}=e,[i,s]=fd(null),l=e=>({x:no(e.x,0,a.width),y:no(e.y,0,a.height)}),d=()=>{const e=r();return e?{...e.defaults,strokeWidth:e.defaults.strokeWidth??1,lineEndings:e.defaults.lineEndings??{start:kt.None,end:kt.None},color:e.defaults.color??"#000000",opacity:e.defaults.opacity??1,strokeStyle:e.defaults.strokeStyle??Ot.SOLID,strokeDashArray:e.defaults.strokeDashArray??[],strokeColor:e.defaults.strokeColor??"#000000",flags:e.defaults.flags??["print"]}:null},c=Pd({threshold:5,getTool:r,onClickDetected:(e,o)=>{const r=d();if(!r)return;const a=o.clickBehavior;if(!(null==a?void 0:a.enabled))return;const i=a.defaultAngle??0,s=a.defaultLength/2,c=e.x-s*Math.cos(i),u=e.y-s*Math.sin(i),m=e.x+s*Math.cos(i),p=e.y+s*Math.sin(i),h=l({x:c,y:u}),g=l({x:m,y:p}),f=Ad([h,g],r.strokeWidth,r.lineEndings);n({...r,rect:f,linePoints:{start:h,end:g},pageIndex:t,id:_n(),created:new Date,type:Et.LINE})}}),u=e=>{const t=i();if(!t)return null;const n=d();if(!n)return null;const o=Ad([t,e],n.strokeWidth,n.lineEndings);return{type:Et.LINE,bounds:o,data:{...n,rect:o,linePoints:{start:t,end:e}}}};return{onPointerDown:(e,t)=>{var n;const r=l(e);s(r),c.onStart(r),o(u(r)),null==(n=t.setPointerCapture)||n.call(t)},onPointerMove:e=>{const t=l(e);c.onMove(t),i()&&c.hasMoved()&&o(u(t))},onPointerUp:(e,r)=>{var a;const u=i();if(!u)return;const m=l(e);if(c.hasMoved()){const e=d();if(!e)return;if(Math.abs(m.x-u.x)>2||Math.abs(m.y-u.y)>2){const o=Ad([u,m],e.strokeWidth,e.lineEndings);n({...e,rect:o,linePoints:{start:u,end:m},pageIndex:t,id:_n(),flags:["print"],created:new Date,type:Et.LINE})}}else c.onEnd(m);s(null),o(null),c.reset(),null==(a=r.releasePointerCapture)||a.call(r)},onPointerLeave:(e,t)=>{var n;s(null),o(null),c.reset(),null==(n=t.releasePointerCapture)||n.call(t)},onPointerCancel:(e,t)=>{var n;s(null),o(null),c.reset(),null==(n=t.releasePointerCapture)||n.call(t)}}}},Md={annotationType:Et.POLYLINE,create(e){const{onCommit:t,onPreview:n,getTool:o,pageSize:r}=e,[a,i]=fd([]),[s,l]=fd(null),d=e=>({x:no(e.x,0,r.width),y:no(e.y,0,r.height)}),c=()=>{const e=o();return e?{...e.defaults,strokeWidth:e.defaults.strokeWidth??1,lineEndings:e.defaults.lineEndings??{start:kt.None,end:kt.None},color:e.defaults.color??"#000000",opacity:e.defaults.opacity??1,strokeColor:e.defaults.strokeColor??"#000000",strokeStyle:e.defaults.strokeStyle??Ot.SOLID,strokeDashArray:e.defaults.strokeDashArray??[],flags:e.defaults.flags??["print"]}:null},u=()=>{const e=a(),t=s();if(0===e.length||!t)return null;const n=c();if(!n)return null;const o=[...e,t],r=Ad(o,n.strokeWidth,n.lineEndings);return{type:Et.POLYLINE,bounds:r,data:{...n,rect:r,vertices:o,currentVertex:t}}};return{onClick:e=>{const t=d(e),o=a(),r=o[o.length-1];r&&Math.abs(r.x-t.x)<1&&Math.abs(r.y-t.y)<1||(i([...o,t]),l(t),n(u()))},onDoubleClick:()=>{(()=>{const o=a();if(o.length<2)return;const r=c();if(!r)return;const s=Ad(o,r.strokeWidth,r.lineEndings),d={...r,vertices:o,rect:s,type:Et.POLYLINE,pageIndex:e.pageIndex,id:_n(),created:new Date};t(d),i([]),l(null),n(null)})()},onPointerMove:e=>{if(a().length>0){const t=d(e);l(t),n(u())}},onPointerCancel:()=>{i([]),l(null),n(null)}}}},kd={annotationType:Et.POLYGON,create(e){const{onCommit:t,onPreview:n,getTool:o,scale:r,pageSize:a}=e,[i,s]=fd([]),[l,d]=fd(null),c=e=>({x:no(e.x,0,a.width),y:no(e.y,0,a.height)}),u=()=>{const e=o();return e?{...e.defaults,color:e.defaults.color??"#000000",opacity:e.defaults.opacity??1,strokeWidth:e.defaults.strokeWidth??1,strokeColor:e.defaults.strokeColor??"#000000",strokeStyle:e.defaults.strokeStyle??Ot.SOLID,strokeDashArray:e.defaults.strokeDashArray??[],flags:e.defaults.flags??["print"]}:null},m=()=>{const o=i();if(o.length<3)return;const r=u();if(!r)return;const a=nt(tt(o),r.strokeWidth/2),l={...r,vertices:o,rect:a,type:Et.POLYGON,pageIndex:e.pageIndex,id:_n(),created:new Date};t(l),s([]),d(null),n(null)},p=()=>{const e=i(),t=l();if(0===e.length||!t)return null;const n=u();if(!n)return null;const o=nt(tt([...e,t]),n.strokeWidth/2);return{type:Et.POLYGON,bounds:o,data:{...n,rect:o,vertices:e,currentVertex:t}}};return{onClick:e=>{const t=c(e);if((e=>{const t=i();if(t.length<2)return!1;const n=14/r/2,o=t[0];return e.x>=o.x-n&&e.x<=o.x+n&&e.y>=o.y-n&&e.y<=o.y+n})(t)&&i().length>=3)return void m();const o=i(),a=o[o.length-1];a&&Math.abs(a.x-t.x)<1&&Math.abs(a.y-t.y)<1||(s([...o,t]),d(t),n(p()))},onDoubleClick:e=>{m()},onPointerMove:e=>{if(i().length>0){const t=c(e);d(t),n(p())}},onPointerCancel:e=>{s([]),d(null),n(null)}}}},Td={annotationType:Et.SQUARE,create(e){const{pageIndex:t,onCommit:n,onPreview:o,getTool:r,pageSize:a}=e,[i,s]=fd(null),l=e=>({x:no(e.x,0,a.width),y:no(e.y,0,a.height)}),d=()=>{const e=r();return e?{...e.defaults,flags:e.defaults.flags??["print"],strokeWidth:e.defaults.strokeWidth??2,strokeColor:e.defaults.strokeColor??"#000000",strokeStyle:e.defaults.strokeStyle??Ot.SOLID,strokeDashArray:e.defaults.strokeDashArray??[],color:e.defaults.color??"#000000",opacity:e.defaults.opacity??1}:null},c=Pd({threshold:5,getTool:r,onClickDetected:(e,o)=>{const r=d();if(!r)return;const i=o.clickBehavior;if(!(null==i?void 0:i.enabled))return;const{width:s,height:l}=i.defaultSize,c=s/2,u=l/2,m=no(e.x-c,0,a.width-s),p=no(e.y-u,0,a.height-l),h=r.strokeWidth,g=h/2,f={origin:{x:m-g,y:p-g},size:{width:s+h,height:l+h}},F={...r,type:Et.SQUARE,created:new Date,id:_n(),pageIndex:t,rect:f};n(F)}}),u=e=>{const t=i();if(!t)return null;const n=Math.min(t.x,e.x),o=Math.min(t.y,e.y),r=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y),s=d();if(!s)return null;const l=s.strokeWidth,c=l/2,u={origin:{x:n-c,y:o-c},size:{width:r+l,height:a+l}};return{type:Et.SQUARE,bounds:u,data:{rect:u,...s}}};return{onPointerDown:(e,t)=>{var n;const r=l(e);s(r),c.onStart(r),o(u(r)),null==(n=t.setPointerCapture)||n.call(t)},onPointerMove:e=>{const t=l(e);c.onMove(t),i()&&c.hasMoved()&&o(u(t))},onPointerUp:(e,r)=>{var a;if(!i())return;if(!d())return;const m=l(e);if(c.hasMoved()){const e=d();if(!e)return;const o=u(m);if(o){const r={...e,type:Et.SQUARE,created:new Date,id:_n(),pageIndex:t,rect:o.data.rect};n(r)}}else c.onEnd(m);s(null),o(null),c.reset(),null==(a=r.releasePointerCapture)||a.call(r)},onPointerLeave:(e,t)=>{var n;s(null),o(null),c.reset(),null==(n=t.releasePointerCapture)||n.call(t)},onPointerCancel:(e,t)=>{var n;s(null),o(null),c.reset(),null==(n=t.releasePointerCapture)||n.call(t)}}}},Id={annotationType:Et.STAMP,create(e){const{services:t,onCommit:n,getTool:o,pageSize:r}=e;return{onPointerDown:a=>{const i=o();if(!i)return;const{imageSrc:s,imageSize:l}=i.defaults,d=(t,o,s)=>{const l=a.x-o/2,d=a.y-s/2,c={origin:{x:no(l,0,r.width-o),y:no(d,0,r.height-s)},size:{width:o,height:s}},u={...i.defaults,rect:c,type:Et.STAMP,icon:i.defaults.icon??Mt.Draft,subject:i.defaults.subject??"Stamp",flags:i.defaults.flags??["print"],pageIndex:e.pageIndex,id:_n(),created:new Date};n(u,{imageData:t})};s?t.processImage({source:s,maxWidth:r.width,maxHeight:r.height,onComplete:e=>d(e.imageData,(null==l?void 0:l.width)??e.width,(null==l?void 0:l.height)??e.height)}):t.requestFile({accept:"image/png,image/jpeg",onFile:e=>{t.processImage({source:e,maxWidth:r.width,maxHeight:r.height,onComplete:e=>d(e.imageData,e.width,e.height)})}})}}}},Od={annotationType:Et.CIRCLE,create(e){const{pageIndex:t,onCommit:n,onPreview:o,getTool:r,pageSize:a}=e,[i,s]=fd(null),l=e=>({x:no(e.x,0,a.width),y:no(e.y,0,a.height)}),d=()=>{const e=r();return e?{...e.defaults,strokeWidth:e.defaults.strokeWidth??2,strokeColor:e.defaults.strokeColor??"#000000",strokeStyle:e.defaults.strokeStyle??Ot.SOLID,strokeDashArray:e.defaults.strokeDashArray??[],color:e.defaults.color??"#000000",opacity:e.defaults.opacity??1,flags:e.defaults.flags??["print"]}:null},c=Pd({threshold:5,getTool:r,onClickDetected:(e,o)=>{const r=d();if(!r)return;const i=o.clickBehavior;if(!(null==i?void 0:i.enabled))return;const{width:s,height:l}=i.defaultSize,c=s/2,u=l/2,m=no(e.x-c,0,a.width-s),p=no(e.y-u,0,a.height-l),h=r.strokeWidth,g=h/2,f={origin:{x:m-g,y:p-g},size:{width:s+h,height:l+h}},F={...r,type:Et.CIRCLE,created:new Date,id:_n(),pageIndex:t,rect:f};n(F)}}),u=e=>{const t=i();if(!t)return null;const n=Math.min(t.x,e.x),o=Math.min(t.y,e.y),r=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y),s=d();if(!s)return null;const l=s.strokeWidth,c=l/2,u={origin:{x:n-c,y:o-c},size:{width:r+l,height:a+l}};return{type:Et.CIRCLE,bounds:u,data:{rect:u,...s}}};return{onPointerDown:(e,t)=>{var n;const r=l(e);s(r),c.onStart(r),o(u(r)),null==(n=t.setPointerCapture)||n.call(t)},onPointerMove:e=>{const t=l(e);c.onMove(t),i()&&c.hasMoved()&&o(u(t))},onPointerUp:(e,r)=>{var a;if(!i())return;if(!d())return;const m=l(e);if(c.hasMoved()){const e=d();if(!e)return;const o=u(m);if(o){const r={...e,type:Et.CIRCLE,flags:["print"],created:new Date,id:_n(),pageIndex:t,rect:o.data.rect};n(r)}}else c.onEnd(m);s(null),o(null),c.reset(),null==(a=r.releasePointerCapture)||a.call(r)},onPointerLeave:(e,t)=>{var n;s(null),o(null),c.reset(),null==(n=t.releasePointerCapture)||n.call(t)},onPointerCancel:(e,t)=>{var n;s(null),o(null),c.reset(),null==(n=t.releasePointerCapture)||n.call(t)}}}},Rd=(e,t)=>{var n;switch(t.type){case"vertex-edit":default:return t.changes;case"move":if(t.changes.rect){const n=t.changes.rect.origin.x-e.rect.origin.x,o=t.changes.rect.origin.y-e.rect.origin.y,r=e.inkList.map(e=>({points:e.points.map(e=>({x:e.x+n,y:e.y+o}))}));return{rect:t.changes.rect,inkList:r}}return t.changes;case"resize":if(t.changes.rect){const o=e.rect,r=t.changes.rect;let a=r.size.width/o.size.width,i=r.size.height/o.size.height;const s=10;if((r.size.width<s||r.size.height<s)&&(a=Math.max(a,s/o.size.width),i=Math.max(i,s/o.size.height),t.changes.rect={origin:r.origin,size:{width:o.size.width*a,height:o.size.height*i}}),null==(n=t.metadata)?void 0:n.maintainAspectRatio){const e=Math.min(a,i);a=e,i=e,t.changes.rect.size={width:o.size.width*e,height:o.size.height*e}}const l=(e,t)=>({origin:{x:e.origin.x+t,y:e.origin.y+t},size:{width:Math.max(1,e.size.width-2*t),height:Math.max(1,e.size.height-2*t)}}),d=Math.min(t.changes.rect.size.width/o.size.width,t.changes.rect.size.height/o.size.height),c=Math.max(1,Math.round(e.strokeWidth*d)),u=l(o,e.strokeWidth/2),m=l(t.changes.rect,c/2),p=m.size.width/Math.max(u.size.width,1e-6),h=m.size.height/Math.max(u.size.height,1e-6),g=e.inkList.map(e=>({points:e.points.map(e=>({x:m.origin.x+(e.x-u.origin.x)*p,y:m.origin.y+(e.y-u.origin.y)*h}))}));return{rect:t.changes.rect,inkList:g,strokeWidth:c}}return t.changes;case"property-update":if(void 0!==t.changes.strokeWidth){const n={...e,...t.changes},o=n.inkList.flatMap(e=>e.points),r=nt(tt(o),n.strokeWidth/2);return{...t.changes,rect:r}}return t.changes}},Gd=(e,t)=>{var n;switch(t.type){case"vertex-edit":if(t.changes.linePoints){const{start:n,end:o}=t.changes.linePoints;return{rect:Ad([n,o],e.strokeWidth,e.lineEndings),linePoints:{start:n,end:o}}}return t.changes;case"move":if(t.changes.rect){const n=t.changes.rect.origin.x-e.rect.origin.x,o=t.changes.rect.origin.y-e.rect.origin.y;return{rect:t.changes.rect,linePoints:{start:{x:e.linePoints.start.x+n,y:e.linePoints.start.y+o},end:{x:e.linePoints.end.x+n,y:e.linePoints.end.y+o}}}}return t.changes;case"resize":if(t.changes.rect){const o=e.rect,r=t.changes.rect;let a=r.size.width/o.size.width,i=r.size.height/o.size.height;const s=10;if((r.size.width<s||r.size.height<s)&&(a=Math.max(a,s/o.size.width),i=Math.max(i,s/o.size.height),t.changes.rect={origin:r.origin,size:{width:o.size.width*a,height:o.size.height*i}}),null==(n=t.metadata)?void 0:n.maintainAspectRatio){const e=Math.min(a,i);a=e,i=e,t.changes.rect.size={width:o.size.width*e,height:o.size.height*e}}const l={start:{x:t.changes.rect.origin.x+(e.linePoints.start.x-o.origin.x)*a,y:t.changes.rect.origin.y+(e.linePoints.start.y-o.origin.y)*i},end:{x:t.changes.rect.origin.x+(e.linePoints.end.x-o.origin.x)*a,y:t.changes.rect.origin.y+(e.linePoints.end.y-o.origin.y)*i}};return{rect:t.changes.rect,linePoints:l}}return t.changes;case"property-update":if(t.changes.strokeWidth||t.changes.lineEndings){const n={...e,...t.changes},o=Ad([n.linePoints.start,n.linePoints.end],n.strokeWidth,n.lineEndings);return{...t.changes,rect:o}}return t.changes;default:return t.changes}},Ld=(e,t)=>{var n;switch(t.type){case"vertex-edit":return t.changes.vertices&&t.changes.vertices.length?{rect:Ad(t.changes.vertices,e.strokeWidth,e.lineEndings),vertices:t.changes.vertices}:t.changes;case"move":if(t.changes.rect){const n=t.changes.rect.origin.x-e.rect.origin.x,o=t.changes.rect.origin.y-e.rect.origin.y,r=e.vertices.map(e=>({x:e.x+n,y:e.y+o}));return{rect:t.changes.rect,vertices:r}}return t.changes;case"resize":if(t.changes.rect){const o=e.rect,r=t.changes.rect;let a=r.size.width/o.size.width,i=r.size.height/o.size.height;const s=10;if((r.size.width<s||r.size.height<s)&&(a=Math.max(a,s/o.size.width),i=Math.max(i,s/o.size.height),t.changes.rect={origin:r.origin,size:{width:o.size.width*a,height:o.size.height*i}}),null==(n=t.metadata)?void 0:n.maintainAspectRatio){const e=Math.min(a,i);a=e,i=e,t.changes.rect.size={width:o.size.width*e,height:o.size.height*e}}const l=e.vertices.map(e=>({x:t.changes.rect.origin.x+(e.x-o.origin.x)*a,y:t.changes.rect.origin.y+(e.y-o.origin.y)*i}));return{rect:t.changes.rect,vertices:l}}return t.changes;case"property-update":if(void 0!==t.changes.strokeWidth||void 0!==t.changes.lineEndings){const n={...e,...t.changes},o=Ad(n.vertices,n.strokeWidth,n.lineEndings);return{...t.changes,rect:o}}return t.changes;default:return t.changes}},Nd=(e,t)=>{var n;switch(t.type){case"vertex-edit":if(t.changes.vertices&&t.changes.vertices.length){const n=e.strokeWidth/2;return{rect:nt(tt(t.changes.vertices),n),vertices:t.changes.vertices}}return t.changes;case"move":if(t.changes.rect){const n=t.changes.rect.origin.x-e.rect.origin.x,o=t.changes.rect.origin.y-e.rect.origin.y,r=e.vertices.map(e=>({x:e.x+n,y:e.y+o}));return{rect:t.changes.rect,vertices:r}}return t.changes;case"resize":if(t.changes.rect){const o=e.rect,r=t.changes.rect;let a=r.size.width/o.size.width,i=r.size.height/o.size.height;const s=10;if((r.size.width<s||r.size.height<s)&&(a=Math.max(a,s/o.size.width),i=Math.max(i,s/o.size.height),t.changes.rect={origin:r.origin,size:{width:o.size.width*a,height:o.size.height*i}}),null==(n=t.metadata)?void 0:n.maintainAspectRatio){const e=Math.min(a,i);a=e,i=e,t.changes.rect.size={width:o.size.width*e,height:o.size.height*e}}const l=e.vertices.map(e=>({x:t.changes.rect.origin.x+(e.x-o.origin.x)*a,y:t.changes.rect.origin.y+(e.y-o.origin.y)*i}));return{rect:t.changes.rect,vertices:l}}return t.changes;case"property-update":if(void 0!==t.changes.strokeWidth){const n={...e,...t.changes},o=n.strokeWidth/2,r=nt(tt(n.vertices),o);return{...t.changes,rect:r}}return t.changes;default:return t.changes}},zd=class extends Qn{constructor(e,t,n){var o,r,a;super(e,t),this.ANNOTATION_HISTORY_TOPIC="annotations",this.state$=lo(),this.pendingContexts=new Map,this.isInitialLoadComplete=new Map,this.importQueue=new Map,this.handlerFactories=new Map,this.activeTool$=lo(),this.events$=lo(),this.toolsChange$=lo(),this.patchRegistry=new wd,this.config=n,this.selection=(null==(o=t.getPlugin("selection"))?void 0:o.provides())??null,this.history=(null==(r=t.getPlugin("history"))?void 0:r.provides())??null,this.interactionManager=(null==(a=t.getPlugin("interaction-manager"))?void 0:a.provides())??null,this.registerHandlerFactories(),this.registerBuiltInPatches()}onDocumentLoadingStarted(e){this.dispatch(function(e){return{type:Cl,payload:{documentId:e,state:{pages:{},byUid:{},selectedUid:null,activeToolId:null,hasPendingChanges:!1}}}}(e)),this.pendingContexts.set(e,new Map),this.isInitialLoadComplete.set(e,!1),this.importQueue.set(e,[]),this.logger.debug("AnnotationPlugin","DocumentOpened",`Initialized annotation state for document: ${e}`)}onDocumentLoaded(e){const t=this.getCoreDocument(e);if((null==t?void 0:t.document)&&this.getAllAnnotations(e,t.document),this.selection)for(const e of this.state.tools)e.interaction.textSelection&&this.selection.enableForMode(e.interaction.mode??e.id)}onDocumentClosed(e){this.dispatch(function(e){return{type:Ml,payload:e}}(e)),this.pendingContexts.delete(e),this.isInitialLoadComplete.delete(e),this.importQueue.delete(e),this.logger.debug("AnnotationPlugin","DocumentClosed",`Cleaned up annotation state for document: ${e}`)}registerHandlerFactories(){this.handlerFactories.set(Et.CIRCLE,Od),this.handlerFactories.set(Et.SQUARE,Td),this.handlerFactories.set(Et.STAMP,Id),this.handlerFactories.set(Et.POLYGON,kd),this.handlerFactories.set(Et.POLYLINE,Md),this.handlerFactories.set(Et.LINE,Cd),this.handlerFactories.set(Et.INK,Fd),this.handlerFactories.set(Et.FREETEXT,bd)}registerBuiltInPatches(){this.patchRegistry.register(Et.INK,Rd),this.patchRegistry.register(Et.LINE,Gd),this.patchRegistry.register(Et.POLYLINE,Ld),this.patchRegistry.register(Et.POLYGON,Nd)}async initialize(){var e,t;this.state.tools.forEach(e=>this.registerInteractionForTool(e)),this.history&&this.history.onHistoryChange(e=>{e.topic===this.ANNOTATION_HISTORY_TOPIC&&!1!==this.config.autoCommit&&this.commit(e.documentId)}),null==(e=this.interactionManager)||e.onModeChange(e=>{var t,n;const o=(null==(t=this.state.tools.find(t=>(t.interaction.mode??t.id)===e.activeMode))?void 0:t.id)??null;o!==((null==(n=this.state.documents[e.documentId])?void 0:n.activeToolId)??null)&&e.documentId&&this.dispatch(Wl(e.documentId,o))}),null==(t=this.selection)||t.onEndSelection(({documentId:e})=>{var t,n,o;const r=this.getActiveTool(e);if(!r||!r.interaction.textSelection)return;const a=null==(t=this.selection)?void 0:t.getFormattedSelection(),i=null==(n=this.selection)?void 0:n.getSelectedText();if(a&&i){for(const t of a)i.wait(n=>{const o=_n();this.createAnnotation(t.pageIndex,{...r.defaults,rect:t.rect,segmentRects:t.segmentRects,pageIndex:t.pageIndex,created:new Date,id:o,custom:{text:n.join("\n")}},void 0,e),this.getToolBehavior(r,"deactivateToolAfterCreate")&&this.setActiveTool(null,e),this.getToolBehavior(r,"selectAfterCreate")&&this.selectAnnotation(t.pageIndex,o,e)},yn);null==(o=this.selection)||o.clear()}})}registerInteractionForTool(e){var t;null==(t=this.interactionManager)||t.registerMode({id:e.interaction.mode??e.id,scope:"page",exclusive:e.interaction.exclusive,cursor:e.interaction.cursor})}buildCapability(){return{getActiveTool:()=>this.getActiveTool(),setActiveTool:e=>this.setActiveTool(e),getState:()=>this.getDocumentState(),getPageAnnotations:e=>this.getPageAnnotations(e),getSelectedAnnotation:()=>this.getSelectedAnnotation(),getAnnotationById:e=>this.getAnnotationById(e),selectAnnotation:(e,t)=>this.selectAnnotation(e,t),deselectAnnotation:()=>this.deselectAnnotation(),importAnnotations:e=>this.importAnnotations(e),createAnnotation:(e,t,n)=>this.createAnnotation(e,t,n),updateAnnotation:(e,t,n)=>this.updateAnnotation(e,t,n),deleteAnnotation:(e,t)=>this.deleteAnnotation(e,t),renderAnnotation:e=>this.renderAnnotation(e),commit:()=>this.commit(),forDocument:e=>this.createAnnotationScope(e),getTools:()=>this.state.tools,getTool:e=>this.getTool(e),addTool:e=>{this.dispatch((e=>({type:$l,payload:e}))(e)),this.registerInteractionForTool(e)},findToolForAnnotation:e=>this.findToolForAnnotation(e),setToolDefaults:(e,t)=>this.dispatch(((e,t)=>({type:Bl,payload:{toolId:e,patch:t}}))(e,t)),getColorPresets:()=>[...this.state.colorPresets],addColorPreset:e=>this.dispatch((e=>({type:jl,payload:e}))(e)),transformAnnotation:(e,t)=>this.transformAnnotation(e,t),registerPatchFunction:(e,t)=>this.registerPatchFunction(e,t),onStateChange:this.state$.on,onActiveToolChange:this.activeTool$.on,onAnnotationEvent:this.events$.on,onToolsChange:this.toolsChange$.on}}createAnnotationScope(e){return{getState:()=>this.getDocumentState(e),getPageAnnotations:t=>this.getPageAnnotations(t,e),getSelectedAnnotation:()=>this.getSelectedAnnotation(e),getAnnotationById:t=>this.getAnnotationById(t,e),selectAnnotation:(t,n)=>this.selectAnnotation(t,n,e),deselectAnnotation:()=>this.deselectAnnotation(e),getActiveTool:()=>this.getActiveTool(e),setActiveTool:t=>this.setActiveTool(t,e),findToolForAnnotation:e=>this.findToolForAnnotation(e),importAnnotations:t=>this.importAnnotations(t,e),createAnnotation:(t,n,o)=>this.createAnnotation(t,n,o,e),updateAnnotation:(t,n,o)=>this.updateAnnotation(t,n,o,e),deleteAnnotation:(t,n)=>this.deleteAnnotation(t,n,e),renderAnnotation:t=>this.renderAnnotation(t,e),commit:()=>this.commit(e),onStateChange:t=>this.state$.on(n=>{n.documentId===e&&t(n.state)}),onAnnotationEvent:t=>this.events$.on(n=>{n.documentId===e&&t(n)}),onActiveToolChange:t=>this.activeTool$.on(n=>{n.documentId===e&&t(n.tool)})}}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o!==r&&(this.state$.emit({documentId:n,state:r}),o&&o.activeToolId!==r.activeToolId&&this.activeTool$.emit({documentId:n,tool:this.getActiveTool(n)}))}if(e.tools!==t.tools){for(const e in t.documents)this.activeTool$.emit({documentId:e,tool:this.getActiveTool(e)});this.toolsChange$.emit({tools:t.tools})}}registerPatchFunction(e,t){this.patchRegistry.register(e,t)}transformAnnotation(e,t){const n={type:t.type,changes:t.changes,metadata:t.metadata};return this.patchRegistry.transform(e,n)}registerPageHandlers(e,t,n,o){var r;const a=this.getCoreDocument(e),i=null==(r=null==a?void 0:a.document)?void 0:r.pages[t];if(!i)return()=>{};if(!this.interactionManager)return()=>{};const s=[];for(const r of this.state.tools){if(!r.defaults.type)continue;const a=this.handlerFactories.get(r.defaults.type);if(!a)continue;const l={pageIndex:t,pageSize:i.size,scale:n,services:o.services,onPreview:e=>o.onPreview(r.id,e),onCommit:(n,o)=>{this.createAnnotation(t,n,o,e),this.getToolBehavior(r,"deactivateToolAfterCreate")&&this.setActiveTool(null,e),this.getToolBehavior(r,"selectAfterCreate")&&this.selectAnnotation(t,n.id,e)},getTool:()=>this.state.tools.find(e=>e.id===r.id)},d=this.interactionManager.registerHandlers({documentId:e,modeId:r.interaction.mode??r.id,handlers:a.create(l),pageIndex:t});s.push(d)}return()=>s.forEach(e=>e())}getDocumentState(e){const t=e??this.getActiveDocumentId(),n=this.state.documents[t];if(!n)throw new Error(`Annotation state not found for document: ${t}`);return n}getAllAnnotations(e,t){this.engine.getAllAnnotations(t).wait(t=>{this.dispatch(((e,t)=>({type:kl,payload:{documentId:e,annotations:t}}))(e,t)),this.isInitialLoadComplete.set(e,!0);const n=this.importQueue.get(e);n&&n.length>0&&this.processImportQueue(e),this.events$.emit({type:"loaded",documentId:e,total:Object.values(t).reduce((e,t)=>e+t.length,0)})},yn)}getPageAnnotations(e,t){const{pageIndex:n}=e,o=t??this.getActiveDocumentId(),r=this.getCoreDocument(o),a=null==r?void 0:r.document;if(!a)return Wt.reject({code:Ut.NotFound,message:"Document not found"});const i=a.pages.find(e=>e.index===n);return i?this.engine.getPageAnnotations(a,i):Wt.reject({code:Ut.NotFound,message:"Page not found"})}getSelectedAnnotation(e){return(e=>e.selectedUid?e.byUid[e.selectedUid]:null)(this.getDocumentState(e))}getAnnotationById(e,t){const n=this.getDocumentState(t);return cd(n,e)}renderAnnotation({pageIndex:e,annotation:t,options:n},o){const r=o??this.getActiveDocumentId(),a=this.getCoreDocument(r),i=null==a?void 0:a.document;if(!i)return Wt.reject({code:Ut.NotFound,message:"Document not found"});const s=i.pages.find(t=>t.index===e);return s?this.engine.renderPageAnnotation(i,s,t,n):Wt.reject({code:Ut.NotFound,message:"Page not found"})}importAnnotations(e,t){const n=t??this.getActiveDocumentId();if(!this.isInitialLoadComplete.get(n)){const t=this.importQueue.get(n)||[];return t.push(...e),void this.importQueue.set(n,t)}this.processImportItems(n,e)}processImportQueue(e){const t=this.importQueue.get(e);if(!t||0===t.length)return;const n=[...t];this.importQueue.set(e,[]),this.processImportItems(e,n)}processImportItems(e,t){const n=this.pendingContexts.get(e);if(n){for(const o of t){const{annotation:t,ctx:r}=o,a=t.pageIndex,i=t.id;this.dispatch(Hl(e,a,t)),r&&n.set(i,r)}!1!==this.config.autoCommit&&this.commit(e)}}createAnnotation(e,t,n,o){const r=t.id,a=o??this.getActiveDocumentId(),i=this.pendingContexts.get(a);if(!i)return;const s={...t,author:t.author??this.config.annotationAuthor},l=()=>{this.dispatch(Hl(a,e,s)),n&&i.set(r,n),this.events$.emit({type:"create",documentId:a,annotation:s,pageIndex:e,ctx:n,committed:!1})};if(!this.history)return l(),void(this.config.autoCommit&&this.commit(a));const d={execute:l,undo:()=>{i.delete(r),this.dispatch(Ul(a)),this.dispatch(Yl(a,e,r)),this.events$.emit({type:"delete",documentId:a,annotation:s,pageIndex:e,committed:!1})}};this.history.forDocument(a).register(d,this.ANNOTATION_HISTORY_TOPIC)}buildPatch(e,t){return"rect"in t?t:this.transformAnnotation(e,{type:"property-update",changes:t})}updateAnnotation(e,t,n,o){const r=o??this.getActiveDocumentId(),a=this.getDocumentState(r).byUid[t].object,i=this.buildPatch(a,{...n,author:n.author??this.config.annotationAuthor}),s=()=>{this.dispatch(Vl(r,e,t,i)),this.events$.emit({type:"update",documentId:r,annotation:a,pageIndex:e,patch:i,committed:!1})};if(!this.history)return s(),void(!1!==this.config.autoCommit&&this.commit(r));const l=Object.fromEntries(Object.keys(n).map(e=>[e,a[e]])),d={execute:s,undo:()=>{this.dispatch(Vl(r,e,t,l)),this.events$.emit({type:"update",documentId:r,annotation:a,pageIndex:e,patch:l,committed:!1})}};this.history.forDocument(r).register(d,this.ANNOTATION_HISTORY_TOPIC)}deleteAnnotation(e,t,n){var o;const r=n??this.getActiveDocumentId(),a=null==(o=this.getDocumentState(r).byUid[t])?void 0:o.object;if(!a)return;const i=()=>{this.dispatch(Ul(r)),this.dispatch(Yl(r,e,t)),this.events$.emit({type:"delete",documentId:r,annotation:a,pageIndex:e,committed:!1})};if(!this.history)return i(),void(!1!==this.config.autoCommit&&this.commit(r));const s={execute:i,undo:()=>{this.dispatch(Hl(r,e,a)),this.events$.emit({type:"create",documentId:r,annotation:a,pageIndex:e,committed:!1})}};this.history.forDocument(r).register(s,this.ANNOTATION_HISTORY_TOPIC)}selectAnnotation(e,t,n){const o=n??this.getActiveDocumentId();this.dispatch(((e,t,n)=>({type:Tl,payload:{documentId:e,pageIndex:t,id:n}}))(o,e,t))}deselectAnnotation(e){const t=e??this.getActiveDocumentId();this.dispatch(Ul(t))}getActiveTool(e){const t=this.getDocumentState(e);return t.activeToolId?this.state.tools.find(e=>e.id===t.activeToolId)??null:null}setActiveTool(e,t){var n,o;const r=t??this.getActiveDocumentId(),a=this.getDocumentState(r);if(e===a.activeToolId)return;this.dispatch(Wl(r,e));const i=this.state.tools.find(t=>t.id===e);i?null==(n=this.interactionManager)||n.forDocument(r).activate(i.interaction.mode??i.id):null==(o=this.interactionManager)||o.forDocument(r).activateDefaultMode()}getTool(e){return this.state.tools.find(t=>t.id===e)}findToolForAnnotation(e){let t=null,n=0;for(const o of this.state.tools){const r=o.matchScore(e);r>n&&(n=r,t=o)}return t}commit(e){const t=new ft,n=e??this.getActiveDocumentId(),o=this.getDocumentState(n);if(!o.hasPendingChanges)return Wt.resolve(!0);const r=this.getCoreDocument(n),a=null==r?void 0:r.document;if(!a)return Wt.reject({code:Ut.NotFound,message:"Document not found"});const i=this.pendingContexts.get(n);if(!i)return Wt.resolve(!0);const s=[],l=[],d=[];for(const[e,t]of Object.entries(o.byUid)){if("synced"===t.commitState)continue;const o=a.pages.find(e=>e.index===t.object.pageIndex);if(o)switch(t.commitState){case"new":const r=i.get(t.object.id),c=this.engine.createPageAnnotation(a,o,t.object,r);c.wait(()=>{this.events$.emit({type:"create",documentId:n,annotation:t.object,pageIndex:t.object.pageIndex,ctx:r,committed:!0}),i.delete(t.object.id)},yn),s.push(c);break;case"dirty":const u=this.engine.updatePageAnnotation(a,o,t.object);u.wait(()=>{this.events$.emit({type:"update",documentId:n,annotation:t.object,pageIndex:t.object.pageIndex,patch:t.object,committed:!0})},yn),l.push(u);break;case"deleted":d.push({ta:t,uid:e})}}const c=[];for(const{ta:e,uid:t}of d){const o=a.pages.find(t=>t.index===e.object.pageIndex);if("deleted"===e.commitState&&e.object.id){const r=new ft;this.engine.removePageAnnotation(a,o,e.object).wait(()=>{this.dispatch(ql(n,t)),this.events$.emit({type:"delete",documentId:n,annotation:e.object,pageIndex:e.object.pageIndex,committed:!0}),r.resolve(!0)},r.fail),c.push(r)}else this.dispatch(ql(n,t))}const u=[...s,...l,...c];return ft.allSettled(u).wait(()=>{this.dispatch((e=>({type:Nl,payload:{documentId:e}}))(n)),t.resolve(!0)},t.fail),t}getToolBehavior(e,t){var n;return void 0!==(null==(n=e.behavior)?void 0:n[t])?e.behavior[t]:!1!==this.config[t]}};zd.id="annotation";let jd=zd;function Bd(e){return t=>(null==t?void 0:t.id)===e}const $d=Bd("highlight"),Ud=Bd("squiggly"),Wd=Bd("underline"),Hd=Bd("strikeout"),Vd={manifest:El,create:(e,t)=>new jd(Sl,e,t),reducer:(e,t)=>{switch(t.type){case Cl:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case Ml:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"ANNOTATION/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case kl:{const{documentId:n,annotations:o}=t.payload,r=e.documents[n];if(!r)return e;const a={},i={};for(const[e,t]of Object.entries(o)){const n=Number(e),o=r.pages[n]||[];for(const e of o)delete i[e];const s=t.map(e=>{const t=e.id;return i[t]={commitState:"synced",object:e},t});a[n]=s}return{...e,documents:{...e.documents,[n]:{...r,pages:a,byUid:i}}}}case Tl:{const{documentId:n,id:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,selectedUid:o}}}:e}case Il:{const{documentId:n}=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,selectedUid:null}}}:e}case Ol:{const{documentId:n,toolId:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,activeToolId:o}}}:e}case Rl:{const{documentId:n,pageIndex:o,annotation:r}=t.payload,a=e.documents[n];if(!a)return e;const i=r.id;return{...e,documents:{...e.documents,[n]:{...a,pages:{...a.pages,[o]:[...a.pages[o]??[],i]},byUid:{...a.byUid,[i]:{commitState:"new",object:r}},hasPendingChanges:!0}}}}case Ll:{const{documentId:n,pageIndex:o,id:r}=t.payload,a=e.documents[n];return a&&a.byUid[r]?{...e,documents:{...e.documents,[n]:{...a,pages:{...a.pages,[o]:(a.pages[o]??[]).filter(e=>e!==r)},byUid:{...a.byUid,[r]:{...a.byUid[r],commitState:"deleted"}},hasPendingChanges:!0}}}:e}case Gl:{const{documentId:n,id:o,patch:r}=t.payload,a=e.documents[n];return a?{...e,documents:{...e.documents,[n]:gd(a,o,r)}}:e}case Nl:{const{documentId:n}=t.payload,o=e.documents[n];if(!o)return e;const r={};for(const[e,t]of Object.entries(o.byUid))r[e]={...t,commitState:"dirty"===t.commitState||"new"===t.commitState?"synced":t.commitState};return{...e,documents:{...e.documents,[n]:{...o,byUid:r,hasPendingChanges:!1}}}}case zl:{const{documentId:n,uid:o}=t.payload,r=e.documents[n];if(!r)return e;const{[o]:a,...i}=r.byUid;return{...e,documents:{...e.documents,[n]:{...r,byUid:i}}}}case $l:{const n=new Map(e.tools.map(e=>[e.id,e]));return n.set(t.payload.id,t.payload),{...e,tools:Array.from(n.values())}}case Bl:{const{toolId:n,patch:o}=t.payload;return{...e,tools:e.tools.map(e=>e.id===n?{...e,defaults:{...e.defaults,...o}}:e)}}case jl:return e.colorPresets.includes(t.payload)?e:{...e,colorPresets:[...e.colorPresets,t.payload]};default:return e}},initialState:(e,t)=>(e=>{const t=new Map;return pd.forEach(e=>t.set(e.id,e)),(e.tools||[]).forEach(e=>t.set(e.id,e)),{documents:{},activeDocumentId:null,tools:Array.from(t.values()),colorPresets:e.colorPresets??hd}})(t)},Yd="INTERACTION/INIT_STATE",qd="INTERACTION/CLEANUP_STATE",Kd="INTERACTION/ACTIVATE_MODE",Xd="INTERACTION/PAUSE",Zd="INTERACTION/RESUME",Qd="INTERACTION/SET_CURSOR",Jd="INTERACTION/SET_DEFAULT_MODE",ec="INTERACTION/SET_EXCLUSION_RULES",tc="INTERACTION/ADD_EXCLUSION_CLASS",nc="INTERACTION/REMOVE_EXCLUSION_CLASS",oc="INTERACTION/ADD_EXCLUSION_ATTRIBUTE",rc="INTERACTION/REMOVE_EXCLUSION_ATTRIBUTE";function ac(e){return{type:Jd,payload:{mode:e}}}function ic(e){return{type:ec,payload:{rules:e}}}const sc="pointerMode",lc=class extends Qn{constructor(e,t,n){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Map,this.alwaysPage=new Map,this.onModeChange$=so(),this.onHandlerChange$=so(),this.onCursorChange$=so(),this.onStateChange$=lo(),this.registerMode({id:sc,scope:"page",exclusive:!1,cursor:"auto"}),this.dispatch(ac(sc)),n.exclusionRules&&this.dispatch(ic(n.exclusionRules))}onDocumentLoadingStarted(e){const t={activeMode:this.state.defaultMode,cursor:"auto",paused:!1};this.dispatch(function(e,t){return{type:Yd,payload:{documentId:e,state:t}}}(e,t)),this.cursorClaims.set(e,new Map),this.buckets.set(e,new Map),this.alwaysGlobal.set(e,new Set),this.alwaysPage.set(e,new Map);const n=this.buckets.get(e);for(const e of this.modes.keys())n.set(e,{global:new Set,page:new Map});this.logger.debug("InteractionManagerPlugin","DocumentOpened",`Initialized interaction state for document: ${e}`)}onDocumentClosed(e){this.cursorClaims.delete(e),this.buckets.delete(e),this.alwaysGlobal.delete(e),this.alwaysPage.delete(e),this.dispatch(function(e){return{type:qd,payload:e}}(e)),this.logger.debug("InteractionManagerPlugin","DocumentClosed",`Cleaned up interaction state for document: ${e}`)}buildCapability(){return{getActiveMode:()=>this.getActiveMode(),getActiveInteractionMode:()=>this.getActiveInteractionMode(),activate:e=>this.activate(e),activateDefaultMode:()=>this.activateDefaultMode(),setCursor:(e,t,n)=>this.setCursor(e,t,n),getCurrentCursor:()=>this.getCurrentCursor(),removeCursor:e=>this.removeCursor(e),getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.pause(),resume:()=>this.resume(),isPaused:()=>this.registry.isDestroyed()||this.isPaused(),getState:()=>this.getDocumentStateOrThrow(),forDocument:e=>this.createInteractionScope(e),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setDefaultMode:e=>this.setDefaultMode(e),getDefaultMode:()=>this.state.defaultMode,getExclusionRules:()=>this.state.exclusionRules,setExclusionRules:e=>this.dispatch(ic(e)),addExclusionClass:e=>this.dispatch(function(e){return{type:tc,payload:{className:e}}}(e)),removeExclusionClass:e=>this.dispatch(function(e){return{type:nc,payload:{className:e}}}(e)),addExclusionAttribute:e=>this.dispatch(function(e){return{type:oc,payload:{attribute:e}}}(e)),removeExclusionAttribute:e=>this.dispatch(function(e){return{type:rc,payload:{attribute:e}}}(e)),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on}}createInteractionScope(e){return{getActiveMode:()=>this.getActiveMode(e),getActiveInteractionMode:()=>this.getActiveInteractionMode(e),activate:t=>this.activate(t,e),activateDefaultMode:()=>this.activateDefaultMode(e),setCursor:(t,n,o)=>this.setCursor(t,n,o,e),getCurrentCursor:()=>this.getCurrentCursor(e),removeCursor:t=>this.removeCursor(t,e),getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(e),pause:()=>this.pause(e),resume:()=>this.resume(e),isPaused:()=>this.isPaused(e),getState:()=>this.getDocumentStateOrThrow(e),onModeChange:t=>this.onModeChange$.on(n=>{n.documentId===e&&t(n.activeMode)}),onCursorChange:t=>this.onCursorChange$.on(n=>{n.documentId===e&&t(n.cursor)}),onStateChange:t=>this.onStateChange$.on(n=>{n.documentId===e&&t(n.state)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Interaction state not found for document: ${e??"active"}`);return t}activate(e,t){var n;const o=t??this.getActiveDocumentId(),r=this.getDocumentStateOrThrow(o);if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===r.activeMode)return;const a=r.activeMode;null==(n=this.cursorClaims.get(o))||n.clear(),this.notifyHandlersInactive(o,a),this.dispatch(function(e,t){return{type:Kd,payload:{documentId:e,mode:t}}}(o,e)),this.emitCursor(o),this.notifyHandlersActive(o,e),this.onModeChange$.emit({documentId:o,activeMode:e,previousMode:a})}activateDefaultMode(e){const t=e??this.getActiveDocumentIdOrNull();t&&this.activate(this.state.defaultMode,t)}setDefaultMode(e){if(!this.modes.has(e))throw new Error(`[interaction] cannot set unknown mode '${e}' as default`);this.dispatch(ac(e))}getActiveMode(e){return this.getDocumentStateOrThrow(e).activeMode}getActiveInteractionMode(e){const t=this.getDocumentState(e);return t?this.modes.get(t.activeMode)??null:null}activeModeIsExclusive(e){const t=this.getActiveInteractionMode(e);return!!(null==t?void 0:t.exclusive)}pause(e){const t=e??this.getActiveDocumentId();this.dispatch(function(e){return{type:Xd,payload:e}}(t))}resume(e){const t=e??this.getActiveDocumentId();this.dispatch(function(e){return{type:Zd,payload:e}}(t))}isPaused(e){return this.getDocumentStateOrThrow(e).paused}registerMode(e){this.modes.set(e.id,e);for(const t of this.buckets.keys()){const n=this.buckets.get(t);n.has(e.id)||n.set(e.id,{global:new Set,page:new Map})}}registerHandlers({documentId:e,modeId:t,handlers:n,pageIndex:o}){const r=Array.isArray(t)?t:[t],a=[],i=this.buckets.get(e);if(!i)throw new Error(`No buckets found for document: ${e}`);for(const e of r){const t=i.get(e);if(!t)throw new Error(`unknown mode '${e}'`);if(null==o)t.global.add(n);else{const e=t.page.get(o)??new Set;e.add(n),t.page.set(o,e)}a.push(()=>{if(null==o)t.global.delete(n);else{const e=t.page.get(o);e&&(e.delete(n),0===e.size&&t.page.delete(o))}})}return this.onHandlerChange$.emit({...this.state}),()=>{a.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type){const n=this.alwaysGlobal.get(e.documentId)??new Set;return n.add(t),this.alwaysGlobal.set(e.documentId,n),this.onHandlerChange$.emit({...this.state}),()=>{n.delete(t),this.onHandlerChange$.emit({...this.state})}}const n=this.alwaysPage.get(e.documentId)??new Map,o=n.get(e.pageIndex)??new Set;return o.add(t),n.set(e.pageIndex,o),this.alwaysPage.set(e.documentId,n),this.onHandlerChange$.emit({...this.state}),()=>{o.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){var t;const n=this.getDocumentState(e.documentId);if(!n)return null;const o=this.modes.get(n.activeMode);if(!o)return null;const r=this.buckets.get(e.documentId);if(!r)return null;const a=r.get(o.id);if(!a)return null;const i=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel","onMouseDown","onMouseUp","onMouseMove","onMouseEnter","onMouseLeave","onMouseCancel","onClick","onDoubleClick"],n={};for(const o of t)n[o]=(t,n,r)=>{var a;for(const i of e)null==(a=i[o])||a.call(i,t,n,r)};return n}([...e,...t]):null;return"global"===e.type?i(this.alwaysGlobal.get(e.documentId)??new Set,"global"===o.scope?a.global:new Set):i((null==(t=this.alwaysPage.get(e.documentId))?void 0:t.get(e.pageIndex))??new Set,"page"===o.scope?a.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,n=0,o){const r=o??this.getActiveDocumentId(),a=this.cursorClaims.get(r);a&&(a.set(e,{cursor:t,priority:n}),this.emitCursor(r))}removeCursor(e,t){const n=t??this.getActiveDocumentId(),o=this.cursorClaims.get(n);o&&(o.delete(e),this.emitCursor(n))}getCurrentCursor(e){return this.getDocumentStateOrThrow(e).cursor}emitCursor(e){var t;const n=this.cursorClaims.get(e);if(!n)return;const o=this.getDocumentState(e);if(!o)return;const r=[...n.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(t=this.modes.get(o.activeMode))?void 0:t.cursor)??"auto"};r.cursor!==o.cursor&&(this.dispatch(function(e,t){return{type:Qd,payload:{documentId:e,cursor:t}}}(e,r.cursor)),this.onCursorChange$.emit({documentId:e,cursor:r.cursor}))}notifyHandlersActive(e,t){var n,o;null==(n=this.alwaysGlobal.get(e))||n.forEach(e=>{var n;null==(n=e.onHandlerActiveStart)||n.call(e,t)}),null==(o=this.alwaysPage.get(e))||o.forEach(e=>{e.forEach(e=>{var n;null==(n=e.onHandlerActiveStart)||n.call(e,t)})});const r=this.modes.get(t);if(!r)return;const a=this.buckets.get(e);if(!a)return;const i=a.get(t);i&&("global"===r.scope&&i.global.forEach(e=>{var n;null==(n=e.onHandlerActiveStart)||n.call(e,t)}),"page"===r.scope&&i.page.forEach(e=>{e.forEach(e=>{var n;null==(n=e.onHandlerActiveStart)||n.call(e,t)})}))}notifyHandlersInactive(e,t){var n,o;null==(n=this.alwaysGlobal.get(e))||n.forEach(e=>{var n;null==(n=e.onHandlerActiveEnd)||n.call(e,t)}),null==(o=this.alwaysPage.get(e))||o.forEach(e=>{e.forEach(e=>{var n;null==(n=e.onHandlerActiveEnd)||n.call(e,t)})});const r=this.modes.get(t);if(!r)return;const a=this.buckets.get(e);if(!a)return;const i=a.get(t);i&&("global"===r.scope&&i.global.forEach(e=>{var n;null==(n=e.onHandlerActiveEnd)||n.call(e,t)}),"page"===r.scope&&i.page.forEach(e=>{e.forEach(e=>{var n;null==(n=e.onHandlerActiveEnd)||n.call(e,t)})}))}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o!==r&&this.onStateChange$.emit({documentId:n,state:r})}}async initialize(e){this.logger.info("InteractionManagerPlugin","Initialize","Interaction Manager Plugin initialized")}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),this.onHandlerChange$.clear(),this.onStateChange$.clear(),await super.destroy()}};lc.id="interaction-manager";let dc=lc;const cc="interaction-manager",uc={defaultMode:"pointerMode",exclusionRules:{classes:[],dataAttributes:["data-no-interaction"]},documents:{},activeDocumentId:null},mc={manifest:{id:cc,name:"Interaction Manager Plugin",version:"1.0.0",provides:["interaction-manager"],requires:[],optional:[],defaultConfig:{exclusionRules:{classes:[],dataAttributes:["data-no-interaction"]}}},create:(e,t)=>new dc(cc,e,t),reducer:(e=uc,t)=>{switch(t.type){case Yd:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case qd:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"INTERACTION/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case Kd:{const{documentId:n,mode:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,activeMode:o}}}:e}case Qd:{const{documentId:n,cursor:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,cursor:o}}}:e}case Xd:{const n=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,paused:!0}}}:e}case Zd:{const n=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,paused:!1}}}:e}case Jd:return{...e,defaultMode:t.payload.mode};case ec:return{...e,exclusionRules:t.payload.rules};case tc:return{...e,exclusionRules:{...e.exclusionRules,classes:[...e.exclusionRules.classes||[],t.payload.className].filter((e,t,n)=>n.indexOf(e)===t)}};case nc:return{...e,exclusionRules:{...e.exclusionRules,classes:(e.exclusionRules.classes||[]).filter(e=>e!==t.payload.className)}};case oc:return{...e,exclusionRules:{...e.exclusionRules,dataAttributes:[...e.exclusionRules.dataAttributes||[],t.payload.attribute].filter((e,t,n)=>n.indexOf(e)===t)}};case rc:return{...e,exclusionRules:{...e.exclusionRules,dataAttributes:(e.exclusionRules.dataAttributes||[]).filter(e=>e!==t.payload.attribute)}};default:return e}},initialState:uc},pc=()=>Fo(dc.id),hc={pointerdown:"onPointerDown",pointerup:"onPointerUp",pointermove:"onPointerMove",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",pointercancel:"onPointerCancel",mousedown:"onMouseDown",mouseup:"onMouseUp",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousecancel:"onMouseCancel",click:"onClick",dblclick:"onDoubleClick",touchstart:"onPointerDown",touchend:"onPointerUp",touchmove:"onPointerMove",touchcancel:"onPointerCancel"},gc=["pointerdown","pointerup","pointermove","pointerenter","pointerleave","pointercancel","mousedown","mouseup","mousemove","mouseenter","mouseleave","mousecancel","click","dblclick"],fc="undefined"!=typeof PointerEvent?gc:[...gc,"touchstart","touchend","touchmove","touchcancel"];function Fc(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}function Pc(e,t,n,o){const r=e.forDocument(t.documentId);let a=e.getHandlersForScope(t);const i=()=>{var e;return!1!==(null==(e=r.getActiveInteractionMode())?void 0:e.wantsRawTouch)},s={};let l=i();const d=e=>{fc.forEach(t=>{const o=s[t]??(s[t]=F);var r;n.addEventListener(t,o,(r=e,t.startsWith("touch")?{passive:!r}:{passive:!1}))})},c=()=>{fc.forEach(e=>{const t=s[e];t&&n.removeEventListener(e,t)})};d(l),n.style.touchAction=l?"none":"";const u=r.onModeChange(()=>{if("global"===t.type){const e=r.getActiveInteractionMode();n.style.cursor="global"===(null==e?void 0:e.scope)?e.cursor??"auto":"auto"}a=e.getHandlersForScope(t);const o=i();o!==l&&(c(),d(o),l=o,n.style.touchAction=l?"none":"")}),m=e.onHandlerChange(()=>{a=e.getHandlersForScope(t)}),p=r.getActiveInteractionMode(),h=r.getCurrentCursor();n.style.cursor="global"===t.type&&"global"!==(null==p?void 0:p.scope)?"auto":h;const g=r.onCursorChange(e=>{var o;"global"===t.type&&"global"!==(null==(o=r.getActiveInteractionMode())?void 0:o.scope)||(n.style.cursor=e)}),f=(e,t)=>{if(o)return o(e,t);const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}};function F(t){var o;if(e.isPaused())return;const i=e.getExclusionRules();if(t.target&&function(e,t){var n,o,r;if(!e)return!1;let a=e;for(;a;){if(null==(n=t.classes)?void 0:n.length)for(const e of t.classes)if(null==(o=a.classList)?void 0:o.contains(e))return!0;if(null==(r=t.dataAttributes)?void 0:r.length)for(const e of t.dataAttributes)if(a.hasAttribute(e))return!0;a=a.parentElement}return!1}(t.target,i))return;const s=hc[t.type];if(!s||!(null==a?void 0:a[s]))return;let d,c;if(Fc(t)&&l&&("touchmove"===t.type||"touchcancel"===t.type)&&t.preventDefault(),Fc(t)){const e="touchend"===t.type||"touchcancel"===t.type?t.changedTouches[0]:t.touches[0];if(!e)return;d=f(e,n),c={clientX:e.clientX,clientY:e.clientY,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey,metaKey:t.metaKey,target:t.target,currentTarget:t.currentTarget,setPointerCapture:()=>{},releasePointerCapture:()=>{}}}else{const e=t;d=f(e,n),c={clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,target:e.target,currentTarget:e.currentTarget,setPointerCapture:()=>{var t,n;null==(n=null==(t=e.target)?void 0:t.setPointerCapture)||n.call(t,e.pointerId)},releasePointerCapture:()=>{var t,n;null==(n=null==(t=e.target)?void 0:t.releasePointerCapture)||n.call(t,e.pointerId)}}}null==(o=a[s])||o.call(a,d,c,r.getActiveMode())}return()=>{c(),u(),g(),m()}}const bc=({children:e,documentId:t,style:n,...o})=>{const r=Te(null),{provides:a}=pc();return Me(()=>{if(a&&r.current)return Pc(a,{type:"global",documentId:t},r.current)},[a,t]),We("div",{ref:r,style:{width:"100%",height:"100%",...n},...o,children:e})},_c=({documentId:e,pageIndex:t,children:n,rotation:o,scale:r,convertEventToPoint:a,style:i,...s})=>{var l,d;const c=Te(null),{provides:u}=pc(),m=function(e){const{provides:t}=pc(),[n,o]=Ee(()=>{if(!t)return!1;const n=t.forDocument(e).getActiveInteractionMode();return"page"===(null==n?void 0:n.scope)&&!!n.exclusive});return Me(()=>{if(!t)return;const n=t.forDocument(e);return n.onModeChange(()=>{const e=n.getActiveInteractionMode();o("page"===(null==e?void 0:e.scope)&&!!(null==e?void 0:e.exclusive))})},[t,e]),n}(e),p=bo(e),h=null==(d=null==(l=null==p?void 0:p.document)?void 0:l.pages)?void 0:d[t],g=(null==h?void 0:h.size)??{width:0,height:0},f=o??(null==p?void 0:p.rotation)??0,F=r??(null==p?void 0:p.scale)??1,P=Xe(g,0,F),b=Oe((e,t)=>{const n=t.getBoundingClientRect(),o={x:e.clientX-n.left,y:e.clientY-n.top};return function(e,t,n,o){return et(Je(e,t,(4-n)%4),1/o)}(Xe({width:P.width,height:P.height},f,1),o,f,F)},[g,f,F]);return Me(()=>{if(u&&c.current)return Pc(u,{type:"page",documentId:e,pageIndex:t},c.current,a||b)},[u,e,t,a,b]),We("div",{ref:c,style:{position:"relative",width:P.width,height:P.height,...i},...s,children:[n,m&&We("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:10}})]})},vc={},yc=()=>Fo(jd.id),Dc=e=>{var t;const{provides:n}=yc(),[o,r]=Ee((null==(t=null==n?void 0:n.forDocument(e))?void 0:t.getState())??{pages:{},byUid:{},selectedUid:null,activeToolId:null,hasPendingChanges:!1});return Me(()=>{if(!n)return;const t=n.forDocument(e);return r(t.getState()),t.onStateChange(e=>{r(e)})},[n,e]),{state:o,provides:(null==n?void 0:n.forDocument(e))??null}};function xc({scale:e,documentId:t,pageIndex:n,rotation:o,pageWidth:r,pageHeight:a,trackedAnnotation:i,children:s,isSelected:l,isDraggable:d,isResizable:c,lockAspectRatio:u=!1,style:m={},vertexConfig:p,selectionMenu:h,outlineOffset:g=1,onDoubleClick:f,onSelect:F,zIndex:P=1,resizeUI:b,vertexUI:_,selectionOutlineColor:v="#007ACC",customAnnotationRenderer:y,...D}){const[x,A]=Ee(i.object),{provides:w}=yc(),S=Te(null),E=Ie(()=>w?w.forDocument(t):null,[w,t]),C=x?{...i.object,...x}:i.object,M=(null==b?void 0:b.color)??"#007ACC",k=(null==_?void 0:_.color)??"#007ACC",T=(null==b?void 0:b.size)??12,I=(null==_?void 0:_.size)??12,{dragProps:O,vertices:R,resize:G}=function(e){const{controller:t,resizeUI:n,vertexUI:o,includeVertices:r=!1,handleAttrs:a,vertexAttrs:i}=e,{dragProps:s,createResizeProps:l,createVertexProps:d}=function(e){const{onUpdate:t,enabled:n=!0,...o}=e,r=Te(null),a=Te(t);Me(()=>{a.current=t},[t]),Me(()=>{r.current?r.current.updateConfig(o):r.current=new Ws(o,e=>{var t;return null==(t=a.current)?void 0:t.call(a,e)})},[o.element,o.constraints,o.maintainAspectRatio,o.pageRotation,o.scale,o.vertices]);const i=Oe(e=>{var t;n&&(e.preventDefault(),e.stopPropagation(),null==(t=r.current)||t.startDrag(e.clientX,e.clientY),e.currentTarget.setPointerCapture(e.pointerId))},[n]),s=Oe(e=>{var t;e.preventDefault(),e.stopPropagation(),null==(t=r.current)||t.move(e.clientX,e.clientY)},[]),l=Oe(e=>{var t,n,o;e.preventDefault(),e.stopPropagation(),null==(t=r.current)||t.end(),null==(o=(n=e.currentTarget).releasePointerCapture)||o.call(n,e.pointerId)},[]),d=Oe(e=>({onPointerDown:t=>{var o;n&&(t.preventDefault(),t.stopPropagation(),null==(o=r.current)||o.startResize(e,t.clientX,t.clientY),t.currentTarget.setPointerCapture(t.pointerId))},onPointerMove:s,onPointerUp:l,onPointerCancel:l}),[n,s,l]),c=Oe(e=>({onPointerDown:t=>{var o;n&&(t.preventDefault(),t.stopPropagation(),null==(o=r.current)||o.startVertexEdit(e,t.clientX,t.clientY),t.currentTarget.setPointerCapture(t.pointerId))},onPointerMove:s,onPointerUp:l,onPointerCancel:l}),[n,s,l]);return{dragProps:n?{onPointerDown:i,onPointerMove:s,onPointerUp:l,onPointerCancel:l}:{},createResizeProps:d,createVertexProps:c}}(t),c=Ie(()=>function(e,t={}){const{handleSize:n=8,spacing:o=1,offsetMode:r="outside",includeSides:a=!1,zIndex:i=3,rotationAwareCursor:s=!0}=t,l=(e.pageRotation??0)%4,d=e=>({[e]:Vs(n,o,r)+"px"});return[["nw",{...d("top"),...d("left")}],["ne",{...d("top"),...d("right")}],["sw",{...d("bottom"),...d("left")}],["se",{...d("bottom"),...d("right")}],...a?[["n",{...d("top"),left:`calc(50% - ${n/2}px)`}],["s",{...d("bottom"),left:`calc(50% - ${n/2}px)`}],["w",{...d("left"),top:`calc(50% - ${n/2}px)`}],["e",{...d("right"),top:`calc(50% - ${n/2}px)`}]]:[]].map(([e,t])=>({handle:e,style:{position:"absolute",width:n+"px",height:n+"px",borderRadius:"50%",zIndex:i,cursor:s?Hs(e,l):"default",touchAction:"none",...t},attrs:{"data-epdf-handle":e}}))}(t,n).map(e=>{var t;return{key:null==(t=e.attrs)?void 0:t["data-epdf-handle"],style:e.style,...l(e.handle),...e.attrs??{},...(null==a?void 0:a(e.handle))??{}}}),[t.element.origin.x,t.element.origin.y,t.element.size.width,t.element.size.height,t.scale,t.pageRotation,t.maintainAspectRatio,null==n?void 0:n.handleSize,null==n?void 0:n.spacing,null==n?void 0:n.offsetMode,null==n?void 0:n.includeSides,null==n?void 0:n.zIndex,null==n?void 0:n.rotationAwareCursor,l,a]),u=Ie(()=>{if(!r)return[];const e=function(e,t={},n){const{vertexSize:o=12,zIndex:r=4}=t,a=e.element,i=e.scale??1;return(n??e.vertices??[]).map((e,t)=>({handle:"nw",style:{position:"absolute",left:(e.x-a.origin.x)*i-o/2+"px",top:(e.y-a.origin.y)*i-o/2+"px",width:o+"px",height:o+"px",borderRadius:"50%",cursor:"pointer",zIndex:r,touchAction:"none"},attrs:{"data-epdf-vertex":t}}))}(t,o,t.vertices);return e.map((e,t)=>({key:t,style:e.style,...d(t),...e.attrs??{},...(null==i?void 0:i(t))??{}}))},[r,t.element.origin.x,t.element.origin.y,t.element.size.width,t.element.size.height,t.scale,t.vertices,null==o?void 0:o.vertexSize,null==o?void 0:o.zIndex,d,i]);return{dragProps:s,resize:c,vertices:u}}({controller:{element:C.rect,vertices:null==p?void 0:p.extractVertices(C),constraints:{minWidth:10,minHeight:10,boundingBox:{width:r,height:a}},maintainAspectRatio:u,pageRotation:o,scale:e,enabled:l,onUpdate:e=>{var t;if(!(null==(t=e.transformData)?void 0:t.type))return;"start"===e.state&&(S.current=C);const o=e.transformData.type,r=S.current??C,a=e.transformData.changes.vertices?null==p?void 0:p.transformAnnotation(r,e.transformData.changes.vertices):{rect:e.transformData.changes.rect},s=null==w?void 0:w.transformAnnotation(r,{type:o,changes:a,metadata:e.transformData.metadata});s&&A(e=>({...e,...s})),"end"===e.state&&s&&(S.current=null,null==E||E.updateAnnotation(n,i.object.id,s))}},resizeUI:{handleSize:T,spacing:g,offsetMode:"outside",includeSides:!u,zIndex:P+1},vertexUI:{vertexSize:I,zIndex:P+2},includeVertices:!!p}),L=function(e,{delay:t=300,tolerancePx:n=18}={}){const o=Te({t:0,x:0,y:0}),r=Oe(r=>{if(!e)return;if("mouse"===r.pointerType||!1===r.isPrimary)return;const a=performance.now(),i=r.clientX,s=r.clientY,l=a-o.current.t<=t,d=i-o.current.x,c=s-o.current.y;l&&d*d+c*c<=n*n&&(null==e||e(r)),o.current={t:a,x:i,y:s}},[e,t,n]),a=Oe(t=>{null==e||e(t)},[e]);return e?{[$s]:a,onPointerUpCapture:r}:{}}(f);return Me(()=>{A(i.object)},[i.object]),We("div",{"data-no-interaction":!0,children:[We("div",{...d&&l?O:{},...L,style:{position:"absolute",left:C.rect.origin.x*e,top:C.rect.origin.y*e,width:C.rect.size.width*e,height:C.rect.size.height*e,outline:l?`1px solid ${v}`:"none",outlineOffset:l?`${g}px`:"0px",pointerEvents:l?"auto":"none",touchAction:"none",cursor:l&&d?"move":"default",zIndex:P,...m},...D,children:[(()=>{const t="function"==typeof s?s(C):s,i=null==y?void 0:y({annotation:C,children:t,isSelected:l,scale:e,rotation:o,pageWidth:r,pageHeight:a,pageIndex:n,onSelect:F});return null!=i?i:t})(),l&&c&&G.map(({key:e,...t})=>(null==b?void 0:b.component)?b.component({key:e,...t,backgroundColor:M}):We("div",{...t,style:{...t.style,backgroundColor:M}},e)),l&&R.map(({key:e,...t})=>(null==_?void 0:_.component)?_.component({key:e,...t,backgroundColor:k}):We("div",{...t,style:{...t.style,backgroundColor:k}},e))]}),h&&We(Us,{rect:{origin:{x:C.rect.origin.x*e,y:C.rect.origin.y*e},size:{width:C.rect.size.width*e,height:C.rect.size.height*e}},rotation:o,children:e=>h({...e,context:{type:"annotation",annotation:i,pageIndex:n},selected:l,placement:{suggestTop:!1}})})]})}function Ac({color:e="#FFFF00",opacity:t=.5,segmentRects:n,rect:o,scale:r,onClick:a,style:i}){return We(H,{children:n.map((n,s)=>We("div",{onPointerDown:a,onTouchStart:a,style:{position:"absolute",left:(o?n.origin.x-o.origin.x:n.origin.x)*r,top:(o?n.origin.y-o.origin.y:n.origin.y)*r,width:n.size.width*r,height:n.size.height*r,background:e,opacity:t,pointerEvents:a?"auto":"none",cursor:a?"pointer":"default",zIndex:a?1:void 0,...i}},s))})}function wc({color:e="#FFFF00",opacity:t=.5,segmentRects:n,rect:o,scale:r,onClick:a,style:i}){const s=2*r;return We(H,{children:n.map((n,l)=>We("div",{onPointerDown:a,onTouchStart:a,style:{position:"absolute",left:(o?n.origin.x-o.origin.x:n.origin.x)*r,top:(o?n.origin.y-o.origin.y:n.origin.y)*r,width:n.size.width*r,height:n.size.height*r,background:"transparent",pointerEvents:a?"auto":"none",cursor:a?"pointer":"default",zIndex:a?1:0,...i},children:We("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",height:s,background:e,opacity:t,pointerEvents:"none"}})},l))})}function Sc({color:e="#FFFF00",opacity:t=.5,segmentRects:n,rect:o,scale:r,onClick:a,style:i}){const s=2*r;return We(H,{children:n.map((n,l)=>We("div",{onPointerDown:a,onTouchStart:a,style:{position:"absolute",left:(o?n.origin.x-o.origin.x:n.origin.x)*r,top:(o?n.origin.y-o.origin.y:n.origin.y)*r,width:n.size.width*r,height:n.size.height*r,background:"transparent",pointerEvents:a?"auto":"none",cursor:a?"pointer":"default",zIndex:a?1:0,...i},children:We("div",{style:{position:"absolute",left:0,top:"50%",width:"100%",height:s,background:e,opacity:t,transform:"translateY(-50%)",pointerEvents:"none"}})},l))})}function Ec({color:e="#FFFF00",opacity:t=.5,segmentRects:n,rect:o,scale:r,onClick:a,style:i}){const s=2*r,l=6*r,d=`url("data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="${l}" height="${2*s}" viewBox="0 0 ${l} ${2*s}">\n      <path d="M0 ${s} Q ${l/4} 0 ${l/2} ${s} T ${l} ${s}"\n            fill="none" stroke="${e}" stroke-width="${s}" stroke-linecap="round"/>\n    </svg>`)}")`;return We(H,{children:n.map((e,n)=>We("div",{onPointerDown:a,onTouchStart:a,style:{position:"absolute",left:(o?e.origin.x-o.origin.x:e.origin.x)*r,top:(o?e.origin.y-o.origin.y:e.origin.y)*r,width:e.size.width*r,height:e.size.height*r,background:"transparent",pointerEvents:a?"auto":"none",cursor:a?"pointer":"default",zIndex:a?1:0,...i},children:We("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",height:2*s,backgroundImage:d,backgroundRepeat:"repeat-x",backgroundSize:`${l}px ${2*s}px`,opacity:t,pointerEvents:"none"}})},n))})}function Cc({isSelected:e,color:t="#000000",opacity:n=1,strokeWidth:o,inkList:r,rect:a,scale:i,onClick:s}){const l=Ie(()=>r.map(({points:e})=>{let t="";return e.forEach(({x:e,y:n},o)=>{const r=e-a.origin.x,i=n-a.origin.y;t+=(0===o?"M":"L")+r+" "+i+" "}),t.trim()}),[r,a]),d=a.size.width*i,c=a.size.height*i;return We("svg",{style:{position:"absolute",width:d,height:c,pointerEvents:"none",zIndex:2,overflow:"visible"},width:d,height:c,viewBox:`0 0 ${a.size.width} ${a.size.height}`,children:l.map((r,a)=>We("path",{d:r,fill:"none",opacity:n,onPointerDown:s,onTouchStart:s,style:{cursor:e?"move":"pointer",pointerEvents:e?"none":"visibleStroke",stroke:t,strokeWidth:o,strokeLinecap:"round",strokeLinejoin:"round"}},a))})}function Mc({isSelected:e,color:t="#000000",strokeColor:n,opacity:o=1,strokeWidth:r,strokeStyle:a=Ot.SOLID,strokeDashArray:i,rect:s,scale:l,onClick:d}){const{width:c,height:u,x:m,y:p}=Ie(()=>{const e=s.size.width,t=s.size.height;return{width:Math.max(e-r,0),height:Math.max(t-r,0),x:r/2,y:r/2}},[s,r]),h=(c+r)*l,g=(u+r)*l;return We("svg",{style:{position:"absolute",width:h,height:g,pointerEvents:"none",zIndex:2},width:h,height:g,viewBox:`0 0 ${c+r} ${u+r}`,children:We("rect",{x:m,y:p,width:c,height:u,fill:t,opacity:o,onPointerDown:d,onTouchStart:d,style:{cursor:e?"move":"pointer",pointerEvents:e?"none":"transparent"===t?"visibleStroke":"visible",stroke:n??t,strokeWidth:r,...a===Ot.DASHED&&{strokeDasharray:null==i?void 0:i.join(",")}}})})}function kc({color:e="#000000",strokeColor:t,opacity:n=1,strokeWidth:o,strokeStyle:r=Ot.SOLID,strokeDashArray:a,rect:i,scale:s,onClick:l,isSelected:d}){const{width:c,height:u,cx:m,cy:p,rx:h,ry:g}=Ie(()=>{const e=i.size.width,t=i.size.height,n=Math.max(e-o,0),r=Math.max(t-o,0);return{width:e,height:t,cx:o/2+n/2,cy:o/2+r/2,rx:n/2,ry:r/2}},[i,o]),f=c*s,F=u*s;return We("svg",{style:{position:"absolute",width:f,height:F,pointerEvents:"none",zIndex:2},width:f,height:F,viewBox:`0 0 ${c} ${u}`,children:We("ellipse",{cx:m,cy:p,rx:h,ry:g,fill:e,opacity:n,onPointerDown:l,onTouchStart:l,style:{cursor:d?"move":"pointer",pointerEvents:d?"none":"transparent"===e?"visibleStroke":"visible",stroke:t??e,strokeWidth:o,...r===Ot.DASHED&&{strokeDasharray:null==a?void 0:a.join(",")}}})})}function Tc({color:e="transparent",opacity:t=1,strokeWidth:n,strokeColor:o="#000000",strokeStyle:r=Ot.SOLID,strokeDashArray:a,rect:i,linePoints:s,lineEndings:l,scale:d,onClick:c,isSelected:u}){const{x1:m,y1:p,x2:h,y2:g}=Ie(()=>({x1:s.start.x-i.origin.x,y1:s.start.y-i.origin.y,x2:s.end.x-i.origin.x,y2:s.end.y-i.origin.y}),[s,i]),f=Ie(()=>{const e=Math.atan2(g-p,h-m);return{start:Ed.createEnding(null==l?void 0:l.start,n,e+Math.PI,m,p),end:Ed.createEnding(null==l?void 0:l.end,n,e,h,g)}},[l,n,m,p,h,g]),F=i.size.width*d,P=i.size.height*d;return We("svg",{style:{position:"absolute",width:F,height:P,pointerEvents:"none",zIndex:2,overflow:"visible"},width:F,height:P,viewBox:`0 0 ${i.size.width} ${i.size.height}`,children:[We("line",{x1:m,y1:p,x2:h,y2:g,opacity:t,onPointerDown:c,onTouchStart:c,style:{cursor:u?"move":"pointer",pointerEvents:u?"none":"visibleStroke",stroke:o,strokeWidth:n,strokeLinecap:"butt",...r===Ot.DASHED&&{strokeDasharray:null==a?void 0:a.join(",")}}}),f.start&&We("path",{d:f.start.d,transform:f.start.transform,onPointerDown:c,onTouchStart:c,stroke:o,style:{cursor:u?"move":"pointer",strokeWidth:n,strokeLinecap:"butt",pointerEvents:u?"none":f.start.filled?"visible":"visibleStroke",...r===Ot.DASHED&&{strokeDasharray:null==a?void 0:a.join(",")}},fill:f.start.filled?e:"none"}),f.end&&We("path",{d:f.end.d,transform:f.end.transform,stroke:o,onPointerDown:c,onTouchStart:c,style:{cursor:u?"move":"pointer",strokeWidth:n,strokeLinecap:"butt",pointerEvents:u?"none":f.end.filled?"visible":"visibleStroke",...r===Ot.DASHED&&{strokeDasharray:null==a?void 0:a.join(",")}},fill:f.end.filled?e:"none"})]})}function Ic({rect:e,vertices:t,color:n="transparent",strokeColor:o="#000000",opacity:r=1,strokeWidth:a,scale:i,isSelected:s,onClick:l,lineEndings:d}){const c=Ie(()=>t.map(({x:t,y:n})=>({x:t-e.origin.x,y:n-e.origin.y})),[t,e]),u=Ie(()=>{if(!c.length)return"";const[e,...t]=c;return`M ${e.x} ${e.y} `+t.map(e=>`L ${e.x} ${e.y} `).join("").trim()},[c]),m=Ie(()=>{if(c.length<2)return{start:null,end:null};const e=(e,t)=>Math.atan2(t.y-e.y,t.x-e.x),t=e(c[0],c[1]),n=e(c[c.length-2],c[c.length-1]);return{start:Ed.createEnding(null==d?void 0:d.start,a,t+Math.PI,c[0].x,c[0].y),end:Ed.createEnding(null==d?void 0:d.end,a,n,c[c.length-1].x,c[c.length-1].y)}},[c,d,a]),p=e.size.width*i,h=e.size.height*i;return We("svg",{style:{position:"absolute",width:p,height:h,pointerEvents:"none",zIndex:2,overflow:"visible"},width:p,height:h,viewBox:`0 0 ${e.size.width} ${e.size.height}`,children:[We("path",{d:u,onPointerDown:l,onTouchStart:l,opacity:r,style:{fill:"none",stroke:o??n,strokeWidth:a,cursor:s?"move":"pointer",pointerEvents:s?"none":"visibleStroke",strokeLinecap:"butt",strokeLinejoin:"miter"}}),m.start&&We("path",{d:m.start.d,transform:m.start.transform,stroke:o,fill:m.start.filled?n:"none",onPointerDown:l,onTouchStart:l,style:{cursor:s?"move":"pointer",strokeWidth:a,pointerEvents:s?"none":m.start.filled?"visible":"visibleStroke",strokeLinecap:"butt"}}),m.end&&We("path",{d:m.end.d,transform:m.end.transform,stroke:o,fill:m.end.filled?n:"none",onPointerDown:l,onTouchStart:l,style:{cursor:s?"move":"pointer",strokeWidth:a,pointerEvents:s?"none":m.end.filled?"visible":"visibleStroke",strokeLinecap:"butt"}})]})}function Oc({rect:e,vertices:t,color:n="transparent",strokeColor:o="#000000",opacity:r=1,strokeWidth:a,strokeStyle:i=Ot.SOLID,strokeDashArray:s,scale:l,isSelected:d,onClick:c,currentVertex:u,handleSize:m=14}){const p=u?[...t,u]:t,h=Ie(()=>p.map(({x:t,y:n})=>({x:t-e.origin.x,y:n-e.origin.y})),[p,e]),g=Ie(()=>{if(!h.length)return"";const[e,...t]=h,n=!!u;return(`M ${e.x} ${e.y} `+t.map(e=>`L ${e.x} ${e.y}`).join(" ")+(n?"":" Z")).trim()},[h,u]),f=u&&t.length>0,F=e.size.width*l,P=e.size.height*l;return We("svg",{style:{position:"absolute",width:F,height:P,pointerEvents:"none",zIndex:2,overflow:"visible"},width:F,height:P,viewBox:`0 0 ${e.size.width} ${e.size.height}`,children:[We("path",{d:g,onPointerDown:c,onTouchStart:c,opacity:r,style:{fill:u?"none":n,stroke:o??n,strokeWidth:a,cursor:d?"move":"pointer",pointerEvents:d?"none":"transparent"===n?"visibleStroke":"visible",strokeLinecap:"butt",strokeLinejoin:"miter",...i===Ot.DASHED&&{strokeDasharray:null==s?void 0:s.join(",")}}}),f&&t.length>1&&We("path",{d:`M ${h[h.length-1].x} ${h[h.length-1].y} L ${h[0].x} ${h[0].y}`,fill:"none",style:{stroke:o,strokeWidth:a,strokeDasharray:"4,4",opacity:.7}}),f&&t.length>=2&&We("rect",{x:h[0].x-m/l/2,y:h[0].y-m/l/2,width:m/l,height:m/l,fill:o,opacity:.4,stroke:o,strokeWidth:a/2})]})}function Rc({isSelected:e,isEditing:t,annotation:n,pageIndex:o,scale:r,onClick:a}){const i=Te(null),{provides:s}=yc(),[l,d]=Ee(!1);Me(()=>{if(t&&i.current){const e=i.current;e.focus();const t=window.getSelection();if(t){const n=document.createRange();n.selectNodeContents(e),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}}},[t]),ke(()=>{try{const e=navigator,t=/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&(null==e?void 0:e.maxTouchPoints)>1;d(t)}catch{d(!1)}},[]);const c=n.object.fontSize*r,u=l&&t&&c>0&&c<16,m=u?16:c,p=u?c/16:1,h=u?100/p:100;return We("div",{style:{position:"absolute",width:n.object.rect.size.width*r,height:n.object.rect.size.height*r,cursor:e&&!t?"move":"default",pointerEvents:e&&!t?"none":"auto",zIndex:2},onPointerDown:a,onTouchStart:a,children:We("span",{ref:i,onBlur:()=>{s&&i.current&&s.updateAnnotation(o,n.object.id,{contents:i.current.innerText})},tabIndex:0,style:{color:n.object.fontColor,fontSize:m,fontFamily:(g=n.object.fontFamily,sn(g).css),textAlign:Jt(n.object.textAlign),flexDirection:"column",justifyContent:n.object.verticalAlign===xt.Top?"flex-start":n.object.verticalAlign===xt.Middle?"center":"flex-end",display:"flex",backgroundColor:n.object.backgroundColor,opacity:n.object.opacity,width:u?`${h}%`:"100%",height:u?`${h}%`:"100%",lineHeight:"1.18",overflow:"hidden",cursor:t?"text":"pointer",outline:"none",transform:u?`scale(${p})`:void 0,transformOrigin:"top left"},contentEditable:t,...vc,children:n.object.contents})});var g}function Gc({documentId:e,pageIndex:t,annotation:n,scaleFactor:o=1,style:r,...a}){const{provides:i}=yc(),[s,l]=Ee(null),d=Te(null),{width:c,height:u}=n.rect.size;return Me(()=>{if(i){const r=i.forDocument(e).renderAnnotation({pageIndex:t,annotation:n,options:{scaleFactor:o,dpr:window.devicePixelRatio}});return r.wait(e=>{const t=URL.createObjectURL(e);l(t),d.current=t},yn),()=>{d.current?(URL.revokeObjectURL(d.current),d.current=null):r.abort({code:Ut.Cancelled,message:"canceled render task"})}}},[t,o,i,e,n.id,c,u]),We(H,{children:s&&We("img",{src:s,onLoad:()=>{d.current&&(URL.revokeObjectURL(d.current),d.current=null)},...a,style:{width:"100%",height:"100%",display:"block",...r||{}}})})}function Lc({isSelected:e,annotation:t,documentId:n,pageIndex:o,scale:r,onClick:a}){return We("div",{style:{position:"absolute",width:"100%",height:"100%",zIndex:2,pointerEvents:e?"none":"auto",cursor:"pointer"},onPointerDown:a,onTouchStart:a,children:We(Gc,{documentId:n,pageIndex:o,annotation:{...t.object,id:t.object.id},scaleFactor:r})})}function Nc(e){const{documentId:t,pageIndex:n,scale:o,selectionMenu:r}=e,{provides:a}=yc(),{provides:i}=Ys(),[s,l]=Ee([]),{register:d}=function({modeId:e,pageIndex:t,documentId:n}){const{provides:o}=pc();return{register:(r,a)=>{const i=(null==a?void 0:a.modeId)??e,s=(null==a?void 0:a.pageIndex)??t,l=(null==a?void 0:a.documentId)??n;return i?null==o?void 0:o.registerHandlers({modeId:i,handlers:r,pageIndex:s,documentId:l}):null==o?void 0:o.registerAlways({scope:void 0!==s?{type:"page",documentId:l,pageIndex:s}:{type:"global",documentId:l},handlers:r})}}}({documentId:t,pageIndex:n}),[c,u]=Ee(null),[m,p]=Ee(null),h=Ie(()=>a?a.forDocument(t):null,[a,t]);Me(()=>{if(h){const e=h.getState();return l(dd(e,n)),u(ud(e,n)),h.onStateChange(e=>{l(dd(e,n)),u(ud(e,n))})}},[h,n]);const g=Ie(()=>({onPointerDown:(e,t)=>{t.target===t.currentTarget&&h&&(h.deselectAnnotation(),p(null))}}),[h]),f=Oe((e,t)=>{e.stopPropagation(),h&&i&&(h.selectAnnotation(n,t.object.id),i.clear(),t.object.id!==m&&p(null))},[h,i,m,n]);return Me(()=>d(g,{documentId:t}),[d,g]),We(H,{children:s.map(a=>{const i=(null==c?void 0:c.object.id)===a.object.id,s=m===a.object.id,l=null==h?void 0:h.findToolForAnnotation(a.object);return Kl(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!0,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(Cc,{...e,isSelected:i,scale:o,onClick:e=>f(e,a)})},a.object.id):Ql(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!0,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(Mc,{...e,isSelected:i,scale:o,onClick:e=>f(e,a)})},a.object.id):Xl(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!0,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(kc,{...e,isSelected:i,scale:o,onClick:e=>f(e,a)})},a.object.id):nd(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!1,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),zIndex:0,style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(wc,{...e,scale:o,onClick:e=>f(e,a)})},a.object.id):od(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!1,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),zIndex:0,style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(Sc,{...e,scale:o,onClick:e=>f(e,a)})},a.object.id):rd(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!1,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),zIndex:0,style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(Ec,{...e,scale:o,onClick:e=>f(e,a)})},a.object.id):td(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!1,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),zIndex:0,style:{mixBlendMode:gn(a.object.blendMode??At.Multiply)},...e,children:e=>We(Ac,{...e,scale:o,onClick:e=>f(e,a)})},a.object.id):Jl(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),vertexConfig:{extractVertices:e=>[e.linePoints.start,e.linePoints.end],transformAnnotation:(e,t)=>({...e,linePoints:{start:t[0],end:t[1]}})},style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(H,{children:We(Tc,{...e,isSelected:i,scale:o,onClick:e=>f(e,a)})})},a.object.id):ed(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),vertexConfig:{extractVertices:e=>e.vertices,transformAnnotation:(e,t)=>({...e,vertices:t})},style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(H,{children:We(Ic,{...e,isSelected:i,scale:o,onClick:e=>f(e,a)})})},a.object.id):Zl(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!1,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),vertexConfig:{extractVertices:e=>e.vertices,transformAnnotation:(e,t)=>({...e,vertices:t})},style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(H,{children:We(Oc,{...e,isSelected:i,scale:o,onClick:e=>f(e,a)})})},a.object.id):ad(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:((null==l?void 0:l.interaction.isDraggable)??!0)&&!s,isResizable:(null==l?void 0:l.interaction.isResizable)??!0,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},onDoubleClick:e=>{e.stopPropagation(),p(a.object.id)},...e,children:e=>We(Rc,{isSelected:i,isEditing:s,annotation:{...a,object:e},pageIndex:n,scale:o,onClick:e=>f(e,a)})},a.object.id):id(a)?We(xc,{trackedAnnotation:a,isSelected:i,isDraggable:(null==l?void 0:l.interaction.isDraggable)??!0,isResizable:(null==l?void 0:l.interaction.isResizable)??!0,lockAspectRatio:(null==l?void 0:l.interaction.lockAspectRatio)??!1,selectionMenu:r,onSelect:e=>f(e,a),style:{mixBlendMode:gn(a.object.blendMode??At.Normal)},...e,children:e=>We(Lc,{isSelected:i,annotation:a,documentId:t,pageIndex:n,scale:o,onClick:e=>f(e,a)})},a.object.id):null})})}function zc({documentId:e,pageIndex:t,scale:n}){var o,r,a,i,s,l,d,c,u,m,p,h;const{provides:g}=Ys(),{provides:f}=yc(),[F,P]=Ee([]),[b,_]=Ee(null),[v,y]=Ee(null);if(Me(()=>{if(g)return g.forDocument(e).onSelectionChange(()=>{P(g.forDocument(e).getHighlightRectsForPage(t)),_(g.forDocument(e).getBoundingRectForPage(t))})},[g,e,t]),Me(()=>{if(f)return y(f.forDocument(e).getActiveTool()),f.forDocument(e).onActiveToolChange(e=>y(e))},[f,e]),!b)return null;if(!v||!v.defaults)return null;switch(v.defaults.type){case Et.UNDERLINE:return We("div",{style:{mixBlendMode:gn((null==(o=v.defaults)?void 0:o.blendMode)??At.Normal),pointerEvents:"none",position:"absolute",inset:0},children:We(wc,{color:null==(r=v.defaults)?void 0:r.color,opacity:null==(a=v.defaults)?void 0:a.opacity,segmentRects:F,scale:n})});case Et.HIGHLIGHT:return We("div",{style:{mixBlendMode:gn((null==(i=v.defaults)?void 0:i.blendMode)??At.Multiply),pointerEvents:"none",position:"absolute",inset:0},children:We(Ac,{color:null==(s=v.defaults)?void 0:s.color,opacity:null==(l=v.defaults)?void 0:l.opacity,segmentRects:F,scale:n})});case Et.STRIKEOUT:return We("div",{style:{mixBlendMode:gn((null==(d=v.defaults)?void 0:d.blendMode)??At.Normal),pointerEvents:"none",position:"absolute",inset:0},children:We(Sc,{color:null==(c=v.defaults)?void 0:c.color,opacity:null==(u=v.defaults)?void 0:u.opacity,segmentRects:F,scale:n})});case Et.SQUIGGLY:return We("div",{style:{mixBlendMode:gn((null==(m=v.defaults)?void 0:m.blendMode)??At.Normal),pointerEvents:"none",position:"absolute",inset:0},children:We(Ec,{color:null==(p=v.defaults)?void 0:p.color,opacity:null==(h=v.defaults)?void 0:h.opacity,segmentRects:F,scale:n})});default:return null}}function jc({preview:e,scale:t}){const{bounds:n}=e,o={position:"absolute",left:n.origin.x*t,top:n.origin.y*t,width:n.size.width*t,height:n.size.height*t,pointerEvents:"none",zIndex:10};return e.type===Et.CIRCLE?We("div",{style:o,children:We(kc,{isSelected:!1,scale:t,...e.data})}):e.type===Et.SQUARE?We("div",{style:o,children:We(Mc,{isSelected:!1,scale:t,...e.data})}):e.type===Et.POLYGON?We("div",{style:o,children:We(Oc,{isSelected:!1,scale:t,...e.data})}):e.type===Et.POLYLINE?We("div",{style:o,children:We(Ic,{isSelected:!1,scale:t,...e.data})}):e.type===Et.LINE?We("div",{style:o,children:We(Tc,{isSelected:!1,scale:t,...e.data})}):e.type===Et.INK?We("div",{style:o,children:We(Cc,{isSelected:!1,scale:t,...e.data})}):e.type===Et.FREETEXT?We("div",{style:o,children:We("div",{style:{width:"100%",height:"100%",border:`1px dashed ${e.data.fontColor||"#000000"}`,backgroundColor:"transparent"}})}):null}function Bc({documentId:e,pageIndex:t,scale:n}){const{plugin:o}=fo(jd.id),[r,a]=Ee(new Map),i=Te(null),s=Te(null),l=Ie(()=>({requestFile:({accept:e,onFile:t})=>{if(!i.current)return;const n=i.current;n.accept=e,n.onchange=e=>{var o;const r=null==(o=e.target.files)?void 0:o[0];r&&(t(r),n.value="")},n.click()},processImage:({source:e,maxWidth:t,maxHeight:n,onComplete:o})=>{const r=s.current;if(!r||!r.getContext)return;const a=r.getContext("2d");if(!a)return;const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{let{naturalWidth:s,naturalHeight:l}=i;const d=t?t/s:1,c=n?n/l:1,u=Math.min(d,c,1),m=s*u,p=l*u;r.width=m,r.height=p,a.drawImage(i,0,0,m,p);const h=a.getImageData(0,0,m,p);"string"!=typeof e&&URL.revokeObjectURL(i.src),o({imageData:h,width:m,height:p})},i.src="string"==typeof e?e:URL.createObjectURL(e)}}),[]);return Me(()=>{if(o)return o.registerPageHandlers(e,t,n,{services:l,onPreview:(e,t)=>{a(n=>{const o=new Map(n);return t?o.set(e,t):o.delete(e),o})}})},[e,t,n,o,l]),We(H,{children:[We("input",{ref:i,type:"file",style:{display:"none"}}),We("canvas",{ref:s,style:{display:"none"}}),Array.from(r.entries()).map(([e,t])=>We(jc,{preview:t,scale:n},e))]})}function $c({style:e,documentId:t,pageIndex:n,scale:o,rotation:r,selectionMenu:a,resizeUI:i,vertexUI:s,selectionOutlineColor:l,customAnnotationRenderer:d,...c}){var u,m,p,h;const g=bo(t),f=null==(m=null==(u=null==g?void 0:g.document)?void 0:u.pages)?void 0:m[n],F=(null==(p=null==f?void 0:f.size)?void 0:p.width)??0,P=(null==(h=null==f?void 0:f.size)?void 0:h.height)??0,b=Ie(()=>void 0!==o?o:(null==g?void 0:g.scale)??1,[o,null==g?void 0:g.scale]);return We("div",{style:{...e},...c,children:[We(Nc,{documentId:t,selectionMenu:a,pageIndex:n,scale:b,rotation:Ie(()=>void 0!==r?r:(null==g?void 0:g.rotation)??He.Degree0,[r,null==g?void 0:g.rotation]),pageWidth:F,pageHeight:P,resizeUI:i,vertexUI:s,selectionOutlineColor:l,customAnnotationRenderer:d}),We(zc,{documentId:t,pageIndex:n,scale:b}),We(Bc,{documentId:t,pageIndex:n,scale:b})]})}const Uc="print",Wc={id:Uc,name:"Print Plugin",version:"1.0.0",provides:["print"],requires:[],optional:[],defaultConfig:{}},Hc=class extends Qn{constructor(e,t,n){super(e,t),this.printReady$=so()}buildCapability(){return{print:e=>this.print(e),forDocument:e=>this.createPrintScope(e)}}createPrintScope(e){return{print:t=>this.print(t,e)}}print(e,t){const n=t??this.getActiveDocumentId(),o=e??{},r=new ft;return r.progress({stage:"preparing",message:"Preparing document..."}),this.preparePrintDocument(o,n).wait(e=>{r.progress({stage:"document-ready",message:"Document prepared successfully"}),this.printReady$.emit({documentId:n,options:o,buffer:e,task:r})},e=>r.fail(e)),r}preparePrintDocument(e,t){const n=this.coreState.core.documents[t];return(null==n?void 0:n.document)?this.engine.preparePrintDocument(n.document,e):Wt.reject({code:Ut.DocNotOpen,message:`Document ${t} not found`})}onPrintRequest(e){return this.printReady$.on(e)}async initialize(e){this.logger.info("PrintPlugin","Initialize","Print plugin initialized")}async destroy(){this.printReady$.clear(),await super.destroy()}};Hc.id="print";let Vc=Hc;const Yc=()=>Fo(Vc.id),qc=mo({manifest:Wc,create:(e,t)=>new Vc(Uc,e,t),reducer:()=>{},initialState:{}}).addUtility(function(){const{provides:e}=Yc(),{plugin:t}=fo(Vc.id),n=Te(null),o=Te(null);return Me(()=>{if(!e||!t)return;const r=t.onPrintRequest(({buffer:e,task:t})=>{const r=n.current;if(!r)return;o.current&&(URL.revokeObjectURL(o.current),o.current=null);const a=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));o.current=a,r.onload=()=>{var n,o;r.src===a&&(t.progress({stage:"iframe-ready",message:"Ready to print"}),null==(n=r.contentWindow)||n.focus(),null==(o=r.contentWindow)||o.print(),t.progress({stage:"printing",message:"Print dialog opened"}),t.resolve(e))},r.src=a});return()=>{r(),o.current&&URL.revokeObjectURL(o.current)}},[e,t]),We("iframe",{ref:n,style:{position:"absolute",display:"none"},title:"Print Document",src:"about:blank"})}).build(),Kc="fullscreen",Xc={id:Kc,name:"Fullscreen Plugin",version:"1.0.0",provides:["fullscreen"],requires:[],optional:[],defaultConfig:{}},Zc="SET_FULLSCREEN",Qc=class extends Qn{constructor(e,t,n){super(e,t),this.onStateChange$=lo(),this.fullscreenRequest$=so(),this.config=n}async initialize(e){}buildCapability(){return{isFullscreen:()=>this.state.isFullscreen,enableFullscreen:e=>this.enableFullscreen(e),exitFullscreen:()=>this.exitFullscreen(),toggleFullscreen:e=>this.toggleFullscreen(e),onRequest:this.fullscreenRequest$.on,onStateChange:this.onStateChange$.on}}getTargetSelector(){return this.currentTargetElement??this.config.targetElement}toggleFullscreen(e){this.state.isFullscreen?this.exitFullscreen():this.enableFullscreen(e)}enableFullscreen(e){this.currentTargetElement=e??this.config.targetElement,this.fullscreenRequest$.emit({action:"enter",targetElement:this.currentTargetElement})}exitFullscreen(){this.fullscreenRequest$.emit({action:"exit"}),this.currentTargetElement=void 0}onStoreUpdated(e,t){this.onStateChange$.emit(t)}setFullscreenState(e){this.dispatch({type:Zc,payload:e})}async destroy(){this.fullscreenRequest$.clear(),super.destroy()}};Qc.id="fullscreen";let Jc=Qc;const eu=()=>fo(Jc.id),tu=mo({manifest:Xc,create:(e,t)=>new Jc(Kc,e,t),reducer:(e,t)=>t.type===Zc?{...e,isFullscreen:t.payload}:e,initialState:{isFullscreen:!1}}).addWrapper(function({children:e,...t}){const{provides:n}=Fo(Jc.id),{plugin:o}=eu(),{plugin:r}=eu(),a=Te(null);return Me(()=>{if(n&&o)return n.onRequest(async e=>{const t=o.getTargetSelector();await async function(e,t,n){if("enter"===e.action){const o=function(e,t,n){if(!t||"enter"!==e.action)return t;let o=null;return n&&(o=t.querySelector(n),o||console.warn(`Fullscreen: Could not find element with selector "${n}" within the wrapper. Falling back to wrapper element.`)),o||(o=t),o}(e,t,n);o&&!document.fullscreenElement&&await o.requestFullscreen()}else document.fullscreenElement&&await document.exitFullscreen()}(e,a.current,t)})},[n,o]),Me(()=>{if(!r)return;const e=()=>r.setFullscreenState(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[r]),We("div",{...t,style:{position:"relative",width:"100%",height:"100%",...t.style},ref:a,children:e})}).build(),nu="bookmark",ou={id:nu,name:"Bookmark Plugin",version:"1.0.0",provides:["bookmark"],requires:[],optional:[],defaultConfig:{}},ru=class extends Qn{constructor(e,t){super(e,t)}async initialize(e){}buildCapability(){return{getBookmarks:()=>this.getBookmarks(),forDocument:e=>this.createBookmarkScope(e)}}createBookmarkScope(e){return{getBookmarks:()=>this.getBookmarks(e)}}getBookmarks(e){const t=e??this.getActiveDocumentId(),n=this.coreState.core.documents[t];if(!(null==n?void 0:n.document))throw new Error(`Document ${t} not loaded`);return this.engine.getBookmarks(n.document)}};ru.id="bookmark";let au=ru;const iu={manifest:ou,create:e=>new au(nu,e),reducer:()=>{},initialState:{}},su=class extends Qn{constructor(e,t,n){super(e,t),this.downloadRequest$=so(),this.config=n}buildCapability(){return{saveAsCopy:()=>this.saveAsCopy(),download:()=>this.download(),forDocument:e=>this.createExportScope(e)}}createExportScope(e){return{saveAsCopy:()=>this.saveAsCopy(e),download:()=>this.download(e)}}download(e){const t=e??this.getActiveDocumentId();this.downloadRequest$.emit({documentId:t})}saveAsCopy(e){const t=e??this.getActiveDocumentId(),n=this.coreState.core.documents[t];return(null==n?void 0:n.document)?this.engine.saveAsCopy(n.document):Wt.reject({code:Ut.DocNotOpen,message:`Document ${t} not found`})}saveAsCopyAndGetBufferAndName(e){const t=new ft,n=this.coreState.core.documents[e];return(null==n?void 0:n.document)?(this.saveAsCopy(e).wait(e=>{t.resolve({buffer:e,name:n.name??this.config.defaultFileName})},e=>t.fail(e)),t):Wt.reject({code:Ut.DocNotOpen,message:`Document ${e} not found`})}onRequest(e){return this.downloadRequest$.on(e)}async initialize(e){this.logger.info("ExportPlugin","Initialize","Export plugin initialized")}async destroy(){this.downloadRequest$.clear(),await super.destroy()}};su.id="export";let lu=su;const du="export",cu=mo({manifest:{id:du,name:"Export Plugin",version:"1.0.0",provides:["export"],requires:[],optional:[],defaultConfig:{defaultFileName:"document.pdf"}},create:(e,t)=>new lu(du,e,t),reducer:()=>{},initialState:{}}).addUtility(function(){const{plugin:e}=fo(lu.id),t=Te(null);return Me(()=>{if(e)return e.onRequest(n=>{const o=t.current;o&&e.saveAsCopyAndGetBufferAndName(n.documentId).wait(({buffer:e,name:t})=>{const n=URL.createObjectURL(new Blob([e]));o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n)},yn)})},[e]),We("a",{style:{display:"none"},ref:t})}).build(),uu="PAN/INIT_STATE",mu="PAN/CLEANUP_STATE",pu="PAN/SET_PAN_MODE",hu=class extends Qn{constructor(e,t,n){var o,r,a;super(e,t),this.panMode$=lo(),this.documentHandlers=new Map,this.config=n,this.interactionManager=null==(o=t.getPlugin(dc.id))?void 0:o.provides(),this.viewport=null==(r=t.getPlugin(No.id))?void 0:r.provides(),this.interactionManager&&(this.interactionManager.registerMode({id:"panMode",scope:"global",exclusive:!1,cursor:"grab",wantsRawTouch:!1}),null==(a=this.interactionManager)||a.onModeChange(e=>{const t="panMode"===e.activeMode,n=this.getDocumentState(e.documentId);n&&n.isPanMode!==t&&this.dispatch(function(e,t){return{type:pu,payload:{documentId:e,isPanMode:t}}}(e.documentId,t))}))}onDocumentLoadingStarted(e){this.dispatch(function(e){return{type:uu,payload:{documentId:e,state:{isPanMode:!1}}}}(e)),this.registerPanHandlersForDocument(e),"always"===this.config.defaultMode&&this.makePanDefault(!0),this.logger.debug("PanPlugin","DocumentOpened",`Initialized pan state for document: ${e}`)}onDocumentClosed(e){const t=this.documentHandlers.get(e);t&&(t(),this.documentHandlers.delete(e)),this.dispatch(function(e){return{type:mu,payload:e}}(e)),this.logger.debug("PanPlugin","DocumentClosed",`Cleaned up pan state for document: ${e}`)}buildCapability(){return{enablePan:()=>this.enablePan(),disablePan:()=>this.disablePan(),togglePan:()=>this.togglePan(),makePanDefault:e=>this.makePanDefault(e),isPanMode:()=>this.isPanMode(),forDocument:e=>this.createPanScope(e),onPanModeChange:this.panMode$.on}}createPanScope(e){return{enablePan:()=>this.enablePan(e),disablePan:()=>this.disablePan(e),togglePan:()=>this.togglePan(e),isPanMode:()=>this.isPanMode(e),onPanModeChange:t=>this.panMode$.on(n=>{n.documentId===e&&t(n.isPanMode)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Pan state not found for document: ${e??"active"}`);return t}enablePan(e){const t=e??this.getActiveDocumentId();this.interactionManager.forDocument(t).activate("panMode")}disablePan(e){const t=e??this.getActiveDocumentId();this.interactionManager.forDocument(t).activateDefaultMode()}togglePan(e){const t=e??this.getActiveDocumentId(),n=this.interactionManager.forDocument(t);"panMode"===n.getActiveMode()?n.activateDefaultMode():n.activate("panMode")}makePanDefault(e=!0){this.interactionManager&&(this.interactionManager.setDefaultMode("panMode"),e&&this.interactionManager.activateDefaultMode())}isPanMode(e){return this.getDocumentStateOrThrow(e).isPanMode}registerPanHandlersForDocument(e){if(!this.interactionManager||!this.viewport)return;let t=null;const n=this.interactionManager.forDocument(e),o=this.viewport.forDocument(e),r={onMouseDown:(e,r)=>{const a=o.getMetrics();t={startX:r.clientX,startY:r.clientY,startLeft:a.scrollLeft,startTop:a.scrollTop},n.setCursor("panMode","grabbing",10)},onMouseMove:(e,n)=>{if(!t)return;const r=n.clientX-t.startX,a=n.clientY-t.startY;o.scrollTo({x:t.startLeft-r,y:t.startTop-a})},onMouseUp:()=>{t&&(t=null,n.removeCursor("panMode"))},onMouseLeave:()=>{t&&(t=null,n.removeCursor("panMode"))},onMouseCancel:()=>{t&&(t=null,n.removeCursor("panMode"))}},a=this.interactionManager.registerHandlers({documentId:e,modeId:"panMode",handlers:r});this.documentHandlers.set(e,a)}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];(null==o?void 0:o.isPanMode)!==r.isPanMode&&(this.panMode$.emit({documentId:n,isPanMode:r.isPanMode}),this.logger.debug("PanPlugin","PanModeChanged",`Pan mode changed for document ${n}: ${(null==o?void 0:o.isPanMode)??!1} -> ${r.isPanMode}`))}}async initialize(e){this.logger.info("PanPlugin","Initialize","Pan plugin initialized")}async destroy(){this.documentHandlers.forEach(e=>e()),this.documentHandlers.clear(),this.panMode$.clear(),await super.destroy()}};hu.id="pan";let gu=hu;const fu={documents:{},activeDocumentId:null},Fu=mo({manifest:{id:"pan",name:"Pan Plugin",version:"1.0.0",provides:["pan"],requires:["interaction-manager","viewport"],optional:[],defaultConfig:{defaultMode:"mobile"}},create:(e,t)=>new gu("pan",e,t),reducer:(e=fu,t)=>{switch(t.type){case uu:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case mu:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"PAN/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case pu:{const{documentId:n,isPanMode:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,isPanMode:o}}}:e}default:return e}},initialState:fu}).addUtility(()=>{const{provides:e}=Fo(gu.id),{plugin:t}=fo(gu.id);return Me(()=>{var n;if(!e||!t)return;const o=(null==(n=t.config)?void 0:n.defaultMode)??"never",r="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0);"mobile"===o&&r&&e.makePanDefault()},[e,t]),null}).build(),Pu="capture",bu={id:Pu,name:"Capture Plugin",version:"1.0.0",provides:["capture"],requires:["render"],optional:["interaction-manager"],defaultConfig:{scale:1,imageType:"image/png",withAnnotations:!1}},_u="CAPTURE/INIT_STATE",vu="CAPTURE/CLEANUP_STATE",yu="CAPTURE/SET_MARQUEE_CAPTURE_ACTIVE",Du={isMarqueeCaptureActive:!1},xu={documents:{},activeDocumentId:null},Au=class extends Qn{constructor(e,t,n){var o;super(e,t),this.captureArea$=so(),this.state$=lo(),this.config=n,this.renderCapability=this.registry.getPlugin("render").provides(),this.interactionManagerCapability=null==(o=this.registry.getPlugin("interaction-manager"))?void 0:o.provides(),this.interactionManagerCapability&&(this.interactionManagerCapability.registerMode({id:"marqueeCapture",scope:"page",exclusive:!0,cursor:"crosshair"}),this.interactionManagerCapability.onModeChange(e=>{const t="marqueeCapture"===e.activeMode,n=this.getDocumentState(e.documentId);var o;n&&n.isMarqueeCaptureActive!==t&&this.dispatch((o=e.documentId,{type:yu,payload:{documentId:o,isActive:t}}))}))}onDocumentLoadingStarted(e){const t={...Du};this.dispatch(function(e,t){return{type:_u,payload:{documentId:e,state:t}}}(e,t)),this.logger.debug("CapturePlugin","DocumentOpened",`Initialized capture state for document: ${e}`)}onDocumentClosed(e){this.dispatch(function(e){return{type:vu,payload:e}}(e)),this.logger.debug("CapturePlugin","DocumentClosed",`Cleaned up capture state for document: ${e}`)}async initialize(e){}buildCapability(){return{captureArea:(e,t)=>this.captureArea(e,t),enableMarqueeCapture:()=>this.enableMarqueeCapture(),disableMarqueeCapture:()=>this.disableMarqueeCapture(),toggleMarqueeCapture:()=>this.toggleMarqueeCapture(),isMarqueeCaptureActive:()=>this.isMarqueeCaptureActive(),getState:()=>this.getDocumentStateOrThrow(),forDocument:e=>this.createCaptureScope(e),registerMarqueeOnPage:e=>this.registerMarqueeOnPage(e),onCaptureArea:this.captureArea$.on,onStateChange:this.state$.on}}createCaptureScope(e){return{captureArea:(t,n)=>this.captureArea(t,n,e),enableMarqueeCapture:()=>this.enableMarqueeCapture(e),disableMarqueeCapture:()=>this.disableMarqueeCapture(e),toggleMarqueeCapture:()=>this.toggleMarqueeCapture(e),isMarqueeCaptureActive:()=>this.isMarqueeCaptureActive(e),getState:()=>this.getDocumentStateOrThrow(e),onCaptureArea:t=>this.captureArea$.on(n=>{n.documentId===e&&t(n)}),onStateChange:t=>this.state$.on(n=>{n.documentId===e&&t(n.state)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Capture state not found for document: ${e??"active"}`);return t}registerMarqueeOnPage(e){if(!this.interactionManagerCapability)return this.logger.warn("CapturePlugin","MissingDependency","Interaction manager plugin not loaded, marquee capture disabled"),()=>{};const t=this.coreState.core.documents[e.documentId];if(!t||!t.document)return this.logger.warn("CapturePlugin","DocumentNotFound","Document not found"),()=>{};const n=t.document.pages[e.pageIndex];if(!n)return this.logger.warn("CapturePlugin","PageNotFound",`Page ${e.pageIndex} not found`),()=>{};const o=function(e){const{pageSize:t,scale:n,minDragPx:o=5,onPreview:r,onCommit:a}=e;let i=null,s=null;return{onPointerDown:(e,t)=>{var n;i=e,s={origin:{x:e.x,y:e.y},size:{width:0,height:0}},null==r||r(s),null==(n=t.setPointerCapture)||n.call(t)},onPointerMove:e=>{if(!i)return;const n=no(e.x,0,t.width),o=no(e.y,0,t.height);s={origin:{x:Math.min(i.x,n),y:Math.min(i.y,o)},size:{width:Math.abs(n-i.x),height:Math.abs(o-i.y)}},null==r||r(s)},onPointerUp:(e,t)=>{var l;s&&Math.max(s.size.width,s.size.height)*n>o&&(null==a||a(s)),i=null,s=null,null==r||r(null),null==(l=t.releasePointerCapture)||l.call(t)},onPointerCancel:(e,t)=>{var n;i=null,s=null,null==r||r(null),null==(n=t.releasePointerCapture)||n.call(t)}}}({pageSize:n.size,scale:e.scale,onPreview:e.callback.onPreview,onCommit:t=>{var n,o;this.captureArea(e.pageIndex,t,e.documentId),null==(o=(n=e.callback).onCommit)||o.call(n,t)}});return this.interactionManagerCapability.registerHandlers({documentId:e.documentId,modeId:"marqueeCapture",handlers:o,pageIndex:e.pageIndex})}captureArea(e,t,n){const o=n??this.getActiveDocumentId();this.disableMarqueeCapture(o),this.renderCapability.forDocument(o).renderPageRect({pageIndex:e,rect:t,options:{imageType:this.config.imageType,scaleFactor:this.config.scale,withAnnotations:this.config.withAnnotations||!1}}).wait(n=>{this.captureArea$.emit({documentId:o,pageIndex:e,rect:t,blob:n,imageType:this.config.imageType||"image/png",scale:this.config.scale||1,withAnnotations:this.config.withAnnotations||!1})},yn)}enableMarqueeCapture(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManagerCapability)||t.forDocument(n).activate("marqueeCapture")}disableMarqueeCapture(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManagerCapability)||t.forDocument(n).activateDefaultMode()}toggleMarqueeCapture(e){var t;const n=e??this.getActiveDocumentId(),o=null==(t=this.interactionManagerCapability)?void 0:t.forDocument(n);"marqueeCapture"===(null==o?void 0:o.getActiveMode())?o.activateDefaultMode():null==o||o.activate("marqueeCapture")}isMarqueeCaptureActive(e){var t;const n=e??this.getActiveDocumentId();return"marqueeCapture"===(null==(t=this.interactionManagerCapability)?void 0:t.forDocument(n).getActiveMode())}onStoreUpdated(e,t){for(const n in t.documents){const o=e.documents[n],r=t.documents[n];o&&r&&o.isMarqueeCaptureActive!==r.isMarqueeCaptureActive&&this.state$.emit({documentId:n,state:r})}}async destroy(){this.captureArea$.clear(),this.state$.clear(),super.destroy()}};Au.id="capture";let wu=Au;const Su={manifest:bu,create:(e,t)=>new wu(Pu,e,t),reducer:(e=xu,t)=>{switch(t.type){case _u:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case vu:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"CAPTURE/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case yu:{const{documentId:n,isActive:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,isMarqueeCaptureActive:o}}}:e}default:return e}},initialState:xu},Eu=()=>Fo(wu.id),Cu=({documentId:e,pageIndex:t,scale:n,className:o,stroke:r="rgba(33,150,243,0.8)",fill:a="rgba(33,150,243,0.15)"})=>{const{provides:i}=Eu(),s=bo(e),[l,d]=Ee(null),c=Ie(()=>void 0!==n?n:(null==s?void 0:s.scale)??1,[n,null==s?void 0:s.scale]);return Me(()=>{if(i)return i.registerMarqueeOnPage({documentId:e,pageIndex:t,scale:c,callback:{onPreview:d}})},[i,e,t,c]),l?We("div",{style:{position:"absolute",pointerEvents:"none",left:l.origin.x*c,top:l.origin.y*c,width:l.size.width*c,height:l.size.height*c,border:`1px solid ${r}`,background:a,boxSizing:"border-box"},className:o}):null},Mu="history",ku={id:Mu,name:"History Plugin",version:"1.0.0",provides:["history"],requires:[],optional:[],defaultConfig:{}},Tu="HISTORY/INIT_STATE",Iu="HISTORY/CLEANUP_STATE",Ou="HISTORY/SET_DOCUMENT_STATE",Ru=class extends Qn{constructor(e,t){super(e,t),this.documentHistories=new Map,this.historyChange$=so()}async initialize(e){this.logger.info("HistoryPlugin","Initialize","History plugin initialized")}onDocumentLoadingStarted(e){this.dispatch((e=>({type:Tu,payload:{documentId:e}}))(e)),this.documentHistories.set(e,{topicHistories:new Map,globalTimeline:[],globalIndex:-1}),this.logger.debug("HistoryPlugin","DocumentOpened",`Initialized history state for document: ${e}`)}onDocumentClosed(e){this.dispatch((e=>({type:Iu,payload:{documentId:e}}))(e)),this.documentHistories.delete(e),this.logger.debug("HistoryPlugin","DocumentClosed",`Cleaned up history state for document: ${e}`)}getDocumentHistoryData(e){const t=e??this.getActiveDocumentId(),n=this.documentHistories.get(t);if(!n)throw new Error(`History data not found for document: ${t}`);return n}getDocumentHistoryState(e){const t=this.documentHistories.get(e);if(!t)throw new Error(`History data not found for document: ${e}`);const n={};return Array.from(t.topicHistories.entries()).forEach(([e,t])=>{n[e]={canUndo:t.currentIndex>-1,canRedo:t.currentIndex<t.commands.length-1}}),{global:{canUndo:t.globalIndex>-1,canRedo:t.globalIndex<t.globalTimeline.length-1},topics:n}}emitHistoryChange(e,t){const n=this.getDocumentHistoryState(e);this.dispatch(((e,t)=>({type:Ou,payload:{documentId:e,state:t}}))(e,n)),this.historyChange$.emit({documentId:e,topic:t,state:n})}register(e,t,n){const o=this.getDocumentHistoryData(n);o.topicHistories.has(t)||o.topicHistories.set(t,{commands:[],currentIndex:-1});const r=o.topicHistories.get(t);r.commands.splice(r.currentIndex+1),r.commands.push(e),r.currentIndex++;const a={command:e,topic:t};o.globalTimeline.splice(o.globalIndex+1),o.globalTimeline.push(a),o.globalIndex++,e.execute(),this.emitHistoryChange(n,t)}undo(e,t){const n=this.getDocumentHistoryData(t);let o;if(e){const t=n.topicHistories.get(e);t&&t.currentIndex>-1&&(t.commands[t.currentIndex].undo(),t.currentIndex--,o=e)}else if(n.globalIndex>-1){const e=n.globalTimeline[n.globalIndex];e.command.undo(),n.topicHistories.get(e.topic).currentIndex--,n.globalIndex--,o=e.topic}o&&this.emitHistoryChange(t,o)}redo(e,t){const n=this.getDocumentHistoryData(t);let o;if(e){const t=n.topicHistories.get(e);t&&t.currentIndex<t.commands.length-1&&(t.currentIndex++,t.commands[t.currentIndex].execute(),o=e)}else if(n.globalIndex<n.globalTimeline.length-1){n.globalIndex++;const e=n.globalTimeline[n.globalIndex];e.command.execute(),n.topicHistories.get(e.topic).currentIndex++,o=e.topic}o&&this.emitHistoryChange(t,o)}canUndo(e,t){const n=this.getDocumentHistoryData(t);if(e){const t=n.topicHistories.get(e);return!!t&&t.currentIndex>-1}return n.globalIndex>-1}canRedo(e,t){const n=this.getDocumentHistoryData(t);if(e){const t=n.topicHistories.get(e);return!!t&&t.currentIndex<t.commands.length-1}return n.globalIndex<n.globalTimeline.length-1}createHistoryScope(e){return{register:(t,n)=>this.register(t,n,e),undo:t=>this.undo(t,e),redo:t=>this.redo(t,e),canUndo:t=>this.canUndo(t,e),canRedo:t=>this.canRedo(t,e),getHistoryState:()=>this.getDocumentHistoryState(e),onHistoryChange:t=>this.historyChange$.on(n=>{n.documentId===e&&t(n.topic)})}}buildCapability(){return{register:(e,t)=>{const n=this.getActiveDocumentId();this.register(e,t,n)},undo:e=>{const t=this.getActiveDocumentId();this.undo(e,t)},redo:e=>{const t=this.getActiveDocumentId();this.redo(e,t)},canUndo:e=>{const t=this.getActiveDocumentId();return this.canUndo(e,t)},canRedo:e=>{const t=this.getActiveDocumentId();return this.canRedo(e,t)},getHistoryState:()=>{const e=this.getActiveDocumentId();return this.getDocumentHistoryState(e)},forDocument:e=>this.createHistoryScope(e),onHistoryChange:this.historyChange$.on}}async destroy(){this.historyChange$.clear(),this.documentHistories.clear(),super.destroy()}};Ru.id="history";let Gu=Ru;const Lu={global:{canUndo:!1,canRedo:!1},topics:{}},Nu={documents:{},activeDocumentId:null},zu={manifest:ku,create:e=>new Gu(Mu,e),reducer:(e=Nu,t)=>{switch(t.type){case Tu:{const{documentId:n}=t.payload;return{...e,documents:{...e.documents,[n]:{...Lu}}}}case Iu:{const{documentId:n}=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case Ou:{const{documentId:n,state:o}=t.payload;return e.documents[n]?{...e,documents:{...e.documents,[n]:o}}:e}case"HISTORY/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};default:return e}},initialState:Nu};var ju=(e=>(e.MarqueeRedact="marqueeRedact",e.RedactSelection="redactSelection",e))(ju||{});const Bu="REDACTION/INIT_STATE",$u="REDACTION/CLEANUP_STATE",Uu="START_REDACTION",Wu="END_REDACTION",Hu="ADD_PENDING",Vu="REMOVE_PENDING",Yu="CLEAR_PENDING",qu="SELECT_PENDING",Ku="DESELECT_PENDING",Xu=(e,t)=>({type:Hu,payload:{documentId:e,items:t}}),Zu=(e,t,n)=>({type:Vu,payload:{documentId:e,page:t,id:n}}),Qu=e=>({type:Yu,payload:e}),Ju=(e,t)=>({type:Uu,payload:{documentId:e,mode:t}}),em=e=>Object.values(e).reduce((e,t)=>e+t.length,0),tm={isRedacting:!1,activeType:null,pending:{},pendingCount:0,selected:null},nm={documents:{},activeDocumentId:null},om=class extends Qn{constructor(e,t,n){var o,r,a;super(e,t),this.redactionSelection$=new Map,this.pending$=lo(),this.selected$=lo(),this.state$=lo(),this.events$=lo(),this.documentUnsubscribers=new Map,this.config=n,this.selectionCapability=null==(o=this.registry.getPlugin("selection"))?void 0:o.provides(),this.interactionManagerCapability=null==(r=this.registry.getPlugin("interaction-manager"))?void 0:r.provides(),this.interactionManagerCapability&&(this.interactionManagerCapability.registerMode({id:ju.MarqueeRedact,scope:"page",exclusive:!0,cursor:"crosshair"}),this.interactionManagerCapability.registerMode({id:ju.RedactSelection,scope:"page",exclusive:!1})),null==(a=this.interactionManagerCapability)||a.onModeChange(e=>{const t=e.documentId;if(e.activeMode===ju.RedactSelection)this.dispatch(Ju(t,ju.RedactSelection));else if(e.activeMode===ju.MarqueeRedact)this.dispatch(Ju(t,ju.MarqueeRedact));else{const e=this.getDocumentState(t);(null==e?void 0:e.isRedacting)&&this.dispatch((e=>({type:Wu,payload:e}))(t))}})}onDocumentLoadingStarted(e){this.dispatch(function(e,t){return{type:Bu,payload:{documentId:e,state:t}}}(e,{...tm})),this.redactionSelection$.set(e,lo());const t=[];if(this.selectionCapability){const n=this.selectionCapability.forDocument(e),o=n.onSelectionChange(()=>{const t=this.getDocumentState(e);if(!(null==t?void 0:t.isRedacting))return;const o=n.getFormattedSelection(),r=this.redactionSelection$.get(e);null==r||r.emit(o)}),r=n.onEndSelection(()=>{const t=this.getDocumentState(e);if(!(null==t?void 0:t.isRedacting))return;const o=n.getFormattedSelection().map(e=>({id:_n(),kind:"text",page:e.pageIndex,rect:e.rect,rects:e.segmentRects}));this.dispatch(Xu(e,o));const r=this.redactionSelection$.get(e);null==r||r.emit([]),n.clear(),this.emitPendingChange(e),o.length&&this.selectPending(o[o.length-1].page,o[o.length-1].id,e)});t.push(o,r)}this.documentUnsubscribers.set(e,t),this.logger.debug("RedactionPlugin","DocumentOpened",`Initialized redaction state for document: ${e}`)}onDocumentLoaded(e){var t;null==(t=this.selectionCapability)||t.enableForMode(ju.RedactSelection,e)}onDocumentClosed(e){this.dispatch(function(e){return{type:$u,payload:e}}(e));const t=this.redactionSelection$.get(e);null==t||t.clear(),this.redactionSelection$.delete(e);const n=this.documentUnsubscribers.get(e);n&&(n.forEach(e=>e()),this.documentUnsubscribers.delete(e)),this.logger.debug("RedactionPlugin","DocumentClosed",`Cleaned up redaction state for document: ${e}`)}async initialize(e){this.logger.info("RedactionPlugin","Initialize","Redaction plugin initialized")}buildCapability(){return{queueCurrentSelectionAsPending:()=>this.queueCurrentSelectionAsPending(),enableMarqueeRedact:()=>this.enableMarqueeRedact(),toggleMarqueeRedact:()=>this.toggleMarqueeRedact(),isMarqueeRedactActive:()=>this.isMarqueeRedactActive(),enableRedactSelection:()=>this.enableRedactSelection(),toggleRedactSelection:()=>this.toggleRedactSelection(),isRedactSelectionActive:()=>this.isRedactSelectionActive(),addPending:e=>this.addPendingItems(e),removePending:(e,t)=>this.removePendingItem(e,t),clearPending:()=>this.clearPendingItems(),commitAllPending:()=>this.commitAllPending(),commitPending:(e,t)=>this.commitPendingOne(e,t),endRedaction:()=>this.endRedactionMode(),startRedaction:()=>this.startRedactionMode(),selectPending:(e,t)=>this.selectPending(e,t),getSelectedPending:()=>this.getSelectedPending(),deselectPending:()=>this.deselectPending(),getState:()=>this.getDocumentStateOrThrow(),forDocument:e=>this.createRedactionScope(e),onPendingChange:this.pending$.on,onSelectedChange:this.selected$.on,onRedactionEvent:this.events$.on,onStateChange:this.state$.on}}createRedactionScope(e){return{queueCurrentSelectionAsPending:()=>this.queueCurrentSelectionAsPending(e),enableMarqueeRedact:()=>this.enableMarqueeRedact(e),toggleMarqueeRedact:()=>this.toggleMarqueeRedact(e),isMarqueeRedactActive:()=>this.isMarqueeRedactActive(e),enableRedactSelection:()=>this.enableRedactSelection(e),toggleRedactSelection:()=>this.toggleRedactSelection(e),isRedactSelectionActive:()=>this.isRedactSelectionActive(e),addPending:t=>this.addPendingItems(t,e),removePending:(t,n)=>this.removePendingItem(t,n,e),clearPending:()=>this.clearPendingItems(e),commitAllPending:()=>this.commitAllPending(e),commitPending:(t,n)=>this.commitPendingOne(t,n,e),endRedaction:()=>this.endRedactionMode(e),startRedaction:()=>this.startRedactionMode(e),selectPending:(t,n)=>this.selectPending(t,n,e),getSelectedPending:()=>this.getSelectedPending(e),deselectPending:()=>this.deselectPending(e),getState:()=>this.getDocumentStateOrThrow(e),onPendingChange:t=>this.pending$.on(n=>{n.documentId===e&&t(n.pending)}),onSelectedChange:t=>this.selected$.on(n=>{n.documentId===e&&t(n.selected)}),onRedactionEvent:t=>this.events$.on(n=>{n.documentId===e&&t(n)}),onStateChange:t=>this.state$.on(n=>{n.documentId===e&&t(n.state)})}}getDocumentState(e){const t=e??this.getActiveDocumentId();return this.state.documents[t]??null}getDocumentStateOrThrow(e){const t=this.getDocumentState(e);if(!t)throw new Error(`Redaction state not found for document: ${e??"active"}`);return t}addPendingItems(e,t){const n=t??this.getActiveDocumentId();this.dispatch(Xu(n,e)),this.emitPendingChange(n),this.events$.emit({type:"add",documentId:n,items:e})}removePendingItem(e,t,n){const o=n??this.getActiveDocumentId();this.dispatch(Zu(o,e,t)),this.emitPendingChange(o),this.events$.emit({type:"remove",documentId:o,page:e,id:t})}clearPendingItems(e){const t=e??this.getActiveDocumentId();this.dispatch(Qu(t)),this.emitPendingChange(t),this.events$.emit({type:"clear",documentId:t})}selectPending(e,t,n){var o;const r=n??this.getActiveDocumentId();this.dispatch(((e,t,n)=>({type:qu,payload:{documentId:e,page:t,id:n}}))(r,e,t)),null==(o=this.selectionCapability)||o.forDocument(r).clear(),this.emitSelectedChange(r)}getSelectedPending(e){var t;const n=e??this.getActiveDocumentId();return(null==(t=this.getDocumentState(n))?void 0:t.selected)??null}deselectPending(e){const t=e??this.getActiveDocumentId();this.dispatch((e=>({type:Ku,payload:e}))(t)),this.emitSelectedChange(t)}enableRedactSelection(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManagerCapability)||t.forDocument(n).activate(ju.RedactSelection)}toggleRedactSelection(e){var t;const n=e??this.getActiveDocumentId(),o=null==(t=this.interactionManagerCapability)?void 0:t.forDocument(n);(null==o?void 0:o.getActiveMode())===ju.RedactSelection?o.activateDefaultMode():null==o||o.activate(ju.RedactSelection)}isRedactSelectionActive(e){var t;const n=e??this.getActiveDocumentId();return(null==(t=this.interactionManagerCapability)?void 0:t.forDocument(n).getActiveMode())===ju.RedactSelection}enableMarqueeRedact(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManagerCapability)||t.forDocument(n).activate(ju.MarqueeRedact)}toggleMarqueeRedact(e){var t;const n=e??this.getActiveDocumentId(),o=null==(t=this.interactionManagerCapability)?void 0:t.forDocument(n);(null==o?void 0:o.getActiveMode())===ju.MarqueeRedact?o.activateDefaultMode():null==o||o.activate(ju.MarqueeRedact)}isMarqueeRedactActive(e){var t;const n=e??this.getActiveDocumentId();return(null==(t=this.interactionManagerCapability)?void 0:t.forDocument(n).getActiveMode())===ju.MarqueeRedact}startRedactionMode(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManagerCapability)||t.forDocument(n).activate(ju.RedactSelection)}endRedactionMode(e){var t;const n=e??this.getActiveDocumentId();null==(t=this.interactionManagerCapability)||t.forDocument(n).activateDefaultMode()}onRedactionSelectionChange(e,t){const n=this.redactionSelection$.get(e);return(null==n?void 0:n.on(t))??(()=>{})}registerMarqueeOnPage(e){if(!this.interactionManagerCapability)return this.logger.warn("RedactionPlugin","MissingDependency","Interaction manager plugin not loaded, marquee redaction disabled"),()=>{};const t=this.coreState.core.documents[e.documentId];if(!(null==t?void 0:t.document))return this.logger.warn("RedactionPlugin","DocumentNotFound","Document not found"),()=>{};const n=t.document.pages[e.pageIndex];if(!n)return this.logger.warn("RedactionPlugin","PageNotFound",`Page ${e.pageIndex} not found`),()=>{};const o=function(e){const{pageSize:t,scale:n,minDragPx:o=5,onPreview:r,onCommit:a}=e;let i=null,s=null;return{onPointerDown:(e,t)=>{var n;i=e,s={origin:{x:e.x,y:e.y},size:{width:0,height:0}},null==r||r(s),null==(n=t.setPointerCapture)||n.call(t)},onPointerMove:e=>{if(!i)return;const n=no(e.x,0,t.width),o=no(e.y,0,t.height);s={origin:{x:Math.min(i.x,n),y:Math.min(i.y,o)},size:{width:Math.abs(n-i.x),height:Math.abs(o-i.y)}},null==r||r(s)},onPointerUp:(e,t)=>{var l;s&&Math.max(s.size.width,s.size.height)*n>o&&(null==a||a(s)),i=null,s=null,null==r||r(null),null==(l=t.releasePointerCapture)||l.call(t)},onPointerCancel:(e,t)=>{var n;i=null,s=null,null==r||r(null),null==(n=t.releasePointerCapture)||n.call(t)}}}({pageSize:n.size,scale:e.scale,onPreview:e.callback.onPreview,onCommit:t=>{var n,o;const r={id:_n(),kind:"area",page:e.pageIndex,rect:t};this.dispatch(Xu(e.documentId,[r])),this.emitPendingChange(e.documentId),null==(o=(n=e.callback).onCommit)||o.call(n,t),this.enableRedactSelection(e.documentId),this.selectPending(e.pageIndex,r.id,e.documentId)}}),r=this.interactionManagerCapability.registerAlways({handlers:{onPointerDown:(t,n)=>{n.target===n.currentTarget&&this.deselectPending(e.documentId)}},scope:{type:"page",documentId:e.documentId,pageIndex:e.pageIndex}}),a=this.interactionManagerCapability.registerHandlers({documentId:e.documentId,modeId:ju.MarqueeRedact,handlers:o,pageIndex:e.pageIndex});return()=>{r(),a()}}queueCurrentSelectionAsPending(e){const t=e??this.getActiveDocumentId();if(!this.selectionCapability)return Wt.reject({code:Ut.NotFound,message:"[RedactionPlugin] selection plugin required"});const n=this.coreState.core.documents[t];if(!(null==n?void 0:n.document))return Wt.reject({code:Ut.NotFound,message:"Document not found"});const o=this.selectionCapability.forDocument(t),r=o.getFormattedSelection();if(!r.length)return Wt.resolve(!0);const a=_n(),i=r.map(e=>({id:a,kind:"text",page:e.pageIndex,rect:e.rect,rects:e.segmentRects}));this.enableRedactSelection(t),this.dispatch(Xu(t,i)),this.emitPendingChange(t);const s=i[i.length-1];this.selectPending(s.page,s.id,t);const l=this.redactionSelection$.get(t);return null==l||l.emit([]),o.clear(),Wt.resolve(!0)}commitPendingOne(e,t,n){const o=n??this.getActiveDocumentId(),r=this.coreState.core.documents[o];if(!(null==r?void 0:r.document))return Wt.reject({code:Ut.NotFound,message:"Document not found"});const a=this.getDocumentState(o);if(!a)return Wt.reject({code:Ut.NotFound,message:"Document state not found"});const i=(a.pending[e]??[]).find(e=>e.id===t);if(!i)return Wt.resolve(!0);const s="text"===i.kind?i.rects:[i.rect],l=r.document.pages[e];if(!l)return Wt.reject({code:Ut.NotFound,message:"Page not found"});const d=new ft;return this.engine.redactTextInRects(r.document,l,s,{drawBlackBoxes:this.config.drawBlackBoxes}).wait(()=>{this.dispatch(Zu(o,e,t)),this.emitPendingChange(o),this.dispatchCoreAction(Wn(o,[e])),this.events$.emit({type:"commit",documentId:o,success:!0}),d.resolve(!0)},e=>{this.events$.emit({type:"commit",documentId:o,success:!1,error:e.reason}),d.reject({code:Ut.Unknown,message:"Failed to commit redactions"})}),d}commitAllPending(e){const t=e??this.getActiveDocumentId(),n=this.coreState.core.documents[t];if(!(null==n?void 0:n.document))return Wt.reject({code:Ut.NotFound,message:"Document not found"});const o=this.getDocumentState(t);if(!o)return Wt.reject({code:Ut.NotFound,message:"Document state not found"});const r=new Map;for(const[e,t]of Object.entries(o.pending)){const n=Number(e),o=r.get(n)??[];for(const e of t)"text"===e.kind?o.push(...e.rects):o.push(e.rect);r.set(n,o)}const a=Array.from(r.entries()).filter(([e,t])=>t.length>0).map(([e])=>e),i=[];for(const[e,t]of r){const o=n.document.pages[e];o&&t.length&&i.push(this.engine.redactTextInRects(n.document,o,t,{drawBlackBoxes:this.config.drawBlackBoxes}))}const s=new ft;return ft.all(i).wait(()=>{this.dispatch(Qu(t)),this.dispatchCoreAction(Wn(t,a)),this.emitPendingChange(t),this.events$.emit({type:"commit",documentId:t,success:!0}),s.resolve(!0)},e=>{this.events$.emit({type:"commit",documentId:t,success:!1,error:e.reason}),s.reject({code:Ut.Unknown,message:"Failed to commit redactions"})}),s}emitPendingChange(e){const t=this.getDocumentState(e);t&&this.pending$.emit({documentId:e,pending:t.pending})}emitSelectedChange(e){const t=this.getDocumentState(e);t&&this.selected$.emit({documentId:e,selected:t.selected})}emitStateChange(e){const t=this.getDocumentState(e);t&&this.state$.emit({documentId:e,state:t})}onStoreUpdated(e,t){for(const e in t.documents)t.documents[e]&&(this.emitPendingChange(e),this.emitSelectedChange(e),this.emitStateChange(e))}async destroy(){this.pending$.clear(),this.selected$.clear(),this.state$.clear(),this.events$.clear(),this.redactionSelection$.forEach(e=>e.clear()),this.redactionSelection$.clear(),this.documentUnsubscribers.forEach(e=>{e.forEach(e=>e())}),this.documentUnsubscribers.clear(),await super.destroy()}};om.id="redaction";let rm=om;const am="redaction",im={manifest:{id:am,name:"Redaction Plugin",version:"1.0.0",provides:["redaction"],requires:[],optional:["interaction-manager","selection"],defaultConfig:{drawBlackBoxes:!0}},create:(e,t)=>new rm(am,e,t),reducer:(e=nm,t)=>{switch(t.type){case Bu:{const{documentId:n,state:o}=t.payload;return{...e,documents:{...e.documents,[n]:o},activeDocumentId:e.activeDocumentId??n}}case $u:{const n=t.payload,{[n]:o,...r}=e.documents;return{...e,documents:r,activeDocumentId:e.activeDocumentId===n?null:e.activeDocumentId}}case"REDACTION/SET_ACTIVE_DOCUMENT":return{...e,activeDocumentId:t.payload};case Hu:{const{documentId:n,items:o}=t.payload,r=e.documents[n];if(!r)return e;const a={...r.pending};for(const e of o)a[e.page]=(a[e.page]??[]).concat(e);return{...e,documents:{...e.documents,[n]:{...r,pending:a,pendingCount:em(a)}}}}case Vu:{const{documentId:n,page:o,id:r}=t.payload,a=e.documents[n];if(!a)return e;const i=(a.pending[o]??[]).filter(e=>e.id!==r),s={...a.pending,[o]:i},l=a.selected&&!(a.selected.page===o&&a.selected.id===r);return{...e,documents:{...e.documents,[n]:{...a,pending:s,pendingCount:em(s),selected:l?a.selected:null}}}}case Yu:{const n=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,pending:{},pendingCount:0,selected:null}}}:e}case qu:{const{documentId:n,page:o,id:r}=t.payload,a=e.documents[n];return a?{...e,documents:{...e.documents,[n]:{...a,selected:{page:o,id:r}}}}:e}case Ku:{const n=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,selected:null}}}:e}case Uu:{const{documentId:n,mode:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,isRedacting:!0,activeType:o}}}:e}case Wu:{const n=t.payload,o=e.documents[n];return o?{...e,documents:{...e.documents,[n]:{...o,pending:{},pendingCount:0,selected:null,isRedacting:!1,activeType:null}}}:e}case"SET_ACTIVE_TYPE":{const{documentId:n,mode:o}=t.payload,r=e.documents[n];return r?{...e,documents:{...e.documents,[n]:{...r,activeType:o}}}:e}default:return e}},initialState:nm},sm=()=>fo(rm.id),lm=({documentId:e,pageIndex:t,scale:n,className:o,stroke:r="red",fill:a="transparent"})=>{const{plugin:i}=sm(),s=bo(e),[l,d]=Ee(null),c=Ie(()=>void 0!==n?n:(null==s?void 0:s.scale)??1,[n,null==s?void 0:s.scale]);return Me(()=>{if(i&&e)return i.registerMarqueeOnPage({documentId:e,pageIndex:t,scale:c,callback:{onPreview:d}})},[i,e,t,c]),l?We("div",{style:{position:"absolute",pointerEvents:"none",left:l.origin.x*c,top:l.origin.y*c,width:l.size.width*c,height:l.size.height*c,border:`1px solid ${r}`,background:a,boxSizing:"border-box"},className:o}):null};function dm({color:e="#FFFF00",opacity:t=1,border:n="1px solid red",rects:o,rect:r,scale:a,onClick:i,style:s,...l}){return We(H,{children:o.map((o,d)=>We("div",{onPointerDown:i,onTouchStart:i,style:{position:"absolute",border:n,left:(r?o.origin.x-r.origin.x:o.origin.x)*a,top:(r?o.origin.y-r.origin.y:o.origin.y)*a,width:o.size.width*a,height:o.size.height*a,background:e,opacity:t,pointerEvents:i?"auto":"none",cursor:i?"pointer":"default",zIndex:i?1:void 0,...s},...l},d))})}function cm({documentId:e,pageIndex:t,scale:n}){const{plugin:o}=sm(),[r,a]=Ee([]),[i,s]=Ee(null);return Me(()=>{if(o)return o.onRedactionSelectionChange(e,e=>{const n=e.find(e=>e.pageIndex===t);a((null==n?void 0:n.segmentRects)??[]),s((null==n?void 0:n.rect)??null)})},[o,e,t]),i?We("div",{style:{mixBlendMode:"normal",pointerEvents:"none",position:"absolute",inset:0},children:We(dm,{color:"transparent",opacity:1,rects:r,scale:n,border:"1px solid red"})}):null}function um({documentId:e,pageIndex:t,scale:n,bboxStroke:o="rgba(0,0,0,0.8)",rotation:r=He.Degree0,selectionMenu:a}){const{provides:i}=Fo(rm.id),[s,l]=Ee([]),[d,c]=Ee(null);Me(()=>{if(!i)return;const n=i.forDocument(e),o=n.getState();l(o.pending[t]??[]),c(o.selected&&o.selected.page===t?o.selected.id:null);const r=n.onPendingChange(e=>l(e[t]??[])),a=n.onSelectedChange(e=>{c(e&&e.page===t?e.id:null)});return()=>{null==r||r(),null==a||a()}},[i,e,t]);const u=Oe((n,o)=>{n.stopPropagation(),i&&i.forDocument(e).selectPending(t,o)},[i,e,t]);return s.length?We("div",{style:{position:"absolute",inset:0,pointerEvents:"none"},children:s.map(e=>{if("area"===e.kind){const i=e.rect;return We(H,{children:[We("div",{style:{position:"absolute",left:i.origin.x*n,top:i.origin.y*n,width:i.size.width*n,height:i.size.height*n,background:"transparent",outline:d===e.id?`1px solid ${o}`:"none",outlineOffset:"2px",border:"1px solid red",pointerEvents:"auto",cursor:"pointer"},onPointerDown:t=>u(t,e.id),onTouchStart:t=>u(t,e.id)}),a&&We(Us,{rect:{origin:{x:i.origin.x*n,y:i.origin.y*n},size:{width:i.size.width*n,height:i.size.height*n}},rotation:r,children:n=>a({...n,context:{type:"redaction",item:e,pageIndex:t},selected:d===e.id,placement:{suggestTop:!1}})})]},e.id)}const i=e.rect;return We(H,{children:[We("div",{style:{position:"absolute",left:i.origin.x*n,top:i.origin.y*n,width:i.size.width*n,height:i.size.height*n,background:"transparent",outline:d===e.id?`1px solid ${o}`:"none",outlineOffset:"2px",pointerEvents:"auto",cursor:d===e.id?"pointer":"default"},children:We(dm,{rect:i,rects:e.rects,color:"transparent",border:"1px solid red",scale:n,onClick:t=>u(t,e.id)})}),a&&We(Us,{rect:{origin:{x:i.origin.x*n,y:i.origin.y*n},size:{width:i.size.width*n,height:i.size.height*n}},rotation:r,children:n=>a({...n,context:{type:"redaction",item:e,pageIndex:t},selected:d===e.id,placement:{suggestTop:!1}})})]},e.id)})}):null}const mm=({documentId:e,pageIndex:t,scale:n,rotation:o,selectionMenu:r})=>{const a=bo(e),i=Ie(()=>void 0!==n?n:(null==a?void 0:a.scale)??1,[n,null==a?void 0:a.scale]);return We(H,{children:[We(um,{documentId:e,pageIndex:t,scale:i,rotation:Ie(()=>void 0!==o?o:(null==a?void 0:a.rotation)??He.Degree0,[o,null==a?void 0:a.rotation]),selectionMenu:r}),We(lm,{documentId:e,pageIndex:t,scale:i}),We(cm,{documentId:e,pageIndex:t,scale:i})]})},pm=class extends Qn{constructor(e,t){super(e,t)}async initialize(e){}buildCapability(){return{getAttachments:()=>this.getAttachments(),downloadAttachment:e=>this.downloadAttachment(e),forDocument:e=>this.createAttachmentScope(e)}}createAttachmentScope(e){return{getAttachments:()=>this.getAttachments(e),downloadAttachment:t=>this.downloadAttachment(t,e)}}downloadAttachment(e,t){const n=t??this.getActiveDocumentId(),o=this.coreState.core.documents[n];return(null==o?void 0:o.document)?this.engine.readAttachmentContent(o.document,e):Wt.reject({code:Ut.NotFound,message:`Document ${n} not found`})}getAttachments(e){const t=e??this.getActiveDocumentId(),n=this.coreState.core.documents[t];return(null==n?void 0:n.document)?this.engine.getAttachments(n.document):Wt.reject({code:Ut.NotFound,message:`Document ${t} not found`})}};pm.id="attachment";let hm=pm;const gm="attachment",fm={manifest:{id:gm,name:"Attachment Plugin",version:"1.0.0",provides:["attachment"],requires:[],optional:[],defaultConfig:{}},create:e=>new hm(gm,e),reducer:()=>{},initialState:{}},Fm=(e=new Map,t=null,n)=>({nextPart:e,validators:t,classGroupId:n}),Pm="-",bm=[],_m=e=>{const t=Dm(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:o}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]"))return ym(e);const n=e.split(Pm),o=""===n[0]&&n.length>1?1:0;return vm(n,o,t)},getConflictingClassGroupIds:(e,t)=>{if(t){const t=o[e],r=n[e];return t?r?((e,t)=>{const n=new Array(e.length+t.length);for(let t=0;t<e.length;t++)n[t]=e[t];for(let o=0;o<t.length;o++)n[e.length+o]=t[o];return n})(r,t):t:r||bm}return n[e]||bm}}},vm=(e,t,n)=>{if(0===e.length-t)return n.classGroupId;const o=e[t],r=n.nextPart.get(o);if(r){const n=vm(e,t+1,r);if(n)return n}const a=n.validators;if(null===a)return;const i=0===t?e.join(Pm):e.slice(t).join(Pm),s=a.length;for(let e=0;e<s;e++){const t=a[e];if(t.validator(i))return t.classGroupId}},ym=e=>-1===e.slice(1,-1).indexOf(":")?void 0:(()=>{const t=e.slice(1,-1),n=t.indexOf(":"),o=t.slice(0,n);return o?"arbitrary.."+o:void 0})(),Dm=e=>{const{theme:t,classGroups:n}=e;return xm(n,t)},xm=(e,t)=>{const n=Fm();for(const o in e){const r=e[o];Am(r,n,o,t)}return n},Am=(e,t,n,o)=>{const r=e.length;for(let a=0;a<r;a++){const r=e[a];wm(r,t,n,o)}},wm=(e,t,n,o)=>{"string"!=typeof e?"function"!=typeof e?Cm(e,t,n,o):Em(e,t,n,o):Sm(e,t,n)},Sm=(e,t,n)=>{(""===e?t:Mm(t,e)).classGroupId=n},Em=(e,t,n,o)=>{km(e)?Am(e(o),t,n,o):(null===t.validators&&(t.validators=[]),t.validators.push(((e,t)=>({classGroupId:e,validator:t}))(n,e)))},Cm=(e,t,n,o)=>{const r=Object.entries(e),a=r.length;for(let e=0;e<a;e++){const[a,i]=r[e];Am(i,Mm(t,a),n,o)}},Mm=(e,t)=>{let n=e;const o=t.split(Pm),r=o.length;for(let e=0;e<r;e++){const t=o[e];let r=n.nextPart.get(t);r||(r=Fm(),n.nextPart.set(t,r)),n=r}return n},km=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,Tm=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=Object.create(null),o=Object.create(null);const r=(r,a)=>{n[r]=a,t++,t>e&&(t=0,o=n,n=Object.create(null))};return{get(e){let t=n[e];return void 0!==t?t:void 0!==(t=o[e])?(r(e,t),t):void 0},set(e,t){e in n?n[e]=t:r(e,t)}}},Im=[],Om=(e,t,n,o,r)=>({modifiers:e,hasImportantModifier:t,baseClassName:n,maybePostfixModifierPosition:o,isExternal:r}),Rm=e=>{const{prefix:t,experimentalParseClassName:n}=e;let o=e=>{const t=[];let n,o=0,r=0,a=0;const i=e.length;for(let s=0;s<i;s++){const i=e[s];if(0===o&&0===r){if(":"===i){t.push(e.slice(a,s)),a=s+1;continue}if("/"===i){n=s;continue}}"["===i?o++:"]"===i?o--:"("===i?r++:")"===i&&r--}const s=0===t.length?e:e.slice(a);let l=s,d=!1;return s.endsWith("!")?(l=s.slice(0,-1),d=!0):s.startsWith("!")&&(l=s.slice(1),d=!0),Om(t,d,l,n&&n>a?n-a:void 0)};if(t){const e=t+":",n=o;o=t=>t.startsWith(e)?n(t.slice(e.length)):Om(Im,!1,t,void 0,!0)}if(n){const e=o;o=t=>n({className:t,parseClassName:e})}return o},Gm=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((e,n)=>{t.set(e,1e6+n)}),e=>{const n=[];let o=[];for(let r=0;r<e.length;r++){const a=e[r],i="["===a[0],s=t.has(a);i||s?(o.length>0&&(o.sort(),n.push(...o),o=[]),n.push(a)):o.push(a)}return o.length>0&&(o.sort(),n.push(...o)),n}},Lm=/\s+/,Nm=e=>{if("string"==typeof e)return e;let t,n="";for(let o=0;o<e.length;o++)e[o]&&(t=Nm(e[o]))&&(n&&(n+=" "),n+=t);return n},zm=[],jm=e=>{const t=t=>t[e]||zm;return t.isThemeGetter=!0,t},Bm=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,$m=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Um=/^\d+\/\d+$/,Wm=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Hm=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Vm=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ym=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qm=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Km=e=>Um.test(e),Xm=e=>!!e&&!Number.isNaN(Number(e)),Zm=e=>!!e&&Number.isInteger(Number(e)),Qm=e=>e.endsWith("%")&&Xm(e.slice(0,-1)),Jm=e=>Wm.test(e),ep=()=>!0,tp=e=>Hm.test(e)&&!Vm.test(e),np=()=>!1,op=e=>Ym.test(e),rp=e=>qm.test(e),ap=e=>!sp(e)&&!pp(e),ip=e=>_p(e,xp,np),sp=e=>Bm.test(e),lp=e=>_p(e,Ap,tp),dp=e=>_p(e,wp,Xm),cp=e=>_p(e,yp,np),up=e=>_p(e,Dp,rp),mp=e=>_p(e,Ep,op),pp=e=>$m.test(e),hp=e=>vp(e,Ap),gp=e=>vp(e,Sp),fp=e=>vp(e,yp),Fp=e=>vp(e,xp),Pp=e=>vp(e,Dp),bp=e=>vp(e,Ep,!0),_p=(e,t,n)=>{const o=Bm.exec(e);return!!o&&(o[1]?t(o[1]):n(o[2]))},vp=(e,t,n=!1)=>{const o=$m.exec(e);return!!o&&(o[1]?t(o[1]):n)},yp=e=>"position"===e||"percentage"===e,Dp=e=>"image"===e||"url"===e,xp=e=>"length"===e||"size"===e||"bg-size"===e,Ap=e=>"length"===e,wp=e=>"number"===e,Sp=e=>"family-name"===e,Ep=e=>"shadow"===e,Cp=((e,...t)=>{let n,o,r,a;const i=e=>{const t=o(e);if(t)return t;const a=((e,t)=>{const{parseClassName:n,getClassGroupId:o,getConflictingClassGroupIds:r,sortModifiers:a}=t,i=[],s=e.trim().split(Lm);let l="";for(let e=s.length-1;e>=0;e-=1){const t=s[e],{isExternal:d,modifiers:c,hasImportantModifier:u,baseClassName:m,maybePostfixModifierPosition:p}=n(t);if(d){l=t+(l.length>0?" "+l:l);continue}let h=!!p,g=o(h?m.substring(0,p):m);if(!g){if(!h){l=t+(l.length>0?" "+l:l);continue}if(g=o(m),!g){l=t+(l.length>0?" "+l:l);continue}h=!1}const f=0===c.length?"":1===c.length?c[0]:a(c).join(":"),F=u?f+"!":f,P=F+g;if(i.indexOf(P)>-1)continue;i.push(P);const b=r(g,h);for(let e=0;e<b.length;++e){const t=b[e];i.push(F+t)}l=t+(l.length>0?" "+l:l)}return l})(e,n);return r(e,a),a};return a=s=>{const l=t.reduce((e,t)=>t(e),e());return n=(e=>({cache:Tm(e.cacheSize),parseClassName:Rm(e),sortModifiers:Gm(e),..._m(e)}))(l),o=n.cache.get,r=n.cache.set,a=i,i(s)},(...e)=>a(((...e)=>{let t,n,o=0,r="";for(;o<e.length;)(t=e[o++])&&(n=Nm(t))&&(r&&(r+=" "),r+=n);return r})(...e))})(()=>{const e=jm("color"),t=jm("font"),n=jm("text"),o=jm("font-weight"),r=jm("tracking"),a=jm("leading"),i=jm("breakpoint"),s=jm("container"),l=jm("spacing"),d=jm("radius"),c=jm("shadow"),u=jm("inset-shadow"),m=jm("text-shadow"),p=jm("drop-shadow"),h=jm("blur"),g=jm("perspective"),f=jm("aspect"),F=jm("ease"),P=jm("animate"),b=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",pp,sp],_=()=>[pp,sp,l],v=()=>[Km,"full","auto",..._()],y=()=>[Zm,"none","subgrid",pp,sp],D=()=>["auto",{span:["full",Zm,pp,sp]},Zm,pp,sp],x=()=>[Zm,"auto",pp,sp],A=()=>["auto","min","max","fr",pp,sp],w=()=>["auto",..._()],S=()=>[Km,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",..._()],E=()=>[e,pp,sp],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",fp,cp,{position:[pp,sp]}],M=()=>["auto","cover","contain",Fp,ip,{size:[pp,sp]}],k=()=>[Qm,hp,lp],T=()=>["","none","full",d,pp,sp],I=()=>["",Xm,hp,lp],O=()=>[Xm,Qm,fp,cp],R=()=>["","none",h,pp,sp],G=()=>["none",Xm,pp,sp],L=()=>["none",Xm,pp,sp],N=()=>[Xm,pp,sp],z=()=>[Km,"full",..._()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Jm],breakpoint:[Jm],color:[ep],container:[Jm],"drop-shadow":[Jm],ease:["in","out","in-out"],font:[ap],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Jm],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Jm],shadow:[Jm],spacing:["px",Xm],text:[Jm],"text-shadow":[Jm],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Km,sp,pp,f]}],container:["container"],columns:[{columns:[Xm,sp,pp,s]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:b()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:v()}],"inset-x":[{"inset-x":v()}],"inset-y":[{"inset-y":v()}],start:[{start:v()}],end:[{end:v()}],top:[{top:v()}],right:[{right:v()}],bottom:[{bottom:v()}],left:[{left:v()}],visibility:["visible","invisible","collapse"],z:[{z:[Zm,"auto",pp,sp]}],basis:[{basis:[Km,"full","auto",s,..._()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Xm,Km,"auto","initial","none",sp]}],grow:[{grow:["",Xm,pp,sp]}],shrink:[{shrink:["",Xm,pp,sp]}],order:[{order:[Zm,"first","last","none",pp,sp]}],"grid-cols":[{"grid-cols":y()}],"col-start-end":[{col:D()}],"col-start":[{"col-start":x()}],"col-end":[{"col-end":x()}],"grid-rows":[{"grid-rows":y()}],"row-start-end":[{row:D()}],"row-start":[{"row-start":x()}],"row-end":[{"row-end":x()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":A()}],"auto-rows":[{"auto-rows":A()}],gap:[{gap:_()}],"gap-x":[{"gap-x":_()}],"gap-y":[{"gap-y":_()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:_()}],px:[{px:_()}],py:[{py:_()}],ps:[{ps:_()}],pe:[{pe:_()}],pt:[{pt:_()}],pr:[{pr:_()}],pb:[{pb:_()}],pl:[{pl:_()}],m:[{m:w()}],mx:[{mx:w()}],my:[{my:w()}],ms:[{ms:w()}],me:[{me:w()}],mt:[{mt:w()}],mr:[{mr:w()}],mb:[{mb:w()}],ml:[{ml:w()}],"space-x":[{"space-x":_()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":_()}],"space-y-reverse":["space-y-reverse"],size:[{size:S()}],w:[{w:[s,"screen",...S()]}],"min-w":[{"min-w":[s,"screen","none",...S()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[i]},...S()]}],h:[{h:["screen","lh",...S()]}],"min-h":[{"min-h":["screen","lh","none",...S()]}],"max-h":[{"max-h":["screen","lh",...S()]}],"font-size":[{text:["base",n,hp,lp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[o,pp,dp]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Qm,sp]}],"font-family":[{font:[gp,sp,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,pp,sp]}],"line-clamp":[{"line-clamp":[Xm,"none",pp,dp]}],leading:[{leading:[a,..._()]}],"list-image":[{"list-image":["none",pp,sp]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",pp,sp]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:E()}],"text-color":[{text:E()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[Xm,"from-font","auto",pp,lp]}],"text-decoration-color":[{decoration:E()}],"underline-offset":[{"underline-offset":[Xm,"auto",pp,sp]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:_()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pp,sp]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pp,sp]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:C()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:M()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Zm,pp,sp],radial:["",pp,sp],conic:[Zm,pp,sp]},Pp,up]}],"bg-color":[{bg:E()}],"gradient-from-pos":[{from:k()}],"gradient-via-pos":[{via:k()}],"gradient-to-pos":[{to:k()}],"gradient-from":[{from:E()}],"gradient-via":[{via:E()}],"gradient-to":[{to:E()}],rounded:[{rounded:T()}],"rounded-s":[{"rounded-s":T()}],"rounded-e":[{"rounded-e":T()}],"rounded-t":[{"rounded-t":T()}],"rounded-r":[{"rounded-r":T()}],"rounded-b":[{"rounded-b":T()}],"rounded-l":[{"rounded-l":T()}],"rounded-ss":[{"rounded-ss":T()}],"rounded-se":[{"rounded-se":T()}],"rounded-ee":[{"rounded-ee":T()}],"rounded-es":[{"rounded-es":T()}],"rounded-tl":[{"rounded-tl":T()}],"rounded-tr":[{"rounded-tr":T()}],"rounded-br":[{"rounded-br":T()}],"rounded-bl":[{"rounded-bl":T()}],"border-w":[{border:I()}],"border-w-x":[{"border-x":I()}],"border-w-y":[{"border-y":I()}],"border-w-s":[{"border-s":I()}],"border-w-e":[{"border-e":I()}],"border-w-t":[{"border-t":I()}],"border-w-r":[{"border-r":I()}],"border-w-b":[{"border-b":I()}],"border-w-l":[{"border-l":I()}],"divide-x":[{"divide-x":I()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":I()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:E()}],"border-color-x":[{"border-x":E()}],"border-color-y":[{"border-y":E()}],"border-color-s":[{"border-s":E()}],"border-color-e":[{"border-e":E()}],"border-color-t":[{"border-t":E()}],"border-color-r":[{"border-r":E()}],"border-color-b":[{"border-b":E()}],"border-color-l":[{"border-l":E()}],"divide-color":[{divide:E()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[Xm,pp,sp]}],"outline-w":[{outline:["",Xm,hp,lp]}],"outline-color":[{outline:E()}],shadow:[{shadow:["","none",c,bp,mp]}],"shadow-color":[{shadow:E()}],"inset-shadow":[{"inset-shadow":["none",u,bp,mp]}],"inset-shadow-color":[{"inset-shadow":E()}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:E()}],"ring-offset-w":[{"ring-offset":[Xm,lp]}],"ring-offset-color":[{"ring-offset":E()}],"inset-ring-w":[{"inset-ring":I()}],"inset-ring-color":[{"inset-ring":E()}],"text-shadow":[{"text-shadow":["none",m,bp,mp]}],"text-shadow-color":[{"text-shadow":E()}],opacity:[{opacity:[Xm,pp,sp]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Xm]}],"mask-image-linear-from-pos":[{"mask-linear-from":O()}],"mask-image-linear-to-pos":[{"mask-linear-to":O()}],"mask-image-linear-from-color":[{"mask-linear-from":E()}],"mask-image-linear-to-color":[{"mask-linear-to":E()}],"mask-image-t-from-pos":[{"mask-t-from":O()}],"mask-image-t-to-pos":[{"mask-t-to":O()}],"mask-image-t-from-color":[{"mask-t-from":E()}],"mask-image-t-to-color":[{"mask-t-to":E()}],"mask-image-r-from-pos":[{"mask-r-from":O()}],"mask-image-r-to-pos":[{"mask-r-to":O()}],"mask-image-r-from-color":[{"mask-r-from":E()}],"mask-image-r-to-color":[{"mask-r-to":E()}],"mask-image-b-from-pos":[{"mask-b-from":O()}],"mask-image-b-to-pos":[{"mask-b-to":O()}],"mask-image-b-from-color":[{"mask-b-from":E()}],"mask-image-b-to-color":[{"mask-b-to":E()}],"mask-image-l-from-pos":[{"mask-l-from":O()}],"mask-image-l-to-pos":[{"mask-l-to":O()}],"mask-image-l-from-color":[{"mask-l-from":E()}],"mask-image-l-to-color":[{"mask-l-to":E()}],"mask-image-x-from-pos":[{"mask-x-from":O()}],"mask-image-x-to-pos":[{"mask-x-to":O()}],"mask-image-x-from-color":[{"mask-x-from":E()}],"mask-image-x-to-color":[{"mask-x-to":E()}],"mask-image-y-from-pos":[{"mask-y-from":O()}],"mask-image-y-to-pos":[{"mask-y-to":O()}],"mask-image-y-from-color":[{"mask-y-from":E()}],"mask-image-y-to-color":[{"mask-y-to":E()}],"mask-image-radial":[{"mask-radial":[pp,sp]}],"mask-image-radial-from-pos":[{"mask-radial-from":O()}],"mask-image-radial-to-pos":[{"mask-radial-to":O()}],"mask-image-radial-from-color":[{"mask-radial-from":E()}],"mask-image-radial-to-color":[{"mask-radial-to":E()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[Xm]}],"mask-image-conic-from-pos":[{"mask-conic-from":O()}],"mask-image-conic-to-pos":[{"mask-conic-to":O()}],"mask-image-conic-from-color":[{"mask-conic-from":E()}],"mask-image-conic-to-color":[{"mask-conic-to":E()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:C()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:M()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",pp,sp]}],filter:[{filter:["","none",pp,sp]}],blur:[{blur:R()}],brightness:[{brightness:[Xm,pp,sp]}],contrast:[{contrast:[Xm,pp,sp]}],"drop-shadow":[{"drop-shadow":["","none",p,bp,mp]}],"drop-shadow-color":[{"drop-shadow":E()}],grayscale:[{grayscale:["",Xm,pp,sp]}],"hue-rotate":[{"hue-rotate":[Xm,pp,sp]}],invert:[{invert:["",Xm,pp,sp]}],saturate:[{saturate:[Xm,pp,sp]}],sepia:[{sepia:["",Xm,pp,sp]}],"backdrop-filter":[{"backdrop-filter":["","none",pp,sp]}],"backdrop-blur":[{"backdrop-blur":R()}],"backdrop-brightness":[{"backdrop-brightness":[Xm,pp,sp]}],"backdrop-contrast":[{"backdrop-contrast":[Xm,pp,sp]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Xm,pp,sp]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Xm,pp,sp]}],"backdrop-invert":[{"backdrop-invert":["",Xm,pp,sp]}],"backdrop-opacity":[{"backdrop-opacity":[Xm,pp,sp]}],"backdrop-saturate":[{"backdrop-saturate":[Xm,pp,sp]}],"backdrop-sepia":[{"backdrop-sepia":["",Xm,pp,sp]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":_()}],"border-spacing-x":[{"border-spacing-x":_()}],"border-spacing-y":[{"border-spacing-y":_()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",pp,sp]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Xm,"initial",pp,sp]}],ease:[{ease:["linear","initial",F,pp,sp]}],delay:[{delay:[Xm,pp,sp]}],animate:[{animate:["none",P,pp,sp]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,pp,sp]}],"perspective-origin":[{"perspective-origin":b()}],rotate:[{rotate:G()}],"rotate-x":[{"rotate-x":G()}],"rotate-y":[{"rotate-y":G()}],"rotate-z":[{"rotate-z":G()}],scale:[{scale:L()}],"scale-x":[{"scale-x":L()}],"scale-y":[{"scale-y":L()}],"scale-z":[{"scale-z":L()}],"scale-3d":["scale-3d"],skew:[{skew:N()}],"skew-x":[{"skew-x":N()}],"skew-y":[{"skew-y":N()}],transform:[{transform:[pp,sp,"","none","gpu","cpu"]}],"transform-origin":[{origin:b()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:z()}],"translate-x":[{"translate-x":z()}],"translate-y":[{"translate-y":z()}],"translate-z":[{"translate-z":z()}],"translate-none":["translate-none"],accent:[{accent:E()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:E()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pp,sp]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":_()}],"scroll-mx":[{"scroll-mx":_()}],"scroll-my":[{"scroll-my":_()}],"scroll-ms":[{"scroll-ms":_()}],"scroll-me":[{"scroll-me":_()}],"scroll-mt":[{"scroll-mt":_()}],"scroll-mr":[{"scroll-mr":_()}],"scroll-mb":[{"scroll-mb":_()}],"scroll-ml":[{"scroll-ml":_()}],"scroll-p":[{"scroll-p":_()}],"scroll-px":[{"scroll-px":_()}],"scroll-py":[{"scroll-py":_()}],"scroll-ps":[{"scroll-ps":_()}],"scroll-pe":[{"scroll-pe":_()}],"scroll-pt":[{"scroll-pt":_()}],"scroll-pr":[{"scroll-pr":_()}],"scroll-pb":[{"scroll-pb":_()}],"scroll-pl":[{"scroll-pl":_()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pp,sp]}],fill:[{fill:["none",...E()]}],"stroke-w":[{stroke:[Xm,hp,lp,dp]}],stroke:[{stroke:["none",...E()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});var Mp=["children","onClick","active","disabled","className","anchorRef"];function kp(e){var t=e.children,n=e.onClick,o=e.active,r=void 0!==o&&o,a=e.disabled,i=void 0!==a&&a,s=e.className,l=void 0===s?"":s,d=e.anchorRef,c=f(e,Mp);return U("button",g({ref:d,onClick:n,disabled:i,className:Cp("flex h-[32px] w-auto min-w-[32px] items-center justify-center rounded-md p-[5px] transition-colors hover:bg-interactive-hover hover:ring hover:ring-accent cursor-pointer rounded-none px-2 py-1 text-sm hover:bg-transparent border-b-2 hover:border-b-fg-muted hover:ring-transparent",r?"border-b-accent text-accent hover:border-b-accent":"border-b-transparent",i?"cursor-not-allowed opacity-50":"",l)},c),t)}var Tp=function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M9 6l6 6l-6 6"}))},Ip=function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M15 6l-6 6l6 6"}))},Op=function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M6 9l6 6l6 -6"}))},Rp=function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),U("path",{d:"M21 21l-6 -6"}))},Gp=function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M18 6l-12 12"}),U("path",{d:"M6 6l12 12"}))},Lp={download:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),U("path",{d:"M7 11l5 5l5 -5"}),U("path",{d:"M12 4l0 12"}))},menu:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 8l16 0"}),U("path",{d:"M4 16l16 0"}))},fullscreen:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),U("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),U("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),U("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"}))},fullscreenExit:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 8v-2c0 -.551 .223 -1.05 .584 -1.412"}),U("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),U("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),U("path",{d:"M16 20h2c.545 0 1.04 -.218 1.4 -.572"}),U("path",{d:"M3 3l18 18"}))},save:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"}),U("path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),U("path",{d:"M14 4l0 4l-6 0l0 -4"}))},print:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2"}),U("path",{d:"M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4"}),U("path",{d:"M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z"}))},settings:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z"}),U("path",{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"}))},viewSettings:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),U("path",{d:"M12 10.5v1.5"}),U("path",{d:"M12 16v1.5"}),U("path",{d:"M15.031 12.25l-1.299 .75"}),U("path",{d:"M10.268 15l-1.3 .75"}),U("path",{d:"M15 15.803l-1.285 -.773"}),U("path",{d:"M10.285 12.97l-1.285 -.773"}),U("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),U("path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"}))},rotateClockwise:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4.05 11a8 8 0 1 1 .5 4m-.5 5v-5h5"}))},rotateCounterClockwise:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5"}))},singlePage:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M5 3m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z"}))},doublePage:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 3m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1zm9 -1v18"}))},zoomIn:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"}),U("path",{d:"M9 12h6"}),U("path",{d:"M12 9v6"}))},zoomOut:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),U("path",{d:"M9 12l6 0"}))},fitToWidth:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 12v-6a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v6"}),U("path",{d:"M10 18h-7"}),U("path",{d:"M21 18h-7"}),U("path",{d:"M6 15l-3 3l3 3"}),U("path",{d:"M18 15l3 3l-3 3"}))},fitToPage:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M12 20h-6a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h6"}),U("path",{d:"M18 14v7"}),U("path",{d:"M18 3v7"}),U("path",{d:"M15 18l3 3l3 -3"}),U("path",{d:"M15 6l3 -3l3 3"}))},chevronRight:Tp,chevronLeft:Ip,chevronDown:Op,search:Rp,comment:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M12 11v.01"}),U("path",{d:"M8 11v.01"}),U("path",{d:"M16 11v.01"}),U("path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3z"}))},sidebar:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 18v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"}),U("path",{d:"M14 18v-12a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2 -2z"}))},dots:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),U("path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),U("path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}))},vertical:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M8 7l4 -4l4 4"}),U("path",{d:"M8 17l4 4l4 -4"}),U("path",{d:"M12 3l0 18"}))},horizontal:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M7 8l-4 4l4 4"}),U("path",{d:"M17 8l4 4l-4 4"}),U("path",{d:"M3 12l18 0"}))},book:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),U("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),U("path",{d:"M3 6l0 13"}),U("path",{d:"M12 6l0 13"}),U("path",{d:"M21 6l0 13"}))},book2:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M19 4v16h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12z"}),U("path",{d:"M19 16h-12a2 2 0 0 0 -2 2"}),U("path",{d:"M9 8h6"}))},squares:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M8 10a2 2 0 0 1 2 -2h9a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-9a2 2 0 0 1 -2 -2z"}),U("path",{d:"M16 8v-3a2 2 0 0 0 -2 -2h-9a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h3"}))},listTree:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M9 6h11"}),U("path",{d:"M12 12h8"}),U("path",{d:"M15 18h5"}),U("path",{d:"M5 6v.01"}),U("path",{d:"M8 12v.01"}),U("path",{d:"M11 18v.01"}))},paperclip:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5"}))},copy:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z"}),U("path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1"}))},underline:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none","stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 20h16",stroke:i}),U("path",{d:"M8 16v-8a4 4 0 1 1 8 0v8",stroke:"currentColor"}),U("path",{d:"M8 10h8",stroke:"currentColor"}))},squiggly:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none","stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M8 16v-8a4 4 0 1 1 8 0v8",stroke:"currentColor"}),U("path",{d:"M8 10h8",stroke:"currentColor"}),U("path",{d:"M4 20c1.5 -1.5 3.5 -1.5 5 0s3.5 1.5 5 0 3.5 -1.5 5 0",stroke:i}))},strikethrough:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none","stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M8 16v-8a4 4 0 1 1 8 0v8",stroke:"currentColor"}),U("path",{d:"M4 10h16",stroke:i}))},highlight:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none","stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("rect",{x:"2",y:"6",width:"20",height:"16",rx:"2",fill:i,stroke:"none"}),U("path",{d:"M8 16v-8a4 4 0 1 1 8 0v8",stroke:"currentColor"}),U("path",{d:"M8 10h8",stroke:"currentColor"}))},palette:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25"}),U("path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),U("path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),U("path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}))},x:Gp,fileImport:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),U("path",{d:"M5 13v-8a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-5.5m-9.5 -2h7m-3 -3l3 3l-3 3"}))},hand:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),U("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),U("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),U("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"}))},zoomInArea:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M15 13v4"}),U("path",{d:"M13 15h4"}),U("path",{d:"M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),U("path",{d:"M22 22l-3 -3"}),U("path",{d:"M6 18h-1a2 2 0 0 1 -2 -2v-1"}),U("path",{d:"M3 11v-1"}),U("path",{d:"M3 6v-1a2 2 0 0 1 2 -2h1"}),U("path",{d:"M10 3h1"}),U("path",{d:"M15 3h1a2 2 0 0 1 2 2v1"}))},screenshot:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M7 19a2 2 0 0 1 -2 -2"}),U("path",{d:"M5 13v-2"}),U("path",{d:"M5 7a2 2 0 0 1 2 -2"}),U("path",{d:"M11 5h2"}),U("path",{d:"M17 5a2 2 0 0 1 2 2"}),U("path",{d:"M19 11v2"}),U("path",{d:"M19 17v4"}),U("path",{d:"M21 19h-4"}),U("path",{d:"M13 19h-2"}))},arrowBackUp:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M9 14l-4 -4l4 -4"}),U("path",{d:"M5 10h11a4 4 0 1 1 0 8h-1"}))},arrowForwardUp:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M15 14l4 -4l-4 -4"}),U("path",{d:"M19 10h-11a4 4 0 1 0 0 8h1"}))},trash:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 7l16 0"}),U("path",{d:"M10 11l0 6"}),U("path",{d:"M14 11l0 6"}),U("path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"}),U("path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"}))},deviceFloppy:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"}),U("path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),U("path",{d:"M14 4l0 4l-6 0l0 -4"}))},pencilMarker:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":r,class:e.className,role:"img","aria-label":e.title},U("path",{d:"m9.109 16.275 8.856-8.097c.812-.743.87-2.014.127-2.826s-2.014-.869-2.826-.127L6.41 13.322l-.127 2.826zM13.79 6.575l2.7 2.952",stroke:"currentColor"}),U("path",{stroke:i,d:"M19.375 20.125c.569.063-4.05-.562-6.412-.437s-4.759 1.229-6.857 1.625c-1.764.687-3.404-.938-1.981-2.5"}))},circle:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a,s=e.secondaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:void 0===s?"none":s,stroke:i,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}))},square:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a,s=e.secondaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:void 0===s?"none":s,stroke:i,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"}))},line:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2.2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M20 4l-16 16"}))},lineArrow:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2.2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M20 4l-16 16"}),U("path",{d:"M16 3h5v5"}))},polygon:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a,s=e.secondaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:void 0===s?"none":s,stroke:i,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M13.163 2.168l8.021 5.828c.694 .504 .984 1.397 .719 2.212l-3.064 9.43a1.978 1.978 0 0 1 -1.881 1.367h-9.916a1.978 1.978 0 0 1 -1.881 -1.367l-3.064 -9.43a1.978 1.978 0 0 1 .719 -2.212l8.021 -5.828a1.978 1.978 0 0 1 2.326 0z"}))},zigzag:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{d:"M12 2.4L21.36 11.76L2.64 12.24L12 21.6"}))},text:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M6.5 15.5m-3.5 0a3.5 3.5 0 1 0 7 0a3.5 3.5 0 1 0 -7 0"}),U("path",{d:"M14 19v-10.5a3.5 3.5 0 0 1 7 0v10.5"}),U("path",{d:"M14 13h7"}),U("path",{d:"M10 12v7"}))},italic:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M11 5l6 0"}),U("path",{d:"M7 19l6 0"}),U("path",{d:"M14 5l-4 14"}))},bold:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z"}),U("path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7"}))},alignLeft:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 6l16 0"}),U("path",{d:"M4 12l10 0"}),U("path",{d:"M4 18l14 0"}))},alignCenter:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 6l16 0"}),U("path",{d:"M8 12l8 0"}),U("path",{d:"M6 18l12 0"}))},alignRight:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M4 6l16 0"}),U("path",{d:"M10 12l10 0"}),U("path",{d:"M6 18l14 0"}))},alignTop:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"}),U("path",{d:"M11 13h2"}),U("path",{d:"M9 10h6"}),U("path",{d:"M10 7h4"}))},alignMiddle:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"}),U("path",{d:"M11 15h2"}),U("path",{d:"M9 12h6"}),U("path",{d:"M10 9h4"}))},alignBottom:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"}),U("path",{d:"M11 17h2"}),U("path",{d:"M9 14h6"}),U("path",{d:"M10 11h4"}))},photo:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M15 8h.01"}),U("path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z"}),U("path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5"}),U("path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3"}))},pointer:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M7.904 17.563a1.2 1.2 0 0 0 2.228 .308l2.09 -3.093l4.907 4.907a1.067 1.067 0 0 0 1.509 0l1.047 -1.047a1.067 1.067 0 0 0 0 -1.509l-4.907 -4.907l3.113 -2.09a1.2 1.2 0 0 0 -.309 -2.228l-13.582 -3.904l3.904 13.563z"}))},redact:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M7 4h10"}),U("path",{d:"M12 4v8"}),U("defs",null,U("clipPath",{id:"stripeClip"},U("rect",{x:"2",y:"12",width:"20",height:"10",rx:"2"}))),U("rect",{x:"2",y:"12",width:"20",height:"10",rx:"2",fill:"none"}),U("g",{"clip-path":"url(#stripeClip)"},U("path",{d:"M-7 24l12 -12"}),U("path",{d:"M-3 24l12 -12"}),U("path",{d:"M1 24l12 -12"}),U("path",{d:"M5 24l12 -12"}),U("path",{d:"M9 24l12 -12"}),U("path",{d:"M13 24l12 -12"}),U("path",{d:"M17 24l12 -12"}),U("path",{d:"M21 24l12 -12"}),U("path",{d:"M25 24l12 -12"})))},redactArea:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M6 20h-1a2 2 0 0 1 -2 -2v-1"}),U("path",{d:"M3 13v-3"}),U("path",{d:"M3 6v-1a2 2 0 0 1 2 -2h1"}),U("path",{d:"M10 3h3"}),U("path",{d:"M17 3h1a2 2 0 0 1 2 2v1"}),U("defs",null,U("clipPath",{id:"redactClip"},U("rect",{x:"10",y:"10",width:"12",height:"12",rx:"2"}))),U("rect",{x:"10",y:"10",width:"12",height:"12",rx:"2",fill:"none"}),U("g",{"clip-path":"url(#redactClip)"},U("path",{d:"M-2 24l14 -14"}),U("path",{d:"M2 24l14 -14"}),U("path",{d:"M6 24l14 -14"}),U("path",{d:"M10 24l15 -15"}),U("path",{d:"M14 24l15 -15"}),U("path",{d:"M18 24l15 -15"})))},check:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor;return U("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:void 0===a?"currentColor":a,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:e.className,role:"img","aria-label":e.title},U("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),U("path",{d:"M5 12l5 5l10 -10"}))},file:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a,s=e.className,l=e.title;return U("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:i,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:s,"aria-hidden":!l,role:l?"img":"presentation"},l&&U("title",null,l),U("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),U("polyline",{points:"14 2 14 8 20 8"}))},plus:function(e){var t=e.size,n=void 0===t?24:t,o=e.strokeWidth,r=void 0===o?2:o,a=e.primaryColor,i=void 0===a?"currentColor":a,s=e.className,l=e.title;return U("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:i,"stroke-width":r,"stroke-linecap":"round","stroke-linejoin":"round",class:s,"aria-hidden":!l,role:l?"img":"presentation"},l&&U("title",null,l),U("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),U("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))},lock:function(e){var t=e.size,n=void 0===t?24:t,o=e.className;return U("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:void 0===o?"":o,style:e.style},U("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),U("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"}))},alertTriangle:function(e){var t=e.size,n=void 0===t?24:t,o=e.className;return U("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:void 0===o?"":o,style:e.style},U("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),U("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),U("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"}))}},Np=new Map,zp=/^[MmZzLlHhVvCcSsQqTtAa0-9\s,.\-eE]+$/;function jp(e){return zp.test(e.trim())}function Bp(e,t){for(var n=function(e){var t,n;return"path"in e?{viewBox:e.viewBox||"0 0 24 24",paths:[{d:e.path,stroke:null!==(t=e.stroke)&&void 0!==t?t:"primary",fill:null!==(n=e.fill)&&void 0!==n?n:"none",strokeWidth:e.strokeWidth}],strokeLinecap:e.strokeLinecap||"round",strokeLinejoin:e.strokeLinejoin||"round",strokeWidth:e.strokeWidth}:{viewBox:e.viewBox||"0 0 24 24",paths:e.paths,strokeLinecap:e.strokeLinecap||"round",strokeLinejoin:e.strokeLinejoin||"round",strokeWidth:e.strokeWidth}}(t),o=0;o<n.paths.length;o++){var r=n.paths[o];if(!r.d||!jp(r.d))throw new Error('Invalid path data for icon "'.concat(e,'" at path index ').concat(o,". ")+"Path must only contain valid SVG path commands.")}Np.set(e,n)}function $p(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var o=_(n[t],2);Bp(o[0],o[1])}}function Up(e,t,n){return e&&"none"!==e?"primary"===e?t:"secondary"===e?n:"currentColor"===e?"currentColor":e:"none"}function Wp(e){var t,n=e.icon,o=e.title,r=e.size,a=void 0===r?24:r,i=e.strokeWidth,s=void 0===i?2:i,l=e.primaryColor,d=void 0===l?"currentColor":l,c=e.secondaryColor,u=void 0===c?"none":c,m=e.className,p=Lp[n];if(p)return U(p,{size:a,strokeWidth:s,primaryColor:d,secondaryColor:u,className:m,title:o});if(t=n,Np.has(t)){var h=function(e){return Np.get(e)}(n);return function(e,t){var n,o=t.size,r=t.strokeWidth,a=t.primaryColor,i=t.secondaryColor,s=t.className,l=t.title,d=null!==(n=e.strokeWidth)&&void 0!==n?n:r;return U("svg",{width:o,height:o,viewBox:e.viewBox,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,class:s,role:"img","aria-label":l},e.paths.map(function(e,t){var n,o=Up(e.stroke,a,i),r=Up(e.fill,a,i),s=null!==(n=e.strokeWidth)&&void 0!==n?n:d;return U("path",{key:t,d:e.d,stroke:o,fill:r,"stroke-width":"none"!==o?s:void 0,opacity:e.opacity})}))}(h,{size:a,strokeWidth:s,primaryColor:d,secondaryColor:u,className:m,title:o})}return console.warn("Icon not found: ".concat(n)),null}var Hp=["id","children","onClick","active","disabled","className","tooltip","elementRef"];function Vp(e){var t=e.id,n=e.children,o=e.onClick,r=e.active,a=void 0!==r&&r,i=e.disabled,s=void 0!==i&&i,l=e.className,d=void 0===l?"":l,c=e.tooltip,u=e.elementRef,m=f(e,Hp);return U("button",g({id:t,ref:u,onClick:o,className:"flex h-[32px] w-auto min-w-[32px] items-center justify-center rounded-md p-[5px] transition-colors ".concat(a?"bg-interactive-selected text-accent ring-accent border-none shadow ring":"hover:bg-interactive-hover hover:ring-accent hover:ring"," ").concat(s?"cursor-not-allowed opacity-50 hover:bg-transparent hover:ring-0":"cursor-pointer"," ").concat(d),title:c},m),n)}const Yp=Math.min,qp=Math.max,Kp=Math.round,Xp=Math.floor,Zp=e=>({x:e,y:e}),Qp={left:"right",right:"left",bottom:"top",top:"bottom"},Jp={start:"end",end:"start"};function eh(e,t,n){return qp(e,Yp(t,n))}function th(e,t){return"function"==typeof e?e(t):e}function nh(e){return e.split("-")[0]}function oh(e){return e.split("-")[1]}function rh(e){return"x"===e?"y":"x"}function ah(e){return"y"===e?"height":"width"}const ih=new Set(["top","bottom"]);function sh(e){return ih.has(nh(e))?"y":"x"}function lh(e){return rh(sh(e))}function dh(e){return e.replace(/start|end/g,e=>Jp[e])}const ch=["left","right"],uh=["right","left"],mh=["top","bottom"],ph=["bottom","top"];function hh(e){return e.replace(/left|right|bottom|top/g,e=>Qp[e])}function gh(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function fh(e){const{x:t,y:n,width:o,height:r}=e;return{width:o,height:r,top:n,left:t,right:t+o,bottom:n+r,x:t,y:n}}function Fh(e,t,n){let{reference:o,floating:r}=e;const a=sh(t),i=lh(t),s=ah(i),l=nh(t),d="y"===a,c=o.x+o.width/2-r.width/2,u=o.y+o.height/2-r.height/2,m=o[s]/2-r[s]/2;let p;switch(l){case"top":p={x:c,y:o.y-r.height};break;case"bottom":p={x:c,y:o.y+o.height};break;case"right":p={x:o.x+o.width,y:u};break;case"left":p={x:o.x-r.width,y:u};break;default:p={x:o.x,y:o.y}}switch(oh(t)){case"start":p[i]-=m*(n&&d?-1:1);break;case"end":p[i]+=m*(n&&d?-1:1)}return p}async function Ph(e,t){var n;void 0===t&&(t={});const{x:o,y:r,platform:a,rects:i,elements:s,strategy:l}=e,{boundary:d="clippingAncestors",rootBoundary:c="viewport",elementContext:u="floating",altBoundary:m=!1,padding:p=0}=th(t,e),h=gh(p),g=s[m?"floating"===u?"reference":"floating":u],f=fh(await a.getClippingRect({element:null==(n=await(null==a.isElement?void 0:a.isElement(g)))||n?g:g.contextElement||await(null==a.getDocumentElement?void 0:a.getDocumentElement(s.floating)),boundary:d,rootBoundary:c,strategy:l})),F="floating"===u?{x:o,y:r,width:i.floating.width,height:i.floating.height}:i.reference,P=await(null==a.getOffsetParent?void 0:a.getOffsetParent(s.floating)),b=await(null==a.isElement?void 0:a.isElement(P))&&await(null==a.getScale?void 0:a.getScale(P))||{x:1,y:1},_=fh(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:F,offsetParent:P,strategy:l}):F);return{top:(f.top-_.top+h.top)/b.y,bottom:(_.bottom-f.bottom+h.bottom)/b.y,left:(f.left-_.left+h.left)/b.x,right:(_.right-f.right+h.right)/b.x}}const bh=new Set(["left","top"]);function _h(){return"undefined"!=typeof window}function vh(e){return xh(e)?(e.nodeName||"").toLowerCase():"#document"}function yh(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Dh(e){var t;return null==(t=(xh(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function xh(e){return!!_h()&&(e instanceof Node||e instanceof yh(e).Node)}function Ah(e){return!!_h()&&(e instanceof Element||e instanceof yh(e).Element)}function wh(e){return!!_h()&&(e instanceof HTMLElement||e instanceof yh(e).HTMLElement)}function Sh(e){return!(!_h()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof yh(e).ShadowRoot)}const Eh=new Set(["inline","contents"]);function Ch(e){const{overflow:t,overflowX:n,overflowY:o,display:r}=Bh(e);return/auto|scroll|overlay|hidden|clip/.test(t+o+n)&&!Eh.has(r)}const Mh=new Set(["table","td","th"]);function kh(e){return Mh.has(vh(e))}const Th=[":popover-open",":modal"];function Ih(e){return Th.some(t=>{try{return e.matches(t)}catch(e){return!1}})}const Oh=["transform","translate","scale","rotate","perspective"],Rh=["transform","translate","scale","rotate","perspective","filter"],Gh=["paint","layout","strict","content"];function Lh(e){const t=Nh(),n=Ah(e)?Bh(e):e;return Oh.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||Rh.some(e=>(n.willChange||"").includes(e))||Gh.some(e=>(n.contain||"").includes(e))}function Nh(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const zh=new Set(["html","body","#document"]);function jh(e){return zh.has(vh(e))}function Bh(e){return yh(e).getComputedStyle(e)}function $h(e){return Ah(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Uh(e){if("html"===vh(e))return e;const t=e.assignedSlot||e.parentNode||Sh(e)&&e.host||Dh(e);return Sh(t)?t.host:t}function Wh(e){const t=Uh(e);return jh(t)?e.ownerDocument?e.ownerDocument.body:e.body:wh(t)&&Ch(t)?t:Wh(t)}function Hh(e,t,n){var o;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=Wh(e),a=r===(null==(o=e.ownerDocument)?void 0:o.body),i=yh(r);if(a){const e=Vh(i);return t.concat(i,i.visualViewport||[],Ch(r)?r:[],e&&n?Hh(e):[])}return t.concat(r,Hh(r,[],n))}function Vh(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Yh(e){const t=Bh(e);let n=parseFloat(t.width)||0,o=parseFloat(t.height)||0;const r=wh(e),a=r?e.offsetWidth:n,i=r?e.offsetHeight:o,s=Kp(n)!==a||Kp(o)!==i;return s&&(n=a,o=i),{width:n,height:o,$:s}}function qh(e){return Ah(e)?e:e.contextElement}function Kh(e){const t=qh(e);if(!wh(t))return Zp(1);const n=t.getBoundingClientRect(),{width:o,height:r,$:a}=Yh(t);let i=(a?Kp(n.width):n.width)/o,s=(a?Kp(n.height):n.height)/r;return i&&Number.isFinite(i)||(i=1),s&&Number.isFinite(s)||(s=1),{x:i,y:s}}const Xh=Zp(0);function Zh(e){const t=yh(e);return Nh()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Xh}function Qh(e,t,n,o){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),a=qh(e);let i=Zp(1);t&&(o?Ah(o)&&(i=Kh(o)):i=Kh(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==yh(e))&&t}(a,n,o)?Zh(a):Zp(0);let l=(r.left+s.x)/i.x,d=(r.top+s.y)/i.y,c=r.width/i.x,u=r.height/i.y;if(a){const e=yh(a),t=o&&Ah(o)?yh(o):o;let n=e,r=Vh(n);for(;r&&o&&t!==n;){const e=Kh(r),t=r.getBoundingClientRect(),o=Bh(r),a=t.left+(r.clientLeft+parseFloat(o.paddingLeft))*e.x,i=t.top+(r.clientTop+parseFloat(o.paddingTop))*e.y;l*=e.x,d*=e.y,c*=e.x,u*=e.y,l+=a,d+=i,n=yh(r),r=Vh(n)}}return fh({width:c,height:u,x:l,y:d})}function Jh(e,t){const n=$h(e).scrollLeft;return t?t.left+n:Qh(Dh(e)).left+n}function eg(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-Jh(e,n),y:n.top+t.scrollTop}}const tg=new Set(["absolute","fixed"]);function ng(e,t,n){let o;if("viewport"===t)o=function(e,t){const n=yh(e),o=Dh(e),r=n.visualViewport;let a=o.clientWidth,i=o.clientHeight,s=0,l=0;if(r){a=r.width,i=r.height;const e=Nh();(!e||e&&"fixed"===t)&&(s=r.offsetLeft,l=r.offsetTop)}const d=Jh(o);if(d<=0){const e=o.ownerDocument,t=e.body,n=getComputedStyle(t),r="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,i=Math.abs(o.clientWidth-t.clientWidth-r);i<=25&&(a-=i)}else d<=25&&(a+=d);return{width:a,height:i,x:s,y:l}}(e,n);else if("document"===t)o=function(e){const t=Dh(e),n=$h(e),o=e.ownerDocument.body,r=qp(t.scrollWidth,t.clientWidth,o.scrollWidth,o.clientWidth),a=qp(t.scrollHeight,t.clientHeight,o.scrollHeight,o.clientHeight);let i=-n.scrollLeft+Jh(e);const s=-n.scrollTop;return"rtl"===Bh(o).direction&&(i+=qp(t.clientWidth,o.clientWidth)-r),{width:r,height:a,x:i,y:s}}(Dh(e));else if(Ah(t))o=function(e,t){const n=Qh(e,!0,"fixed"===t),o=n.top+e.clientTop,r=n.left+e.clientLeft,a=wh(e)?Kh(e):Zp(1);return{width:e.clientWidth*a.x,height:e.clientHeight*a.y,x:r*a.x,y:o*a.y}}(t,n);else{const n=Zh(e);o={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return fh(o)}function og(e,t){const n=Uh(e);return!(n===t||!Ah(n)||jh(n))&&("fixed"===Bh(n).position||og(n,t))}function rg(e,t,n){const o=wh(t),r=Dh(t),a="fixed"===n,i=Qh(e,!0,a,t);let s={scrollLeft:0,scrollTop:0};const l=Zp(0);function d(){l.x=Jh(r)}if(o||!o&&!a)if(("body"!==vh(t)||Ch(r))&&(s=$h(t)),o){const e=Qh(t,!0,a,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&d();a&&!o&&r&&d();const c=!r||o||a?Zp(0):eg(r,s);return{x:i.left+s.scrollLeft-l.x-c.x,y:i.top+s.scrollTop-l.y-c.y,width:i.width,height:i.height}}function ag(e){return"static"===Bh(e).position}function ig(e,t){if(!wh(e)||"fixed"===Bh(e).position)return null;if(t)return t(e);let n=e.offsetParent;return Dh(e)===n&&(n=n.ownerDocument.body),n}function sg(e,t){const n=yh(e);if(Ih(e))return n;if(!wh(e)){let t=Uh(e);for(;t&&!jh(t);){if(Ah(t)&&!ag(t))return t;t=Uh(t)}return n}let o=ig(e,t);for(;o&&kh(o)&&ag(o);)o=ig(o,t);return o&&jh(o)&&ag(o)&&!Lh(o)?n:o||function(e){let t=Uh(e);for(;wh(t)&&!jh(t);){if(Lh(t))return t;if(Ih(t))return null;t=Uh(t)}return null}(e)||n}const lg={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:o,strategy:r}=e;const a="fixed"===r,i=Dh(o),s=!!t&&Ih(t.floating);if(o===i||s&&a)return n;let l={scrollLeft:0,scrollTop:0},d=Zp(1);const c=Zp(0),u=wh(o);if((u||!u&&!a)&&(("body"!==vh(o)||Ch(i))&&(l=$h(o)),wh(o))){const e=Qh(o);d=Kh(o),c.x=e.x+o.clientLeft,c.y=e.y+o.clientTop}const m=!i||u||a?Zp(0):eg(i,l);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-l.scrollLeft*d.x+c.x+m.x,y:n.y*d.y-l.scrollTop*d.y+c.y+m.y}},getDocumentElement:Dh,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:o,strategy:r}=e;const a=[..."clippingAncestors"===n?Ih(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let o=Hh(e,[],!1).filter(e=>Ah(e)&&"body"!==vh(e)),r=null;const a="fixed"===Bh(e).position;let i=a?Uh(e):e;for(;Ah(i)&&!jh(i);){const t=Bh(i),n=Lh(i);n||"fixed"!==t.position||(r=null),(a?!n&&!r:!n&&"static"===t.position&&r&&tg.has(r.position)||Ch(i)&&!n&&og(e,i))?o=o.filter(e=>e!==i):r=t,i=Uh(i)}return t.set(e,o),o}(t,this._c):[].concat(n),o],i=a[0],s=a.reduce((e,n)=>{const o=ng(t,n,r);return e.top=qp(o.top,e.top),e.right=Yp(o.right,e.right),e.bottom=Yp(o.bottom,e.bottom),e.left=qp(o.left,e.left),e},ng(t,i,r));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},getOffsetParent:sg,getElementRects:async function(e){const t=this.getOffsetParent||sg,n=this.getDimensions,o=await n(e.floating);return{reference:rg(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Yh(e);return{width:t,height:n}},getScale:Kh,isElement:Ah,isRTL:function(e){return"rtl"===Bh(e).direction}};function dg(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}const cg=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,o;const{x:r,y:a,placement:i,middlewareData:s}=t,l=await async function(e,t){const{placement:n,platform:o,elements:r}=e,a=await(null==o.isRTL?void 0:o.isRTL(r.floating)),i=nh(n),s=oh(n),l="y"===sh(n),d=bh.has(i)?-1:1,c=a&&l?-1:1,u=th(t,e);let{mainAxis:m,crossAxis:p,alignmentAxis:h}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return s&&"number"==typeof h&&(p="end"===s?-1*h:h),l?{x:p*c,y:m*d}:{x:m*d,y:p*c}}(t,e);return i===(null==(n=s.offset)?void 0:n.placement)&&null!=(o=s.arrow)&&o.alignmentOffset?{}:{x:r+l.x,y:a+l.y,data:{...l,placement:i}}}}},ug=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:o,placement:r}=t,{mainAxis:a=!0,crossAxis:i=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=th(e,t),d={x:n,y:o},c=await Ph(t,l),u=sh(nh(r)),m=rh(u);let p=d[m],h=d[u];if(a){const e="y"===m?"bottom":"right";p=eh(p+c["y"===m?"top":"left"],p,p-c[e])}if(i){const e="y"===u?"bottom":"right";h=eh(h+c["y"===u?"top":"left"],h,h-c[e])}const g=s.fn({...t,[m]:p,[u]:h});return{...g,data:{x:g.x-n,y:g.y-o,enabled:{[m]:a,[u]:i}}}}}},mg=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,o;const{placement:r,middlewareData:a,rects:i,initialPlacement:s,platform:l,elements:d}=t,{mainAxis:c=!0,crossAxis:u=!0,fallbackPlacements:m,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:g=!0,...f}=th(e,t);if(null!=(n=a.arrow)&&n.alignmentOffset)return{};const F=nh(r),P=sh(s),b=nh(s)===s,_=await(null==l.isRTL?void 0:l.isRTL(d.floating)),v=m||(b||!g?[hh(s)]:function(e){const t=hh(e);return[dh(e),t,dh(t)]}(s)),y="none"!==h;!m&&y&&v.push(...function(e,t,n,o){const r=oh(e);let a=function(e,t,n){switch(e){case"top":case"bottom":return n?t?uh:ch:t?ch:uh;case"left":case"right":return t?mh:ph;default:return[]}}(nh(e),"start"===n,o);return r&&(a=a.map(e=>e+"-"+r),t&&(a=a.concat(a.map(dh)))),a}(s,g,h,_));const D=[s,...v],x=await Ph(t,f),A=[];let w=(null==(o=a.flip)?void 0:o.overflows)||[];if(c&&A.push(x[F]),u){const e=function(e,t,n){void 0===n&&(n=!1);const o=oh(e),r=lh(e),a=ah(r);let i="x"===r?o===(n?"end":"start")?"right":"left":"start"===o?"bottom":"top";return t.reference[a]>t.floating[a]&&(i=hh(i)),[i,hh(i)]}(r,i,_);A.push(x[e[0]],x[e[1]])}if(w=[...w,{placement:r,overflows:A}],!A.every(e=>e<=0)){var S,E;const e=((null==(S=a.flip)?void 0:S.index)||0)+1,t=D[e];if(t&&("alignment"!==u||P===sh(t)||w.every(e=>sh(e.placement)!==P||e.overflows[0]>0)))return{data:{index:e,overflows:w},reset:{placement:t}};let n=null==(E=w.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:E.placement;if(!n)switch(p){case"bestFit":{var C;const e=null==(C=w.filter(e=>{if(y){const t=sh(e.placement);return t===P||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:C[0];e&&(n=e);break}case"initialPlacement":n=s}if(r!==n)return{reset:{placement:n}}}return{}}}},pg=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:o,placement:r,rects:a,platform:i,elements:s,middlewareData:l}=t,{element:d,padding:c=0}=th(e,t)||{};if(null==d)return{};const u=gh(c),m={x:n,y:o},p=lh(r),h=ah(p),g=await i.getDimensions(d),f="y"===p,F=f?"top":"left",P=f?"bottom":"right",b=f?"clientHeight":"clientWidth",_=a.reference[h]+a.reference[p]-m[p]-a.floating[h],v=m[p]-a.reference[p],y=await(null==i.getOffsetParent?void 0:i.getOffsetParent(d));let D=y?y[b]:0;D&&await(null==i.isElement?void 0:i.isElement(y))||(D=s.floating[b]||a.floating[h]);const x=_/2-v/2,A=D/2-g[h]/2-1,w=Yp(u[F],A),S=Yp(u[P],A),E=w,C=D-g[h]-S,M=D/2-g[h]/2+x,k=eh(E,M,C),T=!l.arrow&&null!=oh(r)&&M!==k&&a.reference[h]/2-(M<E?w:S)-g[h]/2<0,I=T?M<E?M-E:M-C:0;return{[p]:m[p]+I,data:{[p]:k,centerOffset:M-k-I,...T&&{alignmentOffset:I}},reset:T}}});var hg=function(){function e(){return s(this,e),i(this,e,arguments)}return m(e,V),l(e,[{key:"render",value:function(){return this.props.children}}])}();function gg(e){var t=e.children,n=e.content,o=e.position,r=void 0===o?"top":o,a=e.className,i=void 0===a?"":a,s=e.delay,l=void 0===s?200:s,d=e.style,u=void 0===d?"dark":d,m=e.trigger,p=void 0===m?"hover":m,h=Te(null),g=Te(null),f=Te(null),F=_(Ee(!1),2),P=F[0],b=F[1],v=Te(null);return Me(function(){var e;if(null!==(e=h.current)&&void 0!==e&&e.base&&g.current)return function(e,t,n,o){void 0===o&&(o={});const{ancestorScroll:r=!0,ancestorResize:a=!0,elementResize:i="function"==typeof ResizeObserver,layoutShift:s="function"==typeof IntersectionObserver,animationFrame:l=!1}=o,d=qh(e),c=r||a?[...d?Hh(d):[],...Hh(t)]:[];c.forEach(e=>{r&&e.addEventListener("scroll",n,{passive:!0}),a&&e.addEventListener("resize",n)});const u=d&&s?function(e,t){let n,o=null;const r=Dh(e);function a(){var e;clearTimeout(n),null==(e=o)||e.disconnect(),o=null}return function i(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),a();const d=e.getBoundingClientRect(),{left:c,top:u,width:m,height:p}=d;if(s||t(),!m||!p)return;const h={rootMargin:-Xp(u)+"px "+-Xp(r.clientWidth-(c+m))+"px "+-Xp(r.clientHeight-(u+p))+"px "+-Xp(c)+"px",threshold:qp(0,Yp(1,l))||1};let g=!0;function f(t){const o=t[0].intersectionRatio;if(o!==l){if(!g)return i();o?i(!1,o):n=setTimeout(()=>{i(!1,1e-7)},1e3)}1!==o||dg(d,e.getBoundingClientRect())||i(),g=!1}try{o=new IntersectionObserver(f,{...h,root:r.ownerDocument})}catch(e){o=new IntersectionObserver(f,h)}o.observe(e)}(!0),a}(d,n):null;let m,p=-1,h=null;i&&(h=new ResizeObserver(e=>{let[o]=e;o&&o.target===d&&h&&(h.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=h)||e.observe(t)})),n()}),d&&!l&&h.observe(d),h.observe(t));let g=l?Qh(e):null;return l&&function t(){const o=Qh(e);g&&!dg(g,o)&&n(),g=o,m=requestAnimationFrame(t)}(),n(),()=>{var e;c.forEach(e=>{r&&e.removeEventListener("scroll",n),a&&e.removeEventListener("resize",n)}),null==u||u(),null==(e=h)||e.disconnect(),h=null,l&&cancelAnimationFrame(m)}}(h.current.base,g.current,function(){((e,t,n)=>{const o=new Map,r={platform:lg,...n},a={...r.platform,_c:o};return(async(e,t,n)=>{const{placement:o="bottom",strategy:r="absolute",middleware:a=[],platform:i}=n,s=a.filter(Boolean),l=await(null==i.isRTL?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:r}),{x:c,y:u}=Fh(d,o,l),m=o,p={},h=0;for(let n=0;n<s.length;n++){const{name:a,fn:g}=s[n],{x:f,y:F,data:P,reset:b}=await g({x:c,y:u,initialPlacement:o,placement:m,strategy:r,middlewareData:p,rects:d,platform:i,elements:{reference:e,floating:t}});c=null!=f?f:c,u=null!=F?F:u,p={...p,[a]:{...p[a],...P}},b&&h<=50&&(h++,"object"==typeof b&&(b.placement&&(m=b.placement),b.rects&&(d=!0===b.rects?await i.getElementRects({reference:e,floating:t,strategy:r}):b.rects),({x:c,y:u}=Fh(d,m,l))),n=-1)}return{x:c,y:u,placement:m,strategy:r,middlewareData:p}})(e,t,{...r,platform:a})})(h.current.base,g.current,{placement:r,middleware:[cg(8),mg(),ug({padding:8}),pg({element:f.current,padding:6})]}).then(function(e){var t,n=e.x,o=e.y,r=e.placement,a=e.middlewareData;Object.assign(g.current.style,{left:"".concat(n,"px"),top:"".concat(o,"px")});var i=null!==(t=a.arrow)&&void 0!==t?t:{},s=i.x,l=i.y,d={top:"bottom",bottom:"top",left:"right",right:"left"}[r.split("-")[0]];Object.assign(f.current.style,c({left:null!=s?"".concat(s,"px"):"",top:null!=l?"".concat(l,"px"):"",right:"",bottom:""},d,"-4px"))})})},[r,P]),Me(function(){var e,t=null===(e=h.current)||void 0===e?void 0:e.base,n=g.current;if(t&&n){var o=function(){v.current&&clearTimeout(v.current)},r=function(){o(),v.current=setTimeout(function(){return b(!0)},l)},a=function(){o(),b(!1)},i=function(){return b(function(e){return!e})};return"hover"===p?(t.addEventListener("mouseenter",r),t.addEventListener("mouseleave",a),n.addEventListener("mouseenter",r),n.addEventListener("mouseleave",a),t.addEventListener("pointerdown",a)):"click"===p&&t.addEventListener("click",i),"none"===p&&(v.current&&clearTimeout(v.current),b(!1)),function(){o(),"hover"===p?(t.removeEventListener("mouseenter",r),t.removeEventListener("mouseleave",a),n.removeEventListener("mouseenter",r),n.removeEventListener("mouseleave",a),t.removeEventListener("pointerdown",a)):"click"===p&&t.removeEventListener("click",i)}}},[p,l]),U(H,null,U("div",{ref:g,role:"tooltip",className:"z-100 pointer-events-none absolute select-none whitespace-nowrap rounded-lg px-3 py-2 text-sm shadow-md transition-opacity duration-150 ".concat("dark"===u?"bg-tooltip-bg text-tooltip-fg":"border-border-subtle bg-bg-elevated text-fg-primary border"," ").concat(P?"opacity-100":"opacity-0"," ").concat(i," "),style:{visibility:P?"visible":"hidden"}},n,U("div",{ref:f,className:"absolute h-2 w-2 rotate-45 bg-inherit ".concat("light"===u?"border-border-subtle border":""," ")})),U(hg,{ref:h},t))}function fg(e){var t=e.commandId,n=e.documentId,o=e.variant,r=void 0===o?"icon":o,a=e.itemId,i=e.className,s=ti(t,n),l=Ma(n,a||t);if(!s||!s.visible)return null;var d=s.iconProps||{};return U(gg,{content:s.label,position:"bottom",delay:500,trigger:s.active?"none":"hover"},U(Vp,{elementRef:l,onClick:function(){s.disabled||s.execute()},active:s.active,disabled:s.disabled,className:i||"p-1","aria-label":s.label},"text"===r?U("span",{className:"text-sm"},s.label):"icon-text"===r?U(H,null,s.icon&&U(Wp,{icon:s.icon,className:"mr-2 h-5 w-5",primaryColor:d.primaryColor,secondaryColor:d.secondaryColor}),U("span",null,s.label)):"tab"===r?U("span",{className:"px-3 py-1"},s.label):s.icon?U(Wp,{icon:s.icon,className:Cp("h-5 w-5",d.className),primaryColor:d.primaryColor,secondaryColor:d.secondaryColor}):U("span",null,s.label)))}function Fg(e){var t=e.schema,n=e.documentId,o=e.isOpen,r=e.className,a=void 0===r?"":r;if(!o)return null;var i="secondary"===t.position.slot,s=function(e){switch(e){case"top":return"border-b border-border-default bg-bg-surface px-4 py-2";case"bottom":return"border-t border-border-default bg-bg-surface px-4 py-2";case"left":return"border-r border-border-default bg-bg-surface px-2 py-3 flex-col";case"right":return"border-l border-border-default bg-bg-surface px-2 py-3 flex-col"}}(t.position.placement);return U("div",g({className:Cp("flex items-center gap-2",s,i?"bg-bg-surface-alt":"",a)},pa(t)),t.items.map(function(e){return U(Pg,{key:e.id,item:e,documentId:n})}))}function Pg(e){var t=e.item,n=e.documentId;switch(t.type){case"command-button":return U(bg,{item:t,documentId:n});case"tab-group":return U(_g,{item:t,documentId:n});case"divider":return U(Dg,{item:t});case"spacer":return U(xg,{item:t});case"group":return U(Ag,{item:t,documentId:n});case"custom":return U(wg,{item:t,documentId:n});default:return console.warn("Unknown toolbar item type:",t),null}}function bg(e){var t=e.item,n=e.documentId;return U("div",g({},pa(t)),U(fg,{commandId:t.commandId,documentId:n,itemId:t.id,variant:t.variant}))}function _g(e){var t=e.item,n=e.documentId;return U("div",g(g({className:"flex items-center gap-2"},pa(t)),{},{role:"tablist"}),t.tabs.map(function(e){return U(vg,{key:e.id,tab:e,documentId:n})}))}function vg(e){var t=e.tab,n=e.documentId,o=ti(t.commandId,n),r=Ma(n,t.id);return o&&o.visible?U("div",g({},pa(t)),U(kp,{anchorRef:r,active:o.active,onClick:function(){o.disabled||o.execute()},disabled:o.disabled},"text"===t.variant&&o.label,"icon"===t.variant&&o.icon&&U(yg,{icon:o.icon,iconProps:o.iconProps}),"icon-text"===t.variant&&U(H,null,o.icon&&U(yg,{icon:o.icon,iconProps:o.iconProps}),o.label))):null}function yg(e){var t=e.icon,n=e.iconProps;return U(Wp,{icon:t,className:"h-5 w-5",primaryColor:null==n?void 0:n.primaryColor,secondaryColor:null==n?void 0:n.secondaryColor})}function Dg(e){var t=e.item;return U("div",g({},pa(t)),U("div",{className:"vertical"===t.orientation?"bg-border-default h-6 w-px":"bg-border-default h-px w-6","aria-hidden":"true"}))}function xg(e){var t=e.item;return U("div",g(g({className:t.flex?"flex-1":"w-4"},pa(t)),{},{"aria-hidden":"true"}))}function Ag(e){var t=e.item,n=e.documentId,o=t.gap?"gap-".concat(t.gap):"gap-2",r=function(e){switch(e){case"start":default:return"justify-start";case"center":return"justify-center";case"end":return"justify-end"}}(t.alignment);return U("div",g({className:Cp("flex items-center",o,r)},pa(t)),t.items.map(function(e){return U(Pg,{key:e.id,item:e,documentId:n})}))}function wg(e){var t=e.item,n=e.documentId,o=Ia().renderCustomComponent;return U("div",g({},pa(t)),o(t.componentId,n,t.props))}function Sg(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var o in t)if("__source"!==o&&e[o]!==t[o])return!0;return!1}function Eg(e,t){this.props=e,this.context=t}(Eg.prototype=new V).isPureReactComponent=!0,Eg.prototype.shouldComponentUpdate=function(e,t){return Sg(this.props,e)||Sg(this.state,t)};var Cg=w.__b;w.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Cg&&Cg(e)};var Mg=w.__e;w.__e=function(e,t,n,o){if(e.then)for(var r,a=t;a=a.__;)if((r=a.__c)&&r.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t);Mg(e,t,n,o)};var kg=w.unmount;function Tg(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(e){return Tg(e,t,n)})),e}function Ig(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(e){return Ig(e,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Og(){this.__u=0,this.o=null,this.__b=null}function Rg(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Gg(){this.i=null,this.l=null}w.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),kg&&kg(e)},(Og.prototype=new V).__c=function(e,t){var n=t.__c,o=this;null==o.o&&(o.o=[]),o.o.push(n);var r=Rg(o.__v),a=!1,i=function(){a||(a=!0,n.__R=null,r?r(s):s())};n.__R=i;var s=function(){if(! --o.__u){if(o.state.__a){var e=o.state.__a;o.__v.__k[0]=Ig(e,e.__c.__P,e.__c.__O)}var t;for(o.setState({__a:o.__b=null});t=o.o.pop();)t.forceUpdate()}};o.__u++||32&t.__u||o.setState({__a:o.__b=o.__v.__k[0]}),e.then(i,i)},Og.prototype.componentWillUnmount=function(){this.o=[]},Og.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=Tg(this.__b,n,o.__O=o.__P)}this.__b=null}var r=t.__a&&U(H,null,e.fallback);return r&&(r.__u&=-33),[U(H,null,t.__a?null:e.children),r]};var Lg=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};function Ng(e){return this.getChildContext=function(){return e.context},e.children}function zg(e){var t=this,n=e.h;if(t.componentWillUnmount=function(){me(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var o=t.__v;null!==o&&!o.__m&&null!==o.__;)o=o.__;t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:o.__m},contains:function(){return!0},insertBefore:function(e,n){this.childNodes.push(e),t.h.insertBefore(e,n)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.h.removeChild(e)}}}me(U(Ng,{context:t.context},e.__v),t.v)}function jg(e,t){var n=U(zg,{__v:e,h:t});return n.containerInfo=t,n}(Gg.prototype=new V).__a=function(e){var t=this,n=Rg(t.__v),o=t.l.get(e);return o[0]++,function(r){var a=function(){t.props.revealOrder?(o.push(r),Lg(t,e,o)):r()};n?n(a):a()}},Gg.prototype.render=function(e){this.i=null,this.l=new Map;var t=J(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Gg.prototype.componentDidUpdate=Gg.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){Lg(e,n,t)})};var Bg="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,$g=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ug=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Wg=/[A-Z0-9]/g,Hg="undefined"!=typeof document,Vg=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};V.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(V.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Yg=w.event;function qg(){}function Kg(){return this.cancelBubble}function Xg(){return this.defaultPrevented}w.event=function(e){return Yg&&(e=Yg(e)),e.persist=qg,e.isPropagationStopped=Kg,e.isDefaultPrevented=Xg,e.nativeEvent=e};var Zg={enumerable:!1,configurable:!0,get:function(){return this.class}},Qg=w.vnode;w.vnode=function(e){"string"==typeof e.type&&function(e){var t=e.props,n=e.type,o={},r=-1===n.indexOf("-");for(var a in t){var i=t[a];if(!("value"===a&&"defaultValue"in t&&null==i||Hg&&"children"===a&&"noscript"===n||"class"===a||"className"===a)){var s=a.toLowerCase();"defaultValue"===a&&"value"in t&&null==t.value?a="value":"download"===a&&!0===i?i="":"translate"===s&&"no"===i?i=!1:"o"===s[0]&&"n"===s[1]?"ondoubleclick"===s?a="ondblclick":"onchange"!==s||"input"!==n&&"textarea"!==n||Vg(t.type)?"onfocus"===s?a="onfocusin":"onblur"===s?a="onfocusout":Ug.test(a)&&(a=s):s=a="oninput":r&&$g.test(a)?a=a.replace(Wg,"-$&").toLowerCase():null===i&&(i=void 0),"oninput"===s&&o[a=s]&&(a="oninputCapture"),o[a]=i}}"select"==n&&o.multiple&&Array.isArray(o.value)&&(o.value=J(t.children).forEach(function(e){e.props.selected=-1!=o.value.indexOf(e.props.value)})),"select"==n&&null!=o.defaultValue&&(o.value=J(t.children).forEach(function(e){e.props.selected=o.multiple?-1!=o.defaultValue.indexOf(e.props.value):o.defaultValue==e.props.value})),t.class&&!t.className?(o.class=t.class,Object.defineProperty(o,"className",Zg)):(t.className&&!t.class||t.class&&t.className)&&(o.class=o.className=t.className),e.props=o}(e),e.$$typeof=Bg,Qg&&Qg(e)};var Jg=w.__r;w.__r=function(e){Jg&&Jg(e),e.__c};var ef=w.diffed;function tf(e){var t=e.schema,n=e.documentId,o=e.isOpen,r=e.onClose,a=wa().getContainer,i=Ee(function(){var e=a();return!!e&&e.clientWidth<768}),s=_(i,2),l=s[0],d=s[1];Me(function(){var e=a();if(e){var t=new ResizeObserver(function(){var t=e.clientWidth;d(t<768)});return t.observe(e),function(){return t.disconnect()}}},[a]);var c=t.position,u=t.content,m=t.width,p=Ia().renderCustomComponent,h=a();if(l&&h)return jg(U(nf,{schema:t,documentId:n,isOpen:o,onClose:r,renderCustomComponent:p,content:u,rootElement:h}),h);if(!o)return null;var g=function(e){switch(e){case"left":return"border-r";case"right":return"border-l";case"top":return"border-b";case"bottom":return"border-t"}}(c.placement),f=m?{width:m}:void 0;return U("div",{className:"".concat(g," border-border-default bg-bg-surface flex flex-col shadow-lg"),style:f,"data-sidebar-id":t.id},U("div",{className:"min-h-0 flex-1"},"tabs"===u.type&&U(of,{content:u,documentId:n,renderCustomComponent:p}),"component"===u.type&&U(H,null,p(u.componentId,n,{}))))}function nf(e){var t=e.schema,n=e.documentId,o=e.isOpen,r=e.onClose,a=e.renderCustomComponent,i=e.content,s=e.rootElement,l=_(Ee("closed"),2),d=l[0],c=l[1],u=_(Ee(!1),2),m=u[0],p=u[1],h=_(Ee(0),2),g=h[0],f=h[1],F=_(Ee(!1),2),P=F[0],b=F[1],v=Te(null),y=Te({y:0,height:0,time:0,state:"half"}),D=Te({y:0,time:0});Me(function(){if(!o){c("closed");var e=setTimeout(function(){b(!1)},300);return function(){return clearTimeout(e)}}b(!0),requestAnimationFrame(function(){requestAnimationFrame(function(){c("half")})})},[o]);var x=function(e){switch(e){case"closed":return 0;case"half":return 50;case"full":return 100}},A=Oe(function(e){if(v.current){var t,n=s.clientHeight,o=v.current.offsetHeight/n*100;t=o>=75?"full":o<=25?"closed":"half",y.current={y:e,height:o,time:Date.now(),state:t},D.current={y:e,time:Date.now()},f(0),t!==d&&c(t),p(!0)}},[s,d]),w=Oe(function(e){if(m){var t=s.clientHeight,n=(y.current.y-e)/t*100,o=Math.max(0,Math.min(100,y.current.height+n));D.current={y:e,time:Date.now()};var r=x(y.current.state);f(o-r)}},[m,s]),S=Oe(function(){if(m){if(Math.abs(y.current.y-D.current.y)<5)return p(!1),void f(0);var e=x(y.current.state)+g,t=Date.now()-D.current.time,n=D.current.y-y.current.y,o=function(e,t){return Math.abs(t)>.5?t>0?e>50?"half":"closed":e<50?"half":"full":e>=75?"full":e<=25?"closed":"half"}(e,t>0?n/t:0);"closed"===o?(c("closed"),p(!1),f(0),r()):(p(!1),f(0),c(o))}},[m,g,r]),E=Oe(function(e){A(e.touches[0].clientY)},[A]),C=Oe(function(e){m&&(e.cancelable&&e.preventDefault(),w(e.touches[0].clientY))},[m,w]),M=Oe(function(){S()},[S]),k=Oe(function(e){e.preventDefault(),A(e.clientY)},[A]);if(Me(function(){if(m){var e=function(e){w(e.clientY)},t=function(){S()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),function(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}},[m,w,S]),!P)return null;var T=x(m?y.current.state:d),I=m?Math.max(0,Math.min(100,T+g)):T,O=.3*Math.min(I/50,1);return U(H,null,U("div",{className:"bg-bg-overlay absolute inset-0 z-40 transition-opacity duration-300 ".concat(0===I?"pointer-events-none":""),style:{opacity:O},onClick:r}),U("div",{ref:v,className:"bg-bg-surface absolute inset-x-0 bottom-0 z-50 flex flex-col rounded-t-2xl shadow-2xl ".concat(m?"":"transition-[height] duration-300 ease-out"),style:{height:"".concat(I,"%")},"data-sidebar-id":t.id},U("div",{className:"flex flex-shrink-0 cursor-grab touch-none items-center justify-center py-3 active:cursor-grabbing",onTouchStart:E,onTouchMove:C,onTouchEnd:M,onMouseDown:k},U("div",{className:"bg-border-default h-1.5 w-12 rounded-full"})),U("div",{className:"min-h-0 flex-1 overflow-hidden"},"tabs"===i.type&&U(of,{content:i,documentId:n,renderCustomComponent:a}),"component"===i.type&&U(H,null,a(i.componentId,n,{})))))}function of(e){var t,n=e.content,o=e.documentId,r=e.renderCustomComponent,a=_(Ee((null===(t=n.tabs[0])||void 0===t?void 0:t.id)||""),2),i=a[0],s=a[1];return U("div",{className:"flex h-full flex-1 flex-col"},U("div",{role:"tablist",className:"bg-bg-surface mx-4 my-4 flex flex-shrink-0 overflow-hidden"},n.tabs.map(function(e,t,n){var o=i===e.id,r=0===t,a=t===n.length-1;return U("button",{key:e.id,role:"tab","aria-selected":o,tabIndex:o?0:-1,onClick:function(){return s(e.id)},className:"relative flex h-7 flex-1 cursor-pointer items-center justify-center border outline-none transition-colors ".concat(r?"rounded-l-md":""," ").concat(a?"rounded-r-md":""," ").concat(a?"":"border-r-0"," ").concat(o?"border-accent bg-accent text-fg-on-accent":"border-border-default text-fg-secondary hover:bg-interactive-hover")},e.icon&&U(Wp,{icon:e.icon,className:"h-5 w-5"}))})),U("div",{className:"min-h-0 flex-1 overflow-auto"},n.tabs.filter(function(e){return e.id===i}).map(function(e){return U(H,{key:e.id},r(e.componentId,o,{}))})))}function rf(e){var t=e.schema,n=e.documentId,o=e.anchorEl,r=e.onClose,a=wa().getContainer,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:768,n=_(Ee(function(){var n=e();return!!n&&n.clientWidth<t}),2),o=n[0],r=n[1];return Me(function(){var n=e();if(n){var o=new ResizeObserver(function(){r(n.clientWidth<t)});return o.observe(n),function(){return o.disconnect()}}},[e,t]),o}(a,768),s=a(),l=(()=>{const{provides:e}=Da();return(null==e?void 0:e.getSchema())??null})(),d=_(Ee([{menuId:t.id,schema:t,title:void 0}]),2),c=d[0],u=d[1];Me(function(){u([{menuId:t.id,schema:t,title:void 0}])},[t]);var m=c[c.length-1],p=Oe(function(e,t){if(l){var n=l.menus[e];n?u(function(o){return[].concat(v(o),[{menuId:e,schema:n,title:t}])}):console.warn("Submenu schema not found: ".concat(e))}},[l]),h=Oe(function(){c.length>1&&u(function(e){return e.slice(0,-1)})},[c.length]);return m?i&&s?jg(U(af,{currentMenu:m,menuStack:c,documentId:n,onClose:r,onNavigateBack:h,onNavigateToSubmenu:p,container:s}),s):U(sf,{currentMenu:m,documentId:n,anchorEl:o,onClose:r,onNavigateToSubmenu:p}):null}function af(e){var t=e.currentMenu,n=e.menuStack,o=e.documentId,r=e.onClose,a=e.onNavigateBack,i=e.onNavigateToSubmenu,s=e.container,l=_(Ee(!1),2),d=l[0],c=l[1],u=_(Ee(!1),2),m=u[0],p=u[1],h=_(Ee(0),2),f=h[0],F=h[1],P=Te(null),b=Te(null),v=Te({isDragging:!1,startY:0,currentY:0,startTime:0,sheetHeight:0});Me(function(){c(!0),requestAnimationFrame(function(){requestAnimationFrame(function(){p(!0)})})},[]);var y=_(Ee(null),2),D=y[0],x=y[1];Me(function(){if(b.current){var e=(n.length>1?60:0)+b.current.scrollHeight+24,t=.8*s.clientHeight;x(Math.min(e,t))}},[t,n.length,s]);var A=Oe(function(){p(!1),setTimeout(function(){c(!1),r()},300)},[r]),w=Oe(function(e){P.current&&(v.current={isDragging:!0,startY:e,currentY:e,startTime:Date.now(),sheetHeight:P.current.offsetHeight})},[]),S=Oe(function(e){if(v.current.isDragging){var t=e-v.current.startY,n=Math.max(0,t);v.current.currentY=e,F(n)}},[]),E=Oe(function(){if(v.current.isDragging){var e=v.current,t=e.startY,n=e.currentY,o=e.startTime,r=e.sheetHeight,a=Math.abs(t-n);if(v.current.isDragging=!1,a<5)F(0);else{var i=n-t,s=i/r*100,l=Date.now()-o;s>30||(l>0?i/l:0)>.5?A():F(0)}}},[A]),C=Oe(function(e){w(e.touches[0].clientY)},[w]),M=Oe(function(e){v.current.isDragging&&e.cancelable&&e.preventDefault(),S(e.touches[0].clientY)},[S]),k=Oe(function(){E()},[E]),T=Oe(function(e){e.preventDefault(),w(e.clientY)},[w]);if(Me(function(){if(v.current.isDragging){var e=function(e){return S(e.clientY)},t=function(){return E()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),function(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}},[S,E]),Me(function(){var e=function(e){"Escape"===e.key&&A()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}},[A]),!d)return null;var I=m?f:D||400;return U(H,null,U("div",{className:"bg-bg-overlay absolute inset-0 z-40 transition-opacity duration-300 ".concat(m?"opacity-100":"opacity-0"),onClick:A}),U("div",g({ref:P,className:"bg-bg-surface absolute inset-x-0 bottom-0 z-50 flex flex-col rounded-t-2xl shadow-2xl ".concat(v.current.isDragging?"":"transition-transform duration-300 ease-out"),style:{maxHeight:"80%",transform:"translateY(".concat(I,"px)")}},pa(t.schema)),U("div",{className:"flex flex-shrink-0 cursor-grab touch-none items-center justify-center py-3 active:cursor-grabbing",onTouchStart:C,onTouchMove:M,onTouchEnd:k,onMouseDown:T},U("div",{className:"bg-border-default h-1.5 w-12 rounded-full"})),n.length>1&&U("div",{className:"border-border-subtle flex items-center gap-3 border-b px-4 pb-3"},U("button",{onClick:a,className:"hover:bg-interactive-hover rounded-full p-1"},U(Ip,{className:"h-5 w-5"})),U("h3",{className:"text-fg-primary font-semibold"},t.title||"Menu")),U("div",{ref:b,className:"flex-1 overflow-y-auto py-2"},t.schema.items.map(function(e){return U(lf,{key:e.id,item:e,documentId:o,onClose:A,isMobile:!0,onNavigateToSubmenu:i})}))))}function sf(e){var t=e.currentMenu,n=e.documentId,o=e.anchorEl,r=e.onClose,a=e.onNavigateToSubmenu,i=Te(null),s=_(Ee(null),2),l=s[0],d=s[1];Me(function(){if(o){var e=function(){var e,t=o.getBoundingClientRect(),n=(null===(e=i.current)||void 0===e?void 0:e.offsetWidth)||200,r=t.bottom+4,a=t.left;a+n>window.innerWidth&&(a=window.innerWidth-n-8),a<8&&(a=8),d({top:r,left:a})};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),function(){window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}}},[o]),Me(function(){var e=function(e){if(i.current){var t=e.composedPath(),n=t.includes(i.current),a=o&&t.includes(o);n||a||r()}},t=setTimeout(function(){document.addEventListener("mousedown",e)},0);return function(){clearTimeout(t),document.removeEventListener("mousedown",e)}},[r,o]),Me(function(){var e=function(e){"Escape"===e.key&&r()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}},[r]);var c=l?{position:"fixed",top:"".concat(l.top,"px"),left:"".concat(l.left,"px"),zIndex:1e3}:{display:"none"};return U("div",g(g({ref:i},pa(t.schema)),{},{className:"border-border-default bg-bg-elevated min-w-[200px] rounded-lg border py-2 shadow-lg",style:c}),t.schema.items.map(function(e){return U(lf,{key:e.id,item:e,documentId:n,onClose:r,isMobile:!1,onNavigateToSubmenu:a})}))}function lf(e){var t=e.item,n=e.documentId,o=e.onClose,r=e.isMobile,a=e.onNavigateToSubmenu;switch(t.type){case"command":return U(df,{item:t,documentId:n,onClose:o,isMobile:r});case"submenu":return U(cf,{item:t,documentId:n,isMobile:r,onNavigateToSubmenu:a});case"divider":return U("div",g({},pa(t)),U("hr",{className:"border-border-subtle my-2"}));case"section":return U(uf,{item:t,documentId:n,onClose:o,isMobile:r,onNavigateToSubmenu:a});default:return null}}function df(e){var t,n,o=e.item,r=e.documentId,a=e.onClose,i=e.isMobile,s=ti(o.commandId,r);if(!s||!s.visible)return null;var l,d,c=function(){s.disabled||(s.execute(),a())};return i?U("button",g(g({},pa(o)),{},{onClick:c,disabled:s.disabled,className:"active:bg-interactive-active flex w-full items-center gap-3 px-4 py-3 text-left text-base transition-colors ".concat(s.disabled?"cursor-not-allowed opacity-50":"cursor-pointer"," ").concat(s.active?"bg-interactive-selected text-accent":"text-fg-secondary"),role:"menuitem"}),s.icon&&U(Wp,{icon:s.icon,className:"h-5 w-5",primaryColor:null===(l=s.iconProps)||void 0===l?void 0:l.primaryColor,secondaryColor:null===(d=s.iconProps)||void 0===d?void 0:d.secondaryColor}),U("span",{className:"flex-1"},s.label)):U("button",g(g({},pa(o)),{},{onClick:c,disabled:s.disabled,className:"flex w-full items-center justify-between gap-2 px-4 py-1 text-left ".concat(s.disabled?"pointer-events-none cursor-not-allowed opacity-50":"cursor-pointer"," ").concat(s.active&&!s.disabled?"bg-accent text-fg-on-accent":"text-fg-muted hover:bg-accent hover:text-fg-on-accent"),role:"menuitem"}),U("div",{className:"flex items-center gap-2"},U("div",{className:"flex h-6 w-6 items-center justify-center"},s.icon&&U(Wp,{icon:s.icon,className:"h-6 w-6",primaryColor:null===(t=s.iconProps)||void 0===t?void 0:t.primaryColor,secondaryColor:null===(n=s.iconProps)||void 0===n?void 0:n.secondaryColor})),U("span",{className:"text-sm"},s.label)))}function cf(e){var t=e.item,n=e.documentId,o=e.isMobile,r=e.onNavigateToSubmenu,a=pi(n).translate,i=t.labelKey?a(t.labelKey):t.label||"",s=function(){return r(t.menuId,i)};return o?U("button",g(g({},pa(t)),{},{onClick:s,className:"text-fg-secondary active:bg-interactive-active flex w-full cursor-pointer items-center gap-3 px-4 py-3 text-left text-base transition-colors",role:"menuitem"}),U("span",{className:"flex-1"},i),U(Tp,{className:"h-4 w-4"})):U("button",g(g({},pa(t)),{},{onClick:s,className:"text-fg-muted hover:bg-accent hover:text-fg-on-accent flex w-full cursor-pointer items-center justify-between gap-2 px-4 py-1 text-left",role:"menuitem"}),U("span",{className:"text-sm"},i),U(Tp,{className:"h-6 w-6"}))}function uf(e){var t=e.item,n=e.documentId,o=e.onClose,r=e.isMobile,a=e.onNavigateToSubmenu,i=pi(n).translate,s=t.labelKey?i(t.labelKey):t.label||"";return U("div",g({},pa(t)),U("div",{className:"text-fg-secondary px-4 py-3 text-xs font-medium uppercase"},s),t.items.map(function(e){return U(lf,{key:e.id,item:e,documentId:n,onClose:o,isMobile:r,onNavigateToSubmenu:a})}))}function mf(e){var t=e.schema,n=e.documentId,o=e.isOpen,r=e.onClose,a=e.onExited,i=t.content,s=Ia().renderCustomComponent;return"component"!==i.type?(console.warn("SchemaModal only supports component content type, got: ".concat(i.type)),null):U(H,null,s(i.componentId,n,{isOpen:o,onClose:r,onExited:a}))}function pf(e){var t=e.documentId;e.onClose;var n=rr(t),o=n.state,r=n.provides;return U("div",{className:"flex h-full flex-1 flex-col"},U("div",{className:"flex-1 overflow-hidden"},U(Al,{documentId:t,style:{width:"100%",height:"100%"}},function(e){return U("div",{key:e.pageIndex,style:{position:"absolute",width:"100%",height:e.wrapperHeight,top:e.top,display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer"},onClick:function(){var t;null==r||null===(t=r.scrollToPage)||void 0===t||t.call(r,{pageNumber:e.pageIndex+1})}},U("div",{style:{width:e.width,height:e.height,border:"2px solid ".concat(o.currentPage===e.pageIndex+1?"var(--ep-accent-primary)":"var(--ep-border-default)"),borderRadius:"4px",overflow:"hidden",boxShadow:o.currentPage===e.pageIndex+1?"0 0 0 2px var(--ep-interactive-focus-ring)":"none"}},U(wl,{documentId:t,meta:e,style:{width:"100%",height:"100%"}})),U("div",{style:{height:e.labelHeight,display:"flex",alignItems:"center",justifyContent:"center",marginTop:"4px"}},U("span",{className:"text-fg-secondary text-xs"},e.pageIndex+1)))})))}function hf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=_(Ee(e),2),o=n[0],r=n[1];return Me(function(){var n=window.setTimeout(function(){return r(e)},t);return function(){return clearTimeout(n)}},[e,t]),o}w.diffed=function(e){ef&&ef(e);var t=e.props,n=e.__e;null!=n&&"textarea"===e.type&&"value"in t&&t.value!==n.value&&(n.value=null==t.value?"":t.value)};var gf=function(e){var t=e.label,n=e.checked,o=e.onChange;return U("label",{className:"text-fg-secondary inline-flex cursor-pointer select-none items-center gap-2 text-xs font-medium"},U("input",{type:"checkbox",checked:n,onChange:function(e){return o(e.target.checked)},className:"border-border-default bg-bg-input checked:border-accent checked:bg-accent peer h-4 w-4 shrink-0 appearance-none rounded-[3px] border transition-all"}),U("svg",{viewBox:"0 0 24 24",className:"/* fine-tune centering */ text-fg-on-accent pointer-events-none absolute h-3.5 w-3.5 translate-x-[1px] translate-y-[1px] opacity-0 peer-checked:opacity-100",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round"},U("polyline",{points:"20 6 9 17 4 12"})),t)},ff=function(e){var t=e.hit,n=e.onClick,o=e.active,r=Te(null);return Me(function(){o&&r.current&&r.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[o]),U("button",{ref:r,onClick:n,className:"w-full rounded border p-2 text-left text-sm transition-colors ".concat(o?"border-accent bg-accent-light text-fg-primary":"border-border-subtle bg-bg-surface text-fg-secondary hover:bg-interactive-hover")},U("span",null,t.context.truncatedLeft&&"… ",t.context.before,U("span",{className:"text-accent font-bold"},t.context.match),t.context.after,t.context.truncatedRight&&" …"))};function Ff(e){var t=e.documentId;e.onClose;var n=(e=>{const{provides:t}=ms(),[n,o]=Ee(as),r=Ie(()=>null==t?void 0:t.forDocument(e),[t,e]);return Me(()=>{if(r)return o(r.getState()),r.onStateChange(e=>o(e));o(as)},[r]),{state:n,provides:r??null}})(t),o=n.state,r=n.provides,a=or().provides,i=pi(t).translate,s=Te(null),l=_(Ee(""),2),d=l[0],c=l[1];Me(function(){},[]),Me(function(){o.query&&!d&&c(o.query)},[o.query]),Me(function(){void 0!==o.activeResultIndex&&o.activeResultIndex>=0&&p(o.activeResultIndex)},[o.activeResultIndex]);var u=hf(d,300);Me(function(){u!==o.query&&(null==r||r.searchAllPages(u))},[u,r,o.query]);var m=function(e,t){t?null==r||r.setFlags([].concat(v(o.flags),[e])):null==r||r.setFlags(o.flags.filter(function(t){return t!==e}))},p=function(e){var n,r=o.results[e];if(r){var i=r.rects.reduce(function(e,t){return{x:Math.min(e.x,t.origin.x),y:Math.min(e.y,t.origin.y)}},{x:1/0,y:1/0});null==a||null===(n=a.forDocument(t))||void 0===n||n.scrollToPage({pageNumber:r.pageIndex+1,pageCoordinates:i,alignX:50,alignY:25})}},h=function(e){var t={};return e.forEach(function(e,n){t[e.pageIndex]||(t[e.pageIndex]=[]),t[e.pageIndex].push({hit:e,index:n})}),t}(o.results);return U("div",{className:"bg-bg-surface flex h-full flex-col"},U("div",{className:"p-4"},U("div",{className:"relative"},U("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-2"},U(Rp,{className:"text-fg-muted h-4 w-4"})),U("input",{ref:s,type:"text",placeholder:i("search.placeholder"),value:d,onInput:function(e){var t=e.target;c(t.value)},className:"border-border-default bg-bg-input focus:border-accent focus:ring-accent w-full rounded-md border py-1 pl-8 pr-9 text-base focus:outline-none focus:ring-1"}),d&&U("div",{className:"absolute inset-y-0 right-0 flex cursor-pointer items-center pr-3",onClick:function(){c(""),s.current&&s.current.focus()}},U(Gp,{className:"text-fg-muted hover:text-fg-secondary h-4 w-4"}))),U("div",{className:"mt-3 flex flex-col gap-2"},U(gf,{label:i("search.caseSensitive"),checked:o.flags.includes(Bt.MatchCase),onChange:function(e){return m(Bt.MatchCase,e)}}),U(gf,{label:i("search.wholeWord"),checked:o.flags.includes(Bt.MatchWholeWord),onChange:function(e){return m(Bt.MatchWholeWord,e)}})),U("hr",{className:"border-border-subtle mb-2 mt-5"}),o.active&&U("div",{className:"flex h-[32px] flex-row items-center justify-between"},U("div",{className:"text-fg-muted text-xs"},i("search.resultsFound",{params:{count:o.total}})),o.total>1&&U("div",{className:"flex flex-row"},U(Vp,{onClick:function(){null==r||r.previousResult()}},U(Ip,{className:"h-4 w-4"})),U(Vp,{onClick:function(){null==r||r.nextResult()}},U(Tp,{className:"h-4 w-4"}))))),U("div",{className:"flex min-h-0 flex-1 flex-col gap-2 overflow-y-auto px-4"},Object.entries(h).map(function(e){var t=_(e,2),n=t[0],a=t[1];return U("div",{key:n,className:"mt-2 first:mt-0"},U("div",{className:"bg-bg-surface/80 text-fg-muted py-2 text-xs backdrop-blur"},i("search.page",{params:{page:Number(n)+1}})),U("div",{className:"flex flex-col gap-2"},a.map(function(e){var t=e.hit,n=e.index;return U(ff,{key:n,hit:t,active:n===o.activeResultIndex,onClick:function(){null==r||r.goToResult(n)}})})))}),U("div",null)))}function Pf(e){var t=e.documentId,n=Fo(au.id).provides,o=or().provides,r=pi(t).translate,a=bo(t),i=_(Ee([]),2),s=i[0],l=i[1],d=_(Ee(new Set),2),c=d[0],u=d[1],m=_(Ee(!0),2),p=m[0],h=m[1];Me(function(){if(n&&null!=a&&a.document){h(!0);var e=n.getBookmarks();return e.wait(function(e){var t=e.bookmarks;l(t);var n=t.map(function(e,t){return"bookmark-".concat(t)});u(new Set(n)),h(!1)},function(){h(!1)}),function(){e.abort({code:Ut.Cancelled,message:"Bookmark task cancelled"})}}},[n,null==a?void 0:a.document]);var g=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i="bookmark-".concat(t),s=e.children&&e.children.length>0,l=c.has(i);return U("div",{key:i,className:"select-none"},U("div",{className:"hover:bg-interactive-hover flex cursor-pointer items-center gap-1 px-2 py-1",style:{paddingLeft:"".concat(16*r+8,"px")},onClick:function(){return function(e){if(o&&e.target){var t;if("action"===e.target.type){var n=e.target.action;if(n.type===St.Goto||n.type===St.RemoteGoto)t=n.destination;else if(n.type===St.URI)return void window.open(n.uri,"_blank")}else"destination"===e.target.type&&(t=e.target.destination);if(t)if(t.zoom.mode===_t.XYZ){var r,i=null==a||null===(r=a.document)||void 0===r?void 0:r.pages.find(function(e){return e.index===t.pageIndex});if(!i)return;o.scrollToPage({pageNumber:t.pageIndex+1,pageCoordinates:t.zoom.params?{x:t.zoom.params.x,y:i.size.height-t.zoom.params.y}:void 0,behavior:"smooth"})}else o.scrollToPage({pageNumber:t.pageIndex+1,behavior:"smooth"})}}(e)}},s&&U("button",{onClick:function(e){e.stopPropagation(),function(e){u(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})}(i)},className:"flex h-4 w-4 items-center justify-center"},U(l?Op:Tp,{className:"h-3 w-3"})),!s&&U("div",{className:"w-4"}),U("span",{className:"text-fg-secondary text-sm"},e.title)),s&&l&&U("div",null,null===(n=e.children)||void 0===n?void 0:n.map(function(e,t){return g(e,t,r+1)})))};return null==a||!a.document||p?U("div",{className:"text-fg-secondary flex h-full flex-col gap-3 p-4 text-sm"},U("div",{className:"text-fg-primary font-medium"},r("outline.title")),U("p",null,r("outline.loading"))):0===s.length?U("div",{className:"flex h-full items-center justify-center p-6"},U("div",{className:"text-fg-muted text-center"},U("div",{className:"text-sm"},r("outline.noOutline")),U("div",{className:"mt-1 text-xs"},r("outline.noBookmarks")))):U("div",{className:"bg-bg-surface flex h-full flex-col"},U("div",{className:"flex-1 overflow-y-auto"},U("div",{className:"outline-tree"},s.map(function(e,t){return g(e,t)}))))}function bf(e){var t=e.size,n=void 0===t?"md":t,o=e.text,r=e.className,a={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return U("div",{className:"flex flex-col items-center justify-center gap-3 ".concat(void 0===r?"":r)},U("div",{className:"relative"},U("div",{className:"".concat(a[n]," border-border-default animate-spin rounded-full border-4")}),U("div",{className:"".concat(a[n]," border-r-accent border-t-accent absolute left-0 top-0 animate-spin rounded-full border-4 border-transparent")})),o&&U("p",{className:"".concat({sm:"text-sm",md:"text-base",lg:"text-lg"}[n]," text-fg-secondary animate-pulse font-medium")},o))}function _f(e){var t=e.size,n=void 0===t?"md":t,o=e.className,r=void 0===o?"":o;return U("div",{className:"".concat({sm:"w-4 h-4 border-2",md:"w-6 h-6 border-2",lg:"w-8 h-8 border-3"}[n]," border-border-default border-t-accent animate-spin rounded-full ").concat(r)})}var vf,yf=function(e){var t=e.documentId,n=pc().provides,o=_(Ee({show:!1,mode:null,isAnimating:!1}),2),r=o[0],a=o[1],i=pi(t).translate;if(Me(function(){if(n)return n.onModeChange(function(e){var t=e.activeMode;if("marqueeZoom"===t||"marqueeCapture"===t){a({show:!0,mode:t,isAnimating:!0});var n=setTimeout(function(){a(function(e){return g(g({},e),{},{show:!1})})},3e3);return function(){return clearTimeout(n)}}a({show:!1,mode:null,isAnimating:!1})})},[n]),!r.show&&!r.isAnimating)return null;var s="marqueeZoom"===r.mode?i("zoom.dragTip"):i("capture.dragTip"),l="marqueeZoom"===r.mode?"rgba(33,150,243,0.8)":"rgba(76,175,80,0.8)";return U("div",{className:"hint-overlay ".concat(r.show?"hint-show":"hint-hide"),onAnimationEnd:function(){r.show||a(function(e){return g(g({},e),{},{isAnimating:!1,mode:null})})},style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"20px"}},U("div",{className:"hint-text",style:{background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"12px 20px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",textAlign:"center",maxWidth:"250px"}},s),U("div",{className:"drag-demo",style:{position:"relative",width:"150px",height:"100px"}},U("div",{style:{position:"absolute",top:"20px",left:"20px",width:"110px",height:"60px",border:"2px dashed ".concat(l),borderRadius:"4px",opacity:.6}}),U("div",{className:"animated-rect",style:{position:"absolute",top:"20px",left:"20px",border:"2px solid ".concat(l),backgroundColor:"".concat(l.replace("0.8","0.15")),borderRadius:"4px"}}),U("div",{className:"cursor-demo",style:{position:"absolute",width:"20px",height:"20px"}},U("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},U("path",{d:"M3.5 2.5L16.5 10L10 11.5L7.5 16.5L3.5 2.5Z",fill:"rgba(0,0,0,0.3)",transform:"translate(1,1)"}),U("path",{d:"M3 2L16 10L10 11.5L7.5 16L3 2Z",fill:"white",stroke:"black",strokeWidth:"1"}),U("path",{d:"M4 3.5L13.5 9.5L9.5 10.5L7.5 14L4 3.5Z",fill:"rgba(255,255,255,0.8)"})))),U("style",{jsx:!0},"\n        .hint-overlay {\n          animation-duration: 0.3s;\n          animation-fill-mode: both;\n        }\n\n        .hint-show {\n          animation-name: hintFadeIn;\n        }\n\n        .hint-hide {\n          animation-name: hintFadeOut;\n        }\n\n        @keyframes hintFadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes hintFadeOut {\n          from {\n            opacity: 1;\n            transform: translateY(0);\n          }\n          to {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n        }\n\n        .animated-rect {\n          animation: rectGrow 2s ease-in-out infinite;\n        }\n\n        @keyframes rectGrow {\n          0% {\n            width: 0;\n            height: 0;\n          }\n          50% {\n            width: 110px;\n            height: 60px;\n          }\n          100% {\n            width: 110px;\n            height: 60px;\n            opacity: 0.7;\n          }\n        }\n\n        .cursor-demo {\n          animation: cursorMove 2s ease-in-out infinite;\n        }\n\n        @keyframes cursorMove {\n          0% {\n            top: 20px;\n            left: 20px;\n          }\n          50% {\n            top: 50px;\n            left: 80px;\n          }\n          100% {\n            top: 80px;\n            left: 130px;\n          }\n        }\n\n        .hint-text {\n          animation: textPulse 0.6s ease-in-out;\n        }\n\n        @keyframes textPulse {\n          0% {\n            transform: scale(0.9);\n          }\n          50% {\n            transform: scale(1.05);\n          }\n          100% {\n            transform: scale(1);\n          }\n        }\n      "))},Df=function(e){var t=e.placeholder,n=e.onSubmit,o=e.inputRef,r=e.isFocused,a=_(Ee(""),2),i=a[0],s=a[1];return U("form",{className:"border-border-subtle mt-4 flex items-end space-x-2 border-t pt-4",onClick:function(e){return e.stopPropagation()},onSubmit:function(e){null==e||e.preventDefault(),i.trim()&&(n(i),s(""))}},U("input",{ref:o,type:"text",placeholder:t,value:i,onInput:function(e){return s(e.currentTarget.value)},className:"bg-bg-input text-fg-primary placeholder-fg-muted w-full rounded-lg border px-3 py-1 text-base transition-colors focus:border-transparent focus:outline-none focus:ring-2 ".concat(r?"border-accent focus:ring-accent":"border-border-default focus:ring-accent")}),U("button",{type:"submit",disabled:!i.trim(),className:"bg-accent text-fg-on-accent hover:bg-accent-hover disabled:bg-interactive-disabled rounded-lg p-2 transition-colors disabled:cursor-not-allowed"},U("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},U("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"}))))},xf=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500"],Af=function(e){if(!e)return xf[0];var t=e.length>0?e.charCodeAt(0)%xf.length:0;return xf[t]},wf=function(e){var t=e.name,n=e.className,o=void 0===n?"":n;return U("div",{className:"flex h-8 w-8 items-center justify-center rounded-full text-sm font-medium text-white ".concat(Af(t)," ").concat(o)},function(e){return e?e.split(" ").map(function(e){return e[0]}).join("").toUpperCase().slice(0,2):"G"}(t))},Sf=function(e){var t,n,o=e.onEdit,r=e.onDelete,a=e.onClose,i=e.documentId,s=Te(null),l=pi(i).translate;return Me(function(){var e=function(e){t.current&&!t.current.contains(e.target)&&n()};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}},[t=s,n=a]),U("div",{ref:s,className:"bg-bg-elevated ring-border-default absolute right-0 top-6 z-10 w-32 rounded-md shadow-lg ring-1"},U("div",{className:"py-1"},U("button",{onClick:function(e){e.preventDefault(),e.stopPropagation(),o(),a()},className:"text-fg-secondary hover:bg-interactive-hover block w-full px-4 py-2 text-left text-sm"},l("comments.edit")),U("button",{onClick:function(e){e.preventDefault(),e.stopPropagation(),r(),a()},className:"text-state-error hover:bg-interactive-hover block w-full px-4 py-2 text-left text-sm"},l("comments.delete"))))},Ef=function(e){var t=e.initialText,n=e.onSave,o=e.onCancel,r=e.autoFocus,a=void 0!==r&&r,i=e.documentId,s=_(Ee(t),2),l=s[0],d=s[1],c=Te(null),u=pi(i).translate;return Me(function(){a&&c.current&&(c.current.focus(),c.current.setSelectionRange(l.length,l.length))},[a,l.length]),U("div",{className:"flex-1 space-y-2"},U("textarea",{ref:c,value:l,onInput:function(e){return d(e.currentTarget.value)},className:"border-border-default bg-bg-input text-fg-primary focus:border-accent focus:ring-accent w-full rounded-md border px-3 py-2 text-base focus:outline-none focus:ring-1",rows:3}),U("div",{className:"flex flex-wrap gap-2"},U("button",{onClick:function(e){e.stopPropagation(),n(l)},className:"bg-accent text-fg-on-accent hover:bg-accent-hover whitespace-nowrap rounded-md px-3 py-1 text-sm"},u("comments.save")),U("button",{onClick:function(e){e.stopPropagation(),o()},className:"bg-interactive-hover text-fg-secondary hover:bg-border-default whitespace-nowrap rounded-md px-3 py-1 text-sm"},u("comments.cancel"))))},Cf=function(e){if(!e)return"(no date)";try{return(e instanceof Date?e:new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}catch(t){return"string"==typeof e?e:"(no date)"}},Mf=function(e){var t=e.annotation,n=e.onSave,o=e.onDelete,r=e.isReply,a=void 0!==r&&r,i=e.documentId,s=_(Ee(!1),2),l=s[0],d=s[1],c=_(Ee(!1),2),u=c[0],m=c[1],p=t.author||"Guest";return u?U("div",{className:"flex w-full items-start space-x-3",onClick:function(e){return e.stopPropagation()}},a&&U(wf,{name:p,className:"h-8 w-8"}),U(Ef,{initialText:t.contents||"",onSave:function(e){n(e),m(!1)},onCancel:function(){m(!1)},autoFocus:!0,documentId:i})):U("div",{className:"flex items-start space-x-3"},a&&U(wf,{name:p,className:"h-8 w-8"}),U("div",{className:"min-w-0 flex-1"},a&&U("div",{className:"flex items-center justify-between"},U("div",{className:"leading-none"},U("h5",{className:"text-fg-primary text-sm font-medium"},p),U("span",{className:"text-fg-muted text-xs"},Cf(t.modified||t.created))),U("div",{className:"relative"},U("button",{onClick:function(e){e.stopPropagation(),d(!0)},className:"text-fg-muted hover:bg-interactive-hover rounded-md p-1"},U("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},U("path",{d:"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"}))),l&&U(Sf,{onEdit:function(){return m(!0)},onDelete:o,onClose:function(){return d(!1)},documentId:i}))),U("p",{className:"text-fg-primary mt-2 text-sm"},t.contents)))},kf=(c(c(c(c(c(c(c(c(c(c(vf={},Et.HIGHLIGHT,{label:"Highlight",labelKey:"annotation.highlight",icon:"highlight",iconProps:function(e){return{primaryColor:e.color||"#ffff00"}}}),Et.CIRCLE,{label:"Circle",labelKey:"annotation.circle",icon:"circle",iconProps:function(e){return{primaryColor:e.strokeColor||"#000000",secondaryColor:e.color}}}),Et.SQUARE,{label:"Square",labelKey:"annotation.square",icon:"square",iconProps:function(e){return{primaryColor:e.strokeColor||"#000000",secondaryColor:e.color}}}),Et.LINE,{label:"Line",labelKey:"annotation.line",icon:"line",iconProps:function(e){return{primaryColor:e.strokeColor||"#000000"}}}),Et.UNDERLINE,{label:"Underline",labelKey:"annotation.underline",icon:"underline",iconProps:function(e){return{primaryColor:e.color||"#000000"}}}),Et.SQUIGGLY,{label:"Squiggly",labelKey:"annotation.squiggly",icon:"squiggly",iconProps:function(e){return{primaryColor:e.color||"#000000"}}}),Et.STRIKEOUT,{label:"Strikethrough",labelKey:"annotation.strikeout",icon:"strikethrough",iconProps:function(e){return{primaryColor:e.color||"#000000"}}}),Et.INK,{label:"Ink",labelKey:"annotation.ink",icon:"pencilMarker",iconProps:function(e){return{primaryColor:e.color||"#000000"}}}),Et.FREETEXT,{label:"Text",labelKey:"annotation.freeText",icon:"text",iconProps:function(e){return{primaryColor:e.fontColor||"#000000"}}}),Et.POLYGON,{label:"Polygon",labelKey:"annotation.polygon",icon:"polygon",iconProps:function(e){return{primaryColor:e.strokeColor||"#000000",secondaryColor:e.color}}}),c(c(vf,Et.POLYLINE,{label:"Polyline",labelKey:"annotation.polyline",icon:"zigzag",iconProps:function(e){return{primaryColor:e.strokeColor||"#000000"}}}),Et.STAMP,{label:"Stamp",labelKey:"annotation.stamp",icon:"deviceFloppy",iconProps:function(){return{primaryColor:"#dc2626"}}})),Tf=function(e){var t=e.text,n=e.maxWords,o=void 0===n?16:n,r=e.className,a=void 0===r?"":r,i=e.documentId,s=_(Ee(!1),2),l=s[0],d=s[1],c=pi(i).translate,u=t.split(" ");return u.length>o?U("div",{className:a},l?t:u.slice(0,o).join(" ")+"..."," ",U("button",{onClick:function(e){e.stopPropagation(),d(!l)},className:"text-accent hover:text-accent-hover text-sm font-medium focus:outline-none"},c(l?"comments.showLess":"comments.showMore"))):U("div",{className:a},t)},If=function(e){var t=e.annotation,n=e.config,o=e.className,r=void 0===o?"":o,a=e.title,i=n.iconProps(t.object);return U("div",{className:"bg-bg-surface-alt flex items-center justify-center rounded-full ".concat(r),title:a},U(Wp,g({icon:n.icon},i)))},Of=function(e){var t,n=e.entry,o=e.isSelected,r=e.onSelect,a=e.onUpdate,i=e.onDelete,s=e.onReply,l=e.documentId,d=n.annotation,c=n.replies,u=_(Ee(!1),2),m=u[0],p=u[1],h=_(Ee(!1),2),g=h[0],f=h[1],F=pi(l).translate,P=function(e){return ld(e)?kf[e.object.type]:null}(d),b=!!d.object.contents,v=c.length>0,y=!b&&!v,D=Te(null),x=d.object.author||"Guest";return Me(function(){var e;o&&(null===(e=D.current)||void 0===e||e.focus({preventScroll:!0}))},[o,n]),P?U("div",{onClick:r,className:"bg-bg-surface cursor-pointer rounded-lg border shadow-sm transition-all hover:shadow-md ".concat(o?"border-accent ring-interactive-focus-ring ring-2":"border-border-subtle")},U("div",{className:"p-4"},U("div",{className:"flex items-start space-x-3"},U(If,{annotation:d,config:P,title:F(P.labelKey,{fallback:P.label}),className:"h-8 w-8"}),U("div",{className:"min-w-0 flex-1"},U("div",{className:"flex items-center justify-between"},U("div",{className:"leading-none"},U("h4",{className:"text-fg-primary text-sm font-medium"},x),U("span",{className:"text-fg-disabled text-xs"},Cf(d.object.modified||d.object.created))),U("div",{className:"relative"},U("button",{onClick:function(e){e.stopPropagation(),p(!0)},className:"text-fg-disabled hover:bg-interactive-hover hover:text-fg-secondary rounded-md p-1"},U("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},U("path",{d:"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"}))),m&&U(Sf,{onEdit:function(){return f(!0)},onDelete:function(){return i(d)},onClose:function(){return p(!1)},documentId:l}))),(null===(t=d.object.custom)||void 0===t?void 0:t.text)&&U(Tf,{text:d.object.custom.text,maxWords:14,className:"text-fg-muted mt-2 text-sm",documentId:l}),U("div",{className:"mt-2"},g?U(Ef,{initialText:d.object.contents||"",onSave:function(e){a(d.object.id,e),f(!1)},onCancel:function(){f(!1)},autoFocus:!0,documentId:l}):b?U("p",{className:"text-fg-primary text-sm"},d.object.contents):null))),v&&U("div",{className:"border-border-subtle mt-4 space-y-4 border-t pt-4"},c.map(function(e){return U(Mf,{key:e.object.id,annotation:e.object,onSave:function(t){return a(e.object.id,t)},onDelete:function(){return i(e)},isReply:!0,documentId:l})})),!g&&U(Df,{inputRef:D,isFocused:o,placeholder:F(y?"comments.addComment":"comments.addReply"),onSubmit:function(e){y?a(d.object.id,e):s(d.object.id,e)}}))):null},Rf=function(e){var t=e.documentId,n=pi(t).translate;return U("div",{class:"text-fg-muted flex flex-col items-center gap-2 p-4"},U(Wp,{icon:"comment",className:"h-18 w-18 text-fg-muted"}),U("div",{className:"text-fg-muted max-w-[150px] text-center text-sm"},n("comments.emptyState")))},Gf=function(e){var t=e.documentId,n=yc().provides,o=Dc(t).state,r=or().provides,a=pi(t).translate,i=Te({}),s=Te(null),l=o.selectedUid?cd(o,o.selectedUid):null,c=(e=>{const t={};for(const n of Object.values(e.pages))for(const o of n){const n=e.byUid[o];if(n&&sd(n)){const e=n.object.inReplyToId;e&&(t[e]||(t[e]=[])).push(n)}}const n={};for(const[o,r]of Object.entries(e.pages)){const a=Number(o),i=[];for(const n of r){const o=e.byUid[n];o&&ld(o)&&i.push({page:a,annotation:o,replies:t[o.object.id]??[]})}i.length>0&&(n[a]=i)}return n})(o);Me(function(){if(l&&s.current){var e=i.current[l.object.id];if(e&&s.current){var t=s.current,n=t.getBoundingClientRect(),o=e.getBoundingClientRect(),r=o.top-n.top+t.scrollTop-t.clientHeight/2+o.height/2;t.scrollTo({top:r,behavior:"smooth"})}}},[l]);var u=function(e,t){var o=g(e);o&&(null==n||n.updateAnnotation(o.object.pageIndex,e,{contents:t,modified:new Date}))},m=function(e){null==n||n.deleteAnnotation(e.object.pageIndex,e.object.id)},p=function(e,t){var o=g(e);o&&(null==n||n.createAnnotation(o.object.pageIndex,{id:_n(),rect:{origin:{x:o.object.rect.origin.x,y:o.object.rect.origin.y},size:{width:24,height:24}},pageIndex:o.object.pageIndex,created:new Date,modified:new Date,type:Et.TEXT,contents:t,inReplyToId:o.object.id,flags:["noRotate","noZoom","print"],icon:Mt.Comment}))},h=Object.keys(c).map(Number).sort(function(e,t){return e-t}),g=function(e){var t,n=d(h);try{for(n.s();!(t=n.n()).done;){var o,r=t.value,a=d(c[r]);try{for(a.s();!(o=a.n()).done;){var i=o.value;if(i.annotation.object.id===e)return i.annotation;var s=i.replies.find(function(t){return t.object.id===e});if(s)return s}}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}};return 0===h.length?U(Rf,{documentId:t}):U("div",{ref:s,className:"h-full overflow-y-auto"},U("div",{className:"space-y-6 p-3"},h.map(function(e){return U("div",{key:e,className:"space-y-3"},U("div",{className:"bg-bg-surface sticky top-0 z-10 px-1"},U("div",{className:"border-border-subtle border-b py-2"},U("h3",{className:"text-md text-fg-primary font-semibold"},a("comments.page",{params:{page:e+1}})),U("p",{className:"text-fg-muted text-sm"},1===c[e].length?a("comments.commentCount",{params:{count:1}}):a("comments.commentCountPlural",{params:{count:c[e].length}})))),U("div",{className:"space-y-3 px-1"},c[e].map(function(e){return U("div",{key:e.annotation.object.id,ref:function(t){t&&(i.current[e.annotation.object.id]=t)}},U(Of,{entry:e,isSelected:(null==l?void 0:l.object.id)===e.annotation.object.id,onSelect:function(){return t=e.annotation,null==n||n.selectAnnotation(t.object.pageIndex,t.object.id),void(null==r||r.scrollToPage({pageNumber:t.object.pageIndex+1,pageCoordinates:{x:t.object.rect.origin.x,y:t.object.rect.origin.y},alignX:50,alignY:25,behavior:"smooth"}));var t},onUpdate:u,onDelete:m,onReply:p,documentId:t}))})))})))};function Lf(e){var t=e.documentId,n=(e=>{const{provides:t}=Si(),[n,o]=Ee(yi);return Me(()=>{if(!t)return;const n=t.forDocument(e);return o(n.getState()),n.onStateChange(e=>{o(e)})},[t,e]),{state:n,provides:(null==t?void 0:t.forDocument(e))??null}})(t),o=n.state,r=n.provides,a=_(Ee(""),2),i=a[0],s=a[1];if(!r)return null;var l=Math.round(100*o.currentZoomLevel);return Me(function(){s(l.toString())},[l]),U("div",{className:"relative"},U("div",{className:"bg-interactive-hover flex items-center rounded"},U("form",{onSubmit:function(e){e.preventDefault();var t=e.target,n=new FormData(t),o=parseFloat(n.get("zoom")||i);!isNaN(o)&&o>0&&r.requestZoom(o/100)},className:"block"},U("input",{name:"zoom",type:"text",inputMode:"numeric",pattern:"\\d*",className:"h-6 w-8 border-0 bg-transparent p-0 text-right text-sm outline-none focus:outline-none","aria-label":"Set zoom",autoFocus:!1,value:i,onInput:function(e){var t=e.target.value.replace(/[^0-9]/g,"");s(t)},onBlur:function(){(!i||parseFloat(i)<=0)&&s(l.toString())}}),U("span",{className:"text-sm"},"%")),U(fg,{commandId:"zoom:toggle-menu",documentId:t,itemId:"zoom-menu-button"}),U(fg,{commandId:"zoom:out",documentId:t}),U(fg,{commandId:"zoom:in",documentId:t})))}var Nf,zf=["position"],jf=function(){var e=_(Ee(!1),2),t=e[0],n=e[1],o=Te(null),r=Te(null);return Me(function(){if(t){var e=function(e){o.current&&!o.current.contains(e.target)&&n(!1)};return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}}},[t]),Me(function(){t&&r.current&&r.current.scrollIntoView({block:"center",inline:"start"})},[t]),{open:t,setOpen:n,rootRef:o,selectedItemRef:r}},Bf=function(e){var t=e.value,n=e.onChange,o=e.options,r=e.getOptionKey,a=e.renderValue,i=e.renderOption,s=e.triggerClass,l=void 0===s?"px-3 py-2":s,d=jf(),c=d.open,u=d.setOpen,m=d.rootRef,p=d.selectedItemRef;return U("div",{ref:m,class:"relative inline-block w-full"},U("button",{type:"button",class:"border-border-default bg-bg-input flex w-full items-center justify-between gap-2 rounded border ".concat(l),onClick:function(){return u(function(e){return!e})}},a(t),U("svg",{class:"text-fg-secondary h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},U("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z",clipRule:"evenodd"}))),c&&U("div",{class:"border-border-default bg-bg-elevated absolute z-10 mt-1 max-h-60 w-full overflow-y-auto rounded border p-1 shadow-lg"},o.map(function(e){var o=r(e)===r(t);return U("button",{ref:o?p:null,key:r(e),class:"hover:bg-interactive-hover block w-full rounded text-left ".concat(o?"bg-interactive-hover":""),onClick:function(){n(e),u(!1)}},i(e,o))})))},$f=function(e){var t=e.children,n=e.className;return U("label",{class:"text-fg-primary mb-2 block text-sm font-medium ".concat(void 0===n?"":n)},t)},Uf=function(e){var t=e.children,n=e.className;return U("span",{class:"text-fg-muted text-xs ".concat(void 0===n?"":n)},t)},Wf=function(e){var t=e.children,n=e.className;return U("section",{class:"mb-6 ".concat(void 0===n?"":n)},t)},Hf=function(e){var t=e.value,n=e.min,o=void 0===n?0:n,r=e.max,a=void 0===r?1:r,i=e.step,s=void 0===i?.1:i,l=e.onChange;return U("input",{type:"range",class:"range-sm bg-border-subtle mb-2 h-1 w-full cursor-pointer appearance-none rounded-lg",value:t,min:o,max:a,step:s,onInput:function(e){return l(parseFloat(e.target.value))}})},Vf=function(e){var t=e.color,n=e.active,o=e.onSelect,r=function(e){return"transparent"===e||/^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*0\s*\)$/i.test(e)||/^#([0-9a-f]{8})$/i.test(e)&&"00"===e.slice(-2).toLowerCase()||/^#([0-9a-f]{4})$/i.test(e)&&"0"===e.slice(-1).toLowerCase()}(t)?{backgroundColor:"#fff",backgroundImage:"linear-gradient(45deg, transparent 40%, red 40%, red 60%, transparent 60%)",backgroundSize:"100% 100%"}:{backgroundColor:t};return U("button",{title:t,class:"border-border-strong h-5 w-5 rounded-full border ".concat(n?"outline-accent outline outline-2 outline-offset-2":""),style:r,onClick:function(){return o(t)}})},Yf=[{id:Ot.SOLID},{id:Ot.DASHED,dash:[6,2]},{id:Ot.DASHED,dash:[8,4]},{id:Ot.DASHED,dash:[3,3]},{id:Ot.DASHED,dash:[1,2]},{id:Ot.DASHED,dash:[4,2,1,2]},{id:Ot.DASHED,dash:[8,4,1,4]}],qf=function(e){return U("svg",{width:"80",height:"8",viewBox:"0 0 80 8"},U("line",{x1:"0",y1:"4",x2:"80",y2:"4",style:{strokeDasharray:null==e?void 0:e.join(" "),stroke:"currentColor",strokeWidth:"2"}}))},Kf=function(e){return U(Bf,g(g({},e),{},{options:Yf,getOptionKey:function(e){var t;return e.id+((null===(t=e.dash)||void 0===t?void 0:t.join("-"))||"")},renderValue:function(e){return qf(e.dash)},renderOption:function(e){return U("div",{class:"px-1 py-2"},qf(e.dash))}}))},Xf=[kt.None,kt.Square,kt.Circle,kt.Diamond,kt.OpenArrow,kt.ClosedArrow,kt.ROpenArrow,kt.RClosedArrow,kt.Butt,kt.Slash],Zf=function(e){var t,n=e.ending,o=e.position,r=c(c(c(c(c(c(c(c(c({},kt.Square,U("path",{d:"M68 -4 L76 -4 L76 4 L68 4 Z"})),kt.Circle,U("circle",{cx:"72",cy:"0",r:"4"})),kt.Diamond,U("path",{d:"M72 -5 L77 0 L72 5 L67 0 Z"})),kt.OpenArrow,U("path",{d:"M67 -5 L77 0 L67 5",fill:"none"})),kt.ClosedArrow,U("path",{d:"M67 -5 L77 0 L67 5 Z"})),kt.ROpenArrow,U("path",{d:"M77 -5 L67 0 L77 5",fill:"none"})),kt.RClosedArrow,U("path",{d:"M77 -5 L67 0 L77 5 Z"})),kt.Butt,U("path",{d:"M72 -5 L72 5",fill:"none"})),kt.Slash,U("path",{d:"M67 -5 L77 5",fill:"none"})),a=c(c(c(c(c(c(c(c(c({},kt.Square,68),kt.Circle,68),kt.Diamond,67),kt.OpenArrow,76),kt.ClosedArrow,67),kt.ROpenArrow,67),kt.RClosedArrow,67),kt.Butt,72),kt.Slash,72),i=r[n];return U("svg",{width:"80",height:"20",viewBox:"0 0 80 20",class:"text-fg-primary"},U("g",{transform:"start"===o?"rotate(180 40 10)":""},U("line",{x1:"4",y1:"10",x2:null!==(t=a[n])&&void 0!==t?t:77,y2:"10",stroke:"currentColor","stroke-width":"1.5"}),i&&U("g",{transform:"translate(0, 10)",fill:"currentColor",stroke:"currentColor","stroke-width":"1.5"},i)))},Qf=function(e){var t=e.position,n=f(e,zf);return U(Bf,g(g({},n),{},{options:Xf,getOptionKey:function(e){return e},triggerClass:"px-3 py-1",renderValue:function(e){return U(Zf,{ending:e,position:t})},renderOption:function(e){return U("div",{class:"px-1 py-1"},U(Zf,{ending:e,position:t}))}}))},Jf=function(e){return U(Bf,g(g({},e),{},{options:un,getOptionKey:function(e){return e},triggerClass:"px-2 py-1 text-sm",renderValue:function(e){return U("span",null,mn(e))},renderOption:function(e){return U("div",{class:"px-2 py-1"},mn(e))}}))},eF=function(e){var t=e.value,n=e.onChange,o=e.options,r=void 0===o?[8,9,10,11,12,14,16,18,24,36,48,72]:o,a=jf(),i=a.open,s=a.setOpen,l=a.rootRef,d=a.selectedItemRef;return U("div",{ref:l,class:"relative w-full"},U("input",{type:"number",min:"1",class:"border-border-default bg-bg-input w-full rounded border px-2 py-1 pr-7 text-sm",value:t,onInput:function(e){var t=parseInt(e.target.value,10);Number.isFinite(t)&&t>0&&n(t)},onClick:function(){return s(!0)}}),U("button",{type:"button",class:"absolute inset-y-0 right-1 flex items-center",onClick:function(){return s(function(e){return!e})},tabIndex:-1},U("svg",{class:"text-fg-secondary h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},U("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z","clip-rule":"evenodd"}))),i&&U("div",{class:"border-border-default bg-bg-elevated absolute z-10 mt-1 max-h-48 w-full overflow-y-auto rounded border shadow-lg"},r.map(function(e){var o=e===t;return U("button",{ref:o?d:null,key:e,class:"hover:bg-interactive-hover block w-full px-2 py-1 text-left text-sm ".concat(o?"bg-interactive-hover":""),onClick:function(){n(e),s(!1)}},e)})))},tF=(c(c(c(c(c(c(c(c(c(c(Nf={},At.Normal,"blendMode.normal"),At.Multiply,"blendMode.multiply"),At.Screen,"blendMode.screen"),At.Overlay,"blendMode.overlay"),At.Darken,"blendMode.darken"),At.Lighten,"blendMode.lighten"),At.ColorDodge,"blendMode.colorDodge"),At.ColorBurn,"blendMode.colorBurn"),At.HardLight,"blendMode.hardLight"),At.SoftLight,"blendMode.softLight"),c(c(c(c(c(c(Nf,At.Difference,"blendMode.difference"),At.Exclusion,"blendMode.exclusion"),At.Hue,"blendMode.hue"),At.Saturation,"blendMode.saturation"),At.Color,"blendMode.color"),At.Luminosity,"blendMode.luminosity")),nF=function(e){var t,n,o,r,a=e.documentId,i=e.selected,s=e.activeTool,l=e.colorPresets,d=yc().provides,c=pi(a).translate;if(!d)return null;var u=null==i?void 0:i.object,m=null==s?void 0:s.defaults,p=!!u,h=p?u.color:null!==(t=null==m?void 0:m.color)&&void 0!==t?t:"#FFFF00",g=p?u.opacity:null!==(n=null==m?void 0:m.opacity)&&void 0!==n?n:1,f=p?null!==(o=u.blendMode)&&void 0!==o?o:At.Normal:null!==(r=null==m?void 0:m.blendMode)&&void 0!==r?r:At.Normal,F=_(Ee(h),2),P=F[0],b=F[1],v=_(Ee(g),2),y=v[0],D=v[1],x=_(Ee(f),2),A=x[0],w=x[1];Me(function(){return b(h)},[h]),Me(function(){return D(g)},[g]),Me(function(){return w(f)},[f]);var S=hf(y,300);Me(function(){return C({opacity:S})},[S]);var E=function(e){b(e),C({color:e})};function C(e){d&&(p?d.updateAnnotation(u.pageIndex,u.id,e):s&&d.setToolDefaults(s.id,e))}return U(H,null,U(Wf,null,U($f,{className:"mb-3"},c("annotation.color")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},l.map(function(e){return U(Vf,{key:e,color:e,active:e===P,onSelect:E})}))),U(Wf,null,U($f,null,c("annotation.opacity")),U(Hf,{value:y,min:.1,max:1,step:.05,onChange:D}),U(Uf,null,Math.round(100*y),"%")),U(Wf,null,U($f,null,c("annotation.blendMode")),U("select",{class:"border-border-default bg-bg-input text-fg-primary w-full rounded border px-2 py-1 text-sm",value:A,onChange:function(e){return t=parseInt(e.target.value,10),w(n=t),void C({blendMode:n});var t,n}},fn.map(function(e){return U("option",{key:e,value:e},c(tF[e]))}))))},oF=function(e){var t,n,o,r,a,i=e.documentId,s=e.selected,l=e.activeTool,d=e.colorPresets,c=yc().provides,u=pi(i).translate;if(!c)return null;var m=null==s?void 0:s.object,p=null==l?void 0:l.defaults,h=!!m,g=h?m.color:null!==(t=null==p?void 0:p.color)&&void 0!==t?t:"#000000",f=h?m.strokeColor:null!==(n=null==p?void 0:p.strokeColor)&&void 0!==n?n:"#000000",F=h?m.opacity:null!==(o=null==p?void 0:p.opacity)&&void 0!==o?o:1,P=h?m.strokeWidth:null!==(r=null==p?void 0:p.strokeWidth)&&void 0!==r?r:2,b=h?{id:m.strokeStyle,dash:m.strokeDashArray}:{id:null!==(a=null==p?void 0:p.strokeStyle)&&void 0!==a?a:Ot.SOLID,dash:null==p?void 0:p.strokeDashArray},v=_(Ee(g),2),y=v[0],D=v[1],x=_(Ee(f),2),A=x[0],w=x[1],S=_(Ee(F),2),E=S[0],C=S[1],M=_(Ee(P),2),k=M[0],T=M[1],I=_(Ee(b),2),O=I[0],R=I[1];Me(function(){return D(g)},[g]),Me(function(){return w(f)},[f]),Me(function(){return C(F)},[F]),Me(function(){return T(P)},[P]),Me(function(){return R(b)},[b]);var G=hf(E,300),L=hf(k,300);Me(function(){return j({opacity:G})},[G]),Me(function(){return j({strokeWidth:L})},[L]);var N=function(e){D(e),j({color:e})},z=function(e){w(e),j({strokeColor:e})};function j(e){c&&(h?c.updateAnnotation(m.pageIndex,m.id,e):l&&c.setToolDefaults(l.id,e))}return U(H,null,U(Wf,null,U($f,{className:"mb-3"},u("annotation.fillColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},d.map(function(e){return U(Vf,{key:e,color:e,active:e===y,onSelect:N})}),U(Vf,{color:"transparent",active:"transparent"===y,onSelect:N}))),U(Wf,null,U($f,null,u("annotation.opacity")),U(Hf,{value:E,min:.1,max:1,step:.05,onChange:C}),U(Uf,null,Math.round(100*E),"%")),U(Wf,null,U($f,{className:"mb-3"},u("annotation.strokeColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},d.map(function(e){return U(Vf,{key:e,color:e,active:e===A,onSelect:z})}))),U(Wf,null,U($f,{className:"mb-3"},u("annotation.borderStyle")),U(Kf,{value:O,onChange:function(e){R(e),j({strokeStyle:e.id,strokeDashArray:e.dash})}})),U(Wf,null,U($f,null,u("annotation.strokeWidth")),U(Hf,{value:k,min:1,max:30,step:1,onChange:T}),U(Uf,null,k,"px")))},rF=function(e){var t,n,o,r,a,i,s,l=e.documentId,d=e.selected,c=e.activeTool,u=e.colorPresets,m=yc().provides,p=pi(l).translate;if(!m)return null;var h=null==d?void 0:d.object,g=null==c?void 0:c.defaults,f=!!h,F=f?h.color:null!==(t=null==g?void 0:g.color)&&void 0!==t?t:"#000000",P=f?h.strokeColor:null!==(n=null==g?void 0:g.strokeColor)&&void 0!==n?n:"#000000",b=f?h.opacity:null!==(o=null==g?void 0:g.opacity)&&void 0!==o?o:1,v=f?h.strokeWidth:null!==(r=null==g?void 0:g.strokeWidth)&&void 0!==r?r:2,y=f?null!==(a=h.lineEndings)&&void 0!==a?a:{start:kt.None,end:kt.None}:null!==(i=null==g?void 0:g.lineEndings)&&void 0!==i?i:{start:kt.None,end:kt.None},D=f?{id:h.strokeStyle,dash:h.strokeDashArray}:{id:null!==(s=null==g?void 0:g.strokeStyle)&&void 0!==s?s:Ot.SOLID,dash:null==g?void 0:g.strokeDashArray},x=_(Ee(F),2),A=x[0],w=x[1],S=_(Ee(P),2),E=S[0],C=S[1],M=_(Ee(b),2),k=M[0],T=M[1],I=_(Ee(v),2),O=I[0],R=I[1],G=_(Ee(D),2),L=G[0],N=G[1],z=_(Ee(y.start),2),j=z[0],B=z[1],$=_(Ee(y.end),2),W=$[0],V=$[1];Me(function(){return w(F)},[F]),Me(function(){return C(P)},[P]),Me(function(){return T(b)},[b]),Me(function(){return R(v)},[v]),Me(function(){return N(D)},[D]),Me(function(){return B(y.start)},[y.start]),Me(function(){return V(y.end)},[y.end]);var Y=hf(k,300),q=hf(O,300);Me(function(){return Z({opacity:Y})},[Y]),Me(function(){return Z({strokeWidth:q})},[q]);var K=function(e){w(e),Z({color:e})},X=function(e){C(e),Z({strokeColor:e})};function Z(e){m&&(f?m.updateAnnotation(h.pageIndex,h.id,e):c&&m.setToolDefaults(c.id,e))}return U(H,null,U(Wf,null,U($f,{className:"mb-3"},p("annotation.strokeColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},u.map(function(e){return U(Vf,{key:e,color:e,active:e===E,onSelect:X})}),U(Vf,{color:"transparent",active:"transparent"===E,onSelect:X}))),U(Wf,null,U($f,null,p("annotation.opacity")),U(Hf,{value:k,min:.1,max:1,step:.05,onChange:T}),U(Uf,null,Math.round(100*k),"%")),U(Wf,null,U($f,{className:"mb-3"},p("annotation.borderStyle")),U(Kf,{value:L,onChange:function(e){N(e),Z({strokeStyle:e.id,strokeDashArray:e.dash})}})),U(Wf,null,U($f,null,p("annotation.strokeWidth")),U(Hf,{value:O,min:1,max:10,step:1,onChange:R}),U(Uf,null,O)),U(Wf,null,U("div",{class:"grid grid-cols-2 gap-4"},U("div",null,U($f,{className:"mb-3"},p("annotation.lineStart")),U(Qf,{value:j,onChange:function(e){B(e),Z({lineEndings:{start:e,end:W}})},position:"start"})),U("div",null,U($f,{className:"mb-3"},p("annotation.lineEnd")),U(Qf,{value:W,onChange:function(e){V(e),Z({lineEndings:{start:j,end:e}})},position:"end"})))),U(Wf,null,U($f,{className:"mb-3"},p("annotation.fillColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},u.map(function(e){return U(Vf,{key:e,color:e,active:e===A,onSelect:K})}),U(Vf,{color:"transparent",active:"transparent"===A,onSelect:K}))))};function aF(e){var t=e.active,n=void 0!==t&&t,o=e.disabled,r=void 0!==o&&o,a=e.onClick,i=e.title,s=e.children,l=e.className,d=void 0===l?"":l;return U("button",{type:"button",title:i,disabled:r,onClick:a,className:"h-9 w-9 rounded border px-2 py-1 text-sm transition-colors ".concat(n?"border-accent bg-accent text-fg-on-accent":"border-border-default bg-bg-input text-fg-primary hover:bg-interactive-hover"," disabled:cursor-not-allowed disabled:opacity-40 ").concat(d)},s)}var iF,sF=(c(c(c(c(c(c(c(c(c(c(iF={},Et.INK,{component:function(e){var t,n,o,r,a,i,s=e.documentId,l=e.selected,d=e.activeTool,c=e.colorPresets,u=yc().provides,m=pi(s).translate;if(!u)return null;var p=null==l?void 0:l.object,h=null==d?void 0:d.defaults,g=null!==(t=null!==(n=null==p?void 0:p.color)&&void 0!==n?n:null==h?void 0:h.color)&&void 0!==t?t:"#000000",f=null!==(o=null!==(r=null==p?void 0:p.opacity)&&void 0!==r?r:null==h?void 0:h.opacity)&&void 0!==o?o:1,F=null!==(a=null!==(i=null==p?void 0:p.strokeWidth)&&void 0!==i?i:null==h?void 0:h.strokeWidth)&&void 0!==a?a:2,P=_(Ee(g),2),b=P[0],v=P[1],y=_(Ee(f),2),D=y[0],x=y[1],A=_(Ee(F),2),w=A[0],S=A[1];Me(function(){return v(g)},[g]),Me(function(){return x(f)},[f]),Me(function(){return S(F)},[F]);var E=hf(D,300),C=hf(w,300);Me(function(){return k({opacity:E})},[E]),Me(function(){return k({strokeWidth:C})},[C]);var M=function(e){v(e),k({color:e})};function k(e){u&&(p?u.updateAnnotation(p.pageIndex,p.id,e):d&&u.setToolDefaults(d.id,e))}return U(H,null,U(Wf,null,U($f,{className:"mb-3"},m("annotation.color")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},c.map(function(e){return U(Vf,{key:e,color:e,active:e===b,onSelect:M})}))),U(Wf,null,U($f,null,m("annotation.opacity")),U(Hf,{value:D,min:.1,max:1,step:.05,onChange:x}),U(Uf,null,Math.round(100*D),"%")),U(Wf,null,U($f,null,m("annotation.strokeWidth")),U(Hf,{value:w,min:1,max:30,step:1,onChange:S}),U(Uf,null,w,"px")))},titleKey:"annotation.ink"}),Et.POLYGON,{component:function(e){var t,n,o,r,a,i=e.documentId,s=e.selected,l=e.activeTool,d=e.colorPresets,c=yc().provides,u=pi(i).translate;if(!c)return null;var m=null==s?void 0:s.object,p=null==l?void 0:l.defaults,h=!!m,g=h?m.color:null!==(t=null==p?void 0:p.color)&&void 0!==t?t:"#000000",f=h?m.strokeColor:null!==(n=null==p?void 0:p.strokeColor)&&void 0!==n?n:"#000000",F=h?m.opacity:null!==(o=null==p?void 0:p.opacity)&&void 0!==o?o:1,P=h?m.strokeWidth:null!==(r=null==p?void 0:p.strokeWidth)&&void 0!==r?r:2,b=h?{id:m.strokeStyle,dash:m.strokeDashArray}:{id:null!==(a=null==p?void 0:p.strokeStyle)&&void 0!==a?a:Ot.SOLID,dash:null==p?void 0:p.strokeDashArray},v=_(Ee(g),2),y=v[0],D=v[1],x=_(Ee(f),2),A=x[0],w=x[1],S=_(Ee(F),2),E=S[0],C=S[1],M=_(Ee(P),2),k=M[0],T=M[1],I=_(Ee(b),2),O=I[0],R=I[1];Me(function(){return D(g)},[g]),Me(function(){return w(f)},[f]),Me(function(){return C(F)},[F]),Me(function(){return T(P)},[P]),Me(function(){return R(b)},[b]);var G=hf(E,300),L=hf(k,300);Me(function(){return j({opacity:G})},[G]),Me(function(){return j({strokeWidth:L})},[L]);var N=function(e){D(e),j({color:e})},z=function(e){w(e),j({strokeColor:e})};function j(e){c&&(h?c.updateAnnotation(m.pageIndex,m.id,e):l&&c.setToolDefaults(l.id,e))}return U(H,null,U(Wf,null,U($f,{className:"mb-3"},u("annotation.strokeColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},d.map(function(e){return U(Vf,{key:e,color:e,active:e===A,onSelect:z})}),U(Vf,{color:"transparent",active:"transparent"===A,onSelect:z}))),U(Wf,null,U($f,null,u("annotation.opacity")),U(Hf,{value:E,min:.1,max:1,step:.05,onChange:C}),U(Uf,null,Math.round(100*E),"%")),U(Wf,null,U($f,{className:"mb-3"},u("annotation.borderStyle")),U(Kf,{value:O,onChange:function(e){R(e),j({strokeStyle:e.id,strokeDashArray:e.dash})}})),U(Wf,null,U($f,null,u("annotation.strokeWidth")),U(Hf,{value:k,min:1,max:10,step:1,onChange:T}),U(Uf,null,k)),U(Wf,null,U($f,{className:"mb-3"},u("annotation.fillColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},d.map(function(e){return U(Vf,{key:e,color:e,active:e===y,onSelect:N})}),U(Vf,{color:"transparent",active:"transparent"===y,onSelect:N}))))},titleKey:"annotation.polygon"}),Et.SQUARE,{component:oF,titleKey:"annotation.square"}),Et.CIRCLE,{component:oF,titleKey:"annotation.circle"}),Et.LINE,{component:rF,titleKey:function(e){var t;return"lineArrow"===(null===(t=e.activeTool)||void 0===t?void 0:t.id)?"annotation.arrow":"annotation.line"}}),Et.POLYLINE,{component:rF,titleKey:"annotation.polyline"}),Et.HIGHLIGHT,{component:nF,titleKey:"annotation.highlight"}),Et.UNDERLINE,{component:nF,titleKey:"annotation.underline"}),Et.STRIKEOUT,{component:nF,titleKey:"annotation.strikeout"}),Et.SQUIGGLY,{component:nF,titleKey:"annotation.squiggly"}),c(c(iF,Et.FREETEXT,{component:function(e){var t,n,o,r,a,i,s,l=e.documentId,d=e.selected,c=e.activeTool,u=e.colorPresets,m=yc().provides,p=pi(l).translate;if(!m)return null;var h=null==d?void 0:d.object,g=null==c?void 0:c.defaults,f=!!h,F=f?h.fontFamily:null!==(t=null==g?void 0:g.fontFamily)&&void 0!==t?t:yt.Helvetica,P=sn(F).family,b=ln(F),v=dn(F),y=f?h.fontColor:null!==(n=null==g?void 0:g.fontColor)&&void 0!==n?n:"#000000",D=f?h.opacity:null!==(o=null==g?void 0:g.opacity)&&void 0!==o?o:1,x=f?h.backgroundColor:null!==(r=null==g?void 0:g.backgroundColor)&&void 0!==r?r:"#000000",A=f?h.fontSize:null!==(a=null==g?void 0:g.fontSize)&&void 0!==a?a:12,w=f?h.textAlign:null!==(i=null==g?void 0:g.textAlign)&&void 0!==i?i:Dt.Left,S=f?h.verticalAlign:null!==(s=null==g?void 0:g.verticalAlign)&&void 0!==s?s:xt.Top,E=_(Ee(P),2),C=E[0],M=E[1],k=_(Ee(A),2),T=k[0],I=k[1],O=_(Ee(b),2),R=O[0],G=O[1],L=_(Ee(v),2),N=L[0],z=L[1],j=_(Ee(w),2),B=j[0],$=j[1],W=_(Ee(S),2),V=W[0],Y=W[1],q=_(Ee(y),2),K=q[0],X=q[1],Z=_(Ee(D),2),Q=Z[0],J=Z[1],ee=_(Ee(x),2),te=ee[0],ne=ee[1];function oe(e){m&&(f?m.updateAnnotation(h.pageIndex,h.id,e):c&&m.setToolDefaults(c.id,e))}Me(function(){M(P),G(b),z(v)},[P,b,v]),Me(function(){return X(y)},[y]),Me(function(){return J(D)},[D]),Me(function(){return ne(x)},[x]),Me(function(){return I(A)},[A]),Me(function(){return $(w)},[w]),Me(function(){return Y(S)},[S]);var re=hf(Q,300),ae=hf(te,300);Me(function(){return oe({opacity:re})},[re]),Me(function(){return oe({backgroundColor:ae})},[ae]);var ie=function(e){X(e),oe({fontColor:e})},se=function(e){ne(e),oe({backgroundColor:e})},le=function(e,t,n){oe({fontFamily:cn(e,{bold:t,italic:n})})},de=function(e){$(e),oe({textAlign:e})},ce=function(e){Y(e),oe({verticalAlign:e})};return U(H,null,U(Wf,null,U($f,null,p("annotation.font")),U("div",{class:"mb-3 flex gap-2"},U(Jf,{value:C,onChange:function(e){var t=ln(cn(e,{bold:!0,italic:!1})),n=dn(cn(e,{bold:!1,italic:!0})),o=!!t&&R,r=!!n&&N;M(e),G(o),z(r),le(e,o,r)}}),U("div",{class:"w-36"},U(eF,{value:T,onChange:function(e){!Number.isFinite(e)||e<=0||(I(e),oe({fontSize:e}))}}))),U("div",{class:"flex gap-2"},U(aF,{title:"Bold",active:R,disabled:!ln(cn(C,{bold:!0,italic:!1})),onClick:function(){if(ln(cn(C,{bold:!0,italic:!1}))){var e=!R;G(e),le(C,e,N)}},className:"font-bold"},U(Wp,{icon:"bold",size:18})),U(aF,{title:"Italic",active:N,disabled:!dn(cn(C,{bold:!1,italic:!0})),onClick:function(){if(dn(cn(C,{bold:!1,italic:!0}))){var e=!N;z(e),le(C,R,e)}},className:"italic"},U(Wp,{icon:"italic",size:18})))),U(Wf,null,U($f,null,p("annotation.textAlign")),U("div",{class:"flex gap-2"},U(aF,{title:"Align left",active:B===Dt.Left,onClick:function(){return de(Dt.Left)}},U(Wp,{icon:"alignLeft",size:18})),U(aF,{title:"Align center",active:B===Dt.Center,onClick:function(){return de(Dt.Center)}},U(Wp,{icon:"alignCenter",size:18})),U(aF,{title:"Align right",active:B===Dt.Right,onClick:function(){return de(Dt.Right)}},U(Wp,{icon:"alignRight",size:18})))),U(Wf,null,U($f,null,p("annotation.verticalAlign")),U("div",{class:"flex gap-2"},U(aF,{title:"Align top",active:V===xt.Top,onClick:function(){return ce(xt.Top)}},U(Wp,{icon:"alignTop",size:18})),U(aF,{title:"Align middle",active:V===xt.Middle,onClick:function(){return ce(xt.Middle)}},U(Wp,{icon:"alignMiddle",size:18})),U(aF,{title:"Align bottom",active:V===xt.Bottom,onClick:function(){return ce(xt.Bottom)}},U(Wp,{icon:"alignBottom",size:18})))),U(Wf,null,U($f,{className:"mb-3"},p("annotation.fontColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},u.map(function(e){return U(Vf,{key:e,color:e,active:e===K,onSelect:ie})}))),U(Wf,null,U($f,{className:"mb-3"},p("annotation.backgroundColor")),U("div",{class:"grid grid-cols-6 gap-x-1 gap-y-4"},u.map(function(e){return U(Vf,{key:e,color:e,active:e===te,onSelect:se})}),U(Vf,{color:"transparent",active:"transparent"===te,onSelect:se}))),U(Wf,null,U($f,null,p("annotation.opacity")),U(Hf,{value:Q,min:.1,max:1,step:.05,onChange:J}),U(Uf,null,Math.round(100*Q),"%")))},titleKey:"annotation.freeText"}),Et.STAMP,{component:function(e){var t=e.documentId;return U("div",{className:"text-fg-muted text-sm"},(0,pi(t).translate)("annotation.noStylesStamp"))},titleKey:"annotation.stamp"})),lF=function(e){var t=e.documentId,n=pi(t).translate;return U("div",{class:"text-fg-muted flex flex-col items-center gap-2 p-4"},U(Wp,{icon:"palette",className:"h-18 w-18 text-fg-muted"}),U("div",{className:"text-fg-muted max-w-[150px] text-center text-sm"},n("annotation.selectAnnotation")))};function dF(e){var t,n=e.documentId,o=yc().provides,r=Dc(n),a=r.provides,i=r.state,s=pi(n).translate;if(!o||!a)return null;var l=null!==(t=null==o?void 0:o.getColorPresets())&&void 0!==t?t:[],d=null,c=null,u=i.selectedUid?cd(i,i.selectedUid):null;if(u)d=a.findToolForAnnotation(u.object),c=u.object.type;else if(i.activeToolId){var m,p,h;c=null!==(p=null===(h=d=null!==(m=a.getActiveTool())&&void 0!==m?m:null)||void 0===h?void 0:h.defaults.type)&&void 0!==p?p:null}if(null===c)return We(lF,{documentId:n});var f=sF[c];if(!f)return We(lF,{documentId:n});var F=f.component,P=f.titleKey,b={documentId:n,selected:u,activeTool:d,colorPresets:l},_="function"==typeof P?P(b):P,v=_?s(_):"",y=v?s(u?"annotation.styles":"annotation.defaults",{params:{type:v}}):"";return We("div",{class:"h-full overflow-y-auto p-4",children:[y&&We("h2",{class:"text-md mb-4 font-medium",children:y}),We(F,g({},b))]})}function cF(e){var t=e.schema,n=e.documentId,o=e.props,r=o.menuWrapperProps,a=o.rect,i=o.placement,s={position:"absolute",pointerEvents:"auto",cursor:"default",left:"50%",transform:"translateX(-50%)"};return null!=i&&i.suggestTop?s.top=-48:s.top=a.size.height+8,U("div",g(g({},r),pa(t)),U("div",{style:s,className:"border-border-subtle bg-bg-elevated rounded-lg border shadow-lg"},U("div",{className:"flex items-center gap-1 p-1"},t.items.map(function(e){return U(uF,{key:e.id,item:e,documentId:n,props:o})}))))}function uF(e){var t,n=e.item,o=e.documentId,r=e.props;switch(n.type){case"command-button":return U("div",g({},pa(n)),U(fg,{commandId:n.commandId,documentId:o,variant:n.variant}));case"divider":return U("div",g({},pa(n)),U("div",{className:"bg-border-default h-6 w-px","aria-hidden":"true"}));case"group":return U("div",g({className:"flex items-center gap-".concat(null!==(t=n.gap)&&void 0!==t?t:1)},pa(n)),n.items.map(function(e){return U(uF,{key:e.id,item:e,documentId:o,props:r})}));default:return null}}function mF(e){var t,n=e.schema,o=e.documentId,r=e.className,a=n.content,i=n.position,s=Ia().renderCustomComponent,l=(t={"top-left":"top-0 left-0","top-center":"top-0 left-1/2 -translate-x-1/2","top-right":"top-0 right-0","center-left":"top-1/2 left-0 -translate-y-1/2",center:"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","center-right":"top-1/2 right-0 -translate-y-1/2","bottom-left":"bottom-0 left-0","bottom-center":"bottom-0 left-1/2 -translate-x-1/2","bottom-right":"bottom-0 right-0"})[i.anchor]||t["bottom-center"],d=function(e){if(e){var t={};return e.top&&(t.top=e.top),e.right&&(t.right=e.right),e.bottom&&(t.bottom=e.bottom),e.left&&(t.left=e.left),Object.keys(t).length>0?t:void 0}}(i.offset);return U("div",{className:"absolute ".concat(l," ").concat(r||""),style:d,"data-overlay-id":n.id},s(a.componentId,o,{}))}function pF(e){var t=e.open,n=e.title,o=e.children,r=e.onClose,a=e.onExited,i=e.className,s=e.showCloseButton,l=void 0===s||s,d=Te(null),c=_(Ee(t),2),u=c[0],m=c[1],p=_(Ee(!1),2),h=p[0],g=p[1];return Me(function(){if(t)m(!0),requestAnimationFrame(function(){g(!0)});else if(u){g(!1);var e=setTimeout(function(){m(!1),null==a||a()},200);return function(){return clearTimeout(e)}}},[t,u,a]),Me(function(){if(t){var e=function(e){"Escape"===e.key&&(null==r||r())};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}},[t,r]),Me(function(){return document.body.style.overflow=u?"hidden":"",function(){document.body.style.overflow=""}},[u]),u?We("div",{ref:d,className:"fixed inset-0 z-50 transition-opacity duration-200 md:flex md:items-center md:justify-center ".concat(h&&t?"bg-bg-overlay":"bg-transparent"),onClick:function(e){e.target===d.current&&(null==r||r())},children:We("div",{className:Cp("bg-bg-surface md:border-border-subtle relative flex h-full w-full flex-col transition-all duration-200 md:h-auto md:w-[28rem] md:max-w-[90vw] md:rounded-lg md:border md:shadow-lg",h&&t?"scale-100 opacity-100":"scale-95 opacity-0",i),onClick:function(e){return e.stopPropagation()},children:[(n||l)&&We("div",{className:"border-border-subtle flex flex-shrink-0 items-center justify-between border-b px-6 py-4",children:[n&&We("h2",{className:"text-fg-primary text-lg font-semibold",children:n}),l&&We(Vp,{onClick:r,className:"hover:bg-interactive-hover p-1",children:We(Wp,{icon:"x",className:"h-5 w-5"})})]}),We("div",{className:"flex-1 overflow-y-auto px-6 py-4 md:max-h-[80vh] md:flex-none",children:o})]})}):null}function hF(e){var t=e.documentId,n=e.isOpen,o=e.onClose,r=e.onExited,a=or().provides,i=Yc().provides,s=pi(t).translate,l=_(Ee("all"),2),d=l[0],c=l[1],u=_(Ee(""),2),m=u[0],p=u[1],h=_(Ee(!0),2),g=h[0],f=h[1],F=_(Ee(!1),2),P=F[0],b=F[1],v=_(Ee(""),2),y=v[0],D=v[1],x=null==a?void 0:a.forDocument(t).getMetrics(),A=(null==x?void 0:x.currentPage)||1,w=(null==a?void 0:a.forDocument(t).getTotalPages())||0;Me(function(){n&&(c("all"),p(""),f(!0),b(!1),D(""))},[n]);var S=("custom"!==d||m.trim().length>0)&&!P;return U(pF,{open:null!=n&&n,title:s("print.title"),onClose:o,onExited:r,className:"md:w-[32rem]"},U("div",{className:"space-y-6"},U("div",null,U("label",{className:"text-fg-secondary mb-3 block text-sm font-medium"},s("print.pages")),U("div",{className:"space-y-2"},U("label",{className:"flex items-center"},U("input",{type:"radio",name:"pageRange",value:"all",checked:"all"===d,onChange:function(){return c("all")},disabled:P,className:"accent-accent mr-2"}),U("span",{className:"text-fg-primary text-sm"},s("print.all"))),U("label",{className:"flex items-center"},U("input",{type:"radio",name:"pageRange",value:"current",checked:"current"===d,onChange:function(){return c("current")},disabled:P,className:"accent-accent mr-2"}),U("span",{className:"text-fg-primary text-sm"},s("print.current",{params:{currentPage:A}}))),U("label",{className:"flex items-start"},U("input",{type:"radio",name:"pageRange",value:"custom",checked:"custom"===d,onChange:function(){return c("custom")},disabled:P,className:"accent-accent mr-2 mt-0.5"}),U("div",{className:"flex-1"},U("span",{className:"text-fg-primary mb-1 block text-sm"},s("print.specify")),U("input",{type:"text",placeholder:s("print.specifyEG"),value:m,onInput:function(e){return p(e.target.value)},disabled:"custom"!==d||P,className:"w-full rounded-md border px-3 py-1 text-base ".concat("custom"!==d||P?"bg-interactive-disabled text-fg-muted":"border-border-default bg-bg-input text-fg-primary focus:border-accent focus:ring-accent"," focus:outline-none focus:ring-1")}),"custom"===d&&m.trim()&&w>0&&U("p",{className:"text-fg-muted mt-1 text-xs"},s("print.current",{params:{totalPages:w}})))))),U("div",null,U("label",{className:"flex items-center"},U("input",{type:"checkbox",checked:g,onChange:function(e){return f(e.target.checked)},disabled:P,className:"accent-accent mr-2"}),U("span",{className:"text-fg-secondary text-sm font-medium"},s("print.annotation")))),P&&U("div",{className:"bg-state-info-light flex items-center space-x-3 rounded-md p-3"},U(_f,{className:"text-accent"}),U("span",{className:"text-accent text-sm"},y)),U("div",{className:"border-border-subtle flex justify-end space-x-3 border-t pt-4"},U(Vp,{onClick:o,disabled:P,className:"border-border-default bg-bg-surface text-fg-secondary hover:bg-interactive-hover rounded-md border px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50"},s("print.cancel")),U(Vp,{onClick:function(){var e;"current"===d?e=String(A):"custom"===d&&(e=m.trim()||void 0);var n={includeAnnotations:g,pageRange:e};try{b(!0),D(s("print.loading"));var r=null==i?void 0:i.forDocument(t).print(n);r&&(r.onProgress(function(e){D(e.message)}),r.wait(function(){b(!1),D(""),null==o||o()},function(e){console.error("Print failed:",e),b(!1),D("")}))}catch(e){console.error("Print failed:",e),b(!1),D("")}},disabled:!S,className:"bg-accent text-fg-on-accent hover:!bg-accent-hover flex items-center space-x-2 rounded-md border border-transparent px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50"},P&&U(_f,{size:"sm"}),U("span",null,s(P?"print.printing":"print.print"))))))}function gF(e){var t=e.documentId,n=Bo().provides,o=rr(t),r=o.provides,a=o.state,i=a.currentPage,s=a.totalPages,l=_(Ee(!1),2),d=l[0],c=l[1],u=_(Ee(!1),2),m=u[0],p=u[1],h=Te(null),g=_(Ee(i.toString()),2),f=g[0],F=g[1],P=Te(null);Me(function(){F(i.toString())},[i]);var b=Oe(function(){h.current&&clearTimeout(h.current),h.current=setTimeout(function(){m||c(!1)},4e3)},[m]);return Me(function(){if(n)return n.onScrollActivity(function(e){e.documentId===t&&(c(!0),b())})},[n,t,b]),Me(function(){return function(){h.current&&clearTimeout(h.current)}},[]),s<=1?null:U("div",{onMouseEnter:function(){p(!0),c(!0),h.current&&clearTimeout(h.current)},onMouseLeave:function(){p(!1),b()},className:"pointer-events-auto"},U("div",{className:"border-border-default bg-bg-surface flex items-center gap-1 rounded-lg border p-1 shadow-lg transition-opacity duration-300 ".concat(d?"opacity-100":"opacity-0")},U(fg,{commandId:"scroll:previous-page",documentId:t,variant:"icon"}),U("div",{className:"flex items-center gap-1 px-1"},U("input",{ref:P,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:f,onChange:function(e){var t=e.target.value.replace(/[^0-9]/g,"");F(t)},onFocus:function(){setTimeout(function(){var e;return null===(e=P.current)||void 0===e?void 0:e.select()},0)},onBlur:function(){var e,t=parseInt(f,10);!isNaN(t)&&t>=1&&t<=s?null==r||null===(e=r.scrollToPage)||void 0===e||e.call(r,{pageNumber:t}):F(i.toString())},onKeyDown:function(e){"Enter"===e.key?e.target.blur():"Escape"===e.key&&(F(i.toString()),e.target.blur())},className:"border-border-default bg-bg-input text-fg-primary focus:border-accent focus:ring-accent h-7 w-10 rounded border px-1 text-center text-base focus:outline-none focus:ring-1"}),U("span",{className:"text-fg-secondary text-sm"},"  ",s)),U(fg,{commandId:"scroll:next-page",documentId:t,variant:"icon"})))}var fF={colors:{background:{app:"#f3f4f6",surface:"#ffffff",surfaceAlt:"#f1f3f5",elevated:"#ffffff",overlay:"rgba(0, 0, 0, 0.5)",input:"#ffffff"},foreground:{primary:"#111827",secondary:"#374151",muted:"#6b7280",disabled:"#9ca3af",onAccent:"#ffffff"},border:{default:"#d1d5db",subtle:"#e5e7eb",strong:"#9ca3af"},accent:{primary:"#3b82f6",primaryHover:"#2563eb",primaryActive:"#1d4ed8",primaryLight:"#eff6ff",primaryForeground:"#ffffff"},interactive:{hover:"#f3f4f6",active:"#e5e7eb",selected:"#eff6ff",focus:"#3b82f6",focusRing:"#bfdbfe"},state:{error:"#ef4444",errorLight:"#fef2f2",warning:"#f59e0b",warningLight:"#fffbeb",success:"#22c55e",successLight:"#f0fdf4",info:"#3b82f6",infoLight:"#eff6ff"},tooltip:{background:"#111827",foreground:"#ffffff"},scrollbar:{track:"#f3f4f6",thumb:"#d1d5db",thumbHover:"#9ca3af"}}},FF={colors:{background:{app:"#111827",surface:"#1f2937",surfaceAlt:"#374151",elevated:"#1f2937",overlay:"rgba(0, 0, 0, 0.7)",input:"#374151"},foreground:{primary:"#f9fafb",secondary:"#e5e7eb",muted:"#9ca3af",disabled:"#6b7280",onAccent:"#111827"},border:{default:"#4b5563",subtle:"#374151",strong:"#6b7280"},accent:{primary:"#60a5fa",primaryHover:"#3b82f6",primaryActive:"#2563eb",primaryLight:"#1e3a5f",primaryForeground:"#111827"},interactive:{hover:"#374151",active:"#4b5563",selected:"#1e3a5f",focus:"#60a5fa",focusRing:"#1e40af"},state:{error:"#f87171",errorLight:"#7f1d1d",warning:"#fbbf24",warningLight:"#78350f",success:"#4ade80",successLight:"#14532d",info:"#60a5fa",infoLight:"#1e3a5f"},tooltip:{background:"#f9fafb",foreground:"#111827"},scrollbar:{track:"#1f2937",thumb:"#4b5563",thumbHover:"#6b7280"}}};function PF(e,t){var n=g({},e);for(var o in t){var r=t[o];r&&"object"===D(r)&&!Array.isArray(r)?n[o]=PF(e[o]||{},r):void 0!==r&&(n[o]=r)}return n}function bF(e){return"system"===e?"undefined"==typeof window?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e}function _F(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function vF(e){var t=e.documentStates,n=e.activeDocumentId,o=e.visibility,r=void 0===o?"multiple":o,a=e.allowOpenFile,i=void 0===a||a,s=Ha().provides,l=Oe(function(e){null==s||s.setActiveDocument(e)},[s]),d=Oe(function(e){null==s||s.closeDocument(e)},[s]),c=Oe(function(){null==s||s.openFileDialog()},[s]);return"always"===r||"multiple"===r&&t.length>1?U("div",{className:"bg-bg-surface-alt flex items-end pr-2 pt-2"},U("div",{className:"flex flex-1 items-end overflow-x-auto pl-4"},t.map(function(e){var t,o,r=n===e.id;return U("div",{key:e.id,onClick:function(){return l(e.id)},role:"tab",tabIndex:0,"aria-selected":r,onKeyDown:function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),l(e.id))},className:"group relative flex min-w-[120px] max-w-[240px] cursor-pointer items-center gap-2 rounded-t-lg px-4 py-2 text-sm font-medium transition-all ".concat(r?"bg-bg-surface text-fg-primary z-10":"bg-bg-surface-alt text-fg-secondary hover:bg-interactive-hover hover:text-fg-primary")},U("span",{className:"min-w-0 flex-1 truncate"},null!==(t=e.name)&&void 0!==t?t:"Document ".concat(e.id.slice(0,8))),r&&U("button",{onClick:function(t){t.stopPropagation(),d(e.id)},"aria-label":"Close ".concat(null!==(o=e.name)&&void 0!==o?o:"document"),className:"hover:bg-interactive-hover flex-shrink-0 cursor-pointer rounded-full p-1 transition-all ".concat(r?"opacity-100":"opacity-0 group-hover:opacity-100")},U(Wp,{icon:"x",size:14})))}),i&&U("button",{onClick:c,className:"text-fg-secondary hover:bg-interactive-hover hover:text-fg-primary mb-1.5 ml-1 flex-shrink-0 cursor-pointer rounded p-1.5 transition-colors","aria-label":"Open File",title:"Open File"},U(Wp,{icon:"plus",size:14})))):null}function yF(){var e=Ha().provides,t=pi().translate;return U("div",{className:"bg-bg-app flex h-full w-full items-center justify-center"},U("div",{className:"flex max-w-sm flex-col items-center text-center"},U("div",{className:"bg-accent-light mb-6 rounded-full p-5"},U(Wp,{icon:"file",size:48,className:"text-accent"})),U("h2",{className:"text-fg-primary mb-2 text-xl font-semibold"},t("emptyState.title")),U("p",{className:"text-fg-secondary mb-6 text-sm leading-relaxed"},t("emptyState.description"),U("br",null),t("emptyState.descriptionMulti")),U("button",{onClick:function(){null==e||e.openFileDialog()},className:"bg-accent hover:bg-accent-hover text-accent-fg inline-flex cursor-pointer items-center gap-2 rounded-md px-5 py-2.5 text-sm font-medium shadow-sm transition-all"},U(Wp,{icon:"plus",size:16}),t("emptyState.openButton")),U("p",{className:"text-fg-muted mt-4 text-xs"},t("emptyState.supportedFormats"))))}function DF(e){var t=e.documentState,n=Ha().provides,o=pi().translate,r=_(Ee(""),2),i=r[0],s=r[1],l=_(Ee(!1),2),d=l[0],c=l[1];if(!t)return null;var u=t.name,m=t.errorCode,p=t.passwordProvided,h=m===Ut.Password,g=h&&!p,f=h&&p;if(!h)return U("div",{className:"bg-bg-app flex h-full items-center justify-center p-8"},U("div",{className:"bg-bg-surface border-border-default flex max-w-sm flex-col items-center rounded-xl border p-6 text-center shadow-lg"},U("div",{className:"bg-state-error-light mb-4 rounded-full p-4"},U(Wp,{icon:"alertTriangle",size:28,className:"text-state-error"})),U("h3",{className:"text-fg-primary text-lg font-semibold"},o("documentError.title")),U("p",{className:"text-fg-secondary mt-2 text-sm"},t.error||o("documentError.unknown")),m&&U("p",{className:"text-fg-muted mt-1 text-xs"},o("documentError.errorCode",{params:{code:String(m)}})),U("button",{onClick:function(){return null==n?void 0:n.closeDocument(t.id)},className:"bg-accent hover:bg-accent-hover text-accent-fg mt-5 w-full cursor-pointer rounded-md px-4 py-2.5 text-sm font-medium transition-colors"},o("documentError.close"))));var P=function(){var e=a(F().m(function e(){return F().w(function(e){for(;;)switch(e.n){case 0:if(n&&i.trim()){e.n=1;break}return e.a(2);case 1:c(!0),n.retryDocument(t.id,{password:i}).wait(function(){s(""),c(!1)},function(e){console.error("Retry failed:",e),c(!1)});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return U("div",{className:"bg-bg-app flex h-full items-center justify-center p-8"},U("div",{className:"bg-bg-surface border-border-default w-full max-w-sm rounded-xl border p-6 shadow-lg"},U("div",{className:"flex flex-col items-center text-center"},U("div",{className:"bg-accent-light mb-4 rounded-full p-4"},U(Wp,{icon:"lock",size:28,className:"text-accent"})),U("h3",{className:"text-fg-primary text-lg font-semibold"},o("passwordPrompt.title")),u&&U("p",{className:"text-fg-muted mt-1 text-sm"},u)),U("p",{className:"text-fg-secondary mt-4 text-center text-sm"},g&&o("passwordPrompt.required"),f&&o("passwordPrompt.incorrect")),U("div",{className:"mt-5"},U("label",{className:"text-fg-primary mb-1.5 block text-sm font-medium"},o("passwordPrompt.label")),U("input",{type:"password",value:i,onInput:function(e){return s(e.target.value)},onKeyDown:function(e){return"Enter"===e.key&&!d&&i.trim()&&P()},disabled:d,placeholder:o("passwordPrompt.placeholder"),className:"bg-bg-input border-border-default focus:border-accent focus:ring-accent text-fg-primary placeholder:text-fg-muted block w-full rounded-md border px-3 py-2.5 text-sm focus:outline-none focus:ring-1 disabled:opacity-50",autoFocus:!0})),f&&U("div",{className:"bg-state-error-light border-state-error mt-3 flex items-center gap-2 rounded-md border p-3"},U(Wp,{icon:"alertTriangle",size:16,className:"text-state-error flex-shrink-0"}),U("p",{className:"text-state-error text-sm"},o("passwordPrompt.incorrectWarning"))),U("div",{className:"mt-6 flex gap-3"},U("button",{onClick:function(){return null==n?void 0:n.closeDocument(t.id)},disabled:d,className:"border-border-default text-fg-secondary hover:bg-interactive-hover flex-1 cursor-pointer rounded-md border px-4 py-2.5 text-sm font-medium transition-colors disabled:opacity-50"},o("passwordPrompt.cancel")),U("button",{onClick:P,disabled:d||!i.trim(),className:"bg-accent hover:bg-accent-hover text-accent-fg flex-1 cursor-pointer rounded-md px-4 py-2.5 text-sm font-medium transition-colors disabled:cursor-not-allowed disabled:opacity-50"},o(d?"passwordPrompt.opening":"passwordPrompt.open")))))}function xF(e){var t=e.documentId,n=e.className,o=ti("mode:view",t),r=ti("mode:annotate",t),a=ti("mode:shapes",t),i=ti("mode:redact",t),s=ti("tabs:overflow-menu",t),l=Ie(function(){return[o,r,a,i].find(function(e){return null==e?void 0:e.active})||o},[o,r,a,i]),d=Oe(function(e){e.preventDefault(),e.stopPropagation(),s&&!s.disabled&&s.execute()},[s]);if(!s||!s.visible)return null;var c=s.active;return U("div",{style:{maxWidth:"100px",width:"100px"},className:n},U(Vp,{className:"bg-bg-surface col-start-1 row-start-1 !w-full appearance-none rounded-md py-1.5 pl-3 pr-2 text-[13px] ".concat(c?"bg-interactive-selected ring-accent border-none shadow ring":"border-border-default outline-border-default hover:bg-interactive-hover hover:ring-accent outline outline-1 -outline-offset-1 hover:ring"," flex flex-row items-center justify-between gap-2"),onClick:d,disabled:s.disabled,style:{height:34}},U("span",{className:"min-w-0 flex-1 truncate text-left ".concat(c?"text-accent":"text-fg-primary")},null==l?void 0:l.label),U(Wp,{icon:"chevronDown",className:"h-4 w-4 ".concat(c?"text-accent":"text-fg-secondary")})))}function AF(e){var t=e.documentId,n=Eu().provides,o=_(Ee(!1),2),r=o[0],a=o[1],i=_(Ee(null),2),s=i[0],l=i[1],d=_(Ee(null),2),c=d[0],u=d[1],m=_(Ee(null),2),p=m[0],h=m[1],g=Te(null),f=Te(null),F=pi(t).translate,P=function(){g.current&&(URL.revokeObjectURL(g.current),g.current=null),p&&(URL.revokeObjectURL(p),h(null)),a(!1),l(null),u(null)};return Me(function(){if(n)return n.onCaptureArea(function(e){var t=e.pageIndex,n=e.rect,o=e.blob;l({pageIndex:t,rect:n,blob:o});var r=URL.createObjectURL(o);g.current=r,u(r),a(!0)})},[n]),U(H,null,U(pF,{open:r,onClose:P,title:F("capture.title"),className:"md:w-[48rem]"},U("div",{className:"space-y-6"},U("div",{className:"flex justify-center"},c&&U("img",{src:c,onLoad:function(){g.current&&(URL.revokeObjectURL(g.current),g.current=null)},alt:"Captured PDF area",style:{maxWidth:"100%",maxHeight:"400px",border:"1px solid #e5e7eb",borderRadius:"4px",display:"block"}})),U("div",{className:"border-border-subtle flex justify-end space-x-3 border-t pt-4"},U(Vp,{onClick:P,className:"border-border-default bg-bg-surface text-fg-secondary hover:bg-interactive-hover rounded-md border px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50"},F("capture.cancel")),U(Vp,{onClick:function(){if(s&&f.current){var e=URL.createObjectURL(s.blob);h(e),f.current.href=e,f.current.download="pdf-capture-page-".concat(s.pageIndex+1,".png"),f.current.click(),P()}},disabled:!s,className:"bg-accent text-fg-on-accent hover:!bg-accent-hover flex items-center space-x-2 rounded-md border border-transparent px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-50"},F("capture.download"))))),U("a",{ref:f,style:{display:"none"},href:"",download:""}))}var wF={documentManager:{},commands:{commands:{"zoom:in":{id:"zoom:in",labelKey:"zoom.in",icon:"zoomIn",shortcuts:["Ctrl+=","Meta+=","Ctrl+NumpadAdd","Meta+NumpadAdd"],categories:["zoom","zoom-in"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).zoomIn()}},"zoom:out":{id:"zoom:out",labelKey:"zoom.out",icon:"zoomOut",shortcuts:["Ctrl+-","Meta+-","Ctrl+NumpadSubtract","Meta+NumpadSubtract"],categories:["zoom","zoom-out"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).zoomOut()}},"zoom:fit-page":{id:"zoom:fit-page",labelKey:"zoom.fitPage",icon:"fitToPage",shortcuts:["Ctrl+0","Meta+0"],categories:["zoom","zoom-fit-page"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(hi.FitPage)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)===hi.FitPage}},"zoom:fit-width":{id:"zoom:fit-width",labelKey:"zoom.fitWidth",icon:"fitToWidth",shortcuts:["Ctrl+1","Meta+1"],categories:["zoom","zoom-fit-width"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(hi.FitWidth)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)===hi.FitWidth}},"zoom:marquee":{id:"zoom:marquee",labelKey:"zoom.marquee",icon:"zoomInArea",shortcuts:["Ctrl+M","Meta+M"],categories:["zoom","zoom-marquee"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).toggleMarqueeZoom()},active:function(e){var t,n,o=e.state,r=e.documentId;return null!==(t=null===(n=o.plugins.zoom)||void 0===n||null===(n=n.documents[r])||void 0===n?void 0:n.isMarqueeZoomActive)&&void 0!==t&&t}},"zoom:25":{id:"zoom:25",label:"25%",categories:["zoom","zoom-level","zoom-level-25"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(.25)},active:function(e){var t,n=e.state,o=e.documentId;return.25===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:50":{id:"zoom:50",label:"50%",categories:["zoom","zoom-level","zoom-level-50"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(.5)},active:function(e){var t,n=e.state,o=e.documentId;return.5===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:100":{id:"zoom:100",label:"100%",categories:["zoom","zoom-level","zoom-level-100"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(1)},active:function(e){var t,n=e.state,o=e.documentId;return 1===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:125":{id:"zoom:125",label:"125%",categories:["zoom","zoom-level","zoom-level-125"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(1.25)},active:function(e){var t,n=e.state,o=e.documentId;return 1.25===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:150":{id:"zoom:150",label:"150%",categories:["zoom","zoom-level","zoom-level-150"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(1.5)},active:function(e){var t,n=e.state,o=e.documentId;return 1.5===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:200":{id:"zoom:200",label:"200%",categories:["zoom","zoom-level","zoom-level-200"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(2)},active:function(e){var t,n=e.state,o=e.documentId;return 2===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:400":{id:"zoom:400",label:"400%",categories:["zoom","zoom-level","zoom-level-400"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(4)},active:function(e){var t,n=e.state,o=e.documentId;return 4===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:800":{id:"zoom:800",label:"800%",categories:["zoom","zoom-level","zoom-level-800"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(8)},active:function(e){var t,n=e.state,o=e.documentId;return 8===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:1600":{id:"zoom:1600",label:"1600%",categories:["zoom","zoom-level","zoom-level-1600"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("zoom"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).requestZoom(16)},active:function(e){var t,n=e.state,o=e.documentId;return 16===(null===(t=n.plugins.zoom)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.zoomLevel)}},"zoom:toggle-menu":{id:"zoom:toggle-menu",labelKey:"zoom.menu",icon:"chevronDown",iconProps:{className:"h-3.5 w-3.5"},categories:["zoom","zoom-menu"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).toggleMenu("zoom-menu","zoom:toggle-menu","zoom-menu-button")},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["zoom-menu"])}},"zoom:toggle-menu-mobile":{id:"zoom:toggle-menu-mobile",labelKey:"zoom.menu",icon:"zoomIn",categories:["zoom","zoom-menu"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).toggleMenu("zoom-menu","zoom:toggle-menu-mobile","zoom-menu-button")},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["zoom-menu"])}},"pan:toggle":{id:"pan:toggle",labelKey:"pan.toggle",icon:"hand",shortcuts:["h"],categories:["tools","pan"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("pan"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).togglePan()},active:function(e){var t,n,o=e.state,r=e.documentId;return null!==(t=null===(n=o.plugins.pan)||void 0===n||null===(n=n.documents[r])||void 0===n?void 0:n.isPanMode)&&void 0!==t&&t}},"pointer:toggle":{id:"pointer:toggle",labelKey:"pointer.toggle",icon:"pointer",shortcuts:["p"],categories:["tools","pointer"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("interaction-manager"))||void 0===t?void 0:t.provides();r&&r.forDocument(o).activate("pointerMode")},active:function(e){var t,n=e.state,o=e.documentId;return"pointerMode"===(null===(t=n.plugins["interaction-manager"])||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.activeMode)}},"left-action-menu:overflow-menu":{id:"left-action-menu:overflow-menu",labelKey:"menu.moreOptions",icon:"dots",categories:["ui","ui-menu"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.toggleMenu("left-action-menu","left-action-menu:overflow-menu","overflow-left-action-menu-button",o)},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["left-action-menu"])}},"capture:screenshot":{id:"capture:screenshot",labelKey:"capture.screenshot",icon:"screenshot",shortcuts:["Ctrl+Shift+S","Meta+Shift+S"],categories:["tools","capture","capture-screenshot"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("capture"))||void 0===t?void 0:t.provides();if(r){var a=r.forDocument(o);a.isMarqueeCaptureActive()?a.disableMarqueeCapture():a.enableMarqueeCapture()}},active:function(e){var t,n=e.state,o=e.documentId;return"marqueeCapture"===(null===(t=n.plugins["interaction-manager"].documents[o])||void 0===t?void 0:t.activeMode)}},"document:menu":{id:"document:menu",labelKey:"document.menu",icon:"menu",categories:["document","document-menu"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).toggleMenu("document-menu","document:menu","document-menu-button")}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["document-menu"])}},"document:open":{id:"document:open",labelKey:"document.open",icon:"fileImport",shortcuts:["Ctrl+O","Meta+O"],categories:["document","document-open"],action:function(e){var t,n=null===(t=e.registry.getPlugin("document-manager"))||void 0===t?void 0:t.provides();null==n||n.openFileDialog()}},"document:close":{id:"document:close",labelKey:"document.close",icon:"x",shortcuts:["Ctrl+W","Meta+W"],categories:["document","document-close"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("document-manager"))||void 0===t?void 0:t.provides();null==r||r.closeDocument(o)}},"document:print":{id:"document:print",labelKey:"document.print",icon:"print",shortcuts:["Ctrl+P","Meta+P"],categories:["document","document-print"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).openModal("print-modal")}}},"document:export":{id:"document:export",labelKey:"document.export",icon:"download",categories:["document","document-export"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("export"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).download()}},"document:capture":{id:"document:capture",labelKey:"capture.screenshot",icon:"screenshot",categories:["document","document-capture"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("capture"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).toggleMarqueeCapture()},active:function(e){var t,n=e.state,o=e.documentId;return"marqueeCapture"===(null===(t=n.plugins["interaction-manager"])||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.activeMode)}},"document:fullscreen":{id:"document:fullscreen",labelKey:"document.fullscreen",icon:function(e){var t;return null!==(t=e.state.plugins.fullscreen)&&void 0!==t&&t.isFullscreen?"fullscreenExit":"fullscreen"},shortcuts:["F11"],categories:["document","document-fullscreen"],action:function(e){var t,n=null===(t=e.registry.getPlugin("fullscreen"))||void 0===t?void 0:t.provides();n&&(n.isFullscreen()?n.exitFullscreen():n.enableFullscreen())},active:function(e){var t,n;return null!==(t=null===(n=e.state.plugins.fullscreen)||void 0===n?void 0:n.isFullscreen)&&void 0!==t&&t}},"panel:toggle-sidebar":{id:"panel:toggle-sidebar",labelKey:"panel.sidebar",icon:"sidebar",categories:["panel","panel-sidebar"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).toggleSidebar("left","main","sidebar-panel")}},active:function(e){var t=e.state,n=e.documentId;return va(t.plugins,n,"left","main","sidebar-panel")}},"panel:toggle-search":{id:"panel:toggle-search",labelKey:"panel.search",icon:"search",shortcuts:["Ctrl+F","Meta+F"],categories:["panel","panel-search"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).toggleSidebar("right","main","search-panel")}},active:function(e){var t=e.state,n=e.documentId;return va(t.plugins,n,"right","main","search-panel")}},"panel:toggle-comment":{id:"panel:toggle-comment",labelKey:"panel.comment",icon:"comment",categories:["panel","panel-comment"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).toggleSidebar("right","main","comment-panel")}},active:function(e){var t=e.state,n=e.documentId;return va(t.plugins,n,"right","main","comment-panel")}},"panel:toggle-annotation-style":{id:"panel:toggle-annotation-style",labelKey:"panel.annotationStyle",icon:"palette",categories:["panel","panel-annotation-style"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).toggleSidebar("left","main","annotation-panel")}},active:function(e){var t=e.state,n=e.documentId;return va(t.plugins,n,"left","main","annotation-panel")}},"page:settings":{id:"page:settings",labelKey:"page.settings",icon:"viewSettings",categories:["page","page-settings"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin(Pr);if(o&&o.provides){var r=o.provides();r&&r.forDocument(n).toggleMenu("page-settings-menu","page:settings","page-settings-button")}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["page-settings-menu"])}},"spread:none":{id:"spread:none",labelKey:"page.single",icon:"singlePage",categories:["page","spread","spread-none"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("spread"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).setSpreadMode(ir.None)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.spread)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.spreadMode)===ir.None}},"spread:odd":{id:"spread:odd",labelKey:"page.twoOdd",icon:"doublePage",categories:["page","spread","spread-odd"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("spread"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).setSpreadMode(ir.Odd)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.spread)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.spreadMode)===ir.Odd}},"spread:even":{id:"spread:even",labelKey:"page.twoEven",icon:"book2",categories:["page","spread","spread-even"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("spread"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).setSpreadMode(ir.Even)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.spread)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.spreadMode)===ir.Even}},"rotate:clockwise":{id:"rotate:clockwise",labelKey:"rotate.clockwise",icon:"rotateClockwise",shortcuts:["Ctrl+]","Meta+]"],categories:["page","rotate","rotate-clockwise"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("rotate"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).rotateForward()}},"rotate:counter-clockwise":{id:"rotate:counter-clockwise",labelKey:"rotate.counterClockwise",icon:"rotateCounterClockwise",shortcuts:["Ctrl+[","Meta+["],categories:["page","rotate","rotate-counter-clockwise"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("rotate"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).rotateBackward()}},"scroll:vertical":{id:"scroll:vertical",labelKey:"page.vertical",icon:"vertical",categories:["page","scroll","scroll-vertical"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("scroll"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).setScrollStrategy(Uo.Vertical)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.scroll)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.strategy)===Uo.Vertical}},"scroll:horizontal":{id:"scroll:horizontal",labelKey:"page.horizontal",icon:"horizontal",categories:["page","scroll","scroll-horizontal"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("scroll"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).setScrollStrategy(Uo.Horizontal)},active:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.scroll)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.strategy)===Uo.Horizontal}},"scroll:next-page":{id:"scroll:next-page",labelKey:"page.next",icon:"chevronRight",categories:["page","navigation","navigation-next"],shortcuts:["Ctrl+]","Meta+]","ArrowRight"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("scroll"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).scrollToNextPage()},disabled:function(e){var t,n,o=e.state,r=e.documentId;return(null===(t=o.plugins.scroll)||void 0===t||null===(t=t.documents[r])||void 0===t?void 0:t.currentPage)>=(null===(n=o.plugins.scroll)||void 0===n||null===(n=n.documents[r])||void 0===n?void 0:n.totalPages)}},"scroll:previous-page":{id:"scroll:previous-page",labelKey:"page.previous",icon:"chevronLeft",categories:["page","navigation","navigation-previous"],shortcuts:["Ctrl+[","Meta+[","ArrowLeft"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("scroll"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).scrollToPreviousPage()},disabled:function(e){var t,n=e.state,o=e.documentId;return(null===(t=n.plugins.scroll)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.currentPage)<=1}},"mode:view":{id:"mode:view",labelKey:"mode.view",categories:["mode","mode-view"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin("ui"))||void 0===t?void 0:t.provides(),i=null===(n=o.getPlugin("interaction-manager"))||void 0===n?void 0:n.provides();if(a&&i){var s=i.forDocument(r);s&&(s.activate("pointerMode"),a.forDocument(r).closeToolbarSlot("top","secondary"))}},active:function(e){var t=e.state,n=e.documentId;return!_a(t.plugins,n,"top","secondary")}},"mode:annotate":{id:"mode:annotate",labelKey:"mode.annotate",categories:["mode","mode-annotate","annotation"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.setActiveToolbar("top","secondary","annotation-toolbar",o)},active:function(e){var t=e.state,n=e.documentId;return _a(t.plugins,n,"top","secondary","annotation-toolbar")}},"mode:shapes":{id:"mode:shapes",labelKey:"mode.shapes",categories:["mode","mode-shapes","annotation"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.setActiveToolbar("top","secondary","shapes-toolbar",o)},active:function(e){var t=e.state,n=e.documentId;return _a(t.plugins,n,"top","secondary","shapes-toolbar")}},"mode:redact":{id:"mode:redact",labelKey:"mode.redact",categories:["mode","mode-redact","redaction"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.setActiveToolbar("top","secondary","redaction-toolbar",o)},active:function(e){var t=e.state,n=e.documentId;return _a(t.plugins,n,"top","secondary","redaction-toolbar")}},"tabs:overflow-menu":{id:"tabs:overflow-menu",labelKey:"tabs.overflowMenu",icon:"dots",categories:["ui","ui-menu"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();r&&r.toggleMenu("mode-tabs-overflow-menu","tabs:overflow-menu","overflow-tabs-button",o)},active:function(e){var t,n=e.state,o=e.documentId;return void 0!==(null===(t=n.plugins.ui)||void 0===t||null===(t=t.documents[o])||void 0===t?void 0:t.openMenus["mode-tabs-overflow-menu"])}},"annotation:add-highlight":{id:"annotation:add-highlight",labelKey:"annotation.highlight",icon:"highlight",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"highlight"))||void 0===t?void 0:t.color}},categories:["annotation","annotation-markup","annotation-highlight"],action:function(e){var t,n,o,r=e.registry,a=e.documentId,i=null===(t=r.getPlugin(Sl))||void 0===t?void 0:t.provides(),s=null===(n=r.getPlugin(hs))||void 0===n?void 0:n.provides(),l=null===(o=r.getPlugin("ui"))||void 0===o?void 0:o.provides();if(s&&i&&l){var c=null==i?void 0:i.forDocument(a),u=null==s?void 0:s.forDocument(a);if(c&&u){var m=i.getTool("highlight");if(m&&$d(m)){var p=m.defaults,h=u.getFormattedSelection(),g=u.getSelectedText();if(h.length>0){var f,F=d(h);try{var P=function(){var e=f.value;g.wait(function(t){var n=_n();c.createAnnotation(e.pageIndex,{id:n,created:new Date,flags:["print"],type:Et.HIGHLIGHT,blendMode:At.Multiply,color:p.color,opacity:p.opacity,pageIndex:e.pageIndex,rect:e.rect,segmentRects:e.segmentRects,custom:{text:t.join("\n")}}),c.selectAnnotation(e.pageIndex,n)},yn)};for(F.s();!(f=F.n()).done;)P()}catch(e){F.e(e)}finally{F.f()}u.clear(),c.setActiveTool("highlight"),l.setActiveToolbar("top","secondary","annotation-toolbar",a)}else{var b;"highlight"===(null===(b=c.getActiveTool())||void 0===b?void 0:b.id)?c.setActiveTool(null):c.setActiveTool("highlight")}}}}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"highlight"===(null==r?void 0:r.activeToolId)}},"annotation:add-underline":{id:"annotation:add-underline",labelKey:"annotation.underline",icon:"underline",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"underline"))||void 0===t?void 0:t.color}},categories:["annotation","annotation-markup","annotation-underline"],action:function(e){var t,n,o,r=e.registry,a=e.documentId,i=null===(t=r.getPlugin(Sl))||void 0===t?void 0:t.provides(),s=null===(n=r.getPlugin(hs))||void 0===n?void 0:n.provides(),l=null===(o=r.getPlugin("ui"))||void 0===o?void 0:o.provides();if(s&&i&&l){var c=null==i?void 0:i.forDocument(a),u=null==s?void 0:s.forDocument(a);if(c&&u){var m=i.getTool("underline");if(m&&Wd(m)){var p=m.defaults,h=u.getFormattedSelection(),g=u.getSelectedText();if(h.length>0){var f,F=d(h);try{var P=function(){var e=f.value;g.wait(function(t){var n=_n();c.createAnnotation(e.pageIndex,{id:n,created:new Date,flags:["print"],type:Et.UNDERLINE,color:p.color,opacity:p.opacity,pageIndex:e.pageIndex,rect:e.rect,segmentRects:e.segmentRects,custom:{text:t.join("\n")}}),c.selectAnnotation(e.pageIndex,n)},yn)};for(F.s();!(f=F.n()).done;)P()}catch(e){F.e(e)}finally{F.f()}u.clear(),c.setActiveTool("underline"),l.setActiveToolbar("top","secondary","annotation-toolbar",a)}else{var b;"underline"===(null===(b=c.getActiveTool())||void 0===b?void 0:b.id)?c.setActiveTool(null):c.setActiveTool("underline")}}}}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"underline"===(null==r?void 0:r.activeToolId)}},"annotation:add-strikeout":{id:"annotation:add-strikeout",labelKey:"annotation.strikeout",icon:"strikethrough",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"strikeout"))||void 0===t?void 0:t.color}},categories:["annotation","annotation-markup","annotation-strikeout"],action:function(e){var t,n,o,r=e.registry,a=e.documentId,i=null===(t=r.getPlugin(Sl))||void 0===t?void 0:t.provides(),s=null===(n=r.getPlugin(hs))||void 0===n?void 0:n.provides(),l=null===(o=r.getPlugin("ui"))||void 0===o?void 0:o.provides();if(s&&i&&l){var c=null==i?void 0:i.forDocument(a),u=null==s?void 0:s.forDocument(a);if(c&&u){var m=i.getTool("strikeout");if(m&&Hd(m)){var p=m.defaults,h=u.getFormattedSelection(),g=u.getSelectedText();if(h.length>0){var f,F=d(h);try{var P=function(){var e=f.value;g.wait(function(t){var n=_n();c.createAnnotation(e.pageIndex,{id:n,created:new Date,flags:["print"],type:Et.STRIKEOUT,color:p.color,opacity:p.opacity,pageIndex:e.pageIndex,rect:e.rect,segmentRects:e.segmentRects,custom:{text:t.join("\n")}}),c.selectAnnotation(e.pageIndex,n)},yn)};for(F.s();!(f=F.n()).done;)P()}catch(e){F.e(e)}finally{F.f()}u.clear(),c.setActiveTool("strikeout"),l.setActiveToolbar("top","secondary","annotation-toolbar",a)}else{var b;"strikeout"===(null===(b=c.getActiveTool())||void 0===b?void 0:b.id)?c.setActiveTool(null):c.setActiveTool("strikeout")}}}}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"strikeout"===(null==r?void 0:r.activeToolId)}},"annotation:add-squiggly":{id:"annotation:add-squiggly",labelKey:"annotation.squiggly",icon:"squiggly",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"squiggly"))||void 0===t?void 0:t.color}},categories:["annotation","annotation-markup","annotation-squiggly"],action:function(e){var t,n,o,r=e.registry,a=e.documentId,i=null===(t=r.getPlugin(Sl))||void 0===t?void 0:t.provides(),s=null===(n=r.getPlugin(hs))||void 0===n?void 0:n.provides(),l=null===(o=r.getPlugin("ui"))||void 0===o?void 0:o.provides();if(s&&i&&l){var c=null==i?void 0:i.forDocument(a),u=null==s?void 0:s.forDocument(a);if(c&&u){var m=i.getTool("squiggly");if(m&&Ud(m)){var p=m.defaults,h=u.getFormattedSelection(),g=u.getSelectedText();if(h.length>0){var f,F=d(h);try{var P=function(){var e=f.value;g.wait(function(t){var n=_n();c.createAnnotation(e.pageIndex,{id:n,created:new Date,flags:["print"],type:Et.SQUIGGLY,color:p.color,opacity:p.opacity,pageIndex:e.pageIndex,rect:e.rect,segmentRects:e.segmentRects,custom:{text:t.join("\n")}}),c.selectAnnotation(e.pageIndex,n)},yn)};for(F.s();!(f=F.n()).done;)P()}catch(e){F.e(e)}finally{F.f()}u.clear(),c.setActiveTool("squiggly"),l.setActiveToolbar("top","secondary","annotation-toolbar",a)}else{var b;"squiggly"===(null===(b=c.getActiveTool())||void 0===b?void 0:b.id)?c.setActiveTool(null):c.setActiveTool("squiggly")}}}}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"squiggly"===(null==r?void 0:r.activeToolId)}},"annotation:add-ink":{id:"annotation:add-ink",labelKey:"annotation.ink",icon:"pencilMarker",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"ink"))||void 0===t?void 0:t.color}},categories:["annotation","annotation-ink"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("ink"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("ink"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"ink"===(null==r?void 0:r.activeToolId)}},"annotation:add-text":{id:"annotation:add-text",labelKey:"annotation.text",icon:"text",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"freeText"))||void 0===t?void 0:t.fontColor}},categories:["annotation","annotation-text"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("freeText"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("freeText"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"freeText"===(null==r?void 0:r.activeToolId)}},"annotation:add-stamp":{id:"annotation:add-stamp",labelKey:"annotation.stamp",icon:"photo",categories:["annotation","annotation-stamp"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("stamp"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("stamp"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"stamp"===(null==r?void 0:r.activeToolId)}},"annotation:add-rectangle":{id:"annotation:add-rectangle",labelKey:"annotation.rectangle",icon:"square",iconProps:function(e){var t,n,o=e.state;return{primaryColor:null===(t=md(o.plugins.annotation,"square"))||void 0===t?void 0:t.strokeColor,secondaryColor:null===(n=md(o.plugins.annotation,"square"))||void 0===n?void 0:n.color}},categories:["annotation","annotation-shape","annotation-rectangle"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("square"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("square"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"square"===(null==r?void 0:r.activeToolId)}},"annotation:add-circle":{id:"annotation:add-circle",labelKey:"annotation.circle",icon:"circle",iconProps:function(e){var t,n,o=e.state;return{primaryColor:null===(t=md(o.plugins.annotation,"circle"))||void 0===t?void 0:t.strokeColor,secondaryColor:null===(n=md(o.plugins.annotation,"circle"))||void 0===n?void 0:n.color}},categories:["annotation","annotation-shape","annotation-circle"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("circle"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("circle"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"circle"===(null==r?void 0:r.activeToolId)}},"annotation:add-line":{id:"annotation:add-line",labelKey:"annotation.line",icon:"line",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"line"))||void 0===t?void 0:t.strokeColor}},categories:["annotation","annotation-shape","annotation-line"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("line"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("line"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"line"===(null==r?void 0:r.activeToolId)}},"annotation:add-arrow":{id:"annotation:add-arrow",labelKey:"annotation.arrow",icon:"lineArrow",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"line"))||void 0===t?void 0:t.strokeColor}},categories:["annotation","annotation-shape","annotation-arrow"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("lineArrow"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("lineArrow"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"lineArrow"===(null==r?void 0:r.activeToolId)}},"annotation:add-polygon":{id:"annotation:add-polygon",labelKey:"annotation.polygon",icon:"polygon",iconProps:function(e){var t,n,o=e.state;return{primaryColor:null===(t=md(o.plugins.annotation,"polygon"))||void 0===t?void 0:t.strokeColor,secondaryColor:null===(n=md(o.plugins.annotation,"polygon"))||void 0===n?void 0:n.color}},categories:["annotation","annotation-shape","annotation-polygon"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("polygon"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("polygon"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"polygon"===(null==r?void 0:r.activeToolId)}},"annotation:add-polyline":{id:"annotation:add-polyline",labelKey:"annotation.polyline",icon:"zigzag",iconProps:function(e){var t;return{primaryColor:null===(t=md(e.state.plugins.annotation,"polyline"))||void 0===t?void 0:t.strokeColor}},categories:["annotation","annotation-shape","annotation-polyline"],action:function(e){var t,n,o=e.registry,r=e.documentId,a=null===(t=o.getPlugin(Sl))||void 0===t?void 0:t.provides(),i=null==a?void 0:a.forDocument(r);i&&("polyline"===(null===(n=i.getActiveTool())||void 0===n?void 0:n.id)?i.setActiveTool(null):i.setActiveTool("polyline"))},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Sl])||void 0===t?void 0:t.documents[o];return"polyline"===(null==r?void 0:r.activeToolId)}},"annotation:delete-selected":{id:"annotation:delete-selected",labelKey:"annotation.deleteSelected",icon:"trash",categories:["annotation","annotation-delete"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin(Sl))||void 0===t?void 0:t.provides(),a=null==r?void 0:r.forDocument(o);if(a){var i=a.getSelectedAnnotation();i&&a.deleteAnnotation(i.object.pageIndex,i.object.id)}}},"annotation:overflow-tools":{id:"annotation:overflow-tools",labelKey:"annotation.moreTools",icon:"dots",categories:["annotation","annotation-overflow"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();if(r){var a=r.forDocument(o);a&&a.toggleMenu("annotation-tools-menu","annotation:overflow-tools","overflow-annotation-tools")}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["annotation-tools-menu"])}},"annotation:overflow-shapes":{id:"annotation:overflow-shapes",labelKey:"annotation.moreTools",icon:"dots",categories:["annotation","annotation-shape","annotation-overflow"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("ui"))||void 0===t?void 0:t.provides();if(r){var a=r.forDocument(o);a&&a.toggleMenu("shapes-tools-menu","annotation:overflow-shapes","overflow-shapes-tools")}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins.ui)||void 0===t?void 0:t.documents[o];return void 0!==(null==r?void 0:r.openMenus["shapes-tools-menu"])}},"redaction:redact-area":{id:"redaction:redact-area",labelKey:"redaction.area",icon:"redactArea",categories:["redaction","redaction-area"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("redaction"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).toggleMarqueeRedact()},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[am])||void 0===t?void 0:t.documents[o];return(null==r?void 0:r.activeType)===ju.MarqueeRedact}},"redaction:redact-text":{id:"redaction:redact-text",labelKey:"redaction.text",icon:"redact",categories:["redaction","redaction-text"],action:function(e){var t,n,o,r,a=e.registry,i=e.documentId,s=null===(t=a.getPlugin("redaction"))||void 0===t?void 0:t.provides(),l=null===(n=a.getPlugin(hs))||void 0===n?void 0:n.provides(),d=null===(o=a.getPlugin("ui"))||void 0===o?void 0:o.provides();if(s&&l&&d){var c=s.forDocument(i),u=null==l?void 0:l.forDocument(i);(null!==(r=null==u?void 0:u.getFormattedSelection())&&void 0!==r?r:[]).length>0?(c.queueCurrentSelectionAsPending(),d.setActiveToolbar("top","secondary","redaction-toolbar",i)):c.toggleRedactSelection()}},active:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[am])||void 0===t?void 0:t.documents[o];return(null==r?void 0:r.activeType)===ju.RedactSelection}},"redaction:apply-all":{id:"redaction:apply-all",labelKey:"redaction.applyAll",icon:"check",categories:["redaction","redaction-apply"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("redaction"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).commitAllPending()},disabled:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[am])||void 0===t?void 0:t.documents[o];return 0===(null==r?void 0:r.pendingCount)}},"redaction:clear-all":{id:"redaction:clear-all",labelKey:"redaction.clearAll",icon:"x",categories:["redaction","redaction-clear"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("redaction"))||void 0===t?void 0:t.provides();null==r||r.forDocument(o).clearPending()},disabled:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[am])||void 0===t?void 0:t.documents[o];return 0===(null==r?void 0:r.pendingCount)}},"redaction:delete-selected":{id:"redaction:delete-selected",labelKey:"redaction.deleteSelected",icon:"trash",categories:["redaction","redaction-delete"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("redaction"))||void 0===t?void 0:t.provides(),a=null==r?void 0:r.forDocument(o).getSelectedPending();a&&(null==r||r.forDocument(o).removePending(a.page,a.id))}},"redaction:commit-selected":{id:"redaction:commit-selected",labelKey:"redaction.commitSelected",icon:"check",categories:["redaction","redaction-commit"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin("redaction"))||void 0===t?void 0:t.provides(),a=null==r?void 0:r.forDocument(o).getSelectedPending();a&&(null==r||r.forDocument(o).commitPending(a.page,a.id))}},"selection:copy-to-clipboard":{id:"selection:copy-to-clipboard",labelKey:"selection.copyToClipboard",icon:"copy",shortcuts:["Ctrl+C","Meta+C"],categories:["selection","selection-copy-to-clipboard"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin("selection"),r=null==o?void 0:o.provides().forDocument(n);null==r||r.copyToClipboard()}},"selection:copy":{id:"selection:copy",labelKey:"selection.copy",icon:"copy",categories:["selection","selection-copy"],action:function(e){var t=e.registry,n=e.documentId,o=t.getPlugin("selection"),r=null==o?void 0:o.provides().forDocument(n);null==r||r.copyToClipboard(),null==r||r.clear()}},"history:undo":{id:"history:undo",labelKey:"history.undo",icon:"arrowBackUp",shortcuts:["Ctrl+Z","Meta+Z"],categories:["history","history-undo"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin(Mu))||void 0===t?void 0:t.provides();r&&r.forDocument(o).undo()},disabled:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Mu])||void 0===t?void 0:t.documents[o];return!(null!=r&&r.global.canUndo)}},"history:redo":{id:"history:redo",labelKey:"history.redo",icon:"arrowForwardUp",shortcuts:["Ctrl+Y","Meta+Shift+Z"],categories:["history","history-redo"],action:function(e){var t,n=e.registry,o=e.documentId,r=null===(t=n.getPlugin(Mu))||void 0===t?void 0:t.provides();r&&r.forDocument(o).redo()},disabled:function(e){var t,n=e.state,o=e.documentId,r=null===(t=n.plugins[Mu])||void 0===t?void 0:t.documents[o];return!(null!=r&&r.global.canRedo)}}}},i18n:{defaultLocale:"en",locales:[{code:"en",name:"English",translations:{search:{placeholder:"Search",caseSensitive:"Case sensitive",wholeWord:"Whole word",resultsFound:"{count} results found",page:"Page {page}"},zoom:{in:"Zoom In",out:"Zoom Out",fitWidth:"Fit to Width",fitPage:"Fit to Page",marquee:"Marquee Zoom",menu:"Zoom Menu",level:"Zoom Level ({level}%)",dragTip:"Drag to select area to zoom"},pan:{toggle:"Toggle Pan Mode"},pointer:{toggle:"Toggle Pointer Mode"},capture:{screenshot:"Screenshot",dragTip:"Drag to select area to capture",title:"Screenshot Preview",download:"Download",cancel:"Cancel"},document:{menu:"Document Menu",open:"Open",close:"Close",print:"Print",export:"Export",fullscreen:"Fullscreen",loading:"Loading document..."},emptyState:{title:"No Documents Open",description:"Open a PDF document to get started.",descriptionMulti:"You can view multiple documents using tabs.",openButton:"Open Document",supportedFormats:"Supported format: PDF"},passwordPrompt:{title:"Password Required",required:"This document is password protected. Please enter the password to open it.",incorrect:"The password you entered was incorrect. Please try again.",incorrectWarning:"Incorrect password. Please check and try again.",label:"Password",placeholder:"Enter document password",open:"Open",opening:"Opening...",cancel:"Cancel",close:"Close"},documentError:{title:"Error loading document",unknown:"An unknown error occurred",errorCode:"Error Code: {code}",close:"Close Document"},panel:{sidebar:"Sidebar",search:"Search",comment:"Comment",thumbnails:"Thumbnails",outline:"Outline",annotationStyle:"Annotation Style"},menu:{viewControls:"View Controls",zoomControls:"Zoom Controls",moreOptions:"More Options"},outline:{title:"Outline",loading:"Loading outline...",noOutline:"No outline available",noBookmarks:"This document doesn't contain bookmarks"},page:{settings:"Page Settings",single:"Single Page",twoOdd:"Two Page (Odd)",twoEven:"Two Page (Even)",vertical:"Vertical",horizontal:"Horizontal",spreadMode:"Spread Mode",scrollLayout:"Scroll Layout",rotation:"Page Rotation",next:"Next Page",previous:"Previous Page"},rotate:{clockwise:"Rotate Clockwise",counterClockwise:"Rotate Counter-Clockwise"},selection:{copy:"Copy Selection"},mode:{view:"View",annotate:"Annotate",shapes:"Shapes",redact:"Redact"},annotation:{text:"Text",highlight:"Highlight",strikeout:"Strikethrough",underline:"Underline",squiggly:"Squiggly",rectangle:"Rectangle",circle:"Circle",line:"Line",arrow:"Arrow",polygon:"Polygon",polyline:"Polyline",ink:"Ink",stamp:"Stamp",freeText:"Free Text",square:"Square",styles:"{type} Styles",defaults:"{type} Defaults",color:"Color",opacity:"Opacity",blendMode:"Blend mode",strokeWidth:"Stroke width",strokeColor:"Stroke color",borderStyle:"Border style",fillColor:"Fill color",fontSize:"Font size",fontFamily:"Font",textAlign:"Text alignment",verticalAlign:"Vertical alignment",lineEnding:"Line ending",lineStart:"Line start",lineEnd:"Line end",font:"Font",fontColor:"Font color",backgroundColor:"Background color",noStyles:"There are no styles for this annotation.",noStylesStamp:"There are no styles for stamps.",selectAnnotation:"Select an annotation to see styles",deleteSelected:"Delete selected annotation",moreTools:"More Tools"},redaction:{area:"Redact Area",text:"Redact Text",applyAll:"Apply All",clearAll:"Clear All",deleteSelected:"Delete selected redaction",commitSelected:"Apply selected redaction"},history:{undo:"Undo",redo:"Redo"},comments:{page:"Page {page}",commentCount:"{count} comment",commentCountPlural:"{count} comments",addComment:"Add comment...",addReply:"Add reply...",save:"Save",cancel:"Cancel",edit:"Edit",delete:"Delete",showMore:"more",showLess:"less",emptyState:"Add annotations to be able to comment on them."},blendMode:{normal:"Normal",multiply:"Multiply",screen:"Screen",overlay:"Overlay",darken:"Darken",lighten:"Lighten",colorDodge:"Color Dodge",colorBurn:"Color Burn",hardLight:"Hard Light",softLight:"Soft Light",difference:"Difference",exclusion:"Exclusion",hue:"Hue",saturation:"Saturation",color:"Color",luminosity:"Luminosity"},print:{title:"Print Settings",loading:"Preparing document...",pages:"Pages to print",all:"All pages",current:"Current page ({currentPage})",specify:"Specify pages",specifyEG:"e.g., 1-3, 5, 8-10",total:"Total pages in document: {totalPages}",annotation:"Include annotations",printing:"Printing...",print:"Print",cancel:"Cancel"}}},{code:"nl",name:"Nederlands",translations:{search:{placeholder:"Zoeken",caseSensitive:"Hoofdlettergevoelig",wholeWord:"Heel woord",resultsFound:"{count} resultaten gevonden",page:"Pagina {page}"},zoom:{in:"Inzoomen",out:"Uitzoomen",fitWidth:"Aanbreedte aanpassen",fitPage:"Aan pagina aanpassen",marquee:"Lijstzoom",menu:"Zoommenu",level:"Zoomniveau ({level}%)",dragTip:"Drag to select area to zoom"},pan:{toggle:"Pan-modus wisselen"},pointer:{toggle:"Aanwijzermodus wisselen"},capture:{screenshot:"Schermafbeelding",dragTip:"Sleep om een gebied te selecteren om vast te leggen",title:"Screenshot voorbeeld",download:"Downloaden",cancel:"Annuleren"},document:{menu:"Documentmenu",open:"Openen",close:"Sluiten",print:"Afdrukken",export:"Exporteren",fullscreen:"Volledig scherm",loading:"Document laden..."},emptyState:{title:"Geen documenten geopend",description:"Open een PDF-document om te beginnen.",descriptionMulti:"U kunt meerdere documenten bekijken met tabs.",openButton:"Document openen",supportedFormats:"Ondersteund formaat: PDF"},passwordPrompt:{title:"Wachtwoord vereist",required:"Dit document is beveiligd met een wachtwoord. Voer het wachtwoord in om te openen.",incorrect:"Het ingevoerde wachtwoord was onjuist. Probeer het opnieuw.",incorrectWarning:"Onjuist wachtwoord. Controleer en probeer opnieuw.",label:"Wachtwoord",placeholder:"Voer documentwachtwoord in",open:"Openen",opening:"Openen...",cancel:"Annuleren",close:"Sluiten"},documentError:{title:"Fout bij laden van document",unknown:"Er is een onbekende fout opgetreden",errorCode:"Foutcode: {code}",close:"Document sluiten"},panel:{sidebar:"Zijbalk",search:"Zoeken",comment:"Opmerking",thumbnails:"Miniaturen",outline:"Overzicht",annotationStyle:"Annotatiestijl"},menu:{viewControls:"Weergave-instellingen",zoomControls:"Zoom-instellingen",moreOptions:"Meer opties"},outline:{title:"Overzicht",loading:"Overzicht laden...",noOutline:"Geen overzicht beschikbaar",noBookmarks:"Dit document bevat geen bladwijzers"},page:{settings:"Pagina-instellingen",single:"Enkele pagina",twoOdd:"Twee pagina's (Oneven)",twoEven:"Twee pagina's (Even)",vertical:"Verticaal",horizontal:"Horizontaal",spreadMode:"Spreidingsmodus",scrollLayout:"Scrollindeling",rotation:"Paginarotatie",next:"Volgende pagina",previous:"Vorige pagina"},rotate:{clockwise:"Met de klok mee draaien",counterClockwise:"Tegen de klok in draaien"},selection:{copy:"Selectie kopiëren"},mode:{view:"Weergave",annotate:"Annoteren",shapes:"Vormen",redact:"Redigeren"},annotation:{text:"Tekst",highlight:"Markeren",strikeout:"Doorhalen",underline:"Onderstrepen",squiggly:"Golflijn",rectangle:"Rechthoek",circle:"Cirkel",line:"Lijn",arrow:"Pijl",polygon:"Veelhoek",polyline:"Polylijn",ink:"Inkt",stamp:"Stempel",freeText:"Vrije tekst",square:"Vierkant",styles:"{type} stijlen",defaults:"{type} standaardwaarden",color:"Kleur",opacity:"Dekking",blendMode:"Overvloeimodus",strokeWidth:"Lijndikte",strokeColor:"Lijnkleur",borderStyle:"Randstijl",fillColor:"Vulkleur",fontSize:"Lettergrootte",fontFamily:"Lettertype",textAlign:"Tekstuitlijning",verticalAlign:"Verticale uitlijning",lineEnding:"Lijneinde",lineStart:"Lijnbegin",lineEnd:"Lijneinde",font:"Lettertype",fontColor:"Tekstkleur",backgroundColor:"Achtergrondkleur",noStyles:"Er zijn geen stijlen voor deze annotatie.",noStylesStamp:"Er zijn geen stijlen voor stempels.",selectAnnotation:"Selecteer een annotatie om stijlen te zien",deleteSelected:"Geselecteerde annotatie verwijderen",moreTools:"Meer gereedschappen"},redaction:{area:"Gebied redigeren",text:"Tekst redigeren",applyAll:"Alles toepassen",clearAll:"Alles wissen",deleteSelected:"Geselecteerde redactie verwijderen",commitSelected:"Geselecteerde redactie toepassen"},history:{undo:"Ongedaan maken",redo:"Opnieuw doen"},comments:{page:"Pagina {page}",commentCount:"{count} opmerking",commentCountPlural:"{count} opmerkingen",addComment:"Opmerking toevoegen...",addReply:"Antwoord toevoegen...",save:"Opslaan",cancel:"Annuleren",edit:"Bewerken",delete:"Verwijderen",showMore:"meer",showLess:"minder",emptyState:"Voeg annotaties toe om erop te kunnen reageren."},blendMode:{normal:"Normaal",multiply:"Vermenigvuldigen",screen:"Bleken",overlay:"Bedekken",darken:"Donkerder",lighten:"Lichter",colorDodge:"Kleur tegenhouden",colorBurn:"Kleur doordrukken",hardLight:"Hard licht",softLight:"Zacht licht",difference:"Verschil",exclusion:"Uitsluiting",hue:"Kleurtoon",saturation:"Verzadiging",color:"Kleur",luminosity:"Helderheid"},print:{title:"Afdrukinstellingen",loading:"Document voorbereiden...",pages:"Af te drukken pagina's",all:"Alle pagina's",current:"Huidige pagina ({currentPage})",specify:"Pagina's",specifyEG:"bijv. 1-3, 5, 8-10",total:"Totaal aantal pagina's in document: {totalPages}",annotation:"Inclusief annotaties",printing:"Afdrukken...",print:"Afdrukken",cancel:"Annuleren"}}},{code:"de",name:"Deutsch",translations:{search:{placeholder:"Suchen",caseSensitive:"Groß-/Kleinschreibung",wholeWord:"Ganzes Wort",resultsFound:"{count} Ergebnisse gefunden",page:"Seite {page}"},zoom:{in:"Vergrößern",out:"Verkleinern",fitWidth:"An Breite anpassen",fitPage:"An Seite anpassen",marquee:"Laufrahmen-Zoom",menu:"Zoom-Menü",level:"Zoomstufe ({level}%)",dragTip:"Drag to select area to zoom"},pan:{toggle:"Verschieben-Modus umschalten"},pointer:{toggle:"Zeiger-Modus umschalten"},capture:{screenshot:"Screenshot",dragTip:"Ziehen Sie, um den Bereich zum Erfassen auszuwählen",title:"Screenshot-Vorschau",download:"Herunterladen",cancel:"Abbrechen"},document:{menu:"Dokument-Menü",open:"Öffnen",close:"Schließen",print:"Drucken",export:"Exportieren",fullscreen:"Vollbild",loading:"Dokument wird geladen..."},emptyState:{title:"Keine Dokumente geöffnet",description:"Öffnen Sie ein PDF-Dokument, um zu beginnen.",descriptionMulti:"Sie können mehrere Dokumente mit Tabs anzeigen.",openButton:"Dokument öffnen",supportedFormats:"Unterstütztes Format: PDF"},passwordPrompt:{title:"Passwort erforderlich",required:"Dieses Dokument ist passwortgeschützt. Bitte geben Sie das Passwort ein.",incorrect:"Das eingegebene Passwort war falsch. Bitte versuchen Sie es erneut.",incorrectWarning:"Falsches Passwort. Bitte überprüfen und erneut versuchen.",label:"Passwort",placeholder:"Dokumentpasswort eingeben",open:"Öffnen",opening:"Öffnen...",cancel:"Abbrechen",close:"Schließen"},documentError:{title:"Fehler beim Laden des Dokuments",unknown:"Ein unbekannter Fehler ist aufgetreten",errorCode:"Fehlercode: {code}",close:"Dokument schließen"},panel:{sidebar:"Seitenleiste",search:"Suchen",comment:"Kommentar",thumbnails:"Miniaturansichten",outline:"Gliederung",annotationStyle:"Anmerkungsstil"},menu:{viewControls:"Ansichtseinstellungen",zoomControls:"Zoom-Einstellungen",moreOptions:"Weitere Optionen"},outline:{title:"Gliederung",loading:"Gliederung wird geladen...",noOutline:"Keine Gliederung verfügbar",noBookmarks:"Dieses Dokument enthält keine Lesezeichen"},page:{settings:"Seiteneinstellungen",single:"Einzelseite",twoOdd:"Zwei Seiten (Ungerade)",twoEven:"Zwei Seiten (Gerade)",vertical:"Vertikal",horizontal:"Horizontal",spreadMode:"Doppelseiten-Modus",scrollLayout:"Scroll-Layout",rotation:"Seitendrehung",next:"Nächste Seite",previous:"Vorherige Seite"},rotate:{clockwise:"Im Uhrzeigersinn drehen",counterClockwise:"Gegen den Uhrzeigersinn drehen"},selection:{copy:"Auswahl kopieren"},mode:{view:"Ansicht",annotate:"Annotieren",shapes:"Formen",redact:"Schwärzen"},annotation:{text:"Text",highlight:"Markieren",strikeout:"Durchstreichen",underline:"Unterstreichen",squiggly:"Wellenlinie",rectangle:"Rechteck",circle:"Kreis",line:"Linie",arrow:"Pfeil",polygon:"Polygon",polyline:"Polylinie",ink:"Freihand",stamp:"Stempel",freeText:"Freitext",square:"Quadrat",styles:"{type}-Stile",defaults:"{type}-Standardwerte",color:"Farbe",opacity:"Deckkraft",blendMode:"Mischmodus",strokeWidth:"Strichstärke",strokeColor:"Strichfarbe",borderStyle:"Rahmenstil",fillColor:"Füllfarbe",fontSize:"Schriftgröße",fontFamily:"Schriftart",textAlign:"Textausrichtung",verticalAlign:"Vertikale Ausrichtung",lineEnding:"Linienende",lineStart:"Linienanfang",lineEnd:"Linienende",font:"Schriftart",fontColor:"Schriftfarbe",backgroundColor:"Hintergrundfarbe",noStyles:"Für diese Anmerkung gibt es keine Stile.",noStylesStamp:"Für Stempel gibt es keine Stile.",selectAnnotation:"Wählen Sie eine Anmerkung aus, um Stile anzuzeigen",deleteSelected:"Ausgewählte Anmerkung löschen",moreTools:"Weitere Werkzeuge"},redaction:{area:"Bereich schwärzen",text:"Text schwärzen",applyAll:"Alle anwenden",clearAll:"Alle löschen",deleteSelected:"Ausgewählte Schwärzung löschen",commitSelected:"Ausgewählte Schwärzung anwenden"},history:{undo:"Rückgängig",redo:"Wiederholen"},comments:{page:"Seite {page}",commentCount:"{count} Kommentar",commentCountPlural:"{count} Kommentare",addComment:"Kommentar hinzufügen...",addReply:"Antwort hinzufügen...",save:"Speichern",cancel:"Abbrechen",edit:"Bearbeiten",delete:"Löschen",showMore:"mehr",showLess:"weniger",emptyState:"Fügen Sie Anmerkungen hinzu, um sie kommentieren zu können."},blendMode:{normal:"Normal",multiply:"Multiplizieren",screen:"Negativ multiplizieren",overlay:"Ineinanderkopieren",darken:"Abdunkeln",lighten:"Aufhellen",colorDodge:"Farbig abwedeln",colorBurn:"Farbig nachbelichten",hardLight:"Hartes Licht",softLight:"Weiches Licht",difference:"Differenz",exclusion:"Ausschluss",hue:"Farbton",saturation:"Sättigung",color:"Farbe",luminosity:"Luminanz"},print:{title:"Druckeinstellungen",loading:"Dokument wird vorbereitet...",pages:"Zu druckende Seiten",all:"Alle Seiten",current:"Aktuelle Seite ({currentPage})",specify:"Seiten angeben",specifyEG:"z.B. 1-3, 5, 8-10",total:"Gesamtseitenzahl im Dokument: {totalPages}",annotation:"Anmerkungen einbeziehen",printing:"Drucken...",print:"Drucken",cancel:"Abbrechen"}}},{code:"fr",name:"Français",translations:{search:{placeholder:"Rechercher",caseSensitive:"Respecter la casse",wholeWord:"Mot entier",resultsFound:"{count} résultats trouvés",page:"Page {page}"},zoom:{in:"Zoom avant",out:"Zoom arrière",fitWidth:"Ajuster à la largeur",fitPage:"Ajuster à la page",marquee:"Zoom de sélection",menu:"Menu Zoom",level:"Niveau de zoom ({level}%)",dragTip:"Drag to select area to zoom"},pan:{toggle:"Basculer le mode déplacement"},pointer:{toggle:"Basculer le mode pointeur"},capture:{screenshot:"Capture d'écran",dragTip:"Faites glisser pour sélectionner la zone à capturer",title:"Aperçu de la capture",download:"Télécharger",cancel:"Annuler"},document:{menu:"Menu Document",open:"Ouvrir",close:"Fermer",print:"Imprimer",export:"Exporter",fullscreen:"Plein écran",loading:"Chargement du document..."},emptyState:{title:"Aucun document ouvert",description:"Ouvrez un document PDF pour commencer.",descriptionMulti:"Vous pouvez afficher plusieurs documents avec des onglets.",openButton:"Ouvrir un document",supportedFormats:"Format pris en charge : PDF"},passwordPrompt:{title:"Mot de passe requis",required:"Ce document est protégé par mot de passe. Veuillez entrer le mot de passe.",incorrect:"Le mot de passe saisi est incorrect. Veuillez réessayer.",incorrectWarning:"Mot de passe incorrect. Veuillez vérifier et réessayer.",label:"Mot de passe",placeholder:"Entrer le mot de passe du document",open:"Ouvrir",opening:"Ouverture...",cancel:"Annuler",close:"Fermer"},documentError:{title:"Erreur lors du chargement du document",unknown:"Une erreur inconnue est survenue",errorCode:"Code erreur : {code}",close:"Fermer le document"},panel:{sidebar:"Barre latérale",search:"Rechercher",comment:"Commentaire",thumbnails:"Miniatures",outline:"Plan",annotationStyle:"Style d'annotation"},menu:{viewControls:"Contrôles d'affichage",zoomControls:"Contrôles de zoom",moreOptions:"Plus d'options"},outline:{title:"Plan",loading:"Chargement du plan...",noOutline:"Aucun plan disponible",noBookmarks:"Ce document ne contient pas de signets"},page:{settings:"Paramètres de page",single:"Page unique",twoOdd:"Deux pages (Impair)",twoEven:"Deux pages (Pair)",vertical:"Vertical",horizontal:"Horizontal",spreadMode:"Mode double page",scrollLayout:"Disposition de défilement",rotation:"Rotation de page",next:"Page suivante",previous:"Page précédente"},rotate:{clockwise:"Tourner dans le sens horaire",counterClockwise:"Tourner dans le sens antihoraire"},selection:{copy:"Copier la sélection"},mode:{view:"Affichage",annotate:"Annoter",shapes:"Formes",redact:"Caviarder"},annotation:{text:"Texte",highlight:"Surligner",strikeout:"Barrer",underline:"Souligner",squiggly:"Ondulé",rectangle:"Rectangle",circle:"Cercle",line:"Ligne",arrow:"Flèche",polygon:"Polygone",polyline:"Polyligne",ink:"Encre",stamp:"Tampon",freeText:"Texte libre",square:"Carré",styles:"Styles de {type}",defaults:"Valeurs par défaut de {type}",color:"Couleur",opacity:"Opacité",blendMode:"Mode de fusion",strokeWidth:"Épaisseur du trait",strokeColor:"Couleur du trait",borderStyle:"Style de bordure",fillColor:"Couleur de remplissage",fontSize:"Taille de police",fontFamily:"Police",textAlign:"Alignement du texte",verticalAlign:"Alignement vertical",lineEnding:"Fin de ligne",lineStart:"Début de ligne",lineEnd:"Fin de ligne",font:"Police",fontColor:"Couleur du texte",backgroundColor:"Couleur de fond",noStyles:"Il n'y a pas de styles pour cette annotation.",noStylesStamp:"Il n'y a pas de styles pour les tampons.",selectAnnotation:"Sélectionnez une annotation pour voir les styles",deleteSelected:"Supprimer l'annotation sélectionnée",moreTools:"Plus d'outils"},redaction:{area:"Caviarder la zone",text:"Caviarder le texte",applyAll:"Tout appliquer",clearAll:"Tout effacer",deleteSelected:"Supprimer la rédaction sélectionnée",commitSelected:"Appliquer la rédaction sélectionnée"},history:{undo:"Annuler",redo:"Refaire"},comments:{page:"Page {page}",commentCount:"{count} commentaire",commentCountPlural:"{count} commentaires",addComment:"Ajouter un commentaire...",addReply:"Ajouter une réponse...",save:"Enregistrer",cancel:"Annuler",edit:"Modifier",delete:"Supprimer",showMore:"plus",showLess:"moins",emptyState:"Ajoutez des annotations pour pouvoir les commenter."},blendMode:{normal:"Normal",multiply:"Produit",screen:"Superposition",overlay:"Incrustation",darken:"Obscurcir",lighten:"Éclaircir",colorDodge:"Densité couleur -",colorBurn:"Densité couleur +",hardLight:"Lumière crue",softLight:"Lumière tamisée",difference:"Différence",exclusion:"Exclusion",hue:"Teinte",saturation:"Saturation",color:"Couleur",luminosity:"Luminosité"},print:{title:"Paramètres d'impression",loading:"Préparation du document...",pages:"Pages à imprimer",all:"Toutes les pages",current:"Page actuelle ({currentPage})",specify:"Spécifier les pages",specifyEG:"ex : 1-3, 5, 8-10",total:"Nombre total de pages dans le document : {totalPages}",annotation:"Inclure les annotations",printing:"Impression...",print:"Imprimer",cancel:"Annuler"}}},{code:"es",name:"Español",translations:{search:{placeholder:"Buscar",caseSensitive:"Distinguir mayúsculas",wholeWord:"Palabra completa",resultsFound:"{count} resultados encontrados",page:"Página {page}"},zoom:{in:"Acercar",out:"Alejar",fitWidth:"Ajustar al ancho",fitPage:"Ajustar a la página",marquee:"Zoom de selección",menu:"Menú de zoom",level:"Nivel de zoom ({level}%)",dragTip:"Drag to select area to zoom"},pan:{toggle:"Alternar modo desplazamiento"},pointer:{toggle:"Alternar modo puntero"},capture:{screenshot:"Captura de pantalla",dragTip:"Arrastre para seleccionar el área a capturar",title:"Vista previa de la captura",download:"Descargar",cancel:"Cancelar"},document:{menu:"Menú del documento",open:"Abrir",close:"Cerrar",print:"Imprimir",export:"Exportar",fullscreen:"Pantalla completa",loading:"Cargando documento..."},emptyState:{title:"No hay documentos abiertos",description:"Abra un documento PDF para comenzar.",descriptionMulti:"Puede ver varios documentos usando pestañas.",openButton:"Abrir documento",supportedFormats:"Formato compatible: PDF"},passwordPrompt:{title:"Contraseña requerida",required:"Este documento está protegido con contraseña. Por favor, ingrese la contraseña para abrirlo.",incorrect:"La contraseña ingresada es incorrecta. Por favor, inténtelo de nuevo.",incorrectWarning:"Contraseña incorrecta. Por favor, verifique e inténtelo de nuevo.",label:"Contraseña",placeholder:"Ingrese la contraseña del documento",open:"Abrir",opening:"Abriendo...",cancel:"Cancelar",close:"Cerrar"},documentError:{title:"Error al cargar el documento",unknown:"Ha ocurrido un error desconocido",errorCode:"Código de error: {code}",close:"Cerrar documento"},panel:{sidebar:"Barra lateral",search:"Buscar",comment:"Comentario",thumbnails:"Miniaturas",outline:"Esquema",annotationStyle:"Estilo de anotación"},menu:{viewControls:"Controles de vista",zoomControls:"Controles de zoom",moreOptions:"Más opciones"},outline:{title:"Esquema",loading:"Cargando esquema...",noOutline:"No hay esquema disponible",noBookmarks:"Este documento no contiene marcadores"},page:{settings:"Configuración de página",single:"Página única",twoOdd:"Dos páginas (Impar)",twoEven:"Dos páginas (Par)",vertical:"Vertical",horizontal:"Horizontal",spreadMode:"Modo de doble página",scrollLayout:"Diseño de desplazamiento",rotation:"Rotación de página",next:"Página siguiente",previous:"Página anterior"},rotate:{clockwise:"Rotar en sentido horario",counterClockwise:"Rotar en sentido antihorario"},selection:{copy:"Copiar selección"},mode:{view:"Ver",annotate:"Anotar",shapes:"Formas",redact:"Redactar"},annotation:{text:"Texto",highlight:"Resaltar",strikeout:"Tachar",underline:"Subrayar",squiggly:"Ondulado",rectangle:"Rectángulo",circle:"Círculo",line:"Línea",arrow:"Flecha",polygon:"Polígono",polyline:"Polilínea",ink:"Tinta",stamp:"Sello",freeText:"Texto libre",square:"Cuadrado",styles:"Estilos de {type}",defaults:"Valores predeterminados de {type}",color:"Color",opacity:"Opacidad",blendMode:"Modo de fusión",strokeWidth:"Grosor del trazo",strokeColor:"Color del trazo",borderStyle:"Estilo del borde",fillColor:"Color de relleno",fontSize:"Tamaño de fuente",fontFamily:"Fuente",textAlign:"Alineación del texto",verticalAlign:"Alineación vertical",lineEnding:"Final de línea",lineStart:"Inicio de línea",lineEnd:"Final de línea",font:"Fuente",fontColor:"Color de fuente",backgroundColor:"Color de fondo",noStyles:"No hay estilos para esta anotación.",noStylesStamp:"No hay estilos para los sellos.",selectAnnotation:"Seleccione una anotación para ver los estilos",deleteSelected:"Eliminar anotación seleccionada",moreTools:"Más herramientas"},redaction:{area:"Redactar área",text:"Redactar texto",applyAll:"Aplicar todo",clearAll:"Borrar todo",deleteSelected:"Eliminar redacción seleccionada",commitSelected:"Aplicar redacción seleccionada"},history:{undo:"Deshacer",redo:"Rehacer"},comments:{page:"Página {page}",commentCount:"{count} comentario",commentCountPlural:"{count} comentarios",addComment:"Añadir comentario...",addReply:"Añadir respuesta...",save:"Guardar",cancel:"Cancelar",edit:"Editar",delete:"Eliminar",showMore:"más",showLess:"menos",emptyState:"Añada anotaciones para poder comentarlas."},blendMode:{normal:"Normal",multiply:"Multiplicar",screen:"Trama",overlay:"Superponer",darken:"Oscurecer",lighten:"Aclarar",colorDodge:"Sobreexponer color",colorBurn:"Subexponer color",hardLight:"Luz fuerte",softLight:"Luz suave",difference:"Diferencia",exclusion:"Exclusión",hue:"Tono",saturation:"Saturación",color:"Color",luminosity:"Luminosidad"},print:{title:"Configuración de impresión",loading:"Preparando documento...",pages:"Páginas a imprimir",all:"Todas las páginas",current:"Página actual ({currentPage})",specify:"Especificar páginas",specifyEG:"ej: 1-3, 5, 8-10",total:"Total de páginas en el documento: {totalPages}",annotation:"Incluir anotaciones",printing:"Imprimiendo...",print:"Imprimir",cancel:"Cancelar"}}},{code:"zh-CN",name:"简体中文",translations:{search:{placeholder:"搜索",caseSensitive:"大小写敏感",wholeWord:"全词匹配",resultsFound:"{count} 个结果",page:"第{page}页"},zoom:{in:"放大",out:"缩小",fitWidth:"适合宽度",fitPage:"适合页面",marquee:"框选放大",menu:"缩放菜单",level:"缩放比例 ({level}%)",dragTip:"拖动鼠标选择要放大的区域"},pan:{toggle:"拖动模式"},pointer:{toggle:"光标模式"},capture:{screenshot:"截图",dragTip:"拖动鼠标选择要截取的区域",title:"截取的PDF区域",download:"下载",cancel:"取消"},document:{menu:"文件选项",open:"打开",close:"关闭",print:"打印",export:"导出",fullscreen:"全屏",loading:"文件加载中..."},emptyState:{title:"尚无打开的文件",description:"请点击“+ 打开文件”按钮选择并打开一个PDF文件。",descriptionMulti:"您可以使用标签页同时打开多个文件。",openButton:"打开文件",supportedFormats:"支持的文件格式为: PDF"},passwordPrompt:{title:"请输入密码",required:"该文件设置有密码保护，要打开文件请输入密码。",incorrect:"你输入的密码错误，请重新输入。",incorrectWarning:"密码错误，请检查后重新输入。",label:"密码",placeholder:"请输入文件密码",open:"打开",opening:"打开中...",cancel:"取消",close:"关闭"},documentError:{title:"文件加载出错",unknown:"未知错误",errorCode:"错误码: {code}",close:"关闭文件"},panel:{sidebar:"大纲与书签",search:"搜索",comment:"评论",thumbnails:"缩略图",outline:"大纲",annotationStyle:"批注样式"},menu:{viewControls:"视图控件",zoomControls:"缩放控件",moreOptions:"更多选项"},outline:{title:"大纲",loading:"大纲加载中...",noOutline:"没有大纲",noBookmarks:"该文件不含书签"},page:{settings:"页面设置",single:"单页视图",twoOdd:"双页视图",twoEven:"书籍视图",vertical:"垂直滚动",horizontal:"水平滚动",spreadMode:"跨页模式",scrollLayout:"滚动布局",rotation:"页面转向",next:"下一页",previous:"上一页"},rotate:{clockwise:"顺时针旋转",counterClockwise:"逆时针旋转"},selection:{copy:"复制"},mode:{view:"阅读",annotate:"批注",shapes:"形状",redact:"遮蔽"},annotation:{text:"任意文本",highlight:"高亮",strikeout:"删除线",underline:"下划线",squiggly:"下划曲线",rectangle:"矩形",circle:"圆形",line:"直线",arrow:"带箭头直线",polygon:"多边形",polyline:"多段线",ink:"自由绘制",stamp:"印章",freeText:"任意文本",square:"矩形",styles:"{type} 样式",defaults:"{type} 默认值",color:"颜色",opacity:"透明度",blendMode:"混合模式",strokeWidth:"线条宽度",strokeColor:"线条颜色",borderStyle:"线条样式",fillColor:"填充色",fontSize:"字号",fontFamily:"字体",textAlign:"左右对齐",verticalAlign:"上下对齐",lineEnding:"行尾",lineStart:"线条起点",lineEnd:"线条结尾",font:"字体",fontColor:"字色",backgroundColor:"背景色",noStyles:"该批注无需设置样式。",noStylesStamp:"印章无需设置样式。",selectAnnotation:"在此处查看选中批注的样式。",deleteSelected:"删除选中的批注",moreTools:"更多工具"},redaction:{area:"遮蔽区域",text:"遮蔽文本",applyAll:"全部应用",clearAll:"全部取消",deleteSelected:"取消遮蔽",commitSelected:"应用遮蔽"},history:{undo:"撤销",redo:"恢复"},comments:{page:"第{page}页",commentCount:"{count}条评论",commentCountPlural:"{count}条评论",addComment:"新增评论...",addReply:"新增回复...",save:"保存",cancel:"取消",edit:"编辑",delete:"删除",showMore:"展开",showLess:"收起",emptyState:"添加批注后，可以在这里对批注进行评论。"},blendMode:{normal:"正常",multiply:"正片",screen:"屏幕",overlay:"叠加",darken:"变暗",lighten:"变亮",colorDodge:"色彩减淡",colorBurn:"颜色加深",hardLight:"强光",softLight:"柔光",difference:"差值",exclusion:"排除",hue:"色相",saturation:"饱和度",color:"颜色",luminosity:"亮度"},print:{title:"打印设置",loading:"正在处理...",pages:"要打印的页码",all:"所有页",current:"当前页（{currentPage}）",specify:"指定页",specifyEG:"例如：1-3, 5, 8-10",total:"文档总页数：{totalPages}",annotation:"包含批注",printing:"打印中...",print:"打印",cancel:"取消"}}}],paramResolvers:{"zoom.level":function(e){var t,n,o=e.state,r=e.documentId,a=r&&null!==(t=null===(n=o.plugins[fi])||void 0===n||null===(n=n.documents[r])||void 0===n?void 0:n.currentZoomLevel)&&void 0!==t?t:1;return{level:Math.round(100*a)}}}},ui:{schema:{id:"pdf-viewer-ui",version:"1.0.0",toolbars:{"main-toolbar":{id:"main-toolbar",position:{placement:"top",slot:"main",order:0},permanent:!0,responsive:{localeOverrides:{groups:[{id:"chinese-languages",locales:["zh-CN"],breakpoints:{sm:{replaceHide:["zoom-toolbar","mode-select-button","overflow-tabs-button"],replaceShow:["view-mode","annotate-mode","shapes-mode","redact-mode","pan-button","pointer-button","divider-3"]},md:{replaceShow:["view-mode","annotate-mode","shapes-mode","redact-mode","zoom-toolbar","pan-button","pointer-button","divider-3"],replaceHide:["zoom-menu-button","mode-select-button","overflow-tabs-button"]}}},{id:"germanic-languages",locales:["de","nl"],breakpoints:{md:{replaceShow:["view-mode","annotate-mode","zoom-toolbar","pan-button","pointer-button","divider-3","overflow-tabs-button"]}}}]},breakpoints:{xxxs:{maxWidth:400,hide:["annotate-mode","view-mode","shapes-mode","redact-mode","zoom-toolbar","pan-button","pointer-button","divider-3","page-settings-button","zoom-menu-button","divider-2","overflow-tabs-button"],show:["mode-select-button"]},xxs:{minWidth:400,show:["page-settings-button","zoom-menu-button","divider-2"],hide:["overflow-left-action-menu-button"]},xs:{minWidth:500,maxWidth:640,show:["pan-button","pointer-button","divider-3"]},sm:{minWidth:640,maxWidth:768,hide:["shapes-mode","redact-mode","zoom-toolbar","mode-select-button"],show:["view-mode","annotate-mode","overflow-tabs-button","pan-button","pointer-button","divider-3"]},md:{minWidth:768,show:["view-mode","annotate-mode","shapes-mode","zoom-toolbar","pan-button","pointer-button","divider-3","overflow-tabs-button"],hide:["zoom-menu-button","mode-select-button"]},lg:{minWidth:1024,show:["shapes-mode","redact-mode"],hide:["overflow-tabs-button"]}}},items:[{type:"group",id:"left-group",alignment:"start",gap:2,items:[{type:"command-button",id:"document-menu-button",commandId:"document:menu",variant:"icon",categories:["document","document-menu"]},{type:"divider",id:"divider-1",orientation:"vertical"},{type:"command-button",id:"sidebar-button",commandId:"panel:toggle-sidebar",variant:"icon",categories:["panel","panel-sidebar"]},{type:"command-button",id:"overflow-left-action-menu-button",commandId:"left-action-menu:overflow-menu",variant:"icon",categories:["ui","ui-menu"]},{type:"command-button",id:"page-settings-button",commandId:"page:settings",variant:"icon",categories:["page","page-settings"]}]},{type:"divider",id:"divider-2",orientation:"vertical"},{type:"group",id:"center-group",alignment:"center",gap:2,items:[{type:"command-button",id:"zoom-menu-button",commandId:"zoom:toggle-menu-mobile",variant:"icon",categories:["zoom","zoom-menu"]},{type:"custom",id:"zoom-toolbar",componentId:"zoom-toolbar",categories:["zoom"]},{type:"divider",id:"divider-3",orientation:"vertical",visibilityDependsOn:{itemIds:["zoom-toolbar","zoom-menu-button"]}},{type:"command-button",id:"pan-button",commandId:"pan:toggle",variant:"icon",categories:["tools","pan"]},{type:"command-button",id:"pointer-button",commandId:"pointer:toggle",variant:"icon",categories:["tools","pointer"]}]},{type:"spacer",id:"spacer-1",flex:!0},{type:"custom",id:"mode-select-button",componentId:"mode-select-button",categories:["mode"],visibilityDependsOn:{menuId:"mode-tabs-overflow-menu"}},{type:"tab-group",id:"mode-tabs",tabs:[{id:"view-mode",commandId:"mode:view",variant:"text",categories:["mode","mode-view"],visibilityDependsOn:{itemIds:["annotate-mode","shapes-mode","redact-mode"]}},{id:"annotate-mode",commandId:"mode:annotate",variant:"text",categories:["mode","mode-annotate","annotation"]},{id:"shapes-mode",commandId:"mode:shapes",variant:"text",categories:["mode","mode-shapes","annotation"]},{id:"redact-mode",commandId:"mode:redact",variant:"text",categories:["mode","mode-redact","redaction"]},{id:"overflow-tabs-button",commandId:"tabs:overflow-menu",variant:"icon",categories:["ui","ui-menu"],visibilityDependsOn:{menuId:"mode-tabs-overflow-menu"}}]},{type:"spacer",id:"spacer-2",flex:!0},{type:"group",id:"right-group",alignment:"end",gap:2,items:[{type:"command-button",id:"search-button",commandId:"panel:toggle-search",variant:"icon",categories:["panel","panel-search"]},{type:"command-button",id:"comment-button",commandId:"panel:toggle-comment",variant:"icon",categories:["panel","panel-comment"]}]}]},"annotation-toolbar":{id:"annotation-toolbar",position:{placement:"top",slot:"secondary",order:0},responsive:{breakpoints:{sm:{maxWidth:640,hide:["add-text","add-stamp"],show:["overflow-annotation-tools"]},md:{minWidth:640,hide:["overflow-annotation-tools"],show:["add-text","add-stamp"]}}},permanent:!1,categories:["annotation"],items:[{type:"spacer",id:"spacer-3",flex:!0},{type:"group",id:"annotation-tools",alignment:"start",gap:2,items:[{type:"command-button",id:"add-highlight",commandId:"annotation:add-highlight",variant:"icon",categories:["annotation","annotation-markup","annotation-highlight"]},{type:"command-button",id:"add-strikeout",commandId:"annotation:add-strikeout",variant:"icon",categories:["annotation","annotation-markup","annotation-strikeout"]},{type:"command-button",id:"add-underline",commandId:"annotation:add-underline",variant:"icon",categories:["annotation","annotation-markup","annotation-underline"]},{type:"command-button",id:"add-ink",commandId:"annotation:add-ink",variant:"icon",categories:["annotation","annotation-ink"]},{type:"command-button",id:"add-text",commandId:"annotation:add-text",variant:"icon",categories:["annotation","annotation-text"]},{type:"command-button",id:"add-stamp",commandId:"annotation:add-stamp",variant:"icon",categories:["annotation","annotation-stamp"]},{type:"command-button",id:"overflow-annotation-tools",commandId:"annotation:overflow-tools",variant:"icon",categories:["annotation","annotation-overflow"]},{type:"divider",id:"annotation-tools-divider-1",orientation:"vertical"},{type:"command-button",id:"toggle-annotation-style",commandId:"panel:toggle-annotation-style",variant:"icon",categories:["panel","panel-annotation-style"]},{type:"divider",id:"annotation-tools-divider-2",orientation:"vertical",visibilityDependsOn:{itemIds:["toggle-annotation-style"]}},{type:"command-button",id:"undo-button",commandId:"history:undo",variant:"icon",categories:["history","history-undo"]},{type:"command-button",id:"redo-button",commandId:"history:redo",variant:"icon",categories:["history","history-redo"]}]},{type:"spacer",id:"spacer-4",flex:!0}]},"shapes-toolbar":{id:"shapes-toolbar",position:{placement:"top",slot:"secondary",order:0},responsive:{breakpoints:{sm:{maxWidth:640,hide:["add-polygon","add-polyline"],show:["overflow-shapes-tools"]},md:{minWidth:640,hide:["overflow-shapes-tools"],show:["add-polygon","add-polyline"]}}},permanent:!1,categories:["annotation","annotation-shape"],items:[{type:"spacer",id:"spacer-5",flex:!0},{type:"group",id:"shapes-tools",alignment:"start",gap:2,items:[{type:"command-button",id:"add-rectangle",commandId:"annotation:add-rectangle",variant:"icon",categories:["annotation","annotation-shape","annotation-rectangle"]},{type:"command-button",id:"add-circle",commandId:"annotation:add-circle",variant:"icon",categories:["annotation","annotation-shape","annotation-circle"]},{type:"command-button",id:"add-line",commandId:"annotation:add-line",variant:"icon",categories:["annotation","annotation-shape","annotation-line"]},{type:"command-button",id:"add-arrow",commandId:"annotation:add-arrow",variant:"icon",categories:["annotation","annotation-shape","annotation-arrow"]},{type:"command-button",id:"add-polygon",commandId:"annotation:add-polygon",variant:"icon",categories:["annotation","annotation-shape","annotation-polygon"]},{type:"command-button",id:"add-polyline",commandId:"annotation:add-polyline",variant:"icon",categories:["annotation","annotation-shape","annotation-polyline"]},{type:"command-button",id:"overflow-shapes-tools",commandId:"annotation:overflow-shapes",variant:"icon",categories:["annotation","annotation-shape","annotation-overflow"]},{type:"divider",id:"shapes-tools-divider-1",orientation:"vertical"},{type:"command-button",id:"toggle-annotation-style",commandId:"panel:toggle-annotation-style",variant:"icon",categories:["panel","panel-annotation-style"]},{type:"divider",id:"shapes-tools-divider-2",orientation:"vertical",visibilityDependsOn:{itemIds:["toggle-annotation-style"]}},{type:"command-button",id:"undo-button",commandId:"history:undo",variant:"icon",categories:["history","history-undo"]},{type:"command-button",id:"redo-button",commandId:"history:redo",variant:"icon",categories:["history","history-redo"]}]},{type:"spacer",id:"spacer-6",flex:!0}]},"redaction-toolbar":{id:"redaction-toolbar",position:{placement:"top",slot:"secondary",order:0},permanent:!1,categories:["redaction"],items:[{type:"spacer",id:"spacer-7",flex:!0},{type:"group",id:"redaction-tools",alignment:"start",gap:2,items:[{type:"command-button",id:"redact-text",commandId:"redaction:redact-text",variant:"icon",categories:["redaction","redaction-text"]},{type:"command-button",id:"redact-area",commandId:"redaction:redact-area",variant:"icon",categories:["redaction","redaction-area"]},{type:"divider",id:"divider-5",orientation:"vertical"},{type:"command-button",id:"apply-redactions",commandId:"redaction:apply-all",variant:"icon",categories:["redaction","redaction-apply"]},{type:"command-button",id:"clear-redactions",commandId:"redaction:clear-all",variant:"icon",categories:["redaction","redaction-clear"]}]},{type:"spacer",id:"spacer-8",flex:!0}]}},menus:{"left-action-menu":{id:"left-action-menu",categories:["ui"],items:[{type:"submenu",id:"page-settings-submenu",labelKey:"menu.viewControls",label:"View Controls",icon:"viewSettings",menuId:"page-settings-menu",categories:["page"]},{type:"submenu",id:"zoom-submenu",labelKey:"menu.zoomControls",label:"Zoom Controls",icon:"zoomIn",menuId:"zoom-menu",categories:["zoom"]},{type:"divider",id:"divider-15"},{type:"command",id:"pan-button-menu",commandId:"pan:toggle",categories:["tools","pan"]},{type:"command",id:"pointer-button-menu",commandId:"pointer:toggle",categories:["tools","pointer"]}]},"mode-tabs-overflow-menu":{id:"mode-tabs-overflow-menu",items:[{type:"command",id:"mode:view",commandId:"mode:view",categories:["mode","mode-view"]},{type:"command",id:"mode:annotate",commandId:"mode:annotate",categories:["mode","mode-annotate","annotation"]},{type:"command",id:"mode:shapes",commandId:"mode:shapes",categories:["mode","mode-shapes","annotation"]},{type:"command",id:"mode:redact",commandId:"mode:redact",categories:["mode","mode-redact","redaction"]}],responsive:{breakpoints:{xs:{maxWidth:640,show:["mode:view","mode:annotate","mode:shapes","mode:redact"]},sm:{minWidth:640,maxWidth:768,hide:["mode:view","mode:annotate"]},md:{minWidth:768,hide:["mode:view","mode:annotate","mode:shapes"]}},localeOverrides:{groups:[{id:"germanic-languages",locales:["de","nl"],breakpoints:{md:{replaceHide:["mode:view","mode:annotate"]}}}]}}},"zoom-levels-menu":{id:"zoom-levels-menu",categories:["zoom","zoom-level"],items:[{type:"command",id:"zoom-levels-menu:25",commandId:"zoom:25",categories:["zoom","zoom-level","zoom-level-25"]},{type:"command",id:"zoom-levels-menu:50",commandId:"zoom:50",categories:["zoom","zoom-level","zoom-level-50"]},{type:"command",id:"zoom-levels-menu:100",commandId:"zoom:100",categories:["zoom","zoom-level","zoom-level-100"]},{type:"command",id:"zoom-levels-menu:125",commandId:"zoom:125",categories:["zoom","zoom-level","zoom-level-125"]},{type:"command",id:"zoom-levels-menu:150",commandId:"zoom:150",categories:["zoom","zoom-level","zoom-level-150"]},{type:"command",id:"zoom-levels-menu:200",commandId:"zoom:200",categories:["zoom","zoom-level","zoom-level-200"]},{type:"command",id:"zoom-levels-menu:400",commandId:"zoom:400",categories:["zoom","zoom-level","zoom-level-400"]},{type:"command",id:"zoom-levels-menu:800",commandId:"zoom:800",categories:["zoom","zoom-level","zoom-level-800"]},{type:"command",id:"zoom-levels-menu:1600",commandId:"zoom:1600",categories:["zoom","zoom-level","zoom-level-1600"]}]},"zoom-menu":{id:"zoom-menu",categories:["zoom"],items:[{type:"command",id:"zoom-menu:25",commandId:"zoom:25",categories:["zoom","zoom-level","zoom-level-25"]},{type:"command",id:"zoom-menu:50",commandId:"zoom:50",categories:["zoom","zoom-level","zoom-level-50"]},{type:"command",id:"zoom-menu:100",commandId:"zoom:100",categories:["zoom","zoom-level","zoom-level-100"]},{type:"command",id:"zoom-menu:125",commandId:"zoom:125",categories:["zoom","zoom-level","zoom-level-125"]},{type:"command",id:"zoom-menu:150",commandId:"zoom:150",categories:["zoom","zoom-level","zoom-level-150"]},{type:"command",id:"zoom-menu:200",commandId:"zoom:200",categories:["zoom","zoom-level","zoom-level-200"]},{type:"command",id:"zoom-menu:400",commandId:"zoom:400",categories:["zoom","zoom-level","zoom-level-400"]},{type:"command",id:"zoom-menu:800",commandId:"zoom:800",categories:["zoom","zoom-level","zoom-level-800"]},{type:"command",id:"zoom-menu:1600",commandId:"zoom:1600",categories:["zoom","zoom-level","zoom-level-1600"]},{type:"submenu",id:"zoom-levels-submenu",labelKey:"zoom.level",label:"Zoom Levels",menuId:"zoom-levels-menu",categories:["zoom","zoom-level"]},{type:"divider",id:"divider-zoom-in-out"},{type:"command",id:"zoom-menu:in",commandId:"zoom:in",categories:["zoom","zoom-in"]},{type:"command",id:"zoom-menu:out",commandId:"zoom:out",categories:["zoom","zoom-out"]},{type:"divider",id:"divider-8"},{type:"command",id:"zoom:fit-page",commandId:"zoom:fit-page",categories:["zoom","zoom-fit-page"]},{type:"command",id:"zoom:fit-width",commandId:"zoom:fit-width",categories:["zoom","zoom-fit-width"]},{type:"divider",id:"divider-9"},{type:"command",id:"zoom:marquee",commandId:"zoom:marquee",categories:["zoom","zoom-marquee"]}],responsive:{breakpoints:{xs:{maxWidth:640,show:["zoom-levels-submenu","divider-zoom-in-out"],hide:["zoom-menu:25","zoom-menu:50","zoom-menu:100","zoom-menu:125","zoom-menu:150","zoom-menu:200","zoom-menu:400","zoom-menu:800","zoom-menu:1600"]},md:{minWidth:768,show:["zoom-menu:25","zoom-menu:50","zoom-menu:100","zoom-menu:125","zoom-menu:150","zoom-menu:200","zoom-menu:400","zoom-menu:800","zoom-menu:1600"],hide:["zoom-levels-submenu","divider-zoom-in-out","zoom-menu:in","zoom-menu:out"]}}}},"document-menu":{id:"document-menu",categories:["document"],items:[{type:"command",id:"document:open",commandId:"document:open",categories:["document","document-open"]},{type:"command",id:"document:close",commandId:"document:close",categories:["document","document-close"]},{type:"divider",id:"divider-10"},{type:"command",id:"document:print",commandId:"document:print",categories:["document","document-print"]},{type:"command",id:"document:capture",commandId:"document:capture",categories:["document","document-capture"]},{type:"command",id:"document:export",commandId:"document:export",categories:["document","document-export"]},{type:"divider",id:"divider-11",visibilityDependsOn:{itemIds:["document:export","document:print","document:capture"]}},{type:"command",id:"document:fullscreen",commandId:"document:fullscreen",categories:["document","document-fullscreen"]}]},"annotation-tools-menu":{id:"annotation-tools-menu",categories:["annotation"],items:[{type:"command",id:"annotation:add-text",commandId:"annotation:add-text",categories:["annotation","annotation-text"]},{type:"command",id:"annotation:add-stamp",commandId:"annotation:add-stamp",categories:["annotation","annotation-stamp"]}]},"shapes-tools-menu":{id:"shapes-tools-menu",categories:["annotation","annotation-shape"],items:[{type:"command",id:"annotation:add-polygon",commandId:"annotation:add-polygon",categories:["annotation","annotation-shape","annotation-polygon"]},{type:"command",id:"annotation:add-polyline",commandId:"annotation:add-polyline",categories:["annotation","annotation-shape","annotation-polyline"]}]},"page-settings-menu":{id:"page-settings-menu",categories:["page"],items:[{type:"section",id:"spread-mode-section",labelKey:"page.spreadMode",label:"Spread Mode",categories:["page","spread"],items:[{type:"command",id:"spread:none",commandId:"spread:none",categories:["page","spread","spread-none"]},{type:"command",id:"spread:odd",commandId:"spread:odd",categories:["page","spread","spread-odd"]},{type:"command",id:"spread:even",commandId:"spread:even",categories:["page","spread","spread-even"]}]},{type:"divider",id:"divider-13"},{type:"section",id:"scroll-layout-section",labelKey:"page.scrollLayout",label:"Scroll Layout",categories:["page","scroll"],items:[{type:"command",id:"scroll:vertical",commandId:"scroll:vertical",categories:["page","scroll","scroll-vertical"]},{type:"command",id:"scroll:horizontal",commandId:"scroll:horizontal",categories:["page","scroll","scroll-horizontal"]}]},{type:"divider",id:"divider-14"},{type:"section",id:"page-rotation-section",labelKey:"page.rotation",label:"Page Rotation",categories:["page","rotate"],items:[{type:"command",id:"rotate:clockwise",commandId:"rotate:clockwise",categories:["page","rotate","rotate-clockwise"]},{type:"command",id:"rotate:counter-clockwise",commandId:"rotate:counter-clockwise",categories:["page","rotate","rotate-counter-clockwise"]}]},{type:"divider",id:"divider-15"},{type:"command",id:"document:fullscreen",commandId:"document:fullscreen",categories:["document","document-fullscreen"]}]}},sidebars:{"sidebar-panel":{id:"sidebar-panel",position:{placement:"left",slot:"main",order:0},content:{type:"tabs",tabs:[{id:"thumbnails",labelKey:"panel.thumbnails",label:"Thumbnails",icon:"squares",componentId:"thumbnails-sidebar"},{id:"outline",labelKey:"panel.outline",label:"Outline",icon:"listTree",componentId:"outline-sidebar"}]},width:"250px",collapsible:!0,defaultOpen:!1},"annotation-panel":{id:"annotation-panel",position:{placement:"left",slot:"main",order:0},content:{type:"component",componentId:"annotation-sidebar"},width:"250px",collapsible:!0,defaultOpen:!1},"search-panel":{id:"search-panel",position:{placement:"right",slot:"main",order:0},content:{type:"component",componentId:"search-sidebar"},width:"250px",collapsible:!0,defaultOpen:!1},"comment-panel":{id:"comment-panel",position:{placement:"right",slot:"main",order:0},content:{type:"component",componentId:"comment-sidebar"},width:"250px",collapsible:!0,defaultOpen:!1}},modals:{"print-modal":{id:"print-modal",content:{type:"component",componentId:"print-modal"},maxWidth:"28rem",closeOnClickOutside:!0,closeOnEscape:!0}},overlays:{"page-controls":{id:"page-controls",position:{anchor:"bottom-center",offset:{bottom:"1.5rem"}},content:{type:"component",componentId:"page-controls"},defaultEnabled:!0}},selectionMenus:{annotation:{id:"annotation",categories:["annotation"],items:[{type:"command-button",id:"delete-annotation",commandId:"annotation:delete-selected",variant:"icon",categories:["annotation","annotation-delete"]},{type:"command-button",id:"toggle-annotation-style",commandId:"panel:toggle-annotation-style",variant:"icon",categories:["panel","panel-annotation-style"]},{type:"command-button",id:"comment-button",commandId:"panel:toggle-comment",variant:"icon",categories:["panel","panel-comment"]}]},redaction:{id:"redaction",categories:["redaction"],items:[{type:"command-button",id:"delete-redaction",commandId:"redaction:delete-selected",variant:"icon",categories:["redaction","redaction-delete"]},{type:"command-button",id:"commit-redaction",commandId:"redaction:commit-selected",variant:"icon",categories:["redaction","redaction-commit"]}]},selection:{id:"selection",visibilityDependsOn:{itemIds:["copy-selection","add-highlight","add-strikeout","add-underline","add-squiggly","redact-text"]},items:[{type:"command-button",id:"copy-selection",commandId:"selection:copy",variant:"icon",categories:["selection","selection-copy"]},{type:"command-button",id:"add-highlight",commandId:"annotation:add-highlight",variant:"icon",categories:["annotation","annotation-markup","annotation-highlight"]},{type:"command-button",id:"add-strikeout",commandId:"annotation:add-strikeout",variant:"icon",categories:["annotation","annotation-markup","annotation-strikeout"]},{type:"command-button",id:"add-underline",commandId:"annotation:add-underline",variant:"icon",categories:["annotation","annotation-markup","annotation-underline"]},{type:"command-button",id:"add-squiggly",commandId:"annotation:add-squiggly",variant:"icon",categories:["annotation","annotation-markup","annotation-squiggly"]},{type:"command-button",id:"redact-text",commandId:"redaction:redact-text",variant:"icon",categories:["redaction","redaction-text"]}]}}}},viewport:{viewportGap:10},scroll:{defaultStrategy:Uo.Vertical},zoom:{defaultZoomLevel:hi.FitPage},spread:{defaultSpreadMode:ir.None},rotation:{defaultRotation:He.Degree0},pan:{},render:{defaultImageType:"image/png"},tiling:{tileSize:768,overlapPx:2.5,extraRings:0},thumbnails:{width:150,gap:10,buffer:3,labelHeight:30},annotations:{},search:{},selection:{},bookmarks:{},attachments:{},capture:{scale:2,imageType:"image/png"},redaction:{drawBlackBoxes:!0},print:{},export:{defaultFileName:"document.pdf"},fullscreen:{},history:{},interactionManager:{}};function SF(e){var t=e.documentId,n=e.tabBarVisibility,o=void 0===n?"multiple":n,r=function(e){const t=Ga(),{provides:n}=Da(),o=null==n?void 0:n.getSchema(),r=xa(e);return{renderToolbar:(a,i)=>{const s=`${a}-${i}`;if(!o||!n||!r)return null;const l=r.activeToolbars[s],d=l?o.toolbars[l.toolbarId]:null;l&&!d&&console.warn(`Toolbar "${l.toolbarId}" not found in schema`);const c=d&&!d.permanent?()=>n.forDocument(e).closeToolbarSlot(a,i):void 0,u=t.toolbar;return We(H,{children:l&&d&&We(u,{schema:d,documentId:e,isOpen:l.isOpen,onClose:c})},`toolbar-slot-${s}`)},renderSidebar:(a,i)=>{var s;const l=`${a}-${i}`;if(!o||!n||!r)return null;const d=r.activeSidebars[l],c=d?null==(s=o.sidebars)?void 0:s[d.sidebarId]:null;d&&!c&&console.warn(`Sidebar "${d.sidebarId}" not found in schema`);const u=t.sidebar;return We(H,{children:d&&c&&We(u,{schema:c,documentId:e,isOpen:d.isOpen,onClose:()=>{n.forDocument(e).closeSidebarSlot(a,i)}})},`sidebar-slot-${l}`)},renderModal:()=>{var a;if(!o||!n||!r)return null;const i=t.modal;if(!i)return null;const s=r.activeModal,l=s?null==(a=o.modals)?void 0:a[s.modalId]:null;return s&&!l&&console.warn(`Modal "${s.modalId}" not found in schema`),We(H,{children:s&&l&&We(i,{schema:l,documentId:e,isOpen:s.isOpen,onClose:()=>{n.forDocument(e).closeModal()},onExited:()=>{n.forDocument(e).clearModal()}})},"modal-slot")},getActiveToolbars:()=>r?Object.entries(r.activeToolbars).map(([e,t])=>{const[n,o]=e.split("-");return{placement:n,slot:o,toolbarId:t.toolbarId,isOpen:t.isOpen}}):[],getActiveSidebars:()=>r?Object.entries(r.activeSidebars).map(([e,t])=>{const[n,o]=e.split("-");return{placement:n,slot:o,sidebarId:t.sidebarId,isOpen:t.isOpen}}):[],renderOverlays:()=>{if(!o||!n)return null;const r=t.overlay;return r?We(H,{children:(o.overlays?Object.values(o.overlays):[]).map(t=>We(r,{schema:t,documentId:e},t.id))},"overlays-slot"):null}}}(t),a=r.renderToolbar,i=r.renderSidebar,s=r.renderModal,l=r.renderOverlays,d=pi(t).translate,c=La("selection",t),u=La("annotation",t),m=La("redaction",t),p=(()=>{const e=Po();return Ie(()=>e?e.documentOrder.map(t=>e.documents[t]).filter(e=>null!=e):[],[e,void 0])})(),h=(()=>{const e=Po();return Ie(()=>{if(!e)return{activeDocumentId:null,activeDocument:null};const t=e.activeDocumentId;return{activeDocumentId:t,activeDocument:t?e.documents[t]??null:null}},[e])})();return U(H,null,U(vF,{documentStates:p,activeDocumentId:h.activeDocumentId,visibility:o}),a("top","main"),a("top","secondary"),U("div",{id:"document-content",className:"bg-bg-surface flex flex-1 overflow-hidden"},i("left","main"),U("div",{className:"flex-1 overflow-hidden"},U(Wa,{documentId:t},function(e){var n=e.documentState,o=e.isLoading,r=e.isError,a=e.isLoaded;return U(H,null,o&&U("div",{className:"flex h-full items-center justify-center"},U(bf,{size:"lg",text:d("document.loading")})),r&&U(DF,{documentState:n}),a&&U("div",{className:"relative h-full w-full"},U(bc,{documentId:t},U($o,{className:"bg-bg-app",documentId:t},U(Ci,{documentId:t},U(ar,{documentId:t,renderPage:function(e){var n=e.pageIndex;return U(Hi,{documentId:t,pageIndex:n,style:{backgroundColor:"#fff"}},U(_c,{documentId:t,pageIndex:n},U(Ri,{documentId:t,pageIndex:n,scale:.5,style:{pointerEvents:"none"}}),U(ul,{documentId:t,pageIndex:n,style:{pointerEvents:"none"}}),U(ps,{documentId:t,pageIndex:n}),U(Mi,{documentId:t,pageIndex:n}),U(Cu,{documentId:t,pageIndex:n}),U(qs,{documentId:t,pageIndex:n,selectionMenu:c}),U(mm,{documentId:t,pageIndex:n,selectionMenu:m}),U($c,{documentId:t,pageIndex:n,selectionMenu:u})))}})))),l()))})),i("right","main")),s())}var EF=new mt([new dt,new ut]);function CF(e){var t,o=e.config,r=e.onRegistryReady,i=function(e){const{wasmUrl:t=_o,worker:o=!0,logger:r,encoderPoolSize:a,fontFallback:i}=e??{},[s,l]=Ee(null),[d,c]=Ee(!0),[u,m]=Ee(null),p=Te(null);return Me(()=>{let e=!1;return(async()=>{try{const{createPdfiumEngine:e}=o?await Promise.resolve().then(n.bind(n,138)):await Promise.resolve().then(n.bind(n,762)),s=await e(t,{logger:r,encoderPoolSize:a,fontFallback:i});p.current=s,l(s),c(!1)}catch(t){e||(m(t),c(!1))}})(),()=>{var t,n;e=!0,null==(n=null==(t=p.current)?void 0:t.closeAllDocuments)||n.call(t).wait(()=>{var e,t;null==(t=null==(e=p.current)?void 0:e.destroy)||t.call(e),p.current=null},yn)}},[t,o,r,i]),{engine:s,isLoading:d,error:u}}(g(g({},o.wasmUrl&&{wasmUrl:o.wasmUrl}),{},{worker:o.worker,logger:o.log?EF:void 0})),s=i.engine,l=i.isLoading,d=Ie(function(){return{"thumbnails-sidebar":pf,"annotation-sidebar":dF,"zoom-toolbar":Lf,"search-sidebar":Ff,"outline-sidebar":Pf,"comment-sidebar":Gf,"print-modal":hF,"page-controls":gF,"mode-select-button":xF}},[]),c=Ie(function(){return{toolbar:Fg,sidebar:tf,modal:mf,overlay:mF,menu:rf,selectionMenu:cF}},[]);return U(H,null,U("style",null,'/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */\n@layer properties;\n@layer theme, base, components, utilities;\n@layer theme {\n  :root, :host {\n    --font-sans: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji",\n      "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";\n    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",\n      "Courier New", monospace;\n    --color-red-500: oklch(63.7% 0.237 25.331);\n    --color-yellow-500: oklch(79.5% 0.184 86.047);\n    --color-green-500: oklch(72.3% 0.219 149.579);\n    --color-teal-500: oklch(70.4% 0.14 182.503);\n    --color-blue-500: oklch(62.3% 0.214 259.815);\n    --color-indigo-500: oklch(58.5% 0.233 277.117);\n    --color-purple-500: oklch(62.7% 0.265 303.9);\n    --color-pink-500: oklch(65.6% 0.241 354.308);\n    --color-gray-300: oklch(87.2% 0.01 258.338);\n    --color-white: #fff;\n    --spacing: 0.25rem;\n    --container-sm: 24rem;\n    --text-xs: 0.75rem;\n    --text-xs--line-height: calc(1 / 0.75);\n    --text-sm: 0.875rem;\n    --text-sm--line-height: calc(1.25 / 0.875);\n    --text-base: 1rem;\n    --text-base--line-height: calc(1.5 / 1);\n    --text-lg: 1.125rem;\n    --text-lg--line-height: calc(1.75 / 1.125);\n    --text-xl: 1.25rem;\n    --text-xl--line-height: calc(1.75 / 1.25);\n    --font-weight-medium: 500;\n    --font-weight-semibold: 600;\n    --font-weight-bold: 700;\n    --leading-relaxed: 1.625;\n    --radius-md: 0.375rem;\n    --radius-lg: 0.5rem;\n    --radius-xl: 0.75rem;\n    --radius-2xl: 1rem;\n    --ease-out: cubic-bezier(0, 0, 0.2, 1);\n    --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);\n    --animate-spin: spin 1s linear infinite;\n    --animate-pulse: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n    --default-transition-duration: 150ms;\n    --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    --default-font-family: var(--font-sans);\n    --default-mono-font-family: var(--font-mono);\n    --color-bg-app: var(--ep-background-app);\n    --color-bg-surface: var(--ep-background-surface);\n    --color-bg-surface-alt: var(--ep-background-surface-alt);\n    --color-bg-elevated: var(--ep-background-elevated);\n    --color-bg-overlay: var(--ep-background-overlay);\n    --color-bg-input: var(--ep-background-input);\n    --color-fg-primary: var(--ep-foreground-primary);\n    --color-fg-secondary: var(--ep-foreground-secondary);\n    --color-fg-muted: var(--ep-foreground-muted);\n    --color-fg-disabled: var(--ep-foreground-disabled);\n    --color-fg-on-accent: var(--ep-foreground-on-accent);\n    --color-border-default: var(--ep-border-default);\n    --color-border-subtle: var(--ep-border-subtle);\n    --color-border-strong: var(--ep-border-strong);\n    --color-accent: var(--ep-accent-primary);\n    --color-accent-hover: var(--ep-accent-primary-hover);\n    --color-accent-light: var(--ep-accent-primary-light);\n    --color-accent-fg: var(--ep-accent-primary-foreground);\n    --color-interactive-hover: var(--ep-interactive-hover);\n    --color-interactive-active: var(--ep-interactive-active);\n    --color-interactive-selected: var(--ep-interactive-selected);\n    --color-interactive-focus-ring: var(--ep-interactive-focus-ring);\n    --color-state-error: var(--ep-state-error);\n    --color-state-error-light: var(--ep-state-error-light);\n    --color-state-info-light: var(--ep-state-info-light);\n    --color-tooltip-bg: var(--ep-tooltip-background);\n    --color-tooltip-fg: var(--ep-tooltip-foreground);\n  }\n}\n@layer base {\n  *, ::after, ::before, ::backdrop, ::file-selector-button {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n    border: 0 solid;\n  }\n  html, :host {\n    line-height: 1.5;\n    -webkit-text-size-adjust: 100%;\n    -moz-tab-size: 4;\n      -o-tab-size: 4;\n         tab-size: 4;\n    font-family: var(--default-font-family, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji");\n    font-feature-settings: var(--default-font-feature-settings, normal);\n    font-variation-settings: var(--default-font-variation-settings, normal);\n    -webkit-tap-highlight-color: transparent;\n  }\n  hr {\n    height: 0;\n    color: inherit;\n    border-top-width: 1px;\n  }\n  abbr:where([title]) {\n    -webkit-text-decoration: underline dotted;\n    text-decoration: underline dotted;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    font-size: inherit;\n    font-weight: inherit;\n  }\n  a {\n    color: inherit;\n    -webkit-text-decoration: inherit;\n    text-decoration: inherit;\n  }\n  b, strong {\n    font-weight: bolder;\n  }\n  code, kbd, samp, pre {\n    font-family: var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace);\n    font-feature-settings: var(--default-mono-font-feature-settings, normal);\n    font-variation-settings: var(--default-mono-font-variation-settings, normal);\n    font-size: 1em;\n  }\n  small {\n    font-size: 80%;\n  }\n  sub, sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n  sub {\n    bottom: -0.25em;\n  }\n  sup {\n    top: -0.5em;\n  }\n  table {\n    text-indent: 0;\n    border-color: inherit;\n    border-collapse: collapse;\n  }\n  :-moz-focusring {\n    outline: auto;\n  }\n  progress {\n    vertical-align: baseline;\n  }\n  summary {\n    display: list-item;\n  }\n  ol, ul, menu {\n    list-style: none;\n  }\n  img, svg, video, canvas, audio, iframe, embed, object {\n    display: block;\n    vertical-align: middle;\n  }\n  img, video {\n    max-width: 100%;\n    height: auto;\n  }\n  button, input, select, optgroup, textarea, ::file-selector-button {\n    font: inherit;\n    font-feature-settings: inherit;\n    font-variation-settings: inherit;\n    letter-spacing: inherit;\n    color: inherit;\n    border-radius: 0;\n    background-color: transparent;\n    opacity: 1;\n  }\n  :where(select:is([multiple], [size])) optgroup {\n    font-weight: bolder;\n  }\n  :where(select:is([multiple], [size])) optgroup option {\n    padding-inline-start: 20px;\n  }\n  ::file-selector-button {\n    margin-inline-end: 4px;\n  }\n  ::-moz-placeholder {\n    opacity: 1;\n  }\n  ::placeholder {\n    opacity: 1;\n  }\n  @supports (not (-webkit-appearance: -apple-pay-button))  or (contain-intrinsic-size: 1px) {\n    ::-moz-placeholder {\n      color: currentcolor;\n      @supports (color: color-mix(in lab, red, red)) {\n        color: color-mix(in oklab, currentcolor 50%, transparent);\n      }\n    }\n    ::placeholder {\n      color: currentcolor;\n      @supports (color: color-mix(in lab, red, red)) {\n        color: color-mix(in oklab, currentcolor 50%, transparent);\n      }\n    }\n  }\n  textarea {\n    resize: vertical;\n  }\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n  ::-webkit-date-and-time-value {\n    min-height: 1lh;\n    text-align: inherit;\n  }\n  ::-webkit-datetime-edit {\n    display: inline-flex;\n  }\n  ::-webkit-datetime-edit-fields-wrapper {\n    padding: 0;\n  }\n  ::-webkit-datetime-edit, ::-webkit-datetime-edit-year-field, ::-webkit-datetime-edit-month-field, ::-webkit-datetime-edit-day-field, ::-webkit-datetime-edit-hour-field, ::-webkit-datetime-edit-minute-field, ::-webkit-datetime-edit-second-field, ::-webkit-datetime-edit-millisecond-field, ::-webkit-datetime-edit-meridiem-field {\n    padding-block: 0;\n  }\n  ::-webkit-calendar-picker-indicator {\n    line-height: 1;\n  }\n  :-moz-ui-invalid {\n    box-shadow: none;\n  }\n  button, input:where([type="button"], [type="reset"], [type="submit"]), ::file-selector-button {\n    -webkit-appearance: button;\n       -moz-appearance: button;\n            appearance: button;\n  }\n  ::-webkit-inner-spin-button, ::-webkit-outer-spin-button {\n    height: auto;\n  }\n  [hidden]:where(:not([hidden="until-found"])) {\n    display: none !important;\n  }\n}\n@layer utilities {\n  .pointer-events-auto {\n    pointer-events: auto;\n  }\n  .pointer-events-none {\n    pointer-events: none;\n  }\n  .visible {\n    visibility: visible;\n  }\n  .absolute {\n    position: absolute;\n  }\n  .fixed {\n    position: fixed;\n  }\n  .relative {\n    position: relative;\n  }\n  .static {\n    position: static;\n  }\n  .sticky {\n    position: sticky;\n  }\n  .inset-0 {\n    inset: calc(var(--spacing) * 0);\n  }\n  .inset-x-0 {\n    inset-inline: calc(var(--spacing) * 0);\n  }\n  .inset-y-0 {\n    inset-block: calc(var(--spacing) * 0);\n  }\n  .top-0 {\n    top: calc(var(--spacing) * 0);\n  }\n  .top-1\\/2 {\n    top: calc(1/2 * 100%);\n  }\n  .top-4 {\n    top: calc(var(--spacing) * 4);\n  }\n  .top-6 {\n    top: calc(var(--spacing) * 6);\n  }\n  .right-0 {\n    right: calc(var(--spacing) * 0);\n  }\n  .right-1 {\n    right: calc(var(--spacing) * 1);\n  }\n  .right-4 {\n    right: calc(var(--spacing) * 4);\n  }\n  .bottom-0 {\n    bottom: calc(var(--spacing) * 0);\n  }\n  .left-0 {\n    left: calc(var(--spacing) * 0);\n  }\n  .left-1\\/2 {\n    left: calc(1/2 * 100%);\n  }\n  .z-10 {\n    z-index: 10;\n  }\n  .z-40 {\n    z-index: 40;\n  }\n  .z-50 {\n    z-index: 50;\n  }\n  .z-100 {\n    z-index: 100;\n  }\n  .col-start-1 {\n    grid-column-start: 1;\n  }\n  .row-start-1 {\n    grid-row-start: 1;\n  }\n  .container {\n    width: 100%;\n    @media (width >= 40rem) {\n      max-width: 40rem;\n    }\n    @media (width >= 48rem) {\n      max-width: 48rem;\n    }\n    @media (width >= 64rem) {\n      max-width: 64rem;\n    }\n    @media (width >= 80rem) {\n      max-width: 80rem;\n    }\n    @media (width >= 96rem) {\n      max-width: 96rem;\n    }\n  }\n  .mx-4 {\n    margin-inline: calc(var(--spacing) * 4);\n  }\n  .my-2 {\n    margin-block: calc(var(--spacing) * 2);\n  }\n  .my-4 {\n    margin-block: calc(var(--spacing) * 4);\n  }\n  .mt-0\\.5 {\n    margin-top: calc(var(--spacing) * 0.5);\n  }\n  .mt-1 {\n    margin-top: calc(var(--spacing) * 1);\n  }\n  .mt-2 {\n    margin-top: calc(var(--spacing) * 2);\n  }\n  .mt-3 {\n    margin-top: calc(var(--spacing) * 3);\n  }\n  .mt-4 {\n    margin-top: calc(var(--spacing) * 4);\n  }\n  .mt-5 {\n    margin-top: calc(var(--spacing) * 5);\n  }\n  .mt-6 {\n    margin-top: calc(var(--spacing) * 6);\n  }\n  .mr-2 {\n    margin-right: calc(var(--spacing) * 2);\n  }\n  .mb-1 {\n    margin-bottom: calc(var(--spacing) * 1);\n  }\n  .mb-1\\.5 {\n    margin-bottom: calc(var(--spacing) * 1.5);\n  }\n  .mb-2 {\n    margin-bottom: calc(var(--spacing) * 2);\n  }\n  .mb-3 {\n    margin-bottom: calc(var(--spacing) * 3);\n  }\n  .mb-4 {\n    margin-bottom: calc(var(--spacing) * 4);\n  }\n  .mb-6 {\n    margin-bottom: calc(var(--spacing) * 6);\n  }\n  .ml-1 {\n    margin-left: calc(var(--spacing) * 1);\n  }\n  .block {\n    display: block;\n  }\n  .contents {\n    display: contents;\n  }\n  .flex {\n    display: flex;\n  }\n  .grid {\n    display: grid;\n  }\n  .hidden {\n    display: none;\n  }\n  .inline {\n    display: inline;\n  }\n  .inline-block {\n    display: inline-block;\n  }\n  .inline-flex {\n    display: inline-flex;\n  }\n  .h-1 {\n    height: calc(var(--spacing) * 1);\n  }\n  .h-1\\.5 {\n    height: calc(var(--spacing) * 1.5);\n  }\n  .h-2 {\n    height: calc(var(--spacing) * 2);\n  }\n  .h-3 {\n    height: calc(var(--spacing) * 3);\n  }\n  .h-3\\.5 {\n    height: calc(var(--spacing) * 3.5);\n  }\n  .h-4 {\n    height: calc(var(--spacing) * 4);\n  }\n  .h-5 {\n    height: calc(var(--spacing) * 5);\n  }\n  .h-6 {\n    height: calc(var(--spacing) * 6);\n  }\n  .h-7 {\n    height: calc(var(--spacing) * 7);\n  }\n  .h-8 {\n    height: calc(var(--spacing) * 8);\n  }\n  .h-9 {\n    height: calc(var(--spacing) * 9);\n  }\n  .h-10 {\n    height: calc(var(--spacing) * 10);\n  }\n  .h-16 {\n    height: calc(var(--spacing) * 16);\n  }\n  .h-18 {\n    height: calc(var(--spacing) * 18);\n  }\n  .h-\\[32px\\] {\n    height: 32px;\n  }\n  .h-full {\n    height: 100%;\n  }\n  .h-px {\n    height: 1px;\n  }\n  .max-h-48 {\n    max-height: calc(var(--spacing) * 48);\n  }\n  .max-h-60 {\n    max-height: calc(var(--spacing) * 60);\n  }\n  .min-h-0 {\n    min-height: calc(var(--spacing) * 0);\n  }\n  .\\!w-full {\n    width: 100% !important;\n  }\n  .w-2 {\n    width: calc(var(--spacing) * 2);\n  }\n  .w-3 {\n    width: calc(var(--spacing) * 3);\n  }\n  .w-3\\.5 {\n    width: calc(var(--spacing) * 3.5);\n  }\n  .w-4 {\n    width: calc(var(--spacing) * 4);\n  }\n  .w-5 {\n    width: calc(var(--spacing) * 5);\n  }\n  .w-6 {\n    width: calc(var(--spacing) * 6);\n  }\n  .w-8 {\n    width: calc(var(--spacing) * 8);\n  }\n  .w-9 {\n    width: calc(var(--spacing) * 9);\n  }\n  .w-10 {\n    width: calc(var(--spacing) * 10);\n  }\n  .w-12 {\n    width: calc(var(--spacing) * 12);\n  }\n  .w-16 {\n    width: calc(var(--spacing) * 16);\n  }\n  .w-18 {\n    width: calc(var(--spacing) * 18);\n  }\n  .w-32 {\n    width: calc(var(--spacing) * 32);\n  }\n  .w-36 {\n    width: calc(var(--spacing) * 36);\n  }\n  .w-\\[32px\\] {\n    width: 32px;\n  }\n  .w-auto {\n    width: auto;\n  }\n  .w-full {\n    width: 100%;\n  }\n  .w-px {\n    width: 1px;\n  }\n  .max-w-\\[150px\\] {\n    max-width: 150px;\n  }\n  .max-w-\\[240px\\] {\n    max-width: 240px;\n  }\n  .max-w-sm {\n    max-width: var(--container-sm);\n  }\n  .min-w-0 {\n    min-width: calc(var(--spacing) * 0);\n  }\n  .min-w-\\[8rem\\] {\n    min-width: 8rem;\n  }\n  .min-w-\\[32px\\] {\n    min-width: 32px;\n  }\n  .min-w-\\[120px\\] {\n    min-width: 120px;\n  }\n  .min-w-\\[200px\\] {\n    min-width: 200px;\n  }\n  .flex-1 {\n    flex: 1;\n  }\n  .flex-shrink-0 {\n    flex-shrink: 0;\n  }\n  .shrink-0 {\n    flex-shrink: 0;\n  }\n  .-translate-x-1\\/2 {\n    --tw-translate-x: calc(calc(1/2 * 100%) * -1);\n    translate: var(--tw-translate-x) var(--tw-translate-y);\n  }\n  .translate-x-\\[1px\\] {\n    --tw-translate-x: 1px;\n    translate: var(--tw-translate-x) var(--tw-translate-y);\n  }\n  .-translate-y-1\\/2 {\n    --tw-translate-y: calc(calc(1/2 * 100%) * -1);\n    translate: var(--tw-translate-x) var(--tw-translate-y);\n  }\n  .translate-y-\\[1px\\] {\n    --tw-translate-y: 1px;\n    translate: var(--tw-translate-x) var(--tw-translate-y);\n  }\n  .scale-95 {\n    --tw-scale-x: 95%;\n    --tw-scale-y: 95%;\n    --tw-scale-z: 95%;\n    scale: var(--tw-scale-x) var(--tw-scale-y);\n  }\n  .scale-100 {\n    --tw-scale-x: 100%;\n    --tw-scale-y: 100%;\n    --tw-scale-z: 100%;\n    scale: var(--tw-scale-x) var(--tw-scale-y);\n  }\n  .rotate-45 {\n    rotate: 45deg;\n  }\n  .transform {\n    transform: var(--tw-rotate-x,) var(--tw-rotate-y,) var(--tw-rotate-z,) var(--tw-skew-x,) var(--tw-skew-y,);\n  }\n  .animate-pulse {\n    animation: var(--animate-pulse);\n  }\n  .animate-spin {\n    animation: var(--animate-spin);\n  }\n  .cursor-default {\n    cursor: default;\n  }\n  .cursor-grab {\n    cursor: grab;\n  }\n  .cursor-not-allowed {\n    cursor: not-allowed;\n  }\n  .cursor-pointer {\n    cursor: pointer;\n  }\n  .touch-none {\n    touch-action: none;\n  }\n  .resize {\n    resize: both;\n  }\n  .appearance-none {\n    -webkit-appearance: none;\n       -moz-appearance: none;\n            appearance: none;\n  }\n  .grid-cols-2 {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n  }\n  .grid-cols-6 {\n    grid-template-columns: repeat(6, minmax(0, 1fr));\n  }\n  .flex-col {\n    flex-direction: column;\n  }\n  .flex-row {\n    flex-direction: row;\n  }\n  .flex-wrap {\n    flex-wrap: wrap;\n  }\n  .items-center {\n    align-items: center;\n  }\n  .items-end {\n    align-items: flex-end;\n  }\n  .items-start {\n    align-items: flex-start;\n  }\n  .justify-between {\n    justify-content: space-between;\n  }\n  .justify-center {\n    justify-content: center;\n  }\n  .justify-end {\n    justify-content: flex-end;\n  }\n  .justify-start {\n    justify-content: flex-start;\n  }\n  .gap-1 {\n    gap: calc(var(--spacing) * 1);\n  }\n  .gap-2 {\n    gap: calc(var(--spacing) * 2);\n  }\n  .gap-3 {\n    gap: calc(var(--spacing) * 3);\n  }\n  .gap-4 {\n    gap: calc(var(--spacing) * 4);\n  }\n  .space-y-2 {\n    :where(& > :not(:last-child)) {\n      --tw-space-y-reverse: 0;\n      margin-block-start: calc(calc(var(--spacing) * 2) * var(--tw-space-y-reverse));\n      margin-block-end: calc(calc(var(--spacing) * 2) * calc(1 - var(--tw-space-y-reverse)));\n    }\n  }\n  .space-y-3 {\n    :where(& > :not(:last-child)) {\n      --tw-space-y-reverse: 0;\n      margin-block-start: calc(calc(var(--spacing) * 3) * var(--tw-space-y-reverse));\n      margin-block-end: calc(calc(var(--spacing) * 3) * calc(1 - var(--tw-space-y-reverse)));\n    }\n  }\n  .space-y-4 {\n    :where(& > :not(:last-child)) {\n      --tw-space-y-reverse: 0;\n      margin-block-start: calc(calc(var(--spacing) * 4) * var(--tw-space-y-reverse));\n      margin-block-end: calc(calc(var(--spacing) * 4) * calc(1 - var(--tw-space-y-reverse)));\n    }\n  }\n  .space-y-6 {\n    :where(& > :not(:last-child)) {\n      --tw-space-y-reverse: 0;\n      margin-block-start: calc(calc(var(--spacing) * 6) * var(--tw-space-y-reverse));\n      margin-block-end: calc(calc(var(--spacing) * 6) * calc(1 - var(--tw-space-y-reverse)));\n    }\n  }\n  .gap-x-1 {\n    -moz-column-gap: calc(var(--spacing) * 1);\n         column-gap: calc(var(--spacing) * 1);\n  }\n  .space-x-2 {\n    :where(& > :not(:last-child)) {\n      --tw-space-x-reverse: 0;\n      margin-inline-start: calc(calc(var(--spacing) * 2) * var(--tw-space-x-reverse));\n      margin-inline-end: calc(calc(var(--spacing) * 2) * calc(1 - var(--tw-space-x-reverse)));\n    }\n  }\n  .space-x-3 {\n    :where(& > :not(:last-child)) {\n      --tw-space-x-reverse: 0;\n      margin-inline-start: calc(calc(var(--spacing) * 3) * var(--tw-space-x-reverse));\n      margin-inline-end: calc(calc(var(--spacing) * 3) * calc(1 - var(--tw-space-x-reverse)));\n    }\n  }\n  .gap-y-4 {\n    row-gap: calc(var(--spacing) * 4);\n  }\n  .divide-y {\n    :where(& > :not(:last-child)) {\n      --tw-divide-y-reverse: 0;\n      border-bottom-style: var(--tw-border-style);\n      border-top-style: var(--tw-border-style);\n      border-top-width: calc(1px * var(--tw-divide-y-reverse));\n      border-bottom-width: calc(1px * calc(1 - var(--tw-divide-y-reverse)));\n    }\n  }\n  .divide-border-subtle {\n    :where(& > :not(:last-child)) {\n      border-color: var(--color-border-subtle);\n    }\n  }\n  .truncate {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  .overflow-auto {\n    overflow: auto;\n  }\n  .overflow-hidden {\n    overflow: hidden;\n  }\n  .overflow-x-auto {\n    overflow-x: auto;\n  }\n  .overflow-y-auto {\n    overflow-y: auto;\n  }\n  .rounded {\n    border-radius: 0.25rem;\n  }\n  .rounded-\\[3px\\] {\n    border-radius: 3px;\n  }\n  .rounded-full {\n    border-radius: calc(infinity * 1px);\n  }\n  .rounded-lg {\n    border-radius: var(--radius-lg);\n  }\n  .rounded-md {\n    border-radius: var(--radius-md);\n  }\n  .rounded-none {\n    border-radius: 0;\n  }\n  .rounded-xl {\n    border-radius: var(--radius-xl);\n  }\n  .rounded-t-2xl {\n    border-top-left-radius: var(--radius-2xl);\n    border-top-right-radius: var(--radius-2xl);\n  }\n  .rounded-t-lg {\n    border-top-left-radius: var(--radius-lg);\n    border-top-right-radius: var(--radius-lg);\n  }\n  .rounded-l-md {\n    border-top-left-radius: var(--radius-md);\n    border-bottom-left-radius: var(--radius-md);\n  }\n  .rounded-r-md {\n    border-top-right-radius: var(--radius-md);\n    border-bottom-right-radius: var(--radius-md);\n  }\n  .border {\n    border-style: var(--tw-border-style);\n    border-width: 1px;\n  }\n  .border-0 {\n    border-style: var(--tw-border-style);\n    border-width: 0px;\n  }\n  .border-2 {\n    border-style: var(--tw-border-style);\n    border-width: 2px;\n  }\n  .border-3 {\n    border-style: var(--tw-border-style);\n    border-width: 3px;\n  }\n  .border-4 {\n    border-style: var(--tw-border-style);\n    border-width: 4px;\n  }\n  .border-t {\n    border-top-style: var(--tw-border-style);\n    border-top-width: 1px;\n  }\n  .border-r {\n    border-right-style: var(--tw-border-style);\n    border-right-width: 1px;\n  }\n  .border-r-0 {\n    border-right-style: var(--tw-border-style);\n    border-right-width: 0px;\n  }\n  .border-b {\n    border-bottom-style: var(--tw-border-style);\n    border-bottom-width: 1px;\n  }\n  .border-b-2 {\n    border-bottom-style: var(--tw-border-style);\n    border-bottom-width: 2px;\n  }\n  .border-l {\n    border-left-style: var(--tw-border-style);\n    border-left-width: 1px;\n  }\n  .border-none {\n    --tw-border-style: none;\n    border-style: none;\n  }\n  .border-\\[\\#cfd4da\\] {\n    border-color: #cfd4da;\n  }\n  .border-accent {\n    border-color: var(--color-accent);\n  }\n  .border-border-default {\n    border-color: var(--color-border-default);\n  }\n  .border-border-strong {\n    border-color: var(--color-border-strong);\n  }\n  .border-border-subtle {\n    border-color: var(--color-border-subtle);\n  }\n  .border-gray-300 {\n    border-color: var(--color-gray-300);\n  }\n  .border-state-error {\n    border-color: var(--color-state-error);\n  }\n  .border-transparent {\n    border-color: transparent;\n  }\n  .border-t-accent {\n    border-top-color: var(--color-accent);\n  }\n  .border-r-accent {\n    border-right-color: var(--color-accent);\n  }\n  .border-b-accent {\n    border-bottom-color: var(--color-accent);\n  }\n  .border-b-transparent {\n    border-bottom-color: transparent;\n  }\n  .bg-\\[\\#f8f9fa\\] {\n    background-color: #f8f9fa;\n  }\n  .bg-accent {\n    background-color: var(--color-accent);\n  }\n  .bg-accent-light {\n    background-color: var(--color-accent-light);\n  }\n  .bg-bg-app {\n    background-color: var(--color-bg-app);\n  }\n  .bg-bg-elevated {\n    background-color: var(--color-bg-elevated);\n  }\n  .bg-bg-input {\n    background-color: var(--color-bg-input);\n  }\n  .bg-bg-overlay {\n    background-color: var(--color-bg-overlay);\n  }\n  .bg-bg-surface {\n    background-color: var(--color-bg-surface);\n  }\n  .bg-bg-surface-alt {\n    background-color: var(--color-bg-surface-alt);\n  }\n  .bg-bg-surface\\/80 {\n    background-color: var(--color-bg-surface);\n    @supports (color: color-mix(in lab, red, red)) {\n      background-color: color-mix(in oklab, var(--color-bg-surface) 80%, transparent);\n    }\n  }\n  .bg-blue-500 {\n    background-color: var(--color-blue-500);\n  }\n  .bg-border-default {\n    background-color: var(--color-border-default);\n  }\n  .bg-border-subtle {\n    background-color: var(--color-border-subtle);\n  }\n  .bg-green-500 {\n    background-color: var(--color-green-500);\n  }\n  .bg-indigo-500 {\n    background-color: var(--color-indigo-500);\n  }\n  .bg-inherit {\n    background-color: inherit;\n  }\n  .bg-interactive-hover {\n    background-color: var(--color-interactive-hover);\n  }\n  .bg-interactive-selected {\n    background-color: var(--color-interactive-selected);\n  }\n  .bg-pink-500 {\n    background-color: var(--color-pink-500);\n  }\n  .bg-purple-500 {\n    background-color: var(--color-purple-500);\n  }\n  .bg-red-500 {\n    background-color: var(--color-red-500);\n  }\n  .bg-state-error-light {\n    background-color: var(--color-state-error-light);\n  }\n  .bg-state-info-light {\n    background-color: var(--color-state-info-light);\n  }\n  .bg-teal-500 {\n    background-color: var(--color-teal-500);\n  }\n  .bg-tooltip-bg {\n    background-color: var(--color-tooltip-bg);\n  }\n  .bg-transparent {\n    background-color: transparent;\n  }\n  .bg-white {\n    background-color: var(--color-white);\n  }\n  .bg-yellow-500 {\n    background-color: var(--color-yellow-500);\n  }\n  .p-0 {\n    padding: calc(var(--spacing) * 0);\n  }\n  .p-1 {\n    padding: calc(var(--spacing) * 1);\n  }\n  .p-1\\.5 {\n    padding: calc(var(--spacing) * 1.5);\n  }\n  .p-2 {\n    padding: calc(var(--spacing) * 2);\n  }\n  .p-3 {\n    padding: calc(var(--spacing) * 3);\n  }\n  .p-4 {\n    padding: calc(var(--spacing) * 4);\n  }\n  .p-5 {\n    padding: calc(var(--spacing) * 5);\n  }\n  .p-6 {\n    padding: calc(var(--spacing) * 6);\n  }\n  .p-8 {\n    padding: calc(var(--spacing) * 8);\n  }\n  .p-\\[5px\\] {\n    padding: 5px;\n  }\n  .px-1 {\n    padding-inline: calc(var(--spacing) * 1);\n  }\n  .px-2 {\n    padding-inline: calc(var(--spacing) * 2);\n  }\n  .px-3 {\n    padding-inline: calc(var(--spacing) * 3);\n  }\n  .px-4 {\n    padding-inline: calc(var(--spacing) * 4);\n  }\n  .px-5 {\n    padding-inline: calc(var(--spacing) * 5);\n  }\n  .px-6 {\n    padding-inline: calc(var(--spacing) * 6);\n  }\n  .py-1 {\n    padding-block: calc(var(--spacing) * 1);\n  }\n  .py-1\\.5 {\n    padding-block: calc(var(--spacing) * 1.5);\n  }\n  .py-2 {\n    padding-block: calc(var(--spacing) * 2);\n  }\n  .py-2\\.5 {\n    padding-block: calc(var(--spacing) * 2.5);\n  }\n  .py-3 {\n    padding-block: calc(var(--spacing) * 3);\n  }\n  .py-4 {\n    padding-block: calc(var(--spacing) * 4);\n  }\n  .pt-2 {\n    padding-top: calc(var(--spacing) * 2);\n  }\n  .pt-4 {\n    padding-top: calc(var(--spacing) * 4);\n  }\n  .pr-2 {\n    padding-right: calc(var(--spacing) * 2);\n  }\n  .pr-3 {\n    padding-right: calc(var(--spacing) * 3);\n  }\n  .pr-7 {\n    padding-right: calc(var(--spacing) * 7);\n  }\n  .pr-9 {\n    padding-right: calc(var(--spacing) * 9);\n  }\n  .pb-3 {\n    padding-bottom: calc(var(--spacing) * 3);\n  }\n  .pl-2 {\n    padding-left: calc(var(--spacing) * 2);\n  }\n  .pl-3 {\n    padding-left: calc(var(--spacing) * 3);\n  }\n  .pl-4 {\n    padding-left: calc(var(--spacing) * 4);\n  }\n  .pl-8 {\n    padding-left: calc(var(--spacing) * 8);\n  }\n  .text-center {\n    text-align: center;\n  }\n  .text-left {\n    text-align: left;\n  }\n  .text-right {\n    text-align: right;\n  }\n  .text-base {\n    font-size: var(--text-base);\n    line-height: var(--tw-leading, var(--text-base--line-height));\n  }\n  .text-lg {\n    font-size: var(--text-lg);\n    line-height: var(--tw-leading, var(--text-lg--line-height));\n  }\n  .text-sm {\n    font-size: var(--text-sm);\n    line-height: var(--tw-leading, var(--text-sm--line-height));\n  }\n  .text-xl {\n    font-size: var(--text-xl);\n    line-height: var(--tw-leading, var(--text-xl--line-height));\n  }\n  .text-xs {\n    font-size: var(--text-xs);\n    line-height: var(--tw-leading, var(--text-xs--line-height));\n  }\n  .text-\\[13px\\] {\n    font-size: 13px;\n  }\n  .leading-none {\n    --tw-leading: 1;\n    line-height: 1;\n  }\n  .leading-relaxed {\n    --tw-leading: var(--leading-relaxed);\n    line-height: var(--leading-relaxed);\n  }\n  .font-bold {\n    --tw-font-weight: var(--font-weight-bold);\n    font-weight: var(--font-weight-bold);\n  }\n  .font-medium {\n    --tw-font-weight: var(--font-weight-medium);\n    font-weight: var(--font-weight-medium);\n  }\n  .font-semibold {\n    --tw-font-weight: var(--font-weight-semibold);\n    font-weight: var(--font-weight-semibold);\n  }\n  .whitespace-nowrap {\n    white-space: nowrap;\n  }\n  .text-accent {\n    color: var(--color-accent);\n  }\n  .text-accent-fg {\n    color: var(--color-accent-fg);\n  }\n  .text-fg-disabled {\n    color: var(--color-fg-disabled);\n  }\n  .text-fg-muted {\n    color: var(--color-fg-muted);\n  }\n  .text-fg-on-accent {\n    color: var(--color-fg-on-accent);\n  }\n  .text-fg-primary {\n    color: var(--color-fg-primary);\n  }\n  .text-fg-secondary {\n    color: var(--color-fg-secondary);\n  }\n  .text-state-error {\n    color: var(--color-state-error);\n  }\n  .text-tooltip-fg {\n    color: var(--color-tooltip-fg);\n  }\n  .text-white {\n    color: var(--color-white);\n  }\n  .uppercase {\n    text-transform: uppercase;\n  }\n  .italic {\n    font-style: italic;\n  }\n  .underline {\n    text-decoration-line: underline;\n  }\n  .placeholder-fg-muted {\n    &::-moz-placeholder {\n      color: var(--color-fg-muted);\n    }\n    &::placeholder {\n      color: var(--color-fg-muted);\n    }\n  }\n  .accent-accent {\n    accent-color: var(--color-accent);\n  }\n  .opacity-0 {\n    opacity: 0%;\n  }\n  .opacity-50 {\n    opacity: 50%;\n  }\n  .opacity-100 {\n    opacity: 100%;\n  }\n  .shadow {\n    --tw-shadow: 0 1px 3px 0 var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 1px 2px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .shadow-2xl {\n    --tw-shadow: 0 25px 50px -12px var(--tw-shadow-color, rgb(0 0 0 / 0.25));\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .shadow-lg {\n    --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 4px 6px -4px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .shadow-md {\n    --tw-shadow: 0 4px 6px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 2px 4px -2px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .shadow-sm {\n    --tw-shadow: 0 1px 3px 0 var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 1px 2px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .ring {\n    --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .ring-1 {\n    --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .ring-2 {\n    --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n  .ring-accent {\n    --tw-ring-color: var(--color-accent);\n  }\n  .ring-border-default {\n    --tw-ring-color: var(--color-border-default);\n  }\n  .ring-interactive-focus-ring {\n    --tw-ring-color: var(--color-interactive-focus-ring);\n  }\n  .outline {\n    outline-style: var(--tw-outline-style);\n    outline-width: 1px;\n  }\n  .outline-1 {\n    outline-style: var(--tw-outline-style);\n    outline-width: 1px;\n  }\n  .outline-2 {\n    outline-style: var(--tw-outline-style);\n    outline-width: 2px;\n  }\n  .-outline-offset-1 {\n    outline-offset: calc(1px * -1);\n  }\n  .outline-offset-2 {\n    outline-offset: 2px;\n  }\n  .outline-accent {\n    outline-color: var(--color-accent);\n  }\n  .outline-border-default {\n    outline-color: var(--color-border-default);\n  }\n  .backdrop-blur {\n    --tw-backdrop-blur: blur(8px);\n    backdrop-filter: var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,);\n  }\n  .transition {\n    transition-property: color, background-color, border-color, outline-color, text-decoration-color, fill, stroke, --tw-gradient-from, --tw-gradient-via, --tw-gradient-to, opacity, box-shadow, transform, translate, scale, rotate, filter, backdrop-filter, display, content-visibility, overlay, pointer-events;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-\\[height\\] {\n    transition-property: height;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-all {\n    transition-property: all;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-colors {\n    transition-property: color, background-color, border-color, outline-color, text-decoration-color, fill, stroke, --tw-gradient-from, --tw-gradient-via, --tw-gradient-to;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-opacity {\n    transition-property: opacity;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .transition-transform {\n    transition-property: transform, translate, scale, rotate;\n    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n    transition-duration: var(--tw-duration, var(--default-transition-duration));\n  }\n  .duration-150 {\n    --tw-duration: 150ms;\n    transition-duration: 150ms;\n  }\n  .duration-200 {\n    --tw-duration: 200ms;\n    transition-duration: 200ms;\n  }\n  .duration-300 {\n    --tw-duration: 300ms;\n    transition-duration: 300ms;\n  }\n  .ease-in-out {\n    --tw-ease: var(--ease-in-out);\n    transition-timing-function: var(--ease-in-out);\n  }\n  .ease-out {\n    --tw-ease: var(--ease-out);\n    transition-timing-function: var(--ease-out);\n  }\n  .outline-none {\n    --tw-outline-style: none;\n    outline-style: none;\n  }\n  .select-none {\n    -webkit-user-select: none;\n    -moz-user-select: none;\n         user-select: none;\n  }\n  .group-hover\\:opacity-100 {\n    &:is(:where(.group):hover *) {\n      @media (hover: hover) {\n        opacity: 100%;\n      }\n    }\n  }\n  .peer-checked\\:opacity-100 {\n    &:is(:where(.peer):checked ~ *) {\n      opacity: 100%;\n    }\n  }\n  .placeholder\\:text-fg-muted {\n    &::-moz-placeholder {\n      color: var(--color-fg-muted);\n    }\n    &::placeholder {\n      color: var(--color-fg-muted);\n    }\n  }\n  .first\\:mt-0 {\n    &:first-child {\n      margin-top: calc(var(--spacing) * 0);\n    }\n  }\n  .checked\\:border-accent {\n    &:checked {\n      border-color: var(--color-accent);\n    }\n  }\n  .checked\\:bg-accent {\n    &:checked {\n      background-color: var(--color-accent);\n    }\n  }\n  .hover\\:border-b-accent {\n    &:hover {\n      @media (hover: hover) {\n        border-bottom-color: var(--color-accent);\n      }\n    }\n  }\n  .hover\\:border-b-fg-muted {\n    &:hover {\n      @media (hover: hover) {\n        border-bottom-color: var(--color-fg-muted);\n      }\n    }\n  }\n  .hover\\:\\!bg-accent-hover {\n    &:hover {\n      @media (hover: hover) {\n        background-color: var(--color-accent-hover) !important;\n      }\n    }\n  }\n  .hover\\:bg-accent {\n    &:hover {\n      @media (hover: hover) {\n        background-color: var(--color-accent);\n      }\n    }\n  }\n  .hover\\:bg-accent-hover {\n    &:hover {\n      @media (hover: hover) {\n        background-color: var(--color-accent-hover);\n      }\n    }\n  }\n  .hover\\:bg-border-default {\n    &:hover {\n      @media (hover: hover) {\n        background-color: var(--color-border-default);\n      }\n    }\n  }\n  .hover\\:bg-interactive-hover {\n    &:hover {\n      @media (hover: hover) {\n        background-color: var(--color-interactive-hover);\n      }\n    }\n  }\n  .hover\\:bg-transparent {\n    &:hover {\n      @media (hover: hover) {\n        background-color: transparent;\n      }\n    }\n  }\n  .hover\\:text-accent-hover {\n    &:hover {\n      @media (hover: hover) {\n        color: var(--color-accent-hover);\n      }\n    }\n  }\n  .hover\\:text-fg-on-accent {\n    &:hover {\n      @media (hover: hover) {\n        color: var(--color-fg-on-accent);\n      }\n    }\n  }\n  .hover\\:text-fg-primary {\n    &:hover {\n      @media (hover: hover) {\n        color: var(--color-fg-primary);\n      }\n    }\n  }\n  .hover\\:text-fg-secondary {\n    &:hover {\n      @media (hover: hover) {\n        color: var(--color-fg-secondary);\n      }\n    }\n  }\n  .hover\\:shadow-md {\n    &:hover {\n      @media (hover: hover) {\n        --tw-shadow: 0 4px 6px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 2px 4px -2px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n        box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n      }\n    }\n  }\n  .hover\\:ring {\n    &:hover {\n      @media (hover: hover) {\n        --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n        box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n      }\n    }\n  }\n  .hover\\:ring-0 {\n    &:hover {\n      @media (hover: hover) {\n        --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n        box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n      }\n    }\n  }\n  .hover\\:ring-accent {\n    &:hover {\n      @media (hover: hover) {\n        --tw-ring-color: var(--color-accent);\n      }\n    }\n  }\n  .hover\\:ring-transparent {\n    &:hover {\n      @media (hover: hover) {\n        --tw-ring-color: transparent;\n      }\n    }\n  }\n  .focus\\:border-accent {\n    &:focus {\n      border-color: var(--color-accent);\n    }\n  }\n  .focus\\:border-blue-500 {\n    &:focus {\n      border-color: var(--color-blue-500);\n    }\n  }\n  .focus\\:border-transparent {\n    &:focus {\n      border-color: transparent;\n    }\n  }\n  .focus\\:ring-1 {\n    &:focus {\n      --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n      box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n    }\n  }\n  .focus\\:ring-2 {\n    &:focus {\n      --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n      box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n    }\n  }\n  .focus\\:ring-accent {\n    &:focus {\n      --tw-ring-color: var(--color-accent);\n    }\n  }\n  .focus\\:ring-blue-500 {\n    &:focus {\n      --tw-ring-color: var(--color-blue-500);\n    }\n  }\n  .focus\\:outline-none {\n    &:focus {\n      --tw-outline-style: none;\n      outline-style: none;\n    }\n  }\n  .active\\:cursor-grabbing {\n    &:active {\n      cursor: grabbing;\n    }\n  }\n  .active\\:bg-interactive-active {\n    &:active {\n      background-color: var(--color-interactive-active);\n    }\n  }\n  .disabled\\:cursor-not-allowed {\n    &:disabled {\n      cursor: not-allowed;\n    }\n  }\n  .disabled\\:opacity-40 {\n    &:disabled {\n      opacity: 40%;\n    }\n  }\n  .disabled\\:opacity-50 {\n    &:disabled {\n      opacity: 50%;\n    }\n  }\n  .disabled\\:hover\\:bg-transparent {\n    &:disabled {\n      &:hover {\n        @media (hover: hover) {\n          background-color: transparent;\n        }\n      }\n    }\n  }\n  .disabled\\:hover\\:ring-0 {\n    &:disabled {\n      &:hover {\n        @media (hover: hover) {\n          --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n          box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n        }\n      }\n    }\n  }\n  .md\\:flex {\n    @media (width >= 48rem) {\n      display: flex;\n    }\n  }\n  .md\\:h-auto {\n    @media (width >= 48rem) {\n      height: auto;\n    }\n  }\n  .md\\:max-h-\\[80vh\\] {\n    @media (width >= 48rem) {\n      max-height: 80vh;\n    }\n  }\n  .md\\:w-\\[28rem\\] {\n    @media (width >= 48rem) {\n      width: 28rem;\n    }\n  }\n  .md\\:w-\\[32rem\\] {\n    @media (width >= 48rem) {\n      width: 32rem;\n    }\n  }\n  .md\\:w-\\[48rem\\] {\n    @media (width >= 48rem) {\n      width: 48rem;\n    }\n  }\n  .md\\:max-w-\\[90vw\\] {\n    @media (width >= 48rem) {\n      max-width: 90vw;\n    }\n  }\n  .md\\:flex-none {\n    @media (width >= 48rem) {\n      flex: none;\n    }\n  }\n  .md\\:items-center {\n    @media (width >= 48rem) {\n      align-items: center;\n    }\n  }\n  .md\\:justify-center {\n    @media (width >= 48rem) {\n      justify-content: center;\n    }\n  }\n  .md\\:rounded-lg {\n    @media (width >= 48rem) {\n      border-radius: var(--radius-lg);\n    }\n  }\n  .md\\:border {\n    @media (width >= 48rem) {\n      border-style: var(--tw-border-style);\n      border-width: 1px;\n    }\n  }\n  .md\\:border-border-subtle {\n    @media (width >= 48rem) {\n      border-color: var(--color-border-subtle);\n    }\n  }\n  .md\\:shadow-lg {\n    @media (width >= 48rem) {\n      --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 4px 6px -4px var(--tw-shadow-color, rgb(0 0 0 / 0.1));\n      box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n    }\n  }\n}\n@import url(\'https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap\');\n:host {\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-translate-z: 0;\n  --tw-rotate-x: rotateX(0);\n  --tw-rotate-y: rotateY(0);\n  --tw-rotate-z: rotateZ(0);\n  --tw-skew-x: skewX(0);\n  --tw-skew-y: skewY(0);\n  --tw-border-style: solid;\n  --tw-gradient-from: #0000;\n  --tw-gradient-via: #0000;\n  --tw-gradient-to: #0000;\n  --tw-gradient-from-position: 0%;\n  --tw-gradient-via-position: 50%;\n  --tw-gradient-to-position: 100%;\n  --tw-shadow: 0 0 #0000;\n  --tw-inset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-inset-ring-shadow: 0 0 #0000;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-outline-style: solid;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  font-family: \'Open Sans\', system-ui, sans-serif;\n  color: var(--ep-foreground-primary);\n  background-color: var(--ep-background-surface);\n}\n:host *::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n:host *::-webkit-scrollbar-track {\n  background: var(--ep-scrollbar-track);\n}\n:host *::-webkit-scrollbar-thumb {\n  background: var(--ep-scrollbar-thumb);\n  border-radius: 4px;\n}\n:host *::-webkit-scrollbar-thumb:hover {\n  background: var(--ep-scrollbar-thumb-hover);\n}\n@property --tw-translate-x {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0;\n}\n@property --tw-translate-y {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0;\n}\n@property --tw-translate-z {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0;\n}\n@property --tw-scale-x {\n  syntax: "*";\n  inherits: false;\n  initial-value: 1;\n}\n@property --tw-scale-y {\n  syntax: "*";\n  inherits: false;\n  initial-value: 1;\n}\n@property --tw-scale-z {\n  syntax: "*";\n  inherits: false;\n  initial-value: 1;\n}\n@property --tw-rotate-x {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-rotate-y {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-rotate-z {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-skew-x {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-skew-y {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-space-y-reverse {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0;\n}\n@property --tw-space-x-reverse {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0;\n}\n@property --tw-divide-y-reverse {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0;\n}\n@property --tw-border-style {\n  syntax: "*";\n  inherits: false;\n  initial-value: solid;\n}\n@property --tw-leading {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-font-weight {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-shadow {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-shadow-color {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-shadow-alpha {\n  syntax: "<percentage>";\n  inherits: false;\n  initial-value: 100%;\n}\n@property --tw-inset-shadow {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-inset-shadow-color {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-inset-shadow-alpha {\n  syntax: "<percentage>";\n  inherits: false;\n  initial-value: 100%;\n}\n@property --tw-ring-color {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-ring-shadow {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-inset-ring-color {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-inset-ring-shadow {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-ring-inset {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-ring-offset-width {\n  syntax: "<length>";\n  inherits: false;\n  initial-value: 0px;\n}\n@property --tw-ring-offset-color {\n  syntax: "*";\n  inherits: false;\n  initial-value: #fff;\n}\n@property --tw-ring-offset-shadow {\n  syntax: "*";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-outline-style {\n  syntax: "*";\n  inherits: false;\n  initial-value: solid;\n}\n@property --tw-backdrop-blur {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-brightness {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-contrast {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-grayscale {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-hue-rotate {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-invert {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-opacity {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-saturate {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-backdrop-sepia {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-duration {\n  syntax: "*";\n  inherits: false;\n}\n@property --tw-ease {\n  syntax: "*";\n  inherits: false;\n}\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n@keyframes pulse {\n  50% {\n    opacity: 0.5;\n  }\n}\n@layer properties {\n  @supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))) {\n    *, ::before, ::after, ::backdrop {\n      --tw-translate-x: 0;\n      --tw-translate-y: 0;\n      --tw-translate-z: 0;\n      --tw-scale-x: 1;\n      --tw-scale-y: 1;\n      --tw-scale-z: 1;\n      --tw-rotate-x: initial;\n      --tw-rotate-y: initial;\n      --tw-rotate-z: initial;\n      --tw-skew-x: initial;\n      --tw-skew-y: initial;\n      --tw-space-y-reverse: 0;\n      --tw-space-x-reverse: 0;\n      --tw-divide-y-reverse: 0;\n      --tw-border-style: solid;\n      --tw-leading: initial;\n      --tw-font-weight: initial;\n      --tw-shadow: 0 0 #0000;\n      --tw-shadow-color: initial;\n      --tw-shadow-alpha: 100%;\n      --tw-inset-shadow: 0 0 #0000;\n      --tw-inset-shadow-color: initial;\n      --tw-inset-shadow-alpha: 100%;\n      --tw-ring-color: initial;\n      --tw-ring-shadow: 0 0 #0000;\n      --tw-inset-ring-color: initial;\n      --tw-inset-ring-shadow: 0 0 #0000;\n      --tw-ring-inset: initial;\n      --tw-ring-offset-width: 0px;\n      --tw-ring-offset-color: #fff;\n      --tw-ring-offset-shadow: 0 0 #0000;\n      --tw-outline-style: solid;\n      --tw-backdrop-blur: initial;\n      --tw-backdrop-brightness: initial;\n      --tw-backdrop-contrast: initial;\n      --tw-backdrop-grayscale: initial;\n      --tw-backdrop-hue-rotate: initial;\n      --tw-backdrop-invert: initial;\n      --tw-backdrop-opacity: initial;\n      --tw-backdrop-saturate: initial;\n      --tw-backdrop-sepia: initial;\n      --tw-duration: initial;\n      --tw-ease: initial;\n    }\n  }\n}\n'),!s||l?U("div",{className:"flex h-full w-full items-center justify-center"},U(bf,{size:"lg",text:"Initializing PDF engine..."})):U(go,{logger:o.log?EF:void 0,onInitialized:(t=a(F().m(function e(t){return F().w(function(e){for(;;)switch(e.n){case 0:r&&t&&r(t);case 1:return e.a(2)}},e)})),function(e){return t.apply(this,arguments)}),engine:s,plugins:[Xn(Va,g(g(g({},wF.documentManager),o.src&&{initialDocuments:[{url:o.src}]}),o.documentManager)),Xn(ni,g(g(g({},wF.commands),o.disabledCategories&&{disabledCategories:o.disabledCategories}),o.commands)),Xn(mi,g(g({},wF.i18n),o.i18n)),Xn(ya,g(g(g({},wF.ui),o.disabledCategories&&{disabledCategories:o.disabledCategories}),o.ui)),Xn(zo,g(g({},wF.viewport),o.viewport)),Xn(nr,g(g({},wF.scroll),o.scroll)),Xn(wi,g(g({},wF.zoom),o.zoom)),Xn(Fr,g(g({},wF.spread),o.spread)),Xn(Wi,g(g({},wF.rotation),o.rotation)),Xn(Fu,g(g({},wF.pan),o.pan)),Xn(Oi,g(g({},wF.render),o.render)),Xn(ll,g(g({},wF.tiling),o.tiling)),Xn(Dl,g(g({},wF.thumbnails),o.thumbnails)),Xn(Vd,g(g({},wF.annotations),o.annotations)),Xn(us,g(g({},wF.search),o.search)),Xn(Ks,g(g({},wF.selection),o.selection)),Xn(iu,g(g({},wF.bookmarks),o.bookmarks)),Xn(fm,g(g({},wF.attachments),o.attachments)),Xn(Su,g(g({},wF.capture),o.capture)),Xn(im,g(g({},wF.redaction),o.redaction)),Xn(qc,g(g({},wF.print),o.print)),Xn(cu,g(g({},wF.export),o.export)),Xn(tu,g(g({},wF.fullscreen),o.fullscreen)),Xn(zu,g(g({},wF.history),o.history)),Xn(mc,g(g({},wF.interactionManager),o.interactionManager))]},function(e){var t=e.pluginsReady,n=e.activeDocumentId;return U(H,null,t?U(H,null,n?U(ja,{documentId:n,components:d,renderers:c,className:"relative flex h-full w-full select-none flex-col"},U(SF,{documentId:n,tabBarVisibility:o.tabBar}),U(AF,{documentId:n}),U(yf,{documentId:n})):U(yF,null)):U("div",{className:"flex h-full items-center justify-center"},U(bf,{size:"lg",text:"Initializing plugins..."})))}))}var MF="undefined"!=typeof HTMLElement?HTMLElement:l(function e(){s(this,e)}),kF=function(){function e(){var t;return s(this,e),c(t=i(this,e),"_resolveRegistry",null),c(t,"themeStyleEl",null),c(t,"systemPreferenceCleanup",null),c(t,"handleRegistryReady",function(e){t._resolveRegistry&&(t._resolveRegistry(e),t._resolveRegistry=null)}),t.root=t.attachShadow({mode:"open"}),t._registryPromise=new Promise(function(e){t._resolveRegistry=e}),t}return m(e,MF),l(e,[{key:"connectedCallback",value:function(){this._config||(this._config={src:this.getAttribute("src")||"/demo.pdf",worker:"false"!==this.getAttribute("worker"),theme:this.parseThemeAttribute()}),this.setupTheme(),this.renderViewer()}},{key:"disconnectedCallback",value:function(){var e;null===(e=this.systemPreferenceCleanup)||void 0===e||e.call(this),this.systemPreferenceCleanup=null}},{key:"parseThemeAttribute",value:function(){var e=this.getAttribute("theme");if(e)return["light","dark","system"].includes(e)?{preference:e}:void 0}},{key:"config",get:function(){return this._config},set:function(e){this._config=e,e.icons&&$p(e.icons),this.isConnected&&(this.setupTheme(),this.renderViewer())}},{key:"registry",get:function(){return this._registryPromise}},{key:"themePreference",get:function(){var e;return(null===(e=this._config)||void 0===e||null===(e=e.theme)||void 0===e?void 0:e.preference)||"system"}},{key:"activeColorScheme",get:function(){return bF(this.themePreference)}},{key:"activeTheme",get:function(){return this.resolveActiveTheme()}},{key:"resolveActiveTheme",value:function(){var e,t,n,o=null===(e=this._config)||void 0===e?void 0:e.theme,r=bF((null==o?void 0:o.preference)||"system");return n="dark"===r?FF:fF,(t=null==o?void 0:o[r])?function(e,t){return{colors:PF(e.colors,t)}}(n,t):n}},{key:"setupTheme",value:function(){var e,t,n=this;null===(e=this.systemPreferenceCleanup)||void 0===e||e.call(this),this.systemPreferenceCleanup=null,"system"===((null===(t=this._config)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.preference)||"system")&&(this.systemPreferenceCleanup=function(e){if("undefined"==typeof window)return function(){};var t=window.matchMedia("(prefers-color-scheme: dark)"),n=function(t){return e(t.matches?"dark":"light")};return t.addEventListener("change",n),function(){return t.removeEventListener("change",n)}}(function(e){n.injectTheme(),n.dispatchEvent(new CustomEvent("themechange",{detail:{preference:"system",colorScheme:e,theme:n.activeTheme},bubbles:!0}))})),this.injectTheme()}},{key:"injectTheme",value:function(){var e=function(e){return":host {\n".concat(function(e){var t=[];return function e(n,o){for(var r=0,a=Object.entries(n);r<a.length;r++){var i=_(a[r],2),s=i[0],l=i[1];l&&"object"===D(l)?e(l,"".concat(o,"-").concat(_F(s))):void 0!==l&&t.push("  --ep".concat(o,"-").concat(_F(s),": ").concat(l,";"))}}(e.colors,""),t.join("\n")}(e),"\n}")}(this.resolveActiveTheme()),t=this.root.querySelector("style[data-embedpdf-theme]");t||((t=document.createElement("style")).setAttribute("data-embedpdf-theme",""),this.root.appendChild(t)),this.themeStyleEl=t,this.themeStyleEl.textContent=e,this.setAttribute("data-color-scheme",this.activeColorScheme)}},{key:"setTheme",value:function(e){this._config&&(this._config.theme="string"==typeof e?g(g({},this._config.theme),{},{preference:e}):g(g({},this._config.theme),e),this.setupTheme(),this.dispatchEvent(new CustomEvent("themechange",{detail:{preference:this.themePreference,colorScheme:this.activeColorScheme,theme:this.activeTheme},bubbles:!0})))}},{key:"registerIcon",value:function(e,t){Bp(e,t)}},{key:"registerIcons",value:function(e){$p(e)}},{key:"renderViewer",value:function(){this._config&&(me(U(CF,{config:this._config,onRegistryReady:this.handleRegistryReady}),this.root),this.injectTheme())}}])}(),TF=["type","target"];"undefined"==typeof customElements||customElements.get("embedpdf-container")||customElements.define("embedpdf-container",kF);var IF={version:"2.1.2",init:function(e){if("container"===e.type)return function(e){e.type,e.target;var t=f(e,TF),n=document.createElement("embedpdf-container");return n.config=t,e.target.appendChild(n),n}(e)}}},762(e,t,n){n.r(t),n.d(t,{createPdfiumEngine:()=>S});var o,r=n(754),a=n(580),i=(o="file:///home/ccds/work/vscode-pdf-viewer/node_modules/@embedpdf/snippet/dist/direct-engine-CluHueed.js",async function(e={}){var t,r,a,i=e,s=new Promise((e,t)=>{r=e,a=t});["_EPDF_GetMetaKeyCount","_EPDF_GetMetaKeyName","_EPDF_GetMetaTrapped","_EPDF_GetPageRotationByIndex","_EPDF_HasMetaText","_EPDF_PNG_EncodeRGBA","_EPDF_RenderAnnotBitmap","_EPDF_SetMetaText","_EPDF_SetMetaTrapped","_EPDFAction_CreateGoTo","_EPDFAction_CreateGoToNamed","_EPDFAction_CreateLaunch","_EPDFAction_CreateRemoteGoToByName","_EPDFAction_CreateRemoteGoToDest","_EPDFAction_CreateURI","_EPDFAnnot_ClearColor","_EPDFAnnot_GenerateAppearance","_EPDFAnnot_GenerateAppearanceWithBlend","_EPDFAnnot_GetBlendMode","_EPDFAnnot_GetBorderDashPattern","_EPDFAnnot_GetBorderDashPatternCount","_EPDFAnnot_GetBorderEffect","_EPDFAnnot_GetBorderStyle","_EPDFAnnot_GetColor","_EPDFAnnot_GetDefaultAppearance","_EPDFAnnot_GetIcon","_EPDFAnnot_GetIntent","_EPDFAnnot_GetLineEndings","_EPDFAnnot_GetOpacity","_EPDFAnnot_GetRectangleDifferences","_EPDFAnnot_GetRichContent","_EPDFAnnot_GetTextAlignment","_EPDFAnnot_GetVerticalAlignment","_EPDFAnnot_SetBorderDashPattern","_EPDFAnnot_SetBorderStyle","_EPDFAnnot_SetColor","_EPDFAnnot_SetDefaultAppearance","_EPDFAnnot_SetIcon","_EPDFAnnot_SetIntent","_EPDFAnnot_SetLine","_EPDFAnnot_SetLineEndings","_EPDFAnnot_SetLinkedAnnot","_EPDFAnnot_SetOpacity","_EPDFAnnot_SetTextAlignment","_EPDFAnnot_SetVerticalAlignment","_EPDFAnnot_SetVertices","_EPDFAnnot_UpdateAppearanceToRect","_EPDFAttachment_GetDescription","_EPDFAttachment_GetIntegerValue","_EPDFAttachment_SetDescription","_EPDFAttachment_SetSubtype","_EPDFBookmark_AppendChild","_EPDFBookmark_Clear","_EPDFBookmark_ClearTarget","_EPDFBookmark_Create","_EPDFBookmark_Delete","_EPDFBookmark_InsertAfter","_EPDFBookmark_SetAction","_EPDFBookmark_SetDest","_EPDFBookmark_SetTitle","_EPDFCatalog_GetLanguage","_EPDFDest_CreateRemoteView","_EPDFDest_CreateRemoteXYZ","_EPDFDest_CreateView","_EPDFDest_CreateXYZ","_EPDFNamedDest_Remove","_EPDFNamedDest_SetDest","_EPDFPage_CreateAnnot","_EPDFPage_GetAnnotByName","_EPDFPage_GetAnnotCountRaw","_EPDFPage_GetAnnotRaw","_EPDFPage_RemoveAnnotByName","_EPDFPage_RemoveAnnotRaw","_EPDFText_RedactInQuads","_EPDFText_RedactInRect","_FORM_CanRedo","_FORM_CanUndo","_FORM_DoDocumentAAction","_FORM_DoDocumentJSAction","_FORM_DoDocumentOpenAction","_FORM_DoPageAAction","_FORM_ForceToKillFocus","_FORM_GetFocusedAnnot","_FORM_GetFocusedText","_FORM_GetSelectedText","_FORM_IsIndexSelected","_FORM_OnAfterLoadPage","_FORM_OnBeforeClosePage","_FORM_OnChar","_FORM_OnFocus","_FORM_OnKeyDown","_FORM_OnKeyUp","_FORM_OnLButtonDoubleClick","_FORM_OnLButtonDown","_FORM_OnLButtonUp","_FORM_OnMouseMove","_FORM_OnMouseWheel","_FORM_OnRButtonDown","_FORM_OnRButtonUp","_FORM_Redo","_FORM_ReplaceAndKeepSelection","_FORM_ReplaceSelection","_FORM_SelectAllText","_FORM_SetFocusedAnnot","_FORM_SetIndexSelected","_FORM_Undo","_FPDF_AddInstalledFont","_FPDF_CloseDocument","_FPDF_ClosePage","_FPDF_CloseXObject","_FPDF_CopyViewerPreferences","_FPDF_CountNamedDests","_FPDF_CreateClipPath","_FPDF_CreateNewDocument","_FPDF_DestroyClipPath","_FPDF_DestroyLibrary","_FPDF_DeviceToPage","_FPDF_DocumentHasValidCrossReferenceTable","_FPDF_FFLDraw","_FPDF_FreeDefaultSystemFontInfo","_FPDF_GetDefaultSystemFontInfo","_FPDF_GetDefaultTTFMap","_FPDF_GetDefaultTTFMapCount","_FPDF_GetDefaultTTFMapEntry","_FPDF_GetDocPermissions","_FPDF_GetDocUserPermissions","_FPDF_GetFileIdentifier","_FPDF_GetFileVersion","_FPDF_GetFormType","_FPDF_GetLastError","_FPDF_GetMetaText","_FPDF_GetNamedDest","_FPDF_GetNamedDestByName","_FPDF_GetPageAAction","_FPDF_GetPageBoundingBox","_FPDF_GetPageCount","_FPDF_GetPageHeight","_FPDF_GetPageHeightF","_FPDF_GetPageLabel","_FPDF_GetPageSizeByIndex","_FPDF_GetPageSizeByIndexF","_FPDF_GetPageWidth","_FPDF_GetPageWidthF","_FPDF_GetSecurityHandlerRevision","_FPDF_GetSignatureCount","_FPDF_GetSignatureObject","_FPDF_GetTrailerEnds","_FPDF_GetXFAPacketContent","_FPDF_GetXFAPacketCount","_FPDF_GetXFAPacketName","_FPDF_ImportNPagesToOne","_FPDF_ImportPages","_FPDF_ImportPagesByIndex","_FPDF_InitLibrary","_FPDF_InitLibraryWithConfig","_FPDF_LoadCustomDocument","_FPDF_LoadDocument","_FPDF_LoadMemDocument","_FPDF_LoadMemDocument64","_FPDF_LoadPage","_FPDF_LoadXFA","_FPDF_MovePages","_FPDF_NewFormObjectFromXObject","_FPDF_NewXObjectFromPage","_FPDF_PageToDevice","_FPDF_RemoveFormFieldHighlight","_FPDF_RenderPage_Close","_FPDF_RenderPage_Continue","_FPDF_RenderPageBitmap","_FPDF_RenderPageBitmap_Start","_FPDF_RenderPageBitmapWithColorScheme_Start","_FPDF_RenderPageBitmapWithMatrix","_FPDF_SaveAsCopy","_FPDF_SaveWithVersion","_FPDF_SetFormFieldHighlightAlpha","_FPDF_SetFormFieldHighlightColor","_FPDF_SetSandBoxPolicy","_FPDF_SetSystemFontInfo","_FPDF_StructElement_Attr_CountChildren","_FPDF_StructElement_Attr_GetBlobValue","_FPDF_StructElement_Attr_GetBooleanValue","_FPDF_StructElement_Attr_GetChildAtIndex","_FPDF_StructElement_Attr_GetCount","_FPDF_StructElement_Attr_GetName","_FPDF_StructElement_Attr_GetNumberValue","_FPDF_StructElement_Attr_GetStringValue","_FPDF_StructElement_Attr_GetType","_FPDF_StructElement_Attr_GetValue","_FPDF_StructElement_CountChildren","_FPDF_StructElement_GetActualText","_FPDF_StructElement_GetAltText","_FPDF_StructElement_GetAttributeAtIndex","_FPDF_StructElement_GetAttributeCount","_FPDF_StructElement_GetChildAtIndex","_FPDF_StructElement_GetChildMarkedContentID","_FPDF_StructElement_GetID","_FPDF_StructElement_GetLang","_FPDF_StructElement_GetMarkedContentID","_FPDF_StructElement_GetMarkedContentIdAtIndex","_FPDF_StructElement_GetMarkedContentIdCount","_FPDF_StructElement_GetObjType","_FPDF_StructElement_GetParent","_FPDF_StructElement_GetStringAttribute","_FPDF_StructElement_GetTitle","_FPDF_StructElement_GetType","_FPDF_StructTree_Close","_FPDF_StructTree_CountChildren","_FPDF_StructTree_GetChildAtIndex","_FPDF_StructTree_GetForPage","_FPDF_VIEWERREF_GetDuplex","_FPDF_VIEWERREF_GetName","_FPDF_VIEWERREF_GetNumCopies","_FPDF_VIEWERREF_GetPrintPageRange","_FPDF_VIEWERREF_GetPrintPageRangeCount","_FPDF_VIEWERREF_GetPrintPageRangeElement","_FPDF_VIEWERREF_GetPrintScaling","_FPDFAction_GetDest","_FPDFAction_GetFilePath","_FPDFAction_GetType","_FPDFAction_GetURIPath","_FPDFAnnot_AddFileAttachment","_FPDFAnnot_AddInkStroke","_FPDFAnnot_AppendAttachmentPoints","_FPDFAnnot_AppendObject","_FPDFAnnot_CountAttachmentPoints","_FPDFAnnot_GetAP","_FPDFAnnot_GetAttachmentPoints","_FPDFAnnot_GetBorder","_FPDFAnnot_GetColor","_FPDFAnnot_GetFileAttachment","_FPDFAnnot_GetFlags","_FPDFAnnot_GetFocusableSubtypes","_FPDFAnnot_GetFocusableSubtypesCount","_FPDFAnnot_GetFontColor","_FPDFAnnot_GetFontSize","_FPDFAnnot_GetFormAdditionalActionJavaScript","_FPDFAnnot_GetFormControlCount","_FPDFAnnot_GetFormControlIndex","_FPDFAnnot_GetFormFieldAlternateName","_FPDFAnnot_GetFormFieldAtPoint","_FPDFAnnot_GetFormFieldExportValue","_FPDFAnnot_GetFormFieldFlags","_FPDFAnnot_GetFormFieldName","_FPDFAnnot_GetFormFieldType","_FPDFAnnot_GetFormFieldValue","_FPDFAnnot_GetInkListCount","_FPDFAnnot_GetInkListPath","_FPDFAnnot_GetLine","_FPDFAnnot_GetLink","_FPDFAnnot_GetLinkedAnnot","_FPDFAnnot_GetNumberValue","_FPDFAnnot_GetObject","_FPDFAnnot_GetObjectCount","_FPDFAnnot_GetOptionCount","_FPDFAnnot_GetOptionLabel","_FPDFAnnot_GetRect","_FPDFAnnot_GetStringValue","_FPDFAnnot_GetSubtype","_FPDFAnnot_GetValueType","_FPDFAnnot_GetVertices","_FPDFAnnot_HasAttachmentPoints","_FPDFAnnot_HasKey","_FPDFAnnot_IsChecked","_FPDFAnnot_IsObjectSupportedSubtype","_FPDFAnnot_IsOptionSelected","_FPDFAnnot_IsSupportedSubtype","_FPDFAnnot_RemoveInkList","_FPDFAnnot_RemoveObject","_FPDFAnnot_SetAP","_FPDFAnnot_SetAttachmentPoints","_FPDFAnnot_SetBorder","_FPDFAnnot_SetColor","_FPDFAnnot_SetFlags","_FPDFAnnot_SetFocusableSubtypes","_FPDFAnnot_SetFontColor","_FPDFAnnot_SetFormFieldFlags","_FPDFAnnot_SetRect","_FPDFAnnot_SetStringValue","_FPDFAnnot_SetURI","_FPDFAnnot_UpdateObject","_FPDFAttachment_GetFile","_FPDFAttachment_GetName","_FPDFAttachment_GetStringValue","_FPDFAttachment_GetSubtype","_FPDFAttachment_GetValueType","_FPDFAttachment_HasKey","_FPDFAttachment_SetFile","_FPDFAttachment_SetStringValue","_FPDFAvail_Create","_FPDFAvail_Destroy","_FPDFAvail_GetDocument","_FPDFAvail_GetFirstPageNum","_FPDFAvail_IsDocAvail","_FPDFAvail_IsFormAvail","_FPDFAvail_IsLinearized","_FPDFAvail_IsPageAvail","_FPDFBitmap_Create","_FPDFBitmap_CreateEx","_FPDFBitmap_Destroy","_FPDFBitmap_FillRect","_FPDFBitmap_GetBuffer","_FPDFBitmap_GetFormat","_FPDFBitmap_GetHeight","_FPDFBitmap_GetStride","_FPDFBitmap_GetWidth","_FPDFBookmark_Find","_FPDFBookmark_GetAction","_FPDFBookmark_GetCount","_FPDFBookmark_GetDest","_FPDFBookmark_GetFirstChild","_FPDFBookmark_GetNextSibling","_FPDFBookmark_GetTitle","_FPDFCatalog_IsTagged","_FPDFCatalog_SetLanguage","_FPDFClipPath_CountPaths","_FPDFClipPath_CountPathSegments","_FPDFClipPath_GetPathSegment","_FPDFDest_GetDestPageIndex","_FPDFDest_GetLocationInPage","_FPDFDest_GetView","_FPDFDoc_AddAttachment","_FPDFDoc_CloseJavaScriptAction","_FPDFDoc_DeleteAttachment","_FPDFDOC_ExitFormFillEnvironment","_FPDFDoc_GetAttachment","_FPDFDoc_GetAttachmentCount","_FPDFDoc_GetJavaScriptAction","_FPDFDoc_GetJavaScriptActionCount","_FPDFDoc_GetPageMode","_FPDFDOC_InitFormFillEnvironment","_FPDFFont_Close","_FPDFFont_GetAscent","_FPDFFont_GetBaseFontName","_FPDFFont_GetDescent","_FPDFFont_GetFamilyName","_FPDFFont_GetFlags","_FPDFFont_GetFontData","_FPDFFont_GetGlyphPath","_FPDFFont_GetGlyphWidth","_FPDFFont_GetIsEmbedded","_FPDFFont_GetItalicAngle","_FPDFFont_GetWeight","_FPDFFormObj_CountObjects","_FPDFFormObj_GetObject","_FPDFFormObj_RemoveObject","_FPDFGlyphPath_CountGlyphSegments","_FPDFGlyphPath_GetGlyphPathSegment","_FPDFImageObj_GetBitmap","_FPDFImageObj_GetIccProfileDataDecoded","_FPDFImageObj_GetImageDataDecoded","_FPDFImageObj_GetImageDataRaw","_FPDFImageObj_GetImageFilter","_FPDFImageObj_GetImageFilterCount","_FPDFImageObj_GetImageMetadata","_FPDFImageObj_GetImagePixelSize","_FPDFImageObj_GetRenderedBitmap","_FPDFImageObj_LoadJpegFile","_FPDFImageObj_LoadJpegFileInline","_FPDFImageObj_SetBitmap","_FPDFImageObj_SetMatrix","_FPDFJavaScriptAction_GetName","_FPDFJavaScriptAction_GetScript","_FPDFLink_CloseWebLinks","_FPDFLink_CountQuadPoints","_FPDFLink_CountRects","_FPDFLink_CountWebLinks","_FPDFLink_Enumerate","_FPDFLink_GetAction","_FPDFLink_GetAnnot","_FPDFLink_GetAnnotRect","_FPDFLink_GetDest","_FPDFLink_GetLinkAtPoint","_FPDFLink_GetLinkZOrderAtPoint","_FPDFLink_GetQuadPoints","_FPDFLink_GetRect","_FPDFLink_GetTextRange","_FPDFLink_GetURL","_FPDFLink_LoadWebLinks","_FPDFPage_CloseAnnot","_FPDFPage_CountObjects","_FPDFPage_CreateAnnot","_FPDFPage_Delete","_FPDFPage_Flatten","_FPDFPage_FormFieldZOrderAtPoint","_FPDFPage_GenerateContent","_FPDFPage_GetAnnot","_FPDFPage_GetAnnotCount","_FPDFPage_GetAnnotIndex","_FPDFPage_GetArtBox","_FPDFPage_GetBleedBox","_FPDFPage_GetCropBox","_FPDFPage_GetDecodedThumbnailData","_FPDFPage_GetMediaBox","_FPDFPage_GetObject","_FPDFPage_GetRawThumbnailData","_FPDFPage_GetRotation","_FPDFPage_GetThumbnailAsBitmap","_FPDFPage_GetTrimBox","_FPDFPage_HasFormFieldAtPoint","_FPDFPage_HasTransparency","_FPDFPage_InsertClipPath","_FPDFPage_InsertObject","_FPDFPage_InsertObjectAtIndex","_FPDFPage_New","_FPDFPage_RemoveAnnot","_FPDFPage_RemoveObject","_FPDFPage_SetArtBox","_FPDFPage_SetBleedBox","_FPDFPage_SetCropBox","_FPDFPage_SetMediaBox","_FPDFPage_SetRotation","_FPDFPage_SetTrimBox","_FPDFPage_TransformAnnots","_FPDFPage_TransFormWithClip","_FPDFPageObj_AddMark","_FPDFPageObj_CountMarks","_FPDFPageObj_CreateNewPath","_FPDFPageObj_CreateNewRect","_FPDFPageObj_CreateTextObj","_FPDFPageObj_Destroy","_FPDFPageObj_GetBounds","_FPDFPageObj_GetClipPath","_FPDFPageObj_GetDashArray","_FPDFPageObj_GetDashCount","_FPDFPageObj_GetDashPhase","_FPDFPageObj_GetFillColor","_FPDFPageObj_GetIsActive","_FPDFPageObj_GetLineCap","_FPDFPageObj_GetLineJoin","_FPDFPageObj_GetMark","_FPDFPageObj_GetMarkedContentID","_FPDFPageObj_GetMatrix","_FPDFPageObj_GetRotatedBounds","_FPDFPageObj_GetStrokeColor","_FPDFPageObj_GetStrokeWidth","_FPDFPageObj_GetType","_FPDFPageObj_HasTransparency","_FPDFPageObj_NewImageObj","_FPDFPageObj_NewTextObj","_FPDFPageObj_RemoveMark","_FPDFPageObj_SetBlendMode","_FPDFPageObj_SetDashArray","_FPDFPageObj_SetDashPhase","_FPDFPageObj_SetFillColor","_FPDFPageObj_SetIsActive","_FPDFPageObj_SetLineCap","_FPDFPageObj_SetLineJoin","_FPDFPageObj_SetMatrix","_FPDFPageObj_SetStrokeColor","_FPDFPageObj_SetStrokeWidth","_FPDFPageObj_Transform","_FPDFPageObj_TransformClipPath","_FPDFPageObj_TransformF","_FPDFPageObjMark_CountParams","_FPDFPageObjMark_GetName","_FPDFPageObjMark_GetParamBlobValue","_FPDFPageObjMark_GetParamIntValue","_FPDFPageObjMark_GetParamKey","_FPDFPageObjMark_GetParamStringValue","_FPDFPageObjMark_GetParamValueType","_FPDFPageObjMark_RemoveParam","_FPDFPageObjMark_SetBlobParam","_FPDFPageObjMark_SetIntParam","_FPDFPageObjMark_SetStringParam","_FPDFPath_BezierTo","_FPDFPath_Close","_FPDFPath_CountSegments","_FPDFPath_GetDrawMode","_FPDFPath_GetPathSegment","_FPDFPath_LineTo","_FPDFPath_MoveTo","_FPDFPath_SetDrawMode","_FPDFPathSegment_GetClose","_FPDFPathSegment_GetPoint","_FPDFPathSegment_GetType","_FPDFSignatureObj_GetByteRange","_FPDFSignatureObj_GetContents","_FPDFSignatureObj_GetDocMDPPermission","_FPDFSignatureObj_GetReason","_FPDFSignatureObj_GetSubFilter","_FPDFSignatureObj_GetTime","_FPDFText_ClosePage","_FPDFText_CountChars","_FPDFText_CountRects","_FPDFText_FindClose","_FPDFText_FindNext","_FPDFText_FindPrev","_FPDFText_FindStart","_FPDFText_GetBoundedText","_FPDFText_GetCharAngle","_FPDFText_GetCharBox","_FPDFText_GetCharIndexAtPos","_FPDFText_GetCharIndexFromTextIndex","_FPDFText_GetCharOrigin","_FPDFText_GetFillColor","_FPDFText_GetFontInfo","_FPDFText_GetFontSize","_FPDFText_GetFontWeight","_FPDFText_GetLooseCharBox","_FPDFText_GetMatrix","_FPDFText_GetRect","_FPDFText_GetSchCount","_FPDFText_GetSchResultIndex","_FPDFText_GetStrokeColor","_FPDFText_GetText","_FPDFText_GetTextIndexFromCharIndex","_FPDFText_GetTextObject","_FPDFText_GetUnicode","_FPDFText_HasUnicodeMapError","_FPDFText_IsGenerated","_FPDFText_IsHyphen","_FPDFText_LoadCidType2Font","_FPDFText_LoadFont","_FPDFText_LoadPage","_FPDFText_LoadStandardFont","_FPDFText_SetCharcodes","_FPDFText_SetText","_FPDFTextObj_GetFont","_FPDFTextObj_GetFontSize","_FPDFTextObj_GetRenderedBitmap","_FPDFTextObj_GetText","_FPDFTextObj_GetTextRenderMode","_FPDFTextObj_SetTextRenderMode","_PDFiumExt_CloseFileWriter","_PDFiumExt_CloseFormFillInfo","_PDFiumExt_ExitFormFillEnvironment","_PDFiumExt_GetFileWriterData","_PDFiumExt_GetFileWriterSize","_PDFiumExt_Init","_PDFiumExt_InitFormFillEnvironment","_PDFiumExt_OpenFileWriter","_PDFiumExt_OpenFormFillInfo","_PDFiumExt_SaveAsCopy","_malloc","_free","_memory","___indirect_function_table","onRuntimeInitialized"].forEach(e=>{Object.getOwnPropertyDescriptor(s,e)||Object.defineProperty(s,e,{get:()=>V("You are getting "+e+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"),set:()=>V("You are setting "+e+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")})});var l="object"==typeof window,d="function"==typeof importScripts;"object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node&&process.type;var c,u,m=!l&&!d,p=Object.assign({},i),h="./this.program",g="";if(m){if("object"==typeof window||"function"==typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");u=e=>{if("function"==typeof readbuffer)return new Uint8Array(readbuffer(e));let t=read(e,"binary");return M("object"==typeof t),t},c=e=>new Promise((t,n)=>{setTimeout(()=>t(u(e)))}),globalThis.clearTimeout??=e=>{},globalThis.setTimeout??=e=>"function"==typeof e?e():V(),"undefined"!=typeof print&&(globalThis.console??={},console.log=print,console.warn=console.error=globalThis.printErr??print)}else{if(!l&&!d)throw new Error("environment detection error");if(d?g=self.location.href:"undefined"!=typeof document&&document.currentScript&&(g=document.currentScript.src),o&&(g=o),g=g.startsWith("blob:")?"":g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1),"object"!=typeof window&&"function"!=typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");d&&(u=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),c=e=>(M(!Z(e),"readAsync does not work with file:// URLs"),fetch(e,{credentials:"same-origin"}).then(e=>e.ok?e.arrayBuffer():Promise.reject(new Error(e.status+" : "+e.url))))}var f,F=i.print||console.log.bind(console),P=i.printErr||console.error.bind(console);Object.assign(i,p),p=null,f="fetchSettings",Object.getOwnPropertyDescriptor(i,f)&&V(`\`Module.${f}\` was supplied but \`${f}\` not included in INCOMING_MODULE_JS_API`),i.arguments&&i.arguments,te("arguments","arguments_"),i.thisProgram&&(h=i.thisProgram),te("thisProgram","thisProgram"),M(void 0===i.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),M(void 0===i.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),M(void 0===i.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),M(void 0===i.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),M(void 0===i.read,"Module.read option was removed"),M(void 0===i.readAsync,"Module.readAsync option was removed (modify readAsync in JS)"),M(void 0===i.readBinary,"Module.readBinary option was removed (modify readBinary in JS)"),M(void 0===i.setWindowTitle,"Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),M(void 0===i.TOTAL_MEMORY,"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),te("asm","wasmExports"),te("readAsync","readAsync"),te("readBinary","readBinary"),te("setWindowTitle","setWindowTitle");var b,_=i.wasmBinary;te("wasmBinary","wasmBinary"),"object"!=typeof WebAssembly&&P("no native wasm support detected");var v,y,D,x,A,w,S,E,C=!1;function M(e,t){e||V("Assertion failed"+(t?": "+t:""))}function k(){var e=b.buffer;i.HEAP8=v=new Int8Array(e),i.HEAP16=D=new Int16Array(e),i.HEAPU8=y=new Uint8Array(e),i.HEAPU16=x=new Uint16Array(e),i.HEAP32=A=new Int32Array(e),i.HEAPU32=w=new Uint32Array(e),i.HEAPF32=S=new Float32Array(e),i.HEAPF64=E=new Float64Array(e)}function T(){if(!C){var e=rt();0==e&&(e+=4);var t=w[e>>2],n=w[e+4>>2];34821223==t&&2310721022==n||V(`Stack overflow! Stack cookie has been overwritten at ${se(e)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${se(n)} ${se(t)}`),1668509029!=w[0]&&V("Runtime error: The application has corrupted its heap memory area (address zero)!")}}M(!i.STACK_SIZE,"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),M("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&null!=Int32Array.prototype.subarray&&null!=Int32Array.prototype.set,"JS engine does not provide full typed array support"),M(!i.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),M(!i.INITIAL_MEMORY,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var I=[],O=[],R=[],G=!1;function L(e){I.unshift(e)}function N(e){R.unshift(e)}M(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var z=0,j=null,B=null,$={};function U(e){for(var t=e;;){if(!$[e])return e;e=t+Math.random()}}function W(e){z++,i.monitorRunDependencies?.(z),e?(M(!$[e]),$[e]=1,null===j&&"undefined"!=typeof setInterval&&(j=setInterval(()=>{if(C)return clearInterval(j),void(j=null);var e=!1;for(var t in $)e||(e=!0,P("still waiting on run dependencies:")),P(`dependency: ${t}`);e&&P("(end of list)")},1e4))):P("warning: run dependency added without ID")}function H(e){if(z--,i.monitorRunDependencies?.(z),e?(M($[e]),delete $[e]):P("warning: run dependency removed without ID"),0==z&&(null!==j&&(clearInterval(j),j=null),B)){var t=B;B=null,t()}}function V(e){i.onAbort?.(e),P(e="Aborted("+e+")"),C=!0;var t=new WebAssembly.RuntimeError(e);throw a(t),t}var Y,q,K,X=e=>e.startsWith("data:application/octet-stream;base64,"),Z=e=>e.startsWith("file://");function Q(e,t){return(...n)=>{M(G,`native function \`${e}\` called before runtime initialization`);var o=Xe[e];return M(o,`exported native function \`${e}\` not found`),M(n.length<=t,`native function \`${e}\` called with ${n.length} args but expects ${t}`),o(...n)}}function J(e){if(e==Y&&_)return new Uint8Array(_);if(u)return u(e);throw"both async and sync fetching of the wasm failed"}function ee(e,t,n){return function(e){return _?Promise.resolve().then(()=>J(e)):c(e).then(e=>new Uint8Array(e),()=>J(e))}(e).then(e=>WebAssembly.instantiate(e,t)).then(n,e=>{P(`failed to asynchronously prepare wasm: ${e}`),Z(Y)&&P(`warning: Loading from a file URI (${Y}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),V(e)})}if((()=>{var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,115!==t[0]||99!==t[1])throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})(),i.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");function te(e,t,n=!0){Object.getOwnPropertyDescriptor(i,e)||Object.defineProperty(i,e,{configurable:!0,get(){V(`\`Module.${e}\` has been replaced by \`${t}\``+(n?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":""))}})}function ne(e){return"FS_createPath"===e||"FS_createDataFile"===e||"FS_createPreloadedFile"===e||"FS_unlink"===e||"addRunDependency"===e||"FS_createLazyFile"===e||"FS_createDevice"===e||"removeRunDependency"===e}function oe(e,t){"undefined"==typeof globalThis||Object.getOwnPropertyDescriptor(globalThis,e)||Object.defineProperty(globalThis,e,{configurable:!0,get(){t()}})}function re(e,t){oe(e,()=>{ce(`\`${e}\` is not longer defined by emscripten. ${t}`)})}function ae(e){Object.getOwnPropertyDescriptor(i,e)||Object.defineProperty(i,e,{configurable:!0,get(){var t=`'${e}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;ne(e)&&(t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),V(t)}})}re("buffer","Please use HEAP8.buffer or wasmMemory.buffer"),re("asm","Please use wasmExports instead");var ie=e=>{e.forEach(e=>e(i))};i.noExitRuntime;var se=e=>(M("number"==typeof e),"0x"+(e>>>=0).toString(16).padStart(8,"0")),le=e=>at(e),de=()=>st(),ce=e=>{ce.shown||={},ce.shown[e]||(ce.shown[e]=1,P(e))},ue="undefined"!=typeof TextDecoder?new TextDecoder:void 0,me=(e,t=0,n=NaN)=>{for(var o=t+n,r=t;e[r]&&!(r>=o);)++r;if(r-t>16&&e.buffer&&ue)return ue.decode(e.subarray(t,r));for(var a="";t<r;){var i=e[t++];if(128&i){var s=63&e[t++];if(192!=(224&i)){var l=63&e[t++];if(224==(240&i)?i=(15&i)<<12|s<<6|l:(240!=(248&i)&&ce("Invalid UTF-8 leading byte "+se(i)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),i=(7&i)<<18|s<<12|l<<6|63&e[t++]),i<65536)a+=String.fromCharCode(i);else{var d=i-65536;a+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else a+=String.fromCharCode((31&i)<<6|s)}else a+=String.fromCharCode(i)}return a},pe=(e,t)=>(M("number"==typeof e,`UTF8ToString expects a number (got ${typeof e})`),e?me(y,e,t):"");function he(){M(null!=Ie.varargs);var e=A[+Ie.varargs>>2];return Ie.varargs+=4,e}var ge=he,fe={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var n=0,o=e.length-1;o>=0;o--){var r=e[o];"."===r?e.splice(o,1):".."===r?(e.splice(o,1),n++):n&&(e.splice(o,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},normalize:e=>{var t=fe.isAbs(e),n="/"===e.substr(-1);return(e=fe.normalizeArray(e.split("/").filter(e=>!!e),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=fe.splitPath(e),n=t[0],o=t[1];return n||o?(o&&(o=o.substr(0,o.length-1)),n+o):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=fe.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:(...e)=>fe.normalize(e.join("/")),join2:(e,t)=>fe.normalize(e+"/"+t)},Fe=e=>(Fe=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);V("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")})())(e),Pe={resolve:(...e)=>{for(var t="",n=!1,o=e.length-1;o>=-1&&!n;o--){var r=o>=0?e[o]:Te.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");if(!r)return"";t=r+"/"+t,n=fe.isAbs(r)}return(n?"/":"")+(t=fe.normalizeArray(t.split("/").filter(e=>!!e),!n).join("/"))||"."},relative:(e,t)=>{function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=Pe.resolve(e).substr(1),t=Pe.resolve(t).substr(1);for(var o=n(e.split("/")),r=n(t.split("/")),a=Math.min(o.length,r.length),i=a,s=0;s<a;s++)if(o[s]!==r[s]){i=s;break}var l=[];for(s=i;s<o.length;s++)l.push("..");return(l=l.concat(r.slice(i))).join("/")}},be=[],_e=e=>{for(var t=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);o<=127?t++:o<=2047?t+=2:o>=55296&&o<=57343?(t+=4,++n):t+=3}return t},ve=(e,t,n,o)=>{if(M("string"==typeof e,`stringToUTF8Array expects a string (got ${typeof e})`),!(o>0))return 0;for(var r=n,a=n+o-1,i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),s<=127){if(n>=a)break;t[n++]=s}else if(s<=2047){if(n+1>=a)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=a)break;s>1114111&&ce("Invalid Unicode code point "+se(s)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-r};function ye(e,t,n){var o=_e(e)+1,r=new Array(o),a=ve(e,r,0,r.length);return r.length=a,r}var De,xe,Ae={ttys:[],init(){},shutdown(){},register(e,t){Ae.ttys[e]={input:[],output:[],ops:t},Te.registerDevice(e,Ae.stream_ops)},stream_ops:{open(e){var t=Ae.ttys[e.node.rdev];if(!t)throw new Te.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,n,o,r){if(!e.tty||!e.tty.ops.get_char)throw new Te.ErrnoError(60);for(var a=0,i=0;i<o;i++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(e){throw new Te.ErrnoError(29)}if(void 0===s&&0===a)throw new Te.ErrnoError(6);if(null==s)break;a++,t[n+i]=s}return a&&(e.node.timestamp=Date.now()),a},write(e,t,n,o,r){if(!e.tty||!e.tty.ops.put_char)throw new Te.ErrnoError(60);try{for(var a=0;a<o;a++)e.tty.ops.put_char(e.tty,t[n+a])}catch(e){throw new Te.ErrnoError(29)}return o&&(e.node.timestamp=Date.now()),a}},default_tty_ops:{get_char:e=>(()=>{if(!be.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&(e=readline())&&(e+="\n"),!e)return null;be=ye(e)}return be.shift()})(),put_char(e,t){null===t||10===t?(F(me(e.output)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(F(me(e.output)),e.output=[])},ioctl_tcgets:e=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(e,t,n)=>0,ioctl_tiocgwinsz:e=>[24,80]},default_tty1_ops:{put_char(e,t){null===t||10===t?(P(me(e.output)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(P(me(e.output)),e.output=[])}}},we=(e,t)=>(M(t,"alignment argument is required"),Math.ceil(e/t)*t),Se=e=>{e=we(e,65536);var t=et(65536,e);return t&&((e,t)=>{y.fill(0,e,e+t)})(t,e),t},Ee={ops_table:null,mount:e=>Ee.createNode(null,"/",16895,0),createNode(e,t,n,o){if(Te.isBlkdev(n)||Te.isFIFO(n))throw new Te.ErrnoError(63);Ee.ops_table||={dir:{node:{getattr:Ee.node_ops.getattr,setattr:Ee.node_ops.setattr,lookup:Ee.node_ops.lookup,mknod:Ee.node_ops.mknod,rename:Ee.node_ops.rename,unlink:Ee.node_ops.unlink,rmdir:Ee.node_ops.rmdir,readdir:Ee.node_ops.readdir,symlink:Ee.node_ops.symlink},stream:{llseek:Ee.stream_ops.llseek}},file:{node:{getattr:Ee.node_ops.getattr,setattr:Ee.node_ops.setattr},stream:{llseek:Ee.stream_ops.llseek,read:Ee.stream_ops.read,write:Ee.stream_ops.write,allocate:Ee.stream_ops.allocate,mmap:Ee.stream_ops.mmap,msync:Ee.stream_ops.msync}},link:{node:{getattr:Ee.node_ops.getattr,setattr:Ee.node_ops.setattr,readlink:Ee.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Ee.node_ops.getattr,setattr:Ee.node_ops.setattr},stream:Te.chrdev_stream_ops}};var r=Te.createNode(e,t,n,o);return Te.isDir(r.mode)?(r.node_ops=Ee.ops_table.dir.node,r.stream_ops=Ee.ops_table.dir.stream,r.contents={}):Te.isFile(r.mode)?(r.node_ops=Ee.ops_table.file.node,r.stream_ops=Ee.ops_table.file.stream,r.usedBytes=0,r.contents=null):Te.isLink(r.mode)?(r.node_ops=Ee.ops_table.link.node,r.stream_ops=Ee.ops_table.link.stream):Te.isChrdev(r.mode)&&(r.node_ops=Ee.ops_table.chrdev.node,r.stream_ops=Ee.ops_table.chrdev.stream),r.timestamp=Date.now(),e&&(e.contents[t]=r,e.timestamp=r.timestamp),r},getFileDataAsTypedArray:e=>e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0),expandFileStorage(e,t){var n=e.contents?e.contents.length:0;if(!(n>=t)){t=Math.max(t,n*(n<1048576?2:1.125)>>>0),0!=n&&(t=Math.max(t,256));var o=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(o.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var n=e.contents;e.contents=new Uint8Array(t),n&&e.contents.set(n.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=Te.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Te.isDir(e.mode)?t.size=4096:Te.isFile(e.mode)?t.size=e.usedBytes:Te.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Ee.resizeFileStorage(e,t.size)},lookup(e,t){throw Te.genericErrors[44]},mknod:(e,t,n,o)=>Ee.createNode(e,t,n,o),rename(e,t,n){if(Te.isDir(e.mode)){var o;try{o=Te.lookupNode(t,n)}catch(e){}if(o)for(var r in o.contents)throw new Te.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=n,t.contents[n]=e,t.timestamp=e.parent.timestamp},unlink(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir(e,t){var n=Te.lookupNode(e,t);for(var o in n.contents)throw new Te.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var n of Object.keys(e.contents))t.push(n);return t},symlink(e,t,n){var o=Ee.createNode(e,t,41471,0);return o.link=n,o},readlink(e){if(!Te.isLink(e.mode))throw new Te.ErrnoError(28);return e.link}},stream_ops:{read(e,t,n,o,r){var a=e.node.contents;if(r>=e.node.usedBytes)return 0;var i=Math.min(e.node.usedBytes-r,o);if(M(i>=0),i>8&&a.subarray)t.set(a.subarray(r,r+i),n);else for(var s=0;s<i;s++)t[n+s]=a[r+s];return i},write(e,t,n,o,r,a){if(M(!(t instanceof ArrayBuffer)),t.buffer===v.buffer&&(a=!1),!o)return 0;var i=e.node;if(i.timestamp=Date.now(),t.subarray&&(!i.contents||i.contents.subarray)){if(a)return M(0===r,"canOwn must imply no weird position inside the file"),i.contents=t.subarray(n,n+o),i.usedBytes=o,o;if(0===i.usedBytes&&0===r)return i.contents=t.slice(n,n+o),i.usedBytes=o,o;if(r+o<=i.usedBytes)return i.contents.set(t.subarray(n,n+o),r),o}if(Ee.expandFileStorage(i,r+o),i.contents.subarray&&t.subarray)i.contents.set(t.subarray(n,n+o),r);else for(var s=0;s<o;s++)i.contents[r+s]=t[n+s];return i.usedBytes=Math.max(i.usedBytes,r+o),o},llseek(e,t,n){var o=t;if(1===n?o+=e.position:2===n&&Te.isFile(e.node.mode)&&(o+=e.node.usedBytes),o<0)throw new Te.ErrnoError(28);return o},allocate(e,t,n){Ee.expandFileStorage(e.node,t+n),e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap(e,t,n,o,r){if(!Te.isFile(e.node.mode))throw new Te.ErrnoError(43);var a,i,s=e.node.contents;if(2&r||!s||s.buffer!==v.buffer){if(i=!0,!(a=Se(t)))throw new Te.ErrnoError(48);s&&((n>0||n+t<s.length)&&(s=s.subarray?s.subarray(n,n+t):Array.prototype.slice.call(s,n,n+t)),v.set(s,a))}else i=!1,a=s.byteOffset;return{ptr:a,allocated:i}},msync:(e,t,n,o,r)=>(Ee.stream_ops.write(e,t,0,o,n,!1),0)}},Ce=i.preloadPlugins||[],Me=(e,t)=>{var n=0;return e&&(n|=365),t&&(n|=146),n},ke={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},Te={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class extends Error{constructor(e){for(var t in super(G?(e=>pe(tt(e)))(e):""),this.name="ErrnoError",this.errno=e,ke)if(ke[t]===e){this.code=t;break}}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(e){this.node=e}get isRead(){return 1!=(2097155&this.flags)}get isWrite(){return!!(2097155&this.flags)}get isAppend(){return 1024&this.flags}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{constructor(e,t,n,o){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Te.nextInode++,this.name=t,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=o,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return Te.isDir(this.mode)}get isDevice(){return Te.isChrdev(this.mode)}},lookupPath(e,t={}){if(!(e=Pe.resolve(e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new Te.ErrnoError(32);for(var n=e.split("/").filter(e=>!!e),o=Te.root,r="/",a=0;a<n.length;a++){var i=a===n.length-1;if(i&&t.parent)break;if(o=Te.lookupNode(o,n[a]),r=fe.join2(r,n[a]),Te.isMountpoint(o)&&(!i||i&&t.follow_mount)&&(o=o.mounted.root),!i||t.follow)for(var s=0;Te.isLink(o.mode);){var l=Te.readlink(r);if(r=Pe.resolve(fe.dirname(r),l),o=Te.lookupPath(r,{recurse_count:t.recurse_count+1}).node,s++>40)throw new Te.ErrnoError(32)}}return{path:r,node:o}},getPath(e){for(var t;;){if(Te.isRoot(e)){var n=e.mount.mountpoint;return t?"/"!==n[n.length-1]?`${n}/${t}`:n+t:n}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var n=0,o=0;o<t.length;o++)n=(n<<5)-n+t.charCodeAt(o)|0;return(e+n>>>0)%Te.nameTable.length},hashAddNode(e){var t=Te.hashName(e.parent.id,e.name);e.name_next=Te.nameTable[t],Te.nameTable[t]=e},hashRemoveNode(e){var t=Te.hashName(e.parent.id,e.name);if(Te.nameTable[t]===e)Te.nameTable[t]=e.name_next;else for(var n=Te.nameTable[t];n;){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}},lookupNode(e,t){var n=Te.mayLookup(e);if(n)throw new Te.ErrnoError(n);for(var o=Te.hashName(e.id,t),r=Te.nameTable[o];r;r=r.name_next){var a=r.name;if(r.parent.id===e.id&&a===t)return r}return Te.lookup(e,t)},createNode(e,t,n,o){M("object"==typeof e);var r=new Te.FSNode(e,t,n,o);return Te.hashAddNode(r),r},destroyNode(e){Te.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>!(49152&~e),flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>Te.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup:e=>Te.isDir(e.mode)?Te.nodePermissions(e,"x")||(e.node_ops.lookup?0:2):54,mayCreate(e,t){try{return Te.lookupNode(e,t),20}catch(e){}return Te.nodePermissions(e,"wx")},mayDelete(e,t,n){var o;try{o=Te.lookupNode(e,t)}catch(e){return e.errno}var r=Te.nodePermissions(e,"wx");if(r)return r;if(n){if(!Te.isDir(o.mode))return 54;if(Te.isRoot(o)||Te.getPath(o)===Te.cwd())return 10}else if(Te.isDir(o.mode))return 31;return 0},mayOpen:(e,t)=>e?Te.isLink(e.mode)?32:Te.isDir(e.mode)&&("r"!==Te.flagsToPermissionString(t)||512&t)?31:Te.nodePermissions(e,Te.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=Te.MAX_OPEN_FDS;e++)if(!Te.streams[e])return e;throw new Te.ErrnoError(33)},getStreamChecked(e){var t=Te.getStream(e);if(!t)throw new Te.ErrnoError(8);return t},getStream:e=>Te.streams[e],createStream:(e,t=-1)=>(M(t>=-1),e=Object.assign(new Te.FSStream,e),-1==t&&(t=Te.nextfd()),e.fd=t,Te.streams[t]=e,e),closeStream(e){Te.streams[e]=null},dupStream(e,t=-1){var n=Te.createStream(e,t);return n.stream_ops?.dup?.(n),n},chrdev_stream_ops:{open(e){var t=Te.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open?.(e)},llseek(){throw new Te.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){Te.devices[e]={stream_ops:t}},getDevice:e=>Te.devices[e],getMounts(e){for(var t=[],n=[e];n.length;){var o=n.pop();t.push(o),n.push(...o.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),Te.syncFSRequests++,Te.syncFSRequests>1&&P(`warning: ${Te.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var n=Te.getMounts(Te.root.mount),o=0;function r(e){return M(Te.syncFSRequests>0),Te.syncFSRequests--,t(e)}function a(e){if(e)return a.errored?void 0:(a.errored=!0,r(e));++o>=n.length&&r(null)}n.forEach(t=>{if(!t.type.syncfs)return a(null);t.type.syncfs(t,e,a)})},mount(e,t,n){if("string"==typeof e)throw e;var o,r="/"===n,a=!n;if(r&&Te.root)throw new Te.ErrnoError(10);if(!r&&!a){var i=Te.lookupPath(n,{follow_mount:!1});if(n=i.path,o=i.node,Te.isMountpoint(o))throw new Te.ErrnoError(10);if(!Te.isDir(o.mode))throw new Te.ErrnoError(54)}var s={type:e,opts:t,mountpoint:n,mounts:[]},l=e.mount(s);return l.mount=s,s.root=l,r?Te.root=l:o&&(o.mounted=s,o.mount&&o.mount.mounts.push(s)),l},unmount(e){var t=Te.lookupPath(e,{follow_mount:!1});if(!Te.isMountpoint(t.node))throw new Te.ErrnoError(28);var n=t.node,o=n.mounted,r=Te.getMounts(o);Object.keys(Te.nameTable).forEach(e=>{for(var t=Te.nameTable[e];t;){var n=t.name_next;r.includes(t.mount)&&Te.destroyNode(t),t=n}}),n.mounted=null;var a=n.mount.mounts.indexOf(o);M(-1!==a),n.mount.mounts.splice(a,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod(e,t,n){var o=Te.lookupPath(e,{parent:!0}).node,r=fe.basename(e);if(!r||"."===r||".."===r)throw new Te.ErrnoError(28);var a=Te.mayCreate(o,r);if(a)throw new Te.ErrnoError(a);if(!o.node_ops.mknod)throw new Te.ErrnoError(63);return o.node_ops.mknod(o,r,t,n)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,Te.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,Te.mknod(e,t,0)),mkdirTree(e,t){for(var n=e.split("/"),o="",r=0;r<n.length;++r)if(n[r]){o+="/"+n[r];try{Te.mkdir(o,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,n)=>(void 0===n&&(n=t,t=438),t|=8192,Te.mknod(e,t,n)),symlink(e,t){if(!Pe.resolve(e))throw new Te.ErrnoError(44);var n=Te.lookupPath(t,{parent:!0}).node;if(!n)throw new Te.ErrnoError(44);var o=fe.basename(t),r=Te.mayCreate(n,o);if(r)throw new Te.ErrnoError(r);if(!n.node_ops.symlink)throw new Te.ErrnoError(63);return n.node_ops.symlink(n,o,e)},rename(e,t){var n,o,r=fe.dirname(e),a=fe.dirname(t),i=fe.basename(e),s=fe.basename(t);if(n=Te.lookupPath(e,{parent:!0}).node,o=Te.lookupPath(t,{parent:!0}).node,!n||!o)throw new Te.ErrnoError(44);if(n.mount!==o.mount)throw new Te.ErrnoError(75);var l,d=Te.lookupNode(n,i),c=Pe.relative(e,a);if("."!==c.charAt(0))throw new Te.ErrnoError(28);if("."!==(c=Pe.relative(t,r)).charAt(0))throw new Te.ErrnoError(55);try{l=Te.lookupNode(o,s)}catch(e){}if(d!==l){var u=Te.isDir(d.mode),m=Te.mayDelete(n,i,u);if(m)throw new Te.ErrnoError(m);if(m=l?Te.mayDelete(o,s,u):Te.mayCreate(o,s))throw new Te.ErrnoError(m);if(!n.node_ops.rename)throw new Te.ErrnoError(63);if(Te.isMountpoint(d)||l&&Te.isMountpoint(l))throw new Te.ErrnoError(10);if(o!==n&&(m=Te.nodePermissions(n,"w")))throw new Te.ErrnoError(m);Te.hashRemoveNode(d);try{n.node_ops.rename(d,o,s),d.parent=o}catch(e){throw e}finally{Te.hashAddNode(d)}}},rmdir(e){var t=Te.lookupPath(e,{parent:!0}).node,n=fe.basename(e),o=Te.lookupNode(t,n),r=Te.mayDelete(t,n,!0);if(r)throw new Te.ErrnoError(r);if(!t.node_ops.rmdir)throw new Te.ErrnoError(63);if(Te.isMountpoint(o))throw new Te.ErrnoError(10);t.node_ops.rmdir(t,n),Te.destroyNode(o)},readdir(e){var t=Te.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new Te.ErrnoError(54);return t.node_ops.readdir(t)},unlink(e){var t=Te.lookupPath(e,{parent:!0}).node;if(!t)throw new Te.ErrnoError(44);var n=fe.basename(e),o=Te.lookupNode(t,n),r=Te.mayDelete(t,n,!1);if(r)throw new Te.ErrnoError(r);if(!t.node_ops.unlink)throw new Te.ErrnoError(63);if(Te.isMountpoint(o))throw new Te.ErrnoError(10);t.node_ops.unlink(t,n),Te.destroyNode(o)},readlink(e){var t=Te.lookupPath(e).node;if(!t)throw new Te.ErrnoError(44);if(!t.node_ops.readlink)throw new Te.ErrnoError(28);return Pe.resolve(Te.getPath(t.parent),t.node_ops.readlink(t))},stat(e,t){var n=Te.lookupPath(e,{follow:!t}).node;if(!n)throw new Te.ErrnoError(44);if(!n.node_ops.getattr)throw new Te.ErrnoError(63);return n.node_ops.getattr(n)},lstat:e=>Te.stat(e,!0),chmod(e,t,n){var o;if(!(o="string"==typeof e?Te.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new Te.ErrnoError(63);o.node_ops.setattr(o,{mode:4095&t|-4096&o.mode,timestamp:Date.now()})},lchmod(e,t){Te.chmod(e,t,!0)},fchmod(e,t){var n=Te.getStreamChecked(e);Te.chmod(n.node,t)},chown(e,t,n,o){var r;if(!(r="string"==typeof e?Te.lookupPath(e,{follow:!o}).node:e).node_ops.setattr)throw new Te.ErrnoError(63);r.node_ops.setattr(r,{timestamp:Date.now()})},lchown(e,t,n){Te.chown(e,t,n,!0)},fchown(e,t,n){var o=Te.getStreamChecked(e);Te.chown(o.node,t,n)},truncate(e,t){if(t<0)throw new Te.ErrnoError(28);var n;if(!(n="string"==typeof e?Te.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new Te.ErrnoError(63);if(Te.isDir(n.mode))throw new Te.ErrnoError(31);if(!Te.isFile(n.mode))throw new Te.ErrnoError(28);var o=Te.nodePermissions(n,"w");if(o)throw new Te.ErrnoError(o);n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate(e,t){var n=Te.getStreamChecked(e);if(!(2097155&n.flags))throw new Te.ErrnoError(28);Te.truncate(n.node,t)},utime(e,t,n){var o=Te.lookupPath(e,{follow:!0}).node;o.node_ops.setattr(o,{timestamp:Math.max(t,n)})},open(e,t,n){if(""===e)throw new Te.ErrnoError(44);var o;if(n=64&(t="string"==typeof t?(e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(void 0===t)throw new Error(`Unknown file open mode: ${e}`);return t})(t):t)?4095&(n=void 0===n?438:n)|32768:0,"object"==typeof e)o=e;else{e=fe.normalize(e);try{o=Te.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var r=!1;if(64&t)if(o){if(128&t)throw new Te.ErrnoError(20)}else o=Te.mknod(e,n,0),r=!0;if(!o)throw new Te.ErrnoError(44);if(Te.isChrdev(o.mode)&&(t&=-513),65536&t&&!Te.isDir(o.mode))throw new Te.ErrnoError(54);if(!r){var a=Te.mayOpen(o,t);if(a)throw new Te.ErrnoError(a)}512&t&&!r&&Te.truncate(o,0),t&=-131713;var s=Te.createStream({node:o,path:Te.getPath(o),flags:t,seekable:!0,position:0,stream_ops:o.stream_ops,ungotten:[],error:!1});return s.stream_ops.open&&s.stream_ops.open(s),!i.logReadFiles||1&t||e in Te.readFiles||(Te.readFiles[e]=1),s},close(e){if(Te.isClosed(e))throw new Te.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{Te.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek(e,t,n){if(Te.isClosed(e))throw new Te.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Te.ErrnoError(70);if(0!=n&&1!=n&&2!=n)throw new Te.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read(e,t,n,o,r){if(M(n>=0),o<0||r<0)throw new Te.ErrnoError(28);if(Te.isClosed(e))throw new Te.ErrnoError(8);if(1==(2097155&e.flags))throw new Te.ErrnoError(8);if(Te.isDir(e.node.mode))throw new Te.ErrnoError(31);if(!e.stream_ops.read)throw new Te.ErrnoError(28);var a=void 0!==r;if(a){if(!e.seekable)throw new Te.ErrnoError(70)}else r=e.position;var i=e.stream_ops.read(e,t,n,o,r);return a||(e.position+=i),i},write(e,t,n,o,r,a){if(M(n>=0),o<0||r<0)throw new Te.ErrnoError(28);if(Te.isClosed(e))throw new Te.ErrnoError(8);if(!(2097155&e.flags))throw new Te.ErrnoError(8);if(Te.isDir(e.node.mode))throw new Te.ErrnoError(31);if(!e.stream_ops.write)throw new Te.ErrnoError(28);e.seekable&&1024&e.flags&&Te.llseek(e,0,2);var i=void 0!==r;if(i){if(!e.seekable)throw new Te.ErrnoError(70)}else r=e.position;var s=e.stream_ops.write(e,t,n,o,r,a);return i||(e.position+=s),s},allocate(e,t,n){if(Te.isClosed(e))throw new Te.ErrnoError(8);if(t<0||n<=0)throw new Te.ErrnoError(28);if(!(2097155&e.flags))throw new Te.ErrnoError(8);if(!Te.isFile(e.node.mode)&&!Te.isDir(e.node.mode))throw new Te.ErrnoError(43);if(!e.stream_ops.allocate)throw new Te.ErrnoError(138);e.stream_ops.allocate(e,t,n)},mmap(e,t,n,o,r){if(2&o&&!(2&r)&&2!=(2097155&e.flags))throw new Te.ErrnoError(2);if(1==(2097155&e.flags))throw new Te.ErrnoError(2);if(!e.stream_ops.mmap)throw new Te.ErrnoError(43);if(!t)throw new Te.ErrnoError(28);return e.stream_ops.mmap(e,t,n,o,r)},msync:(e,t,n,o,r)=>(M(n>=0),e.stream_ops.msync?e.stream_ops.msync(e,t,n,o,r):0),ioctl(e,t,n){if(!e.stream_ops.ioctl)throw new Te.ErrnoError(59);return e.stream_ops.ioctl(e,t,n)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error(`Invalid encoding type "${t.encoding}"`);var n,o=Te.open(e,t.flags),r=Te.stat(e).size,a=new Uint8Array(r);return Te.read(o,a,0,r,0),"utf8"===t.encoding?n=me(a):"binary"===t.encoding&&(n=a),Te.close(o),n},writeFile(e,t,n={}){n.flags=n.flags||577;var o=Te.open(e,n.flags,n.mode);if("string"==typeof t){var r=new Uint8Array(_e(t)+1),a=ve(t,r,0,r.length);Te.write(o,r,0,a,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Te.write(o,t,0,t.byteLength,void 0,n.canOwn)}Te.close(o)},cwd:()=>Te.currentPath,chdir(e){var t=Te.lookupPath(e,{follow:!0});if(null===t.node)throw new Te.ErrnoError(44);if(!Te.isDir(t.node.mode))throw new Te.ErrnoError(54);var n=Te.nodePermissions(t.node,"x");if(n)throw new Te.ErrnoError(n);Te.currentPath=t.path},createDefaultDirectories(){Te.mkdir("/tmp"),Te.mkdir("/home"),Te.mkdir("/home/web_user")},createDefaultDevices(){Te.mkdir("/dev"),Te.registerDevice(Te.makedev(1,3),{read:()=>0,write:(e,t,n,o,r)=>o}),Te.mkdev("/dev/null",Te.makedev(1,3)),Ae.register(Te.makedev(5,0),Ae.default_tty_ops),Ae.register(Te.makedev(6,0),Ae.default_tty1_ops),Te.mkdev("/dev/tty",Te.makedev(5,0)),Te.mkdev("/dev/tty1",Te.makedev(6,0));var e=new Uint8Array(1024),t=0,n=()=>(0===t&&(t=Fe(e).byteLength),e[--t]);Te.createDevice("/dev","random",n),Te.createDevice("/dev","urandom",n),Te.mkdir("/dev/shm"),Te.mkdir("/dev/shm/tmp")},createSpecialDirectories(){Te.mkdir("/proc");var e=Te.mkdir("/proc/self");Te.mkdir("/proc/self/fd"),Te.mount({mount(){var t=Te.createNode(e,"fd",16895,73);return t.node_ops={lookup(e,t){var n=+t,o=Te.getStreamChecked(n),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>o.path}};return r.parent=r,r}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,n){e?Te.createDevice("/dev","stdin",e):Te.symlink("/dev/tty","/dev/stdin"),t?Te.createDevice("/dev","stdout",null,t):Te.symlink("/dev/tty","/dev/stdout"),n?Te.createDevice("/dev","stderr",null,n):Te.symlink("/dev/tty1","/dev/stderr");var o=Te.open("/dev/stdin",0),r=Te.open("/dev/stdout",1),a=Te.open("/dev/stderr",1);M(0===o.fd,`invalid handle for stdin (${o.fd})`),M(1===r.fd,`invalid handle for stdout (${r.fd})`),M(2===a.fd,`invalid handle for stderr (${a.fd})`)},staticInit(){[44].forEach(e=>{Te.genericErrors[e]=new Te.ErrnoError(e),Te.genericErrors[e].stack="<generic error, no stack>"}),Te.nameTable=new Array(4096),Te.mount(Ee,{},"/"),Te.createDefaultDirectories(),Te.createDefaultDevices(),Te.createSpecialDirectories(),Te.filesystems={MEMFS:Ee}},init(e,t,n){M(!Te.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),Te.initialized=!0,e??=i.stdin,t??=i.stdout,n??=i.stderr,Te.createStandardStreams(e,t,n)},quit(){Te.initialized=!1,Je(0);for(var e=0;e<Te.streams.length;e++){var t=Te.streams[e];t&&Te.close(t)}},findObject(e,t){var n=Te.analyzePath(e,t);return n.exists?n.object:null},analyzePath(e,t){try{e=(o=Te.lookupPath(e,{follow:!t})).path}catch(e){}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=Te.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=o.path,n.parentObject=o.node,n.name=fe.basename(e),o=Te.lookupPath(e,{follow:!t}),n.exists=!0,n.path=o.path,n.object=o.node,n.name=o.node.name,n.isRoot="/"===o.path}catch(e){n.error=e.errno}return n},createPath(e,t,n,o){e="string"==typeof e?e:Te.getPath(e);for(var r=t.split("/").reverse();r.length;){var a=r.pop();if(a){var i=fe.join2(e,a);try{Te.mkdir(i)}catch(e){}e=i}}return i},createFile(e,t,n,o,r){var a=fe.join2("string"==typeof e?e:Te.getPath(e),t),i=Me(o,r);return Te.create(a,i)},createDataFile(e,t,n,o,r,a){var i=t;e&&(e="string"==typeof e?e:Te.getPath(e),i=t?fe.join2(e,t):e);var s=Me(o,r),l=Te.create(i,s);if(n){if("string"==typeof n){for(var d=new Array(n.length),c=0,u=n.length;c<u;++c)d[c]=n.charCodeAt(c);n=d}Te.chmod(l,146|s);var m=Te.open(l,577);Te.write(m,n,0,n.length,0,a),Te.close(m),Te.chmod(l,s)}},createDevice(e,t,n,o){var r=fe.join2("string"==typeof e?e:Te.getPath(e),t),a=Me(!!n,!!o);Te.createDevice.major??=64;var i=Te.makedev(Te.createDevice.major++,0);return Te.registerDevice(i,{open(e){e.seekable=!1},close(e){o?.buffer?.length&&o(10)},read(e,t,o,r,a){for(var i=0,s=0;s<r;s++){var l;try{l=n()}catch(e){throw new Te.ErrnoError(29)}if(void 0===l&&0===i)throw new Te.ErrnoError(6);if(null==l)break;i++,t[o+s]=l}return i&&(e.node.timestamp=Date.now()),i},write(e,t,n,r,a){for(var i=0;i<r;i++)try{o(t[n+i])}catch(e){throw new Te.ErrnoError(29)}return r&&(e.node.timestamp=Date.now()),i}}),Te.mkdev(r,a,i)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{e.contents=u(e.url),e.usedBytes=e.contents.length}catch(e){throw new Te.ErrnoError(29)}},createLazyFile(e,t,n,o,r){class a{constructor(){this.lengthKnown=!1,this.chunks=[]}get(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,n=e/this.chunkSize|0;return this.getter(n)[t]}}setDataGetter(e){this.getter=e}cacheLength(){var e=new XMLHttpRequest;if(e.open("HEAD",n,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+n+". Status: "+e.status);var t,o=Number(e.getResponseHeader("Content-length")),r=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,a=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,i=1048576;r||(i=o);var s=this;s.setDataGetter(e=>{var t=e*i,r=(e+1)*i-1;if(r=Math.min(r,o-1),void 0===s.chunks[e]&&(s.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>o-1)throw new Error("only "+o+" bytes available! programmer error!");var r=new XMLHttpRequest;if(r.open("GET",n,!1),o!==i&&r.setRequestHeader("Range","bytes="+e+"-"+t),r.responseType="arraybuffer",r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.send(null),!(r.status>=200&&r.status<300||304===r.status))throw new Error("Couldn't load "+n+". Status: "+r.status);return void 0!==r.response?new Uint8Array(r.response||[]):ye(r.responseText||"")})(t,r)),void 0===s.chunks[e])throw new Error("doXHR failed!");return s.chunks[e]}),!a&&o||(i=o=1,o=this.getter(0).length,i=o,F("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=o,this._chunkSize=i,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if("undefined"!=typeof XMLHttpRequest){if(!d)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var i={isDevice:!1,contents:new a}}else i={isDevice:!1,url:n};var s=Te.createFile(e,t,i,o,r);i.contents?s.contents=i.contents:i.url&&(s.contents=null,s.url=i.url),Object.defineProperties(s,{usedBytes:{get:function(){return this.contents.length}}});var l={};function c(e,t,n,o,r){var a=e.node.contents;if(r>=a.length)return 0;var i=Math.min(a.length-r,o);if(M(i>=0),a.slice)for(var s=0;s<i;s++)t[n+s]=a[r+s];else for(s=0;s<i;s++)t[n+s]=a.get(r+s);return i}return Object.keys(s.stream_ops).forEach(e=>{var t=s.stream_ops[e];l[e]=(...e)=>(Te.forceLoadFile(s),t(...e))}),l.read=(e,t,n,o,r)=>(Te.forceLoadFile(s),c(e,t,n,o,r)),l.mmap=(e,t,n,o,r)=>{Te.forceLoadFile(s);var a=Se(t);if(!a)throw new Te.ErrnoError(48);return c(e,v,a,t,n),{ptr:a,allocated:!0}},s.stream_ops=l,s},absolutePath(){V("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){V("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){V("FS.createLink has been removed; use FS.symlink instead")},joinPath(){V("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){V("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){V("FS.standardizePath has been removed; use PATH.normalize instead")}},Ie={DEFAULT_POLLMASK:5,calculateAt(e,t,n){if(fe.isAbs(t))return t;var o;if(o=-100===e?Te.cwd():Ie.getStreamFromFD(e).path,0==t.length){if(!n)throw new Te.ErrnoError(44);return o}return fe.join2(o,t)},doStat(e,t,n){var o=e(t);A[n>>2]=o.dev,A[n+4>>2]=o.mode,w[n+8>>2]=o.nlink,A[n+12>>2]=o.uid,A[n+16>>2]=o.gid,A[n+20>>2]=o.rdev,K=[o.size>>>0,(q=o.size,+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[n+24>>2]=K[0],A[n+28>>2]=K[1],A[n+32>>2]=4096,A[n+36>>2]=o.blocks;var r=o.atime.getTime(),a=o.mtime.getTime(),i=o.ctime.getTime();return K=[Math.floor(r/1e3)>>>0,(q=Math.floor(r/1e3),+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[n+40>>2]=K[0],A[n+44>>2]=K[1],w[n+48>>2]=r%1e3*1e3*1e3,K=[Math.floor(a/1e3)>>>0,(q=Math.floor(a/1e3),+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[n+56>>2]=K[0],A[n+60>>2]=K[1],w[n+64>>2]=a%1e3*1e3*1e3,K=[Math.floor(i/1e3)>>>0,(q=Math.floor(i/1e3),+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[n+72>>2]=K[0],A[n+76>>2]=K[1],w[n+80>>2]=i%1e3*1e3*1e3,K=[o.ino>>>0,(q=o.ino,+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[n+88>>2]=K[0],A[n+92>>2]=K[1],0},doMsync(e,t,n,o,r){if(!Te.isFile(t.node.mode))throw new Te.ErrnoError(43);if(2&o)return 0;var a=y.slice(e,e+n);Te.msync(t,a,r,n,o)},getStreamFromFD:e=>Te.getStreamChecked(e),varargs:void 0,getStr:e=>pe(e)},Oe=(e,t)=>(M(e==e>>>0||e==(0|e)),M(t===(0|t)),t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN),Re=(e,t,n)=>(M("number"==typeof n,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),ve(e,y,t,n)),Ge=[0,31,60,91,121,152,182,213,244,274,305,335],Le=[0,31,59,90,120,151,181,212,243,273,304,334],Ne=e=>{var t=b.buffer,n=(e-t.byteLength+65535)/65536|0;try{return b.grow(n),k(),1}catch(n){P(`growMemory: Attempted to grow heap from ${t.byteLength} bytes to ${e} bytes, but got error: ${n}`)}},ze={},je=()=>{if(!je.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:h||"./this.program"};for(var t in ze)void 0===ze[t]?delete e[t]:e[t]=ze[t];var n=[];for(var t in e)n.push(`${t}=${e[t]}`);je.strings=n}return je.strings},Be=[],$e=e=>{var t=Be[e];return t||(e>=Be.length&&(Be.length=e+1),Be[e]=t=De.get(e)),M(De.get(e)==t,"JavaScript-side Wasm function table mirror is out of date!"),t},Ue="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,We=(e,t)=>{M(e<16384),e<128?t.push(e):t.push(e%128|128,e>>7)},He=[],Ve=(e,t)=>{De.set(e,t),Be[e]=De.get(e)},Ye=e=>it(e),qe=(e,t,n,o,r)=>{var a={string:e=>{var t=0;return null!=e&&0!==e&&(t=(e=>{var t=_e(e)+1,n=Ye(t);return Re(e,n,t),n})(e)),t},array:e=>{var t,n,o=Ye(e.length);return n=o,M((t=e).length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),v.set(t,n),o}},s=(e=>{var t=i["_"+e];return M(t,"Cannot call unknown function "+e+", make sure it is exported"),t})(e),l=[],d=0;if(M("array"!==t,'Return type should not be "array".'),o)for(var c=0;c<o.length;c++){var u=a[n[c]];u?(0===d&&(d=de()),l[c]=u(o[c])):l[c]=o[c]}return function(e){return 0!==d&&le(d),function(e){return"string"===t?pe(e):"boolean"===t?Boolean(e):e}(e)}(s(...l))};Te.createPreloadedFile=(e,t,n,o,r,a,i,s,l,d)=>{var u=t?Pe.resolve(fe.join2(e,t)):e,m=U(`cp ${u}`);function p(n){function c(n){d?.(),s||((e,t,n,o,r,a)=>{Te.createDataFile(e,t,n,o,r,a)})(e,t,n,o,r,l),a?.(),H(m)}((e,t,n,o)=>{"undefined"!=typeof Browser&&Browser.init();var r=!1;return Ce.forEach(a=>{r||a.canHandle(t)&&(a.handle(e,t,n,o),r=!0)}),r})(n,u,c,()=>{i?.(),H(m)})||c(n)}W(m),"string"==typeof n?((e,t,n)=>{var o=U(`al ${e}`);c(e).then(n=>{M(n,`Loading data file "${e}" failed (no arrayBuffer).`),t(new Uint8Array(n)),o&&H(o)},t=>{if(!n)throw`Loading data file "${e}" failed.`;n()}),o&&W(o)})(n,p,i):p(n)},Te.staticInit();var Ke={__assert_fail:(e,t,n,o)=>{V(`Assertion failed: ${pe(e)}, at: `+[t?pe(t):"unknown filename",n,o?pe(o):"unknown function"])},__syscall_fcntl64:function(e,t,n){Ie.varargs=n;try{var o=Ie.getStreamFromFD(e);switch(t){case 0:if((r=he())<0)return-28;for(;Te.streams[r];)r++;return Te.dupStream(o,r).fd;case 1:case 2:case 13:case 14:return 0;case 3:return o.flags;case 4:var r=he();return o.flags|=r,0;case 12:return r=ge(),D[r+0>>1]=2,0}return-28}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_fstat64:function(e,t){try{var n=Ie.getStreamFromFD(e);return Ie.doStat(Te.stat,n.path,t)}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_ftruncate64:function(e,t,n){var o=Oe(t,n);try{return isNaN(o)?61:(Te.ftruncate(e,o),0)}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_getdents64:function(e,t,n){try{var o=Ie.getStreamFromFD(e);o.getdents||=Te.readdir(o.path);for(var r=280,a=0,i=Te.llseek(o,0,1),s=Math.floor(i/r);s<o.getdents.length&&a+r<=n;){var l,d,c=o.getdents[s];if("."===c)l=o.node.id,d=4;else if(".."===c)l=Te.lookupPath(o.path,{parent:!0}).node.id,d=4;else{var u=Te.lookupNode(o.node,c);l=u.id,d=Te.isChrdev(u.mode)?2:Te.isDir(u.mode)?4:Te.isLink(u.mode)?10:8}M(l),K=[l>>>0,(q=l,+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[t+a>>2]=K[0],A[t+a+4>>2]=K[1],K=[(s+1)*r>>>0,(q=(s+1)*r,+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[t+a+8>>2]=K[0],A[t+a+12>>2]=K[1],D[t+a+16>>1]=280,v[t+a+18]=d,Re(c,t+a+19,256),a+=r,s+=1}return Te.llseek(o,s*r,0),a}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_ioctl:function(e,t,n){Ie.varargs=n;try{var o=Ie.getStreamFromFD(e);switch(t){case 21509:case 21510:case 21511:case 21512:case 21524:case 21515:return o.tty?0:-59;case 21505:if(!o.tty)return-59;if(o.tty.ops.ioctl_tcgets){var r=o.tty.ops.ioctl_tcgets(o),a=ge();A[a>>2]=r.c_iflag||0,A[a+4>>2]=r.c_oflag||0,A[a+8>>2]=r.c_cflag||0,A[a+12>>2]=r.c_lflag||0;for(var i=0;i<32;i++)v[a+i+17]=r.c_cc[i]||0;return 0}return 0;case 21506:case 21507:case 21508:if(!o.tty)return-59;if(o.tty.ops.ioctl_tcsets){a=ge();var s=A[a>>2],l=A[a+4>>2],d=A[a+8>>2],c=A[a+12>>2],u=[];for(i=0;i<32;i++)u.push(v[a+i+17]);return o.tty.ops.ioctl_tcsets(o.tty,t,{c_iflag:s,c_oflag:l,c_cflag:d,c_lflag:c,c_cc:u})}return 0;case 21519:return o.tty?(a=ge(),A[a>>2]=0,0):-59;case 21520:return o.tty?-28:-59;case 21531:return a=ge(),Te.ioctl(o,t,a);case 21523:if(!o.tty)return-59;if(o.tty.ops.ioctl_tiocgwinsz){var m=o.tty.ops.ioctl_tiocgwinsz(o.tty);a=ge(),D[a>>1]=m[0],D[a+2>>1]=m[1]}return 0;default:return-28}}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_lstat64:function(e,t){try{return e=Ie.getStr(e),Ie.doStat(Te.lstat,e,t)}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_newfstatat:function(e,t,n,o){try{t=Ie.getStr(t);var r=256&o,a=4096&o;return M(!(o&=-6401),`unknown flags in __syscall_newfstatat: ${o}`),t=Ie.calculateAt(e,t,a),Ie.doStat(r?Te.lstat:Te.stat,t,n)}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_openat:function(e,t,n,o){Ie.varargs=o;try{t=Ie.getStr(t),t=Ie.calculateAt(e,t);var r=o?he():0;return Te.open(t,n,r).fd}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_rmdir:function(e){try{return e=Ie.getStr(e),Te.rmdir(e),0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_stat64:function(e,t){try{return e=Ie.getStr(e),Ie.doStat(Te.stat,e,t)}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},__syscall_unlinkat:function(e,t,n){try{return t=Ie.getStr(t),t=Ie.calculateAt(e,t),0===n?Te.unlink(t):512===n?Te.rmdir(t):V("Invalid flags passed to unlinkat"),0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return-e.errno}},_abort_js:()=>{V("native code called abort()")},_emscripten_memcpy_js:(e,t,n)=>y.copyWithin(e,t,t+n),_emscripten_throw_longjmp:()=>{throw 1/0},_gmtime_js:function(e,t,n){var o=Oe(e,t),r=new Date(1e3*o);A[n>>2]=r.getUTCSeconds(),A[n+4>>2]=r.getUTCMinutes(),A[n+8>>2]=r.getUTCHours(),A[n+12>>2]=r.getUTCDate(),A[n+16>>2]=r.getUTCMonth(),A[n+20>>2]=r.getUTCFullYear()-1900,A[n+24>>2]=r.getUTCDay();var a=Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0),i=(r.getTime()-a)/864e5|0;A[n+28>>2]=i},_localtime_js:function(e,t,n){var o=Oe(e,t),r=new Date(1e3*o);A[n>>2]=r.getSeconds(),A[n+4>>2]=r.getMinutes(),A[n+8>>2]=r.getHours(),A[n+12>>2]=r.getDate(),A[n+16>>2]=r.getMonth(),A[n+20>>2]=r.getFullYear()-1900,A[n+24>>2]=r.getDay();var a=0|(e=>{var t;return((t=e.getFullYear())%4!=0||t%100==0&&t%400!=0?Le:Ge)[e.getMonth()]+e.getDate()-1})(r);A[n+28>>2]=a,A[n+36>>2]=-60*r.getTimezoneOffset();var i=new Date(r.getFullYear(),0,1),s=new Date(r.getFullYear(),6,1).getTimezoneOffset(),l=i.getTimezoneOffset(),d=0|(s!=l&&r.getTimezoneOffset()==Math.min(l,s));A[n+32>>2]=d},_tzset_js:(e,t,n,o)=>{var r=(new Date).getFullYear(),a=new Date(r,0,1),i=new Date(r,6,1),s=a.getTimezoneOffset(),l=i.getTimezoneOffset(),d=Math.max(s,l);w[e>>2]=60*d,A[t>>2]=Number(s!=l);var c=e=>{var t=e>=0?"-":"+",n=Math.abs(e);return`UTC${t}${String(Math.floor(n/60)).padStart(2,"0")}${String(n%60).padStart(2,"0")}`},u=c(s),m=c(l);M(u),M(m),M(_e(u)<=16,`timezone name truncated to fit in TZNAME_MAX (${u})`),M(_e(m)<=16,`timezone name truncated to fit in TZNAME_MAX (${m})`),l<s?(Re(u,n,17),Re(m,o,17)):(Re(u,o,17),Re(m,n,17))},emscripten_date_now:()=>Date.now(),emscripten_resize_heap:e=>{var t=y.length;M((e>>>=0)>t);var n=2147483648;if(e>n)return P(`Cannot enlarge memory, requested ${e} bytes, but the limit is 2147483648 bytes!`),!1;for(var o=1;o<=4;o*=2){var r=t*(1+.2/o);r=Math.min(r,e+100663296);var a=Math.min(n,we(Math.max(e,r),65536));if(Ne(a))return!0}return P(`Failed to grow the heap from ${t} bytes to ${a} bytes, not enough memory!`),!1},environ_get:(e,t)=>{var n=0;return je().forEach((o,r)=>{var a=t+n;w[e+4*r>>2]=a,((e,t)=>{for(var n=0;n<e.length;++n)M(e.charCodeAt(n)===(255&e.charCodeAt(n))),v[t++]=e.charCodeAt(n);v[t]=0})(o,a),n+=o.length+1}),0},environ_sizes_get:(e,t)=>{var n=je();w[e>>2]=n.length;var o=0;return n.forEach(e=>o+=e.length+1),w[t>>2]=o,0},fd_close:function(e){try{var t=Ie.getStreamFromFD(e);return Te.close(t),0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return e.errno}},fd_read:function(e,t,n,o){try{var r=((e,t,n)=>{for(var o=0,r=0;r<n;r++){var a=w[t>>2],i=w[t+4>>2];t+=8;var s=Te.read(e,v,a,i,void 0);if(s<0)return-1;if(o+=s,s<i)break}return o})(Ie.getStreamFromFD(e),t,n);return w[o>>2]=r,0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return e.errno}},fd_seek:function(e,t,n,o,r){var a=Oe(t,n);try{if(isNaN(a))return 61;var i=Ie.getStreamFromFD(e);return Te.llseek(i,a,o),K=[i.position>>>0,(q=i.position,+Math.abs(q)>=1?q>0?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],A[r>>2]=K[0],A[r+4>>2]=K[1],i.getdents&&0===a&&0===o&&(i.getdents=null),0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return e.errno}},fd_sync:function(e){try{var t=Ie.getStreamFromFD(e);return t.stream_ops?.fsync?t.stream_ops.fsync(t):0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return e.errno}},fd_write:function(e,t,n,o){try{var r=((e,t,n)=>{for(var o=0,r=0;r<n;r++){var a=w[t>>2],i=w[t+4>>2];t+=8;var s=Te.write(e,v,a,i,void 0);if(s<0)return-1;if(o+=s,s<i)break}return o})(Ie.getStreamFromFD(e),t,n);return w[o>>2]=r,0}catch(e){if(void 0===Te||"ErrnoError"!==e.name)throw e;return e.errno}},invoke_ii:function(e,t){var n=de();try{return $e(e)(t)}catch(e){if(le(n),e!==e+0)throw e;nt(1,0)}},invoke_iii:function(e,t,n){var o=de();try{return $e(e)(t,n)}catch(e){if(le(o),e!==e+0)throw e;nt(1,0)}},invoke_iiii:function(e,t,n,o){var r=de();try{return $e(e)(t,n,o)}catch(e){if(le(r),e!==e+0)throw e;nt(1,0)}},invoke_iiiii:function(e,t,n,o,r){var a=de();try{return $e(e)(t,n,o,r)}catch(e){if(le(a),e!==e+0)throw e;nt(1,0)}},invoke_v:function(e){var t=de();try{$e(e)()}catch(e){if(le(t),e!==e+0)throw e;nt(1,0)}},invoke_vii:function(e,t,n){var o=de();try{$e(e)(t,n)}catch(e){if(le(o),e!==e+0)throw e;nt(1,0)}},invoke_viii:function(e,t,n,o){var r=de();try{$e(e)(t,n,o)}catch(e){if(le(r),e!==e+0)throw e;nt(1,0)}},invoke_viiii:function(e,t,n,o,r){var a=de();try{$e(e)(t,n,o,r)}catch(e){if(le(a),e!==e+0)throw e;nt(1,0)}},invoke_viiiiiiiii:function(e,t,n,o,r,a,i,s,l,d){var c=de();try{$e(e)(t,n,o,r,a,i,s,l,d)}catch(e){if(le(c),e!==e+0)throw e;nt(1,0)}}},Xe=function(){var e={env:Ke,wasi_snapshot_preview1:Ke};function t(e,t){var n;return Xe=e.exports,i.wasmExports=Xe,M(b=Xe.memory,"memory not found in wasm exports"),k(),M(De=Xe.__indirect_function_table,"table not found in wasm exports"),n=Xe.__wasm_call_ctors,O.unshift(n),H("wasm-instantiate"),Xe}W("wasm-instantiate");var o,r,s,l,d=i;if(i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(e){P(`Module.instantiateWasm callback failed with error: ${e}`),a(e)}return Y??=function(){if(i.locateFile){var e="pdfium.wasm";return X(e)?e:(t=e,i.locateFile?i.locateFile(t,g):g+t)}var t;return m?"pdfium.wasm":new URL(n(62),n.b).href}(),(o=_,r=Y,s=e,l=function(e){M(i===d,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),d=null,t(e.instance)},o||"function"!=typeof WebAssembly.instantiateStreaming||X(r)||"function"!=typeof fetch?ee(r,s,l):fetch(r,{credentials:"same-origin"}).then(e=>WebAssembly.instantiateStreaming(e,s).then(l,function(e){return P(`wasm streaming compile failed: ${e}`),P("falling back to ArrayBuffer instantiation"),ee(r,s,l)}))).catch(a),{}}();i._PDFiumExt_Init=Q("PDFiumExt_Init",0),i._FPDF_InitLibraryWithConfig=Q("FPDF_InitLibraryWithConfig",1),i._PDFiumExt_OpenFileWriter=Q("PDFiumExt_OpenFileWriter",0),i._PDFiumExt_GetFileWriterSize=Q("PDFiumExt_GetFileWriterSize",1),i._PDFiumExt_GetFileWriterData=Q("PDFiumExt_GetFileWriterData",3),i._PDFiumExt_CloseFileWriter=Q("PDFiumExt_CloseFileWriter",1),i._PDFiumExt_SaveAsCopy=Q("PDFiumExt_SaveAsCopy",2),i._FPDF_SaveAsCopy=Q("FPDF_SaveAsCopy",3),i._PDFiumExt_OpenFormFillInfo=Q("PDFiumExt_OpenFormFillInfo",0),i._PDFiumExt_CloseFormFillInfo=Q("PDFiumExt_CloseFormFillInfo",1),i._PDFiumExt_InitFormFillEnvironment=Q("PDFiumExt_InitFormFillEnvironment",2),i._FPDFDOC_InitFormFillEnvironment=Q("FPDFDOC_InitFormFillEnvironment",2),i._PDFiumExt_ExitFormFillEnvironment=Q("PDFiumExt_ExitFormFillEnvironment",1),i._FPDFDOC_ExitFormFillEnvironment=Q("FPDFDOC_ExitFormFillEnvironment",1),i._EPDFNamedDest_SetDest=Q("EPDFNamedDest_SetDest",3),i._EPDFNamedDest_Remove=Q("EPDFNamedDest_Remove",2),i._EPDFDest_CreateView=Q("EPDFDest_CreateView",4),i._EPDFDest_CreateXYZ=Q("EPDFDest_CreateXYZ",7),i._EPDFDest_CreateRemoteView=Q("EPDFDest_CreateRemoteView",5),i._EPDFDest_CreateRemoteXYZ=Q("EPDFDest_CreateRemoteXYZ",8),i._EPDFAction_CreateGoTo=Q("EPDFAction_CreateGoTo",2),i._EPDFAction_CreateGoToNamed=Q("EPDFAction_CreateGoToNamed",2),i._EPDFAction_CreateLaunch=Q("EPDFAction_CreateLaunch",2),i._EPDFAction_CreateRemoteGoToByName=Q("EPDFAction_CreateRemoteGoToByName",3),i._EPDFAction_CreateRemoteGoToDest=Q("EPDFAction_CreateRemoteGoToDest",3),i._EPDFAction_CreateURI=Q("EPDFAction_CreateURI",2),i._EPDFBookmark_Create=Q("EPDFBookmark_Create",2),i._EPDFBookmark_Delete=Q("EPDFBookmark_Delete",2),i._EPDFBookmark_AppendChild=Q("EPDFBookmark_AppendChild",3),i._EPDFBookmark_InsertAfter=Q("EPDFBookmark_InsertAfter",4),i._EPDFBookmark_Clear=Q("EPDFBookmark_Clear",1),i._EPDFBookmark_SetTitle=Q("EPDFBookmark_SetTitle",2),i._EPDFBookmark_SetDest=Q("EPDFBookmark_SetDest",3),i._EPDFBookmark_SetAction=Q("EPDFBookmark_SetAction",3),i._EPDFBookmark_ClearTarget=Q("EPDFBookmark_ClearTarget",1),i._EPDF_PNG_EncodeRGBA=Q("EPDF_PNG_EncodeRGBA",6),i._FPDFAnnot_IsSupportedSubtype=Q("FPDFAnnot_IsSupportedSubtype",1),i._FPDFPage_CreateAnnot=Q("FPDFPage_CreateAnnot",2),i._FPDFPage_GetAnnotCount=Q("FPDFPage_GetAnnotCount",1),i._FPDFPage_GetAnnot=Q("FPDFPage_GetAnnot",2),i._FPDFPage_GetAnnotIndex=Q("FPDFPage_GetAnnotIndex",2),i._FPDFPage_CloseAnnot=Q("FPDFPage_CloseAnnot",1),i._FPDFPage_RemoveAnnot=Q("FPDFPage_RemoveAnnot",2),i._FPDFAnnot_GetSubtype=Q("FPDFAnnot_GetSubtype",1),i._FPDFAnnot_IsObjectSupportedSubtype=Q("FPDFAnnot_IsObjectSupportedSubtype",1),i._FPDFAnnot_UpdateObject=Q("FPDFAnnot_UpdateObject",2),i._FPDFAnnot_AddInkStroke=Q("FPDFAnnot_AddInkStroke",3),i._FPDFAnnot_RemoveInkList=Q("FPDFAnnot_RemoveInkList",1),i._FPDFAnnot_AppendObject=Q("FPDFAnnot_AppendObject",2),i._FPDFAnnot_GetObjectCount=Q("FPDFAnnot_GetObjectCount",1),i._FPDFAnnot_GetObject=Q("FPDFAnnot_GetObject",2),i._FPDFAnnot_RemoveObject=Q("FPDFAnnot_RemoveObject",2),i._FPDFAnnot_SetColor=Q("FPDFAnnot_SetColor",6),i._FPDFAnnot_GetColor=Q("FPDFAnnot_GetColor",6),i._FPDFAnnot_HasAttachmentPoints=Q("FPDFAnnot_HasAttachmentPoints",1),i._FPDFAnnot_SetAttachmentPoints=Q("FPDFAnnot_SetAttachmentPoints",3),i._FPDFAnnot_AppendAttachmentPoints=Q("FPDFAnnot_AppendAttachmentPoints",2),i._FPDFAnnot_CountAttachmentPoints=Q("FPDFAnnot_CountAttachmentPoints",1),i._FPDFAnnot_GetAttachmentPoints=Q("FPDFAnnot_GetAttachmentPoints",3),i._FPDFAnnot_SetRect=Q("FPDFAnnot_SetRect",2),i._FPDFAnnot_GetRect=Q("FPDFAnnot_GetRect",2),i._FPDFAnnot_GetVertices=Q("FPDFAnnot_GetVertices",3),i._FPDFAnnot_GetInkListCount=Q("FPDFAnnot_GetInkListCount",1),i._FPDFAnnot_GetInkListPath=Q("FPDFAnnot_GetInkListPath",4),i._FPDFAnnot_GetLine=Q("FPDFAnnot_GetLine",3),i._FPDFAnnot_SetBorder=Q("FPDFAnnot_SetBorder",4),i._FPDFAnnot_GetBorder=Q("FPDFAnnot_GetBorder",4),i._FPDFAnnot_HasKey=Q("FPDFAnnot_HasKey",2),i._FPDFAnnot_GetValueType=Q("FPDFAnnot_GetValueType",2),i._FPDFAnnot_SetStringValue=Q("FPDFAnnot_SetStringValue",3),i._FPDFAnnot_GetStringValue=Q("FPDFAnnot_GetStringValue",4),i._FPDFAnnot_GetNumberValue=Q("FPDFAnnot_GetNumberValue",3),i._FPDFAnnot_SetAP=Q("FPDFAnnot_SetAP",3),i._FPDFAnnot_GetAP=Q("FPDFAnnot_GetAP",4),i._FPDFAnnot_GetLinkedAnnot=Q("FPDFAnnot_GetLinkedAnnot",2),i._FPDFAnnot_GetFlags=Q("FPDFAnnot_GetFlags",1),i._FPDFAnnot_SetFlags=Q("FPDFAnnot_SetFlags",2),i._FPDFAnnot_GetFormFieldFlags=Q("FPDFAnnot_GetFormFieldFlags",2),i._FPDFAnnot_SetFormFieldFlags=Q("FPDFAnnot_SetFormFieldFlags",3),i._FPDFAnnot_GetFormFieldAtPoint=Q("FPDFAnnot_GetFormFieldAtPoint",3),i._FPDFAnnot_GetFormFieldName=Q("FPDFAnnot_GetFormFieldName",4),i._FPDFAnnot_GetFormFieldType=Q("FPDFAnnot_GetFormFieldType",2),i._FPDFAnnot_GetFormAdditionalActionJavaScript=Q("FPDFAnnot_GetFormAdditionalActionJavaScript",5),i._FPDFAnnot_GetFormFieldAlternateName=Q("FPDFAnnot_GetFormFieldAlternateName",4),i._FPDFAnnot_GetFormFieldValue=Q("FPDFAnnot_GetFormFieldValue",4),i._FPDFAnnot_GetOptionCount=Q("FPDFAnnot_GetOptionCount",2),i._FPDFAnnot_GetOptionLabel=Q("FPDFAnnot_GetOptionLabel",5),i._FPDFAnnot_IsOptionSelected=Q("FPDFAnnot_IsOptionSelected",3),i._FPDFAnnot_GetFontSize=Q("FPDFAnnot_GetFontSize",3),i._FPDFAnnot_SetFontColor=Q("FPDFAnnot_SetFontColor",5),i._FPDFAnnot_GetFontColor=Q("FPDFAnnot_GetFontColor",5),i._FPDFAnnot_IsChecked=Q("FPDFAnnot_IsChecked",2),i._FPDFAnnot_SetFocusableSubtypes=Q("FPDFAnnot_SetFocusableSubtypes",3),i._FPDFAnnot_GetFocusableSubtypesCount=Q("FPDFAnnot_GetFocusableSubtypesCount",1),i._FPDFAnnot_GetFocusableSubtypes=Q("FPDFAnnot_GetFocusableSubtypes",3),i._FPDFAnnot_GetLink=Q("FPDFAnnot_GetLink",1),i._FPDFAnnot_GetFormControlCount=Q("FPDFAnnot_GetFormControlCount",2),i._FPDFAnnot_GetFormControlIndex=Q("FPDFAnnot_GetFormControlIndex",2),i._FPDFAnnot_GetFormFieldExportValue=Q("FPDFAnnot_GetFormFieldExportValue",4),i._FPDFAnnot_SetURI=Q("FPDFAnnot_SetURI",2),i._FPDFAnnot_GetFileAttachment=Q("FPDFAnnot_GetFileAttachment",1),i._FPDFAnnot_AddFileAttachment=Q("FPDFAnnot_AddFileAttachment",2),i._EPDFAnnot_SetColor=Q("EPDFAnnot_SetColor",5),i._EPDFAnnot_GetColor=Q("EPDFAnnot_GetColor",5),i._EPDFAnnot_ClearColor=Q("EPDFAnnot_ClearColor",2),i._EPDFAnnot_SetOpacity=Q("EPDFAnnot_SetOpacity",2),i._EPDFAnnot_GetOpacity=Q("EPDFAnnot_GetOpacity",2),i._EPDFAnnot_GetBorderEffect=Q("EPDFAnnot_GetBorderEffect",2),i._EPDFAnnot_GetRectangleDifferences=Q("EPDFAnnot_GetRectangleDifferences",5),i._EPDFAnnot_GetBorderDashPatternCount=Q("EPDFAnnot_GetBorderDashPatternCount",1),i._EPDFAnnot_GetBorderDashPattern=Q("EPDFAnnot_GetBorderDashPattern",3),i._EPDFAnnot_SetBorderDashPattern=Q("EPDFAnnot_SetBorderDashPattern",3),i._EPDFAnnot_GetBorderStyle=Q("EPDFAnnot_GetBorderStyle",2),i._EPDFAnnot_SetBorderStyle=Q("EPDFAnnot_SetBorderStyle",3),i._EPDFAnnot_GenerateAppearance=Q("EPDFAnnot_GenerateAppearance",1),i._EPDFAnnot_GenerateAppearanceWithBlend=Q("EPDFAnnot_GenerateAppearanceWithBlend",2),i._EPDFAnnot_GetBlendMode=Q("EPDFAnnot_GetBlendMode",1),i._EPDFAnnot_SetIntent=Q("EPDFAnnot_SetIntent",2),i._EPDFAnnot_GetIntent=Q("EPDFAnnot_GetIntent",3),i._EPDFAnnot_GetRichContent=Q("EPDFAnnot_GetRichContent",3),i._EPDFAnnot_SetLineEndings=Q("EPDFAnnot_SetLineEndings",3),i._EPDFAnnot_GetLineEndings=Q("EPDFAnnot_GetLineEndings",3),i._EPDFAnnot_SetVertices=Q("EPDFAnnot_SetVertices",3),i._EPDFAnnot_SetLine=Q("EPDFAnnot_SetLine",3),i._EPDFAnnot_SetDefaultAppearance=Q("EPDFAnnot_SetDefaultAppearance",6),i._EPDFAnnot_GetDefaultAppearance=Q("EPDFAnnot_GetDefaultAppearance",6),i._EPDFAnnot_SetTextAlignment=Q("EPDFAnnot_SetTextAlignment",2),i._EPDFAnnot_GetTextAlignment=Q("EPDFAnnot_GetTextAlignment",1),i._EPDFAnnot_SetVerticalAlignment=Q("EPDFAnnot_SetVerticalAlignment",2),i._EPDFAnnot_GetVerticalAlignment=Q("EPDFAnnot_GetVerticalAlignment",1),i._EPDFPage_GetAnnotByName=Q("EPDFPage_GetAnnotByName",2),i._EPDFPage_RemoveAnnotByName=Q("EPDFPage_RemoveAnnotByName",2),i._EPDFAnnot_SetLinkedAnnot=Q("EPDFAnnot_SetLinkedAnnot",3),i._EPDFPage_GetAnnotCountRaw=Q("EPDFPage_GetAnnotCountRaw",2),i._EPDFPage_GetAnnotRaw=Q("EPDFPage_GetAnnotRaw",3),i._EPDFPage_RemoveAnnotRaw=Q("EPDFPage_RemoveAnnotRaw",3),i._EPDFAnnot_SetIcon=Q("EPDFAnnot_SetIcon",2),i._EPDFAnnot_GetIcon=Q("EPDFAnnot_GetIcon",1),i._EPDFAnnot_UpdateAppearanceToRect=Q("EPDFAnnot_UpdateAppearanceToRect",2),i._EPDFPage_CreateAnnot=Q("EPDFPage_CreateAnnot",2),i._FPDFDoc_GetAttachmentCount=Q("FPDFDoc_GetAttachmentCount",1),i._FPDFDoc_AddAttachment=Q("FPDFDoc_AddAttachment",2),i._FPDFDoc_GetAttachment=Q("FPDFDoc_GetAttachment",2),i._FPDFDoc_DeleteAttachment=Q("FPDFDoc_DeleteAttachment",2),i._FPDFAttachment_GetName=Q("FPDFAttachment_GetName",3),i._FPDFAttachment_HasKey=Q("FPDFAttachment_HasKey",2),i._FPDFAttachment_GetValueType=Q("FPDFAttachment_GetValueType",2),i._FPDFAttachment_SetStringValue=Q("FPDFAttachment_SetStringValue",3),i._FPDFAttachment_GetStringValue=Q("FPDFAttachment_GetStringValue",4),i._FPDFAttachment_SetFile=Q("FPDFAttachment_SetFile",4),i._FPDFAttachment_GetFile=Q("FPDFAttachment_GetFile",4),i._FPDFAttachment_GetSubtype=Q("FPDFAttachment_GetSubtype",3),i._EPDFAttachment_SetSubtype=Q("EPDFAttachment_SetSubtype",2),i._EPDFAttachment_SetDescription=Q("EPDFAttachment_SetDescription",2),i._EPDFAttachment_GetDescription=Q("EPDFAttachment_GetDescription",3),i._EPDFAttachment_GetIntegerValue=Q("EPDFAttachment_GetIntegerValue",3),i._FPDFCatalog_IsTagged=Q("FPDFCatalog_IsTagged",1),i._FPDFCatalog_SetLanguage=Q("FPDFCatalog_SetLanguage",2),i._EPDFCatalog_GetLanguage=Q("EPDFCatalog_GetLanguage",3),i._FPDFAvail_Create=Q("FPDFAvail_Create",2),i._FPDFAvail_Destroy=Q("FPDFAvail_Destroy",1),i._FPDFAvail_IsDocAvail=Q("FPDFAvail_IsDocAvail",2),i._FPDFAvail_GetDocument=Q("FPDFAvail_GetDocument",2),i._FPDFAvail_GetFirstPageNum=Q("FPDFAvail_GetFirstPageNum",1),i._FPDFAvail_IsPageAvail=Q("FPDFAvail_IsPageAvail",3),i._FPDFAvail_IsFormAvail=Q("FPDFAvail_IsFormAvail",2),i._FPDFAvail_IsLinearized=Q("FPDFAvail_IsLinearized",1),i._FPDFBookmark_GetFirstChild=Q("FPDFBookmark_GetFirstChild",2),i._FPDFBookmark_GetNextSibling=Q("FPDFBookmark_GetNextSibling",2),i._FPDFBookmark_GetTitle=Q("FPDFBookmark_GetTitle",3),i._FPDFBookmark_GetCount=Q("FPDFBookmark_GetCount",1),i._FPDFBookmark_Find=Q("FPDFBookmark_Find",2),i._FPDFBookmark_GetDest=Q("FPDFBookmark_GetDest",2),i._FPDFBookmark_GetAction=Q("FPDFBookmark_GetAction",1),i._FPDFAction_GetType=Q("FPDFAction_GetType",1),i._FPDFAction_GetDest=Q("FPDFAction_GetDest",2),i._FPDFAction_GetFilePath=Q("FPDFAction_GetFilePath",3),i._FPDFAction_GetURIPath=Q("FPDFAction_GetURIPath",4),i._FPDFDest_GetDestPageIndex=Q("FPDFDest_GetDestPageIndex",2),i._FPDFDest_GetView=Q("FPDFDest_GetView",3),i._FPDFDest_GetLocationInPage=Q("FPDFDest_GetLocationInPage",7),i._FPDFLink_GetLinkAtPoint=Q("FPDFLink_GetLinkAtPoint",3),i._FPDFLink_GetLinkZOrderAtPoint=Q("FPDFLink_GetLinkZOrderAtPoint",3),i._FPDFLink_GetDest=Q("FPDFLink_GetDest",2),i._FPDFLink_GetAction=Q("FPDFLink_GetAction",1),i._FPDFLink_Enumerate=Q("FPDFLink_Enumerate",3),i._FPDFLink_GetAnnot=Q("FPDFLink_GetAnnot",2),i._FPDFLink_GetAnnotRect=Q("FPDFLink_GetAnnotRect",2),i._FPDFLink_CountQuadPoints=Q("FPDFLink_CountQuadPoints",1),i._FPDFLink_GetQuadPoints=Q("FPDFLink_GetQuadPoints",3),i._FPDF_GetPageAAction=Q("FPDF_GetPageAAction",2),i._FPDF_GetFileIdentifier=Q("FPDF_GetFileIdentifier",4),i._FPDF_GetMetaText=Q("FPDF_GetMetaText",4),i._FPDF_GetPageLabel=Q("FPDF_GetPageLabel",4),i._EPDF_SetMetaText=Q("EPDF_SetMetaText",3),i._EPDF_HasMetaText=Q("EPDF_HasMetaText",2),i._EPDF_GetMetaTrapped=Q("EPDF_GetMetaTrapped",1),i._EPDF_SetMetaTrapped=Q("EPDF_SetMetaTrapped",2),i._EPDF_GetMetaKeyCount=Q("EPDF_GetMetaKeyCount",2),i._EPDF_GetMetaKeyName=Q("EPDF_GetMetaKeyName",5),i._FPDFPageObj_NewImageObj=Q("FPDFPageObj_NewImageObj",1),i._FPDFImageObj_LoadJpegFile=Q("FPDFImageObj_LoadJpegFile",4),i._FPDFImageObj_LoadJpegFileInline=Q("FPDFImageObj_LoadJpegFileInline",4),i._FPDFImageObj_SetMatrix=Q("FPDFImageObj_SetMatrix",7),i._FPDFImageObj_SetBitmap=Q("FPDFImageObj_SetBitmap",4),i._FPDFImageObj_GetBitmap=Q("FPDFImageObj_GetBitmap",1),i._FPDFImageObj_GetRenderedBitmap=Q("FPDFImageObj_GetRenderedBitmap",3),i._FPDFImageObj_GetImageDataDecoded=Q("FPDFImageObj_GetImageDataDecoded",3),i._FPDFImageObj_GetImageDataRaw=Q("FPDFImageObj_GetImageDataRaw",3),i._FPDFImageObj_GetImageFilterCount=Q("FPDFImageObj_GetImageFilterCount",1),i._FPDFImageObj_GetImageFilter=Q("FPDFImageObj_GetImageFilter",4),i._FPDFImageObj_GetImageMetadata=Q("FPDFImageObj_GetImageMetadata",3),i._FPDFImageObj_GetImagePixelSize=Q("FPDFImageObj_GetImagePixelSize",3),i._FPDFImageObj_GetIccProfileDataDecoded=Q("FPDFImageObj_GetIccProfileDataDecoded",5),i._FPDF_CreateNewDocument=Q("FPDF_CreateNewDocument",0),i._FPDFPage_Delete=Q("FPDFPage_Delete",2),i._FPDF_MovePages=Q("FPDF_MovePages",4),i._FPDFPage_New=Q("FPDFPage_New",4),i._FPDFPage_GetRotation=Q("FPDFPage_GetRotation",1),i._FPDFPage_InsertObject=Q("FPDFPage_InsertObject",2),i._FPDFPage_InsertObjectAtIndex=Q("FPDFPage_InsertObjectAtIndex",3),i._FPDFPage_RemoveObject=Q("FPDFPage_RemoveObject",2),i._FPDFPage_CountObjects=Q("FPDFPage_CountObjects",1),i._FPDFPage_GetObject=Q("FPDFPage_GetObject",2),i._FPDFPage_HasTransparency=Q("FPDFPage_HasTransparency",1),i._FPDFPageObj_Destroy=Q("FPDFPageObj_Destroy",1),i._FPDFPageObj_GetMarkedContentID=Q("FPDFPageObj_GetMarkedContentID",1),i._FPDFPageObj_CountMarks=Q("FPDFPageObj_CountMarks",1),i._FPDFPageObj_GetMark=Q("FPDFPageObj_GetMark",2),i._FPDFPageObj_AddMark=Q("FPDFPageObj_AddMark",2),i._FPDFPageObj_RemoveMark=Q("FPDFPageObj_RemoveMark",2),i._FPDFPageObjMark_GetName=Q("FPDFPageObjMark_GetName",4),i._FPDFPageObjMark_CountParams=Q("FPDFPageObjMark_CountParams",1),i._FPDFPageObjMark_GetParamKey=Q("FPDFPageObjMark_GetParamKey",5),i._FPDFPageObjMark_GetParamValueType=Q("FPDFPageObjMark_GetParamValueType",2),i._FPDFPageObjMark_GetParamIntValue=Q("FPDFPageObjMark_GetParamIntValue",3),i._FPDFPageObjMark_GetParamStringValue=Q("FPDFPageObjMark_GetParamStringValue",5),i._FPDFPageObjMark_GetParamBlobValue=Q("FPDFPageObjMark_GetParamBlobValue",5),i._FPDFPageObj_HasTransparency=Q("FPDFPageObj_HasTransparency",1),i._FPDFPageObjMark_SetIntParam=Q("FPDFPageObjMark_SetIntParam",5),i._FPDFPageObjMark_SetStringParam=Q("FPDFPageObjMark_SetStringParam",5),i._FPDFPageObjMark_SetBlobParam=Q("FPDFPageObjMark_SetBlobParam",6),i._FPDFPageObjMark_RemoveParam=Q("FPDFPageObjMark_RemoveParam",3),i._FPDFPageObj_GetType=Q("FPDFPageObj_GetType",1),i._FPDFPageObj_GetIsActive=Q("FPDFPageObj_GetIsActive",2),i._FPDFPageObj_SetIsActive=Q("FPDFPageObj_SetIsActive",2),i._FPDFPage_GenerateContent=Q("FPDFPage_GenerateContent",1),i._FPDFPageObj_Transform=Q("FPDFPageObj_Transform",7),i._FPDFPageObj_TransformF=Q("FPDFPageObj_TransformF",2),i._FPDFPageObj_GetMatrix=Q("FPDFPageObj_GetMatrix",2),i._FPDFPageObj_SetMatrix=Q("FPDFPageObj_SetMatrix",2),i._FPDFPageObj_SetBlendMode=Q("FPDFPageObj_SetBlendMode",2),i._FPDFPage_TransformAnnots=Q("FPDFPage_TransformAnnots",7),i._FPDFPage_SetRotation=Q("FPDFPage_SetRotation",2),i._FPDFPageObj_SetFillColor=Q("FPDFPageObj_SetFillColor",5),i._FPDFPageObj_GetFillColor=Q("FPDFPageObj_GetFillColor",5),i._FPDFPageObj_GetBounds=Q("FPDFPageObj_GetBounds",5),i._FPDFPageObj_GetRotatedBounds=Q("FPDFPageObj_GetRotatedBounds",2),i._FPDFPageObj_SetStrokeColor=Q("FPDFPageObj_SetStrokeColor",5),i._FPDFPageObj_GetStrokeColor=Q("FPDFPageObj_GetStrokeColor",5),i._FPDFPageObj_SetStrokeWidth=Q("FPDFPageObj_SetStrokeWidth",2),i._FPDFPageObj_GetStrokeWidth=Q("FPDFPageObj_GetStrokeWidth",2),i._FPDFPageObj_GetLineJoin=Q("FPDFPageObj_GetLineJoin",1),i._FPDFPageObj_SetLineJoin=Q("FPDFPageObj_SetLineJoin",2),i._FPDFPageObj_GetLineCap=Q("FPDFPageObj_GetLineCap",1),i._FPDFPageObj_SetLineCap=Q("FPDFPageObj_SetLineCap",2),i._FPDFPageObj_GetDashPhase=Q("FPDFPageObj_GetDashPhase",2),i._FPDFPageObj_SetDashPhase=Q("FPDFPageObj_SetDashPhase",2),i._FPDFPageObj_GetDashCount=Q("FPDFPageObj_GetDashCount",1),i._FPDFPageObj_GetDashArray=Q("FPDFPageObj_GetDashArray",3),i._FPDFPageObj_SetDashArray=Q("FPDFPageObj_SetDashArray",4),i._FPDFFormObj_CountObjects=Q("FPDFFormObj_CountObjects",1),i._FPDFFormObj_GetObject=Q("FPDFFormObj_GetObject",2),i._FPDFFormObj_RemoveObject=Q("FPDFFormObj_RemoveObject",2),i._FPDFPageObj_CreateNewPath=Q("FPDFPageObj_CreateNewPath",2),i._FPDFPageObj_CreateNewRect=Q("FPDFPageObj_CreateNewRect",4),i._FPDFPath_CountSegments=Q("FPDFPath_CountSegments",1),i._FPDFPath_GetPathSegment=Q("FPDFPath_GetPathSegment",2),i._FPDFPath_MoveTo=Q("FPDFPath_MoveTo",3),i._FPDFPath_LineTo=Q("FPDFPath_LineTo",3),i._FPDFPath_BezierTo=Q("FPDFPath_BezierTo",7),i._FPDFPath_Close=Q("FPDFPath_Close",1),i._FPDFPath_SetDrawMode=Q("FPDFPath_SetDrawMode",3),i._FPDFPath_GetDrawMode=Q("FPDFPath_GetDrawMode",3),i._FPDFPathSegment_GetPoint=Q("FPDFPathSegment_GetPoint",3),i._FPDFPathSegment_GetType=Q("FPDFPathSegment_GetType",1),i._FPDFPathSegment_GetClose=Q("FPDFPathSegment_GetClose",1),i._FPDFPageObj_NewTextObj=Q("FPDFPageObj_NewTextObj",3),i._FPDFText_SetText=Q("FPDFText_SetText",2),i._FPDFText_SetCharcodes=Q("FPDFText_SetCharcodes",3),i._FPDFText_LoadFont=Q("FPDFText_LoadFont",5),i._FPDFText_LoadStandardFont=Q("FPDFText_LoadStandardFont",2),i._FPDFText_LoadCidType2Font=Q("FPDFText_LoadCidType2Font",6),i._FPDFTextObj_GetFontSize=Q("FPDFTextObj_GetFontSize",2),i._FPDFTextObj_GetText=Q("FPDFTextObj_GetText",4),i._FPDFTextObj_GetRenderedBitmap=Q("FPDFTextObj_GetRenderedBitmap",4),i._FPDFFont_Close=Q("FPDFFont_Close",1),i._FPDFPageObj_CreateTextObj=Q("FPDFPageObj_CreateTextObj",3),i._FPDFTextObj_GetTextRenderMode=Q("FPDFTextObj_GetTextRenderMode",1),i._FPDFTextObj_SetTextRenderMode=Q("FPDFTextObj_SetTextRenderMode",2),i._FPDFTextObj_GetFont=Q("FPDFTextObj_GetFont",1),i._FPDFFont_GetBaseFontName=Q("FPDFFont_GetBaseFontName",3),i._FPDFFont_GetFamilyName=Q("FPDFFont_GetFamilyName",3),i._FPDFFont_GetFontData=Q("FPDFFont_GetFontData",4),i._FPDFFont_GetIsEmbedded=Q("FPDFFont_GetIsEmbedded",1),i._FPDFFont_GetFlags=Q("FPDFFont_GetFlags",1),i._FPDFFont_GetWeight=Q("FPDFFont_GetWeight",1),i._FPDFFont_GetItalicAngle=Q("FPDFFont_GetItalicAngle",2),i._FPDFFont_GetAscent=Q("FPDFFont_GetAscent",3),i._FPDFFont_GetDescent=Q("FPDFFont_GetDescent",3),i._FPDFFont_GetGlyphWidth=Q("FPDFFont_GetGlyphWidth",4),i._FPDFFont_GetGlyphPath=Q("FPDFFont_GetGlyphPath",3),i._FPDFGlyphPath_CountGlyphSegments=Q("FPDFGlyphPath_CountGlyphSegments",1),i._FPDFGlyphPath_GetGlyphPathSegment=Q("FPDFGlyphPath_GetGlyphPathSegment",2),i._EPDFText_RedactInRect=Q("EPDFText_RedactInRect",4),i._EPDFText_RedactInQuads=Q("EPDFText_RedactInQuads",5),i._FPDFDoc_GetPageMode=Q("FPDFDoc_GetPageMode",1),i._FPDFPage_Flatten=Q("FPDFPage_Flatten",2),i._FPDFPage_HasFormFieldAtPoint=Q("FPDFPage_HasFormFieldAtPoint",4),i._FPDFPage_FormFieldZOrderAtPoint=Q("FPDFPage_FormFieldZOrderAtPoint",4),i._malloc=Q("malloc",1),i._free=Q("free",1),i._FORM_OnMouseMove=Q("FORM_OnMouseMove",5),i._FORM_OnMouseWheel=Q("FORM_OnMouseWheel",6),i._FORM_OnFocus=Q("FORM_OnFocus",5),i._FORM_OnLButtonDown=Q("FORM_OnLButtonDown",5),i._FORM_OnLButtonUp=Q("FORM_OnLButtonUp",5),i._FORM_OnLButtonDoubleClick=Q("FORM_OnLButtonDoubleClick",5),i._FORM_OnRButtonDown=Q("FORM_OnRButtonDown",5),i._FORM_OnRButtonUp=Q("FORM_OnRButtonUp",5),i._FORM_OnKeyDown=Q("FORM_OnKeyDown",4),i._FORM_OnKeyUp=Q("FORM_OnKeyUp",4),i._FORM_OnChar=Q("FORM_OnChar",4),i._FORM_GetFocusedText=Q("FORM_GetFocusedText",4),i._FORM_GetSelectedText=Q("FORM_GetSelectedText",4),i._FORM_ReplaceAndKeepSelection=Q("FORM_ReplaceAndKeepSelection",3),i._FORM_ReplaceSelection=Q("FORM_ReplaceSelection",3),i._FORM_SelectAllText=Q("FORM_SelectAllText",2),i._FORM_CanUndo=Q("FORM_CanUndo",2),i._FORM_CanRedo=Q("FORM_CanRedo",2),i._FORM_Undo=Q("FORM_Undo",2),i._FORM_Redo=Q("FORM_Redo",2),i._FORM_ForceToKillFocus=Q("FORM_ForceToKillFocus",1),i._FORM_GetFocusedAnnot=Q("FORM_GetFocusedAnnot",3),i._FORM_SetFocusedAnnot=Q("FORM_SetFocusedAnnot",2),i._FPDF_FFLDraw=Q("FPDF_FFLDraw",9),i._FPDF_SetFormFieldHighlightColor=Q("FPDF_SetFormFieldHighlightColor",3),i._FPDF_SetFormFieldHighlightAlpha=Q("FPDF_SetFormFieldHighlightAlpha",2),i._FPDF_RemoveFormFieldHighlight=Q("FPDF_RemoveFormFieldHighlight",1),i._FORM_OnAfterLoadPage=Q("FORM_OnAfterLoadPage",2),i._FORM_OnBeforeClosePage=Q("FORM_OnBeforeClosePage",2),i._FORM_DoDocumentJSAction=Q("FORM_DoDocumentJSAction",1),i._FORM_DoDocumentOpenAction=Q("FORM_DoDocumentOpenAction",1),i._FORM_DoDocumentAAction=Q("FORM_DoDocumentAAction",2),i._FORM_DoPageAAction=Q("FORM_DoPageAAction",3),i._FORM_SetIndexSelected=Q("FORM_SetIndexSelected",4),i._FORM_IsIndexSelected=Q("FORM_IsIndexSelected",3),i._FPDFDoc_GetJavaScriptActionCount=Q("FPDFDoc_GetJavaScriptActionCount",1),i._FPDFDoc_GetJavaScriptAction=Q("FPDFDoc_GetJavaScriptAction",2),i._FPDFDoc_CloseJavaScriptAction=Q("FPDFDoc_CloseJavaScriptAction",1),i._FPDFJavaScriptAction_GetName=Q("FPDFJavaScriptAction_GetName",3),i._FPDFJavaScriptAction_GetScript=Q("FPDFJavaScriptAction_GetScript",3),i._FPDF_ImportPagesByIndex=Q("FPDF_ImportPagesByIndex",5),i._FPDF_ImportPages=Q("FPDF_ImportPages",4),i._FPDF_ImportNPagesToOne=Q("FPDF_ImportNPagesToOne",5),i._FPDF_NewXObjectFromPage=Q("FPDF_NewXObjectFromPage",3),i._FPDF_CloseXObject=Q("FPDF_CloseXObject",1),i._FPDF_NewFormObjectFromXObject=Q("FPDF_NewFormObjectFromXObject",1),i._FPDF_CopyViewerPreferences=Q("FPDF_CopyViewerPreferences",2),i._FPDF_RenderPageBitmapWithColorScheme_Start=Q("FPDF_RenderPageBitmapWithColorScheme_Start",10),i._FPDF_RenderPageBitmap_Start=Q("FPDF_RenderPageBitmap_Start",9),i._FPDF_RenderPage_Continue=Q("FPDF_RenderPage_Continue",2),i._FPDF_RenderPage_Close=Q("FPDF_RenderPage_Close",1),i._FPDF_SaveWithVersion=Q("FPDF_SaveWithVersion",4),i._FPDFText_GetCharIndexFromTextIndex=Q("FPDFText_GetCharIndexFromTextIndex",2),i._FPDFText_GetTextIndexFromCharIndex=Q("FPDFText_GetTextIndexFromCharIndex",2),i._FPDF_GetSignatureCount=Q("FPDF_GetSignatureCount",1),i._FPDF_GetSignatureObject=Q("FPDF_GetSignatureObject",2),i._FPDFSignatureObj_GetContents=Q("FPDFSignatureObj_GetContents",3),i._FPDFSignatureObj_GetByteRange=Q("FPDFSignatureObj_GetByteRange",3),i._FPDFSignatureObj_GetSubFilter=Q("FPDFSignatureObj_GetSubFilter",3),i._FPDFSignatureObj_GetReason=Q("FPDFSignatureObj_GetReason",3),i._FPDFSignatureObj_GetTime=Q("FPDFSignatureObj_GetTime",3),i._FPDFSignatureObj_GetDocMDPPermission=Q("FPDFSignatureObj_GetDocMDPPermission",1),i._FPDF_StructTree_GetForPage=Q("FPDF_StructTree_GetForPage",1),i._FPDF_StructTree_Close=Q("FPDF_StructTree_Close",1),i._FPDF_StructTree_CountChildren=Q("FPDF_StructTree_CountChildren",1),i._FPDF_StructTree_GetChildAtIndex=Q("FPDF_StructTree_GetChildAtIndex",2),i._FPDF_StructElement_GetAltText=Q("FPDF_StructElement_GetAltText",3),i._FPDF_StructElement_GetActualText=Q("FPDF_StructElement_GetActualText",3),i._FPDF_StructElement_GetID=Q("FPDF_StructElement_GetID",3),i._FPDF_StructElement_GetLang=Q("FPDF_StructElement_GetLang",3),i._FPDF_StructElement_GetAttributeCount=Q("FPDF_StructElement_GetAttributeCount",1),i._FPDF_StructElement_GetAttributeAtIndex=Q("FPDF_StructElement_GetAttributeAtIndex",2),i._FPDF_StructElement_GetStringAttribute=Q("FPDF_StructElement_GetStringAttribute",4),i._FPDF_StructElement_GetMarkedContentID=Q("FPDF_StructElement_GetMarkedContentID",1),i._FPDF_StructElement_GetType=Q("FPDF_StructElement_GetType",3),i._FPDF_StructElement_GetObjType=Q("FPDF_StructElement_GetObjType",3),i._FPDF_StructElement_GetTitle=Q("FPDF_StructElement_GetTitle",3),i._FPDF_StructElement_CountChildren=Q("FPDF_StructElement_CountChildren",1),i._FPDF_StructElement_GetChildAtIndex=Q("FPDF_StructElement_GetChildAtIndex",2),i._FPDF_StructElement_GetChildMarkedContentID=Q("FPDF_StructElement_GetChildMarkedContentID",2),i._FPDF_StructElement_GetParent=Q("FPDF_StructElement_GetParent",1),i._FPDF_StructElement_Attr_GetCount=Q("FPDF_StructElement_Attr_GetCount",1),i._FPDF_StructElement_Attr_GetName=Q("FPDF_StructElement_Attr_GetName",5),i._FPDF_StructElement_Attr_GetValue=Q("FPDF_StructElement_Attr_GetValue",2),i._FPDF_StructElement_Attr_GetType=Q("FPDF_StructElement_Attr_GetType",1),i._FPDF_StructElement_Attr_GetBooleanValue=Q("FPDF_StructElement_Attr_GetBooleanValue",2),i._FPDF_StructElement_Attr_GetNumberValue=Q("FPDF_StructElement_Attr_GetNumberValue",2),i._FPDF_StructElement_Attr_GetStringValue=Q("FPDF_StructElement_Attr_GetStringValue",4),i._FPDF_StructElement_Attr_GetBlobValue=Q("FPDF_StructElement_Attr_GetBlobValue",4),i._FPDF_StructElement_Attr_CountChildren=Q("FPDF_StructElement_Attr_CountChildren",1),i._FPDF_StructElement_Attr_GetChildAtIndex=Q("FPDF_StructElement_Attr_GetChildAtIndex",2),i._FPDF_StructElement_GetMarkedContentIdCount=Q("FPDF_StructElement_GetMarkedContentIdCount",1),i._FPDF_StructElement_GetMarkedContentIdAtIndex=Q("FPDF_StructElement_GetMarkedContentIdAtIndex",2),i._FPDF_AddInstalledFont=Q("FPDF_AddInstalledFont",3),i._FPDF_SetSystemFontInfo=Q("FPDF_SetSystemFontInfo",1),i._FPDF_GetDefaultTTFMap=Q("FPDF_GetDefaultTTFMap",0),i._FPDF_GetDefaultTTFMapCount=Q("FPDF_GetDefaultTTFMapCount",0),i._FPDF_GetDefaultTTFMapEntry=Q("FPDF_GetDefaultTTFMapEntry",1),i._FPDF_GetDefaultSystemFontInfo=Q("FPDF_GetDefaultSystemFontInfo",0),i._FPDF_FreeDefaultSystemFontInfo=Q("FPDF_FreeDefaultSystemFontInfo",1),i._FPDFText_LoadPage=Q("FPDFText_LoadPage",1),i._FPDFText_ClosePage=Q("FPDFText_ClosePage",1),i._FPDFText_CountChars=Q("FPDFText_CountChars",1),i._FPDFText_GetUnicode=Q("FPDFText_GetUnicode",2),i._FPDFText_GetTextObject=Q("FPDFText_GetTextObject",2),i._FPDFText_IsGenerated=Q("FPDFText_IsGenerated",2),i._FPDFText_IsHyphen=Q("FPDFText_IsHyphen",2),i._FPDFText_HasUnicodeMapError=Q("FPDFText_HasUnicodeMapError",2),i._FPDFText_GetFontSize=Q("FPDFText_GetFontSize",2),i._FPDFText_GetFontInfo=Q("FPDFText_GetFontInfo",5),i._FPDFText_GetFontWeight=Q("FPDFText_GetFontWeight",2),i._FPDFText_GetFillColor=Q("FPDFText_GetFillColor",6),i._FPDFText_GetStrokeColor=Q("FPDFText_GetStrokeColor",6),i._FPDFText_GetCharAngle=Q("FPDFText_GetCharAngle",2),i._FPDFText_GetCharBox=Q("FPDFText_GetCharBox",6),i._FPDFText_GetLooseCharBox=Q("FPDFText_GetLooseCharBox",3),i._FPDFText_GetMatrix=Q("FPDFText_GetMatrix",3),i._FPDFText_GetCharOrigin=Q("FPDFText_GetCharOrigin",4),i._FPDFText_GetCharIndexAtPos=Q("FPDFText_GetCharIndexAtPos",5),i._FPDFText_GetText=Q("FPDFText_GetText",4),i._FPDFText_CountRects=Q("FPDFText_CountRects",3),i._FPDFText_GetRect=Q("FPDFText_GetRect",6),i._FPDFText_GetBoundedText=Q("FPDFText_GetBoundedText",7),i._FPDFText_FindStart=Q("FPDFText_FindStart",4),i._FPDFText_FindNext=Q("FPDFText_FindNext",1),i._FPDFText_FindPrev=Q("FPDFText_FindPrev",1),i._FPDFText_GetSchResultIndex=Q("FPDFText_GetSchResultIndex",1),i._FPDFText_GetSchCount=Q("FPDFText_GetSchCount",1),i._FPDFText_FindClose=Q("FPDFText_FindClose",1),i._FPDFLink_LoadWebLinks=Q("FPDFLink_LoadWebLinks",1),i._FPDFLink_CountWebLinks=Q("FPDFLink_CountWebLinks",1),i._FPDFLink_GetURL=Q("FPDFLink_GetURL",4),i._FPDFLink_CountRects=Q("FPDFLink_CountRects",2),i._FPDFLink_GetRect=Q("FPDFLink_GetRect",7),i._FPDFLink_GetTextRange=Q("FPDFLink_GetTextRange",4),i._FPDFLink_CloseWebLinks=Q("FPDFLink_CloseWebLinks",1),i._FPDFPage_GetDecodedThumbnailData=Q("FPDFPage_GetDecodedThumbnailData",3),i._FPDFPage_GetRawThumbnailData=Q("FPDFPage_GetRawThumbnailData",3),i._FPDFPage_GetThumbnailAsBitmap=Q("FPDFPage_GetThumbnailAsBitmap",1),i._FPDFPage_SetMediaBox=Q("FPDFPage_SetMediaBox",5),i._FPDFPage_SetCropBox=Q("FPDFPage_SetCropBox",5),i._FPDFPage_SetBleedBox=Q("FPDFPage_SetBleedBox",5),i._FPDFPage_SetTrimBox=Q("FPDFPage_SetTrimBox",5),i._FPDFPage_SetArtBox=Q("FPDFPage_SetArtBox",5),i._FPDFPage_GetMediaBox=Q("FPDFPage_GetMediaBox",5),i._FPDFPage_GetCropBox=Q("FPDFPage_GetCropBox",5),i._FPDFPage_GetBleedBox=Q("FPDFPage_GetBleedBox",5),i._FPDFPage_GetTrimBox=Q("FPDFPage_GetTrimBox",5),i._FPDFPage_GetArtBox=Q("FPDFPage_GetArtBox",5),i._FPDFPage_TransFormWithClip=Q("FPDFPage_TransFormWithClip",3),i._FPDFPageObj_TransformClipPath=Q("FPDFPageObj_TransformClipPath",7),i._FPDFPageObj_GetClipPath=Q("FPDFPageObj_GetClipPath",1),i._FPDFClipPath_CountPaths=Q("FPDFClipPath_CountPaths",1),i._FPDFClipPath_CountPathSegments=Q("FPDFClipPath_CountPathSegments",2),i._FPDFClipPath_GetPathSegment=Q("FPDFClipPath_GetPathSegment",3),i._FPDF_CreateClipPath=Q("FPDF_CreateClipPath",4),i._FPDF_DestroyClipPath=Q("FPDF_DestroyClipPath",1),i._FPDFPage_InsertClipPath=Q("FPDFPage_InsertClipPath",2),i._FPDF_InitLibrary=Q("FPDF_InitLibrary",0),i._FPDF_DestroyLibrary=Q("FPDF_DestroyLibrary",0),i._FPDF_SetSandBoxPolicy=Q("FPDF_SetSandBoxPolicy",2),i._FPDF_LoadDocument=Q("FPDF_LoadDocument",2),i._FPDF_GetFormType=Q("FPDF_GetFormType",1),i._FPDF_LoadXFA=Q("FPDF_LoadXFA",1),i._FPDF_LoadMemDocument=Q("FPDF_LoadMemDocument",3),i._FPDF_LoadMemDocument64=Q("FPDF_LoadMemDocument64",3),i._FPDF_LoadCustomDocument=Q("FPDF_LoadCustomDocument",2),i._FPDF_GetFileVersion=Q("FPDF_GetFileVersion",2),i._FPDF_DocumentHasValidCrossReferenceTable=Q("FPDF_DocumentHasValidCrossReferenceTable",1),i._FPDF_GetDocPermissions=Q("FPDF_GetDocPermissions",1),i._FPDF_GetDocUserPermissions=Q("FPDF_GetDocUserPermissions",1),i._FPDF_GetSecurityHandlerRevision=Q("FPDF_GetSecurityHandlerRevision",1),i._FPDF_GetPageCount=Q("FPDF_GetPageCount",1),i._FPDF_LoadPage=Q("FPDF_LoadPage",2),i._FPDF_GetPageWidthF=Q("FPDF_GetPageWidthF",1),i._FPDF_GetPageWidth=Q("FPDF_GetPageWidth",1),i._FPDF_GetPageHeightF=Q("FPDF_GetPageHeightF",1),i._FPDF_GetPageHeight=Q("FPDF_GetPageHeight",1),i._FPDF_GetPageBoundingBox=Q("FPDF_GetPageBoundingBox",2),i._FPDF_RenderPageBitmap=Q("FPDF_RenderPageBitmap",8),i._FPDF_RenderPageBitmapWithMatrix=Q("FPDF_RenderPageBitmapWithMatrix",5),i._EPDF_RenderAnnotBitmap=Q("EPDF_RenderAnnotBitmap",6),i._FPDF_ClosePage=Q("FPDF_ClosePage",1),i._FPDF_CloseDocument=Q("FPDF_CloseDocument",1),i._FPDF_GetLastError=Q("FPDF_GetLastError",0),i._FPDF_DeviceToPage=Q("FPDF_DeviceToPage",10),i._FPDF_PageToDevice=Q("FPDF_PageToDevice",10),i._FPDFBitmap_Create=Q("FPDFBitmap_Create",3),i._FPDFBitmap_CreateEx=Q("FPDFBitmap_CreateEx",5),i._FPDFBitmap_GetFormat=Q("FPDFBitmap_GetFormat",1),i._FPDFBitmap_FillRect=Q("FPDFBitmap_FillRect",6),i._FPDFBitmap_GetBuffer=Q("FPDFBitmap_GetBuffer",1),i._FPDFBitmap_GetWidth=Q("FPDFBitmap_GetWidth",1),i._FPDFBitmap_GetHeight=Q("FPDFBitmap_GetHeight",1),i._FPDFBitmap_GetStride=Q("FPDFBitmap_GetStride",1),i._FPDFBitmap_Destroy=Q("FPDFBitmap_Destroy",1),i._FPDF_GetPageSizeByIndexF=Q("FPDF_GetPageSizeByIndexF",3),i._EPDF_GetPageRotationByIndex=Q("EPDF_GetPageRotationByIndex",2),i._FPDF_GetPageSizeByIndex=Q("FPDF_GetPageSizeByIndex",4),i._FPDF_VIEWERREF_GetPrintScaling=Q("FPDF_VIEWERREF_GetPrintScaling",1),i._FPDF_VIEWERREF_GetNumCopies=Q("FPDF_VIEWERREF_GetNumCopies",1),i._FPDF_VIEWERREF_GetPrintPageRange=Q("FPDF_VIEWERREF_GetPrintPageRange",1),i._FPDF_VIEWERREF_GetPrintPageRangeCount=Q("FPDF_VIEWERREF_GetPrintPageRangeCount",1),i._FPDF_VIEWERREF_GetPrintPageRangeElement=Q("FPDF_VIEWERREF_GetPrintPageRangeElement",2),i._FPDF_VIEWERREF_GetDuplex=Q("FPDF_VIEWERREF_GetDuplex",1),i._FPDF_VIEWERREF_GetName=Q("FPDF_VIEWERREF_GetName",4),i._FPDF_CountNamedDests=Q("FPDF_CountNamedDests",1),i._FPDF_GetNamedDestByName=Q("FPDF_GetNamedDestByName",2),i._FPDF_GetNamedDest=Q("FPDF_GetNamedDest",4),i._FPDF_GetXFAPacketCount=Q("FPDF_GetXFAPacketCount",1),i._FPDF_GetXFAPacketName=Q("FPDF_GetXFAPacketName",4),i._FPDF_GetXFAPacketContent=Q("FPDF_GetXFAPacketContent",5),i._FPDF_GetTrailerEnds=Q("FPDF_GetTrailerEnds",3);var Ze,Qe,Je=Q("fflush",1),et=Q("emscripten_builtin_memalign",2),tt=Q("strerror",1),nt=Q("setThrew",2),ot=()=>(ot=Xe.emscripten_stack_init)(),rt=()=>(rt=Xe.emscripten_stack_get_end)(),at=e=>(at=Xe._emscripten_stack_restore)(e),it=e=>(it=Xe._emscripten_stack_alloc)(e),st=()=>(st=Xe.emscripten_stack_get_current)();function lt(){var e;function t(){Ze||(Ze=1,i.calledRun=1,C||(M(!G),G=!0,T(),i.noFSInit||Te.initialized||Te.init(),Te.ignorePermissions=!1,ie(O),r(i),i.onRuntimeInitialized?.(),M(!i._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),function(){T();var e=i.postRun;e&&("function"==typeof e&&(e=[e]),e.forEach(N)),ie(R)}()))}z>0||(function(){var e;ot(),M(!(3&(e=rt()))),0==e&&(e+=4),w[e>>2]=34821223,w[e+4>>2]=2310721022,w[0]=1668509029}(),!Qe&&(Qe=1,(e=i.preRun)&&("function"==typeof e&&(e=[e]),e.forEach(L)),ie(I),z>0)||(i.setStatus?(i.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>i.setStatus(""),1),t()},1)):t(),T()))}if(i.dynCall_ji=Q("dynCall_ji",2),i.dynCall_jij=Q("dynCall_jij",4),i.dynCall_iiij=Q("dynCall_iiij",5),i.dynCall_iij=Q("dynCall_iij",4),i.dynCall_j=Q("dynCall_j",1),i.dynCall_jji=Q("dynCall_jji",4),i.dynCall_iji=Q("dynCall_iji",4),i.dynCall_viijii=Q("dynCall_viijii",7),i.dynCall_iiji=Q("dynCall_iiji",5),i.dynCall_jiji=Q("dynCall_jiji",5),i.dynCall_iiiiij=Q("dynCall_iiiiij",7),i.dynCall_iiiiijj=Q("dynCall_iiiiijj",9),i.dynCall_iiiiiijj=Q("dynCall_iiiiiijj",10),i.dynCall_viji=Q("dynCall_viji",5),i.wasmExports=Xe,i.ccall=qe,i.cwrap=(e,t,n,o)=>(...o)=>qe(e,t,n,o),i.addFunction=(e,t)=>{M(void 0!==e);var n=(e=>(xe||(xe=new WeakMap,((e,t)=>{if(xe)for(var n=0;n<0+t;n++){var o=$e(n);o&&xe.set(o,n)}})(0,De.length)),xe.get(e)||0))(e);if(n)return n;var o=(()=>{if(He.length)return He.pop();try{De.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return De.length-1})();try{Ve(o,e)}catch(n){if(!(n instanceof TypeError))throw n;M(void 0!==t,"Missing signature argument to addFunction: "+e);var r=((e,t)=>{if(M(!t.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled"),"function"==typeof WebAssembly.Function)return new WebAssembly.Function((e=>{M(!e.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},n={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},o=1;o<e.length;++o)M(e[o]in t,"invalid signature char: "+e[o]),n.parameters.push(t[e[o]]);return n})(t),e);var n=[1];((e,t)=>{var n=e.slice(0,1),o=e.slice(1),r={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),We(o.length,t);for(var a=0;a<o.length;++a)M(o[a]in r,"invalid signature char: "+o[a]),t.push(r[o[a]]);"v"==n?t.push(0):t.push(1,r[n])})(t,n);var o=[0,97,115,109,1,0,0,0,1];We(n.length,o),o.push(...n),o.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var r=new WebAssembly.Module(new Uint8Array(o));return new WebAssembly.Instance(r,{e:{f:e}}).exports.f})(e,t);Ve(o,r)}return xe.set(e,o),o},i.removeFunction=e=>{xe.delete($e(e)),Ve(e,null),He.push(e)},i.setValue=function(e,t,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":case"i8":v[e]=t;break;case"i16":D[e>>1]=t;break;case"i32":A[e>>2]=t;break;case"i64":V("to do setValue(i64) use WASM_BIGINT");case"float":S[e>>2]=t;break;case"double":E[e>>3]=t;break;case"*":w[e>>2]=t;break;default:V(`invalid type for setValue: ${n}`)}},i.getValue=function(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":return v[e];case"i16":return D[e>>1];case"i32":return A[e>>2];case"i64":V("to do getValue(i64) use WASM_BIGINT");case"float":return S[e>>2];case"double":return E[e>>3];case"*":return w[e>>2];default:V(`invalid type for getValue: ${t}`)}},i.UTF8ToString=pe,i.stringToUTF8=Re,i.UTF16ToString=(e,t)=>{M(e%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var n=e,o=n>>1,r=o+t/2;!(o>=r)&&x[o];)++o;if((n=o<<1)-e>32&&Ue)return Ue.decode(y.subarray(e,n));for(var a="",i=0;!(i>=t/2);++i){var s=D[e+2*i>>1];if(0==s)break;a+=String.fromCharCode(s)}return a},i.stringToUTF16=(e,t,n)=>{if(M(t%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),M("number"==typeof n,"stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),n??=2147483647,n<2)return 0;for(var o=t,r=(n-=2)<2*e.length?n/2:e.length,a=0;a<r;++a){var i=e.charCodeAt(a);D[t>>1]=i,t+=2}return D[t>>1]=0,t-o},["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","getTempRet0","setTempRet0","exitJS","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","readEmAsmArgs","jstoi_q","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","asmjsMangle","HandleAllocator","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","stringToNewUTF8","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","safeSetTimeout","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","safeRequestAnimationFrame","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_unlink","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","setErrNo","demangle","stackTrace"].forEach(function(e){oe(e,()=>{var t=`\`${e}\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`,n=e;n.startsWith("_")||(n="$"+e),t+=` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='${n}')`,ne(e)&&(t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),ce(t)}),ae(e)}),["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","out","err","callMain","abort","wasmMemory","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","stackSave","stackRestore","stackAlloc","ptrToString","zeroMemory","getHeapMax","growMemory","ENV","ERRNO_CODES","strError","DNS","Protocols","Sockets","initRandomFill","randomFill","timers","warnOnce","readEmAsmArgsArray","jstoi_s","getExecutableName","asyncLoad","alignMemory","mmapAlloc","wasmTable","noExitRuntime","getCFunc","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","freeTableIndexes","functionsInTableMap","getEmptyTableSlot","updateTableMap","getFunctionAddress","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","lengthBytesUTF8","intArrayFromString","stringToAscii","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","getEnvStrings","doReadv","doWritev","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","isLeapYear","ydayFromDate","SYSCALLS","preloadPlugins","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar_buffer","FS_stdin_getChar","FS_createPath","FS_createDevice","FS_readFile","FS","FS_createDataFile","FS_createLazyFile","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr"].forEach(ae),B=function e(){Ze||lt(),Ze||(B=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();lt(),t=s;for(const t of Object.keys(i))t in e||Object.defineProperty(e,t,{configurable:!0,get(){V(`Access to module property ('${t}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return t});const s={EPDF_GetMetaKeyCount:[["number","boolean"],"number"],EPDF_GetMetaKeyName:[["number","number","boolean","number","number"],"number"],EPDF_GetMetaTrapped:[["number"],"number"],EPDF_GetPageRotationByIndex:[["number","number"],"number"],EPDF_HasMetaText:[["number","string"],"boolean"],EPDF_PNG_EncodeRGBA:[["number","number","number","number","number","number"],"number"],EPDF_RenderAnnotBitmap:[["number","number","number","number","number","number"],"boolean"],EPDF_SetMetaText:[["number","string","number"],"boolean"],EPDF_SetMetaTrapped:[["number","number"],"boolean"],EPDFAction_CreateGoTo:[["number","number"],"number"],EPDFAction_CreateGoToNamed:[["number","string"],"number"],EPDFAction_CreateLaunch:[["number","number"],"number"],EPDFAction_CreateRemoteGoToByName:[["number","number","number"],"number"],EPDFAction_CreateRemoteGoToDest:[["number","number","number"],"number"],EPDFAction_CreateURI:[["number","string"],"number"],EPDFAnnot_ClearColor:[["number","number"],"boolean"],EPDFAnnot_GenerateAppearance:[["number"],"boolean"],EPDFAnnot_GenerateAppearanceWithBlend:[["number","number"],"boolean"],EPDFAnnot_GetBlendMode:[["number"],"number"],EPDFAnnot_GetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_GetBorderDashPatternCount:[["number"],"number"],EPDFAnnot_GetBorderEffect:[["number","number"],"boolean"],EPDFAnnot_GetBorderStyle:[["number","number"],"number"],EPDFAnnot_GetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_GetIcon:[["number"],"number"],EPDFAnnot_GetIntent:[["number","number","number"],"number"],EPDFAnnot_GetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_GetOpacity:[["number","number"],"boolean"],EPDFAnnot_GetRectangleDifferences:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetRichContent:[["number","number","number"],"number"],EPDFAnnot_GetTextAlignment:[["number"],"number"],EPDFAnnot_GetVerticalAlignment:[["number"],"number"],EPDFAnnot_SetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_SetBorderStyle:[["number","number","number"],"boolean"],EPDFAnnot_SetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_SetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_SetIcon:[["number","number"],"boolean"],EPDFAnnot_SetIntent:[["number","string"],"boolean"],EPDFAnnot_SetLine:[["number","number","number"],"boolean"],EPDFAnnot_SetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_SetLinkedAnnot:[["number","string","number"],"boolean"],EPDFAnnot_SetOpacity:[["number","number"],"boolean"],EPDFAnnot_SetTextAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVerticalAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVertices:[["number","number","number"],"boolean"],EPDFAnnot_UpdateAppearanceToRect:[["number","number"],"boolean"],EPDFAttachment_GetDescription:[["number","number","number"],"number"],EPDFAttachment_GetIntegerValue:[["number","string","number"],"boolean"],EPDFAttachment_SetDescription:[["number","number"],"boolean"],EPDFAttachment_SetSubtype:[["number","string"],"boolean"],EPDFBookmark_AppendChild:[["number","number","number"],"number"],EPDFBookmark_Clear:[["number"],"boolean"],EPDFBookmark_ClearTarget:[["number"],"boolean"],EPDFBookmark_Create:[["number","number"],"number"],EPDFBookmark_Delete:[["number","number"],"boolean"],EPDFBookmark_InsertAfter:[["number","number","number","number"],"number"],EPDFBookmark_SetAction:[["number","number","number"],"boolean"],EPDFBookmark_SetDest:[["number","number","number"],"boolean"],EPDFBookmark_SetTitle:[["number","number"],"boolean"],EPDFCatalog_GetLanguage:[["number","number","number"],"number"],EPDFDest_CreateRemoteView:[["number","number","number","number","number"],"number"],EPDFDest_CreateRemoteXYZ:[["number","number","boolean","number","boolean","number","boolean","number"],"number"],EPDFDest_CreateView:[["number","number","number","number"],"number"],EPDFDest_CreateXYZ:[["number","boolean","number","boolean","number","boolean","number"],"number"],EPDFNamedDest_Remove:[["number","string"],"boolean"],EPDFNamedDest_SetDest:[["number","string","number"],"boolean"],EPDFPage_CreateAnnot:[["number","number"],"number"],EPDFPage_GetAnnotByName:[["number","number"],"number"],EPDFPage_GetAnnotCountRaw:[["number","number"],"number"],EPDFPage_GetAnnotRaw:[["number","number","number"],"number"],EPDFPage_RemoveAnnotByName:[["number","number"],"boolean"],EPDFPage_RemoveAnnotRaw:[["number","number","number"],"boolean"],EPDFText_RedactInQuads:[["number","number","number","boolean","boolean"],"boolean"],EPDFText_RedactInRect:[["number","number","boolean","boolean"],"boolean"],FORM_CanRedo:[["number","number"],"boolean"],FORM_CanUndo:[["number","number"],"boolean"],FORM_DoDocumentAAction:[["number","number"],null],FORM_DoDocumentJSAction:[["number"],null],FORM_DoDocumentOpenAction:[["number"],null],FORM_DoPageAAction:[["number","number","number"],null],FORM_ForceToKillFocus:[["number"],"boolean"],FORM_GetFocusedAnnot:[["number","number","number"],"boolean"],FORM_GetFocusedText:[["number","number","number","number"],"number"],FORM_GetSelectedText:[["number","number","number","number"],"number"],FORM_IsIndexSelected:[["number","number","number"],"boolean"],FORM_OnAfterLoadPage:[["number","number"],null],FORM_OnBeforeClosePage:[["number","number"],null],FORM_OnChar:[["number","number","number","number"],"boolean"],FORM_OnFocus:[["number","number","number","number","number"],"boolean"],FORM_OnKeyDown:[["number","number","number","number"],"boolean"],FORM_OnKeyUp:[["number","number","number","number"],"boolean"],FORM_OnLButtonDoubleClick:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonUp:[["number","number","number","number","number"],"boolean"],FORM_OnMouseMove:[["number","number","number","number","number"],"boolean"],FORM_OnMouseWheel:[["number","number","number","number","number","number"],"boolean"],FORM_OnRButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnRButtonUp:[["number","number","number","number","number"],"boolean"],FORM_Redo:[["number","number"],"boolean"],FORM_ReplaceAndKeepSelection:[["number","number","number"],null],FORM_ReplaceSelection:[["number","number","number"],null],FORM_SelectAllText:[["number","number"],"boolean"],FORM_SetFocusedAnnot:[["number","number"],"boolean"],FORM_SetIndexSelected:[["number","number","number","boolean"],"boolean"],FORM_Undo:[["number","number"],"boolean"],FPDF_AddInstalledFont:[["number","number","number"],null],FPDF_CloseDocument:[["number"],null],FPDF_ClosePage:[["number"],null],FPDF_CloseXObject:[["number"],null],FPDF_CopyViewerPreferences:[["number","number"],"boolean"],FPDF_CountNamedDests:[["number"],"number"],FPDF_CreateClipPath:[["number","number","number","number"],"number"],FPDF_CreateNewDocument:[[],"number"],FPDF_DestroyClipPath:[["number"],null],FPDF_DestroyLibrary:[[],null],FPDF_DeviceToPage:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_DocumentHasValidCrossReferenceTable:[["number"],"boolean"],FPDF_FFLDraw:[["number","number","number","number","number","number","number","number","number"],null],FPDF_FreeDefaultSystemFontInfo:[["number"],null],FPDF_GetDefaultSystemFontInfo:[[],"number"],FPDF_GetDefaultTTFMap:[[],"number"],FPDF_GetDefaultTTFMapCount:[[],"number"],FPDF_GetDefaultTTFMapEntry:[["number"],"number"],FPDF_GetDocPermissions:[["number"],"number"],FPDF_GetDocUserPermissions:[["number"],"number"],FPDF_GetFileIdentifier:[["number","number","number","number"],"number"],FPDF_GetFileVersion:[["number","number"],"boolean"],FPDF_GetFormType:[["number"],"number"],FPDF_GetLastError:[[],"number"],FPDF_GetMetaText:[["number","string","number","number"],"number"],FPDF_GetNamedDest:[["number","number","number","number"],"number"],FPDF_GetNamedDestByName:[["number","string"],"number"],FPDF_GetPageAAction:[["number","number"],"number"],FPDF_GetPageBoundingBox:[["number","number"],"boolean"],FPDF_GetPageCount:[["number"],"number"],FPDF_GetPageHeight:[["number"],"number"],FPDF_GetPageHeightF:[["number"],"number"],FPDF_GetPageLabel:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndex:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndexF:[["number","number","number"],"boolean"],FPDF_GetPageWidth:[["number"],"number"],FPDF_GetPageWidthF:[["number"],"number"],FPDF_GetSecurityHandlerRevision:[["number"],"number"],FPDF_GetSignatureCount:[["number"],"number"],FPDF_GetSignatureObject:[["number","number"],"number"],FPDF_GetTrailerEnds:[["number","number","number"],"number"],FPDF_GetXFAPacketContent:[["number","number","number","number","number"],"boolean"],FPDF_GetXFAPacketCount:[["number"],"number"],FPDF_GetXFAPacketName:[["number","number","number","number"],"number"],FPDF_ImportNPagesToOne:[["number","number","number","number","number"],"number"],FPDF_ImportPages:[["number","number","string","number"],"boolean"],FPDF_ImportPagesByIndex:[["number","number","number","number","number"],"boolean"],FPDF_InitLibrary:[[],null],FPDF_InitLibraryWithConfig:[["number"],null],FPDF_LoadCustomDocument:[["number","string"],"number"],FPDF_LoadDocument:[["number","string"],"number"],FPDF_LoadMemDocument:[["number","number","string"],"number"],FPDF_LoadMemDocument64:[["number","number","string"],"number"],FPDF_LoadPage:[["number","number"],"number"],FPDF_LoadXFA:[["number"],"boolean"],FPDF_MovePages:[["number","number","number","number"],"boolean"],FPDF_NewFormObjectFromXObject:[["number"],"number"],FPDF_NewXObjectFromPage:[["number","number","number"],"number"],FPDF_PageToDevice:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_RemoveFormFieldHighlight:[["number"],null],FPDF_RenderPage_Close:[["number"],null],FPDF_RenderPage_Continue:[["number","number"],"number"],FPDF_RenderPageBitmap:[["number","number","number","number","number","number","number","number"],null],FPDF_RenderPageBitmap_Start:[["number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithColorScheme_Start:[["number","number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithMatrix:[["number","number","number","number","number"],null],FPDF_SaveAsCopy:[["number","number","number"],"boolean"],FPDF_SaveWithVersion:[["number","number","number","number"],"boolean"],FPDF_SetFormFieldHighlightAlpha:[["number","number"],null],FPDF_SetFormFieldHighlightColor:[["number","number","number"],null],FPDF_SetSandBoxPolicy:[["number","boolean"],null],FPDF_SetSystemFontInfo:[["number"],null],FPDF_StructElement_Attr_CountChildren:[["number"],"number"],FPDF_StructElement_Attr_GetBlobValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetBooleanValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_Attr_GetCount:[["number"],"number"],FPDF_StructElement_Attr_GetName:[["number","number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetNumberValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetStringValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetType:[["number"],"number"],FPDF_StructElement_Attr_GetValue:[["number","string"],"number"],FPDF_StructElement_CountChildren:[["number"],"number"],FPDF_StructElement_GetActualText:[["number","number","number"],"number"],FPDF_StructElement_GetAltText:[["number","number","number"],"number"],FPDF_StructElement_GetAttributeAtIndex:[["number","number"],"number"],FPDF_StructElement_GetAttributeCount:[["number"],"number"],FPDF_StructElement_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_GetChildMarkedContentID:[["number","number"],"number"],FPDF_StructElement_GetID:[["number","number","number"],"number"],FPDF_StructElement_GetLang:[["number","number","number"],"number"],FPDF_StructElement_GetMarkedContentID:[["number"],"number"],FPDF_StructElement_GetMarkedContentIdAtIndex:[["number","number"],"number"],FPDF_StructElement_GetMarkedContentIdCount:[["number"],"number"],FPDF_StructElement_GetObjType:[["number","number","number"],"number"],FPDF_StructElement_GetParent:[["number"],"number"],FPDF_StructElement_GetStringAttribute:[["number","string","number","number"],"number"],FPDF_StructElement_GetTitle:[["number","number","number"],"number"],FPDF_StructElement_GetType:[["number","number","number"],"number"],FPDF_StructTree_Close:[["number"],null],FPDF_StructTree_CountChildren:[["number"],"number"],FPDF_StructTree_GetChildAtIndex:[["number","number"],"number"],FPDF_StructTree_GetForPage:[["number"],"number"],FPDF_VIEWERREF_GetDuplex:[["number"],"number"],FPDF_VIEWERREF_GetName:[["number","string","number","number"],"number"],FPDF_VIEWERREF_GetNumCopies:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRange:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeCount:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeElement:[["number","number"],"number"],FPDF_VIEWERREF_GetPrintScaling:[["number"],"boolean"],FPDFAction_GetDest:[["number","number"],"number"],FPDFAction_GetFilePath:[["number","number","number"],"number"],FPDFAction_GetType:[["number"],"number"],FPDFAction_GetURIPath:[["number","number","number","number"],"number"],FPDFAnnot_AddFileAttachment:[["number","number"],"number"],FPDFAnnot_AddInkStroke:[["number","number","number"],"number"],FPDFAnnot_AppendAttachmentPoints:[["number","number"],"boolean"],FPDFAnnot_AppendObject:[["number","number"],"boolean"],FPDFAnnot_CountAttachmentPoints:[["number"],"number"],FPDFAnnot_GetAP:[["number","number","number","number"],"number"],FPDFAnnot_GetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_GetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_GetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_GetFileAttachment:[["number"],"number"],FPDFAnnot_GetFlags:[["number"],"number"],FPDFAnnot_GetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_GetFocusableSubtypesCount:[["number"],"number"],FPDFAnnot_GetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_GetFontSize:[["number","number","number"],"boolean"],FPDFAnnot_GetFormAdditionalActionJavaScript:[["number","number","number","number","number"],"number"],FPDFAnnot_GetFormControlCount:[["number","number"],"number"],FPDFAnnot_GetFormControlIndex:[["number","number"],"number"],FPDFAnnot_GetFormFieldAlternateName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldAtPoint:[["number","number","number"],"number"],FPDFAnnot_GetFormFieldExportValue:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldFlags:[["number","number"],"number"],FPDFAnnot_GetFormFieldName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldType:[["number","number"],"number"],FPDFAnnot_GetFormFieldValue:[["number","number","number","number"],"number"],FPDFAnnot_GetInkListCount:[["number"],"number"],FPDFAnnot_GetInkListPath:[["number","number","number","number"],"number"],FPDFAnnot_GetLine:[["number","number","number"],"boolean"],FPDFAnnot_GetLink:[["number"],"number"],FPDFAnnot_GetLinkedAnnot:[["number","string"],"number"],FPDFAnnot_GetNumberValue:[["number","string","number"],"boolean"],FPDFAnnot_GetObject:[["number","number"],"number"],FPDFAnnot_GetObjectCount:[["number"],"number"],FPDFAnnot_GetOptionCount:[["number","number"],"number"],FPDFAnnot_GetOptionLabel:[["number","number","number","number","number"],"number"],FPDFAnnot_GetRect:[["number","number"],"boolean"],FPDFAnnot_GetStringValue:[["number","string","number","number"],"number"],FPDFAnnot_GetSubtype:[["number"],"number"],FPDFAnnot_GetValueType:[["number","string"],"number"],FPDFAnnot_GetVertices:[["number","number","number"],"number"],FPDFAnnot_HasAttachmentPoints:[["number"],"boolean"],FPDFAnnot_HasKey:[["number","string"],"boolean"],FPDFAnnot_IsChecked:[["number","number"],"boolean"],FPDFAnnot_IsObjectSupportedSubtype:[["number"],"boolean"],FPDFAnnot_IsOptionSelected:[["number","number","number"],"boolean"],FPDFAnnot_IsSupportedSubtype:[["number"],"boolean"],FPDFAnnot_RemoveInkList:[["number"],"boolean"],FPDFAnnot_RemoveObject:[["number","number"],"boolean"],FPDFAnnot_SetAP:[["number","number","number"],"boolean"],FPDFAnnot_SetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_SetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_SetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_SetFlags:[["number","number"],"boolean"],FPDFAnnot_SetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_SetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_SetFormFieldFlags:[["number","number","number"],"boolean"],FPDFAnnot_SetRect:[["number","number"],"boolean"],FPDFAnnot_SetStringValue:[["number","string","number"],"boolean"],FPDFAnnot_SetURI:[["number","number"],"boolean"],FPDFAnnot_UpdateObject:[["number","number"],"boolean"],FPDFAttachment_GetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_GetName:[["number","number","number"],"number"],FPDFAttachment_GetStringValue:[["number","string","number","number"],"number"],FPDFAttachment_GetSubtype:[["number","number","number"],"number"],FPDFAttachment_GetValueType:[["number","string"],"number"],FPDFAttachment_HasKey:[["number","string"],"boolean"],FPDFAttachment_SetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_SetStringValue:[["number","string","number"],"boolean"],FPDFAvail_Create:[["number","number"],"number"],FPDFAvail_Destroy:[["number"],null],FPDFAvail_GetDocument:[["number","string"],"number"],FPDFAvail_GetFirstPageNum:[["number"],"number"],FPDFAvail_IsDocAvail:[["number","number"],"number"],FPDFAvail_IsFormAvail:[["number","number"],"number"],FPDFAvail_IsLinearized:[["number"],"number"],FPDFAvail_IsPageAvail:[["number","number","number"],"number"],FPDFBitmap_Create:[["number","number","number"],"number"],FPDFBitmap_CreateEx:[["number","number","number","number","number"],"number"],FPDFBitmap_Destroy:[["number"],null],FPDFBitmap_FillRect:[["number","number","number","number","number","number"],"boolean"],FPDFBitmap_GetBuffer:[["number"],"number"],FPDFBitmap_GetFormat:[["number"],"number"],FPDFBitmap_GetHeight:[["number"],"number"],FPDFBitmap_GetStride:[["number"],"number"],FPDFBitmap_GetWidth:[["number"],"number"],FPDFBookmark_Find:[["number","number"],"number"],FPDFBookmark_GetAction:[["number"],"number"],FPDFBookmark_GetCount:[["number"],"number"],FPDFBookmark_GetDest:[["number","number"],"number"],FPDFBookmark_GetFirstChild:[["number","number"],"number"],FPDFBookmark_GetNextSibling:[["number","number"],"number"],FPDFBookmark_GetTitle:[["number","number","number"],"number"],FPDFCatalog_IsTagged:[["number"],"boolean"],FPDFCatalog_SetLanguage:[["number","string"],"boolean"],FPDFClipPath_CountPaths:[["number"],"number"],FPDFClipPath_CountPathSegments:[["number","number"],"number"],FPDFClipPath_GetPathSegment:[["number","number","number"],"number"],FPDFDest_GetDestPageIndex:[["number","number"],"number"],FPDFDest_GetLocationInPage:[["number","number","number","number","number","number","number"],"boolean"],FPDFDest_GetView:[["number","number","number"],"number"],FPDFDoc_AddAttachment:[["number","number"],"number"],FPDFDoc_CloseJavaScriptAction:[["number"],null],FPDFDoc_DeleteAttachment:[["number","number"],"boolean"],FPDFDOC_ExitFormFillEnvironment:[["number"],null],FPDFDoc_GetAttachment:[["number","number"],"number"],FPDFDoc_GetAttachmentCount:[["number"],"number"],FPDFDoc_GetJavaScriptAction:[["number","number"],"number"],FPDFDoc_GetJavaScriptActionCount:[["number"],"number"],FPDFDoc_GetPageMode:[["number"],"number"],FPDFDOC_InitFormFillEnvironment:[["number","number"],"number"],FPDFFont_Close:[["number"],null],FPDFFont_GetAscent:[["number","number","number"],"boolean"],FPDFFont_GetBaseFontName:[["number","number","number"],"number"],FPDFFont_GetDescent:[["number","number","number"],"boolean"],FPDFFont_GetFamilyName:[["number","number","number"],"number"],FPDFFont_GetFlags:[["number"],"number"],FPDFFont_GetFontData:[["number","number","number","number"],"boolean"],FPDFFont_GetGlyphPath:[["number","number","number"],"number"],FPDFFont_GetGlyphWidth:[["number","number","number","number"],"boolean"],FPDFFont_GetIsEmbedded:[["number"],"number"],FPDFFont_GetItalicAngle:[["number","number"],"boolean"],FPDFFont_GetWeight:[["number"],"number"],FPDFFormObj_CountObjects:[["number"],"number"],FPDFFormObj_GetObject:[["number","number"],"number"],FPDFFormObj_RemoveObject:[["number","number"],"boolean"],FPDFGlyphPath_CountGlyphSegments:[["number"],"number"],FPDFGlyphPath_GetGlyphPathSegment:[["number","number"],"number"],FPDFImageObj_GetBitmap:[["number"],"number"],FPDFImageObj_GetIccProfileDataDecoded:[["number","number","number","number","number"],"boolean"],FPDFImageObj_GetImageDataDecoded:[["number","number","number"],"number"],FPDFImageObj_GetImageDataRaw:[["number","number","number"],"number"],FPDFImageObj_GetImageFilter:[["number","number","number","number"],"number"],FPDFImageObj_GetImageFilterCount:[["number"],"number"],FPDFImageObj_GetImageMetadata:[["number","number","number"],"boolean"],FPDFImageObj_GetImagePixelSize:[["number","number","number"],"boolean"],FPDFImageObj_GetRenderedBitmap:[["number","number","number"],"number"],FPDFImageObj_LoadJpegFile:[["number","number","number","number"],"boolean"],FPDFImageObj_LoadJpegFileInline:[["number","number","number","number"],"boolean"],FPDFImageObj_SetBitmap:[["number","number","number","number"],"boolean"],FPDFImageObj_SetMatrix:[["number","number","number","number","number","number","number"],"boolean"],FPDFJavaScriptAction_GetName:[["number","number","number"],"number"],FPDFJavaScriptAction_GetScript:[["number","number","number"],"number"],FPDFLink_CloseWebLinks:[["number"],null],FPDFLink_CountQuadPoints:[["number"],"number"],FPDFLink_CountRects:[["number","number"],"number"],FPDFLink_CountWebLinks:[["number"],"number"],FPDFLink_Enumerate:[["number","number","number"],"boolean"],FPDFLink_GetAction:[["number"],"number"],FPDFLink_GetAnnot:[["number","number"],"number"],FPDFLink_GetAnnotRect:[["number","number"],"boolean"],FPDFLink_GetDest:[["number","number"],"number"],FPDFLink_GetLinkAtPoint:[["number","number","number"],"number"],FPDFLink_GetLinkZOrderAtPoint:[["number","number","number"],"number"],FPDFLink_GetQuadPoints:[["number","number","number"],"boolean"],FPDFLink_GetRect:[["number","number","number","number","number","number","number"],"boolean"],FPDFLink_GetTextRange:[["number","number","number","number"],"boolean"],FPDFLink_GetURL:[["number","number","number","number"],"number"],FPDFLink_LoadWebLinks:[["number"],"number"],FPDFPage_CloseAnnot:[["number"],null],FPDFPage_CountObjects:[["number"],"number"],FPDFPage_CreateAnnot:[["number","number"],"number"],FPDFPage_Delete:[["number","number"],null],FPDFPage_Flatten:[["number","number"],"number"],FPDFPage_FormFieldZOrderAtPoint:[["number","number","number","number"],"number"],FPDFPage_GenerateContent:[["number"],"boolean"],FPDFPage_GetAnnot:[["number","number"],"number"],FPDFPage_GetAnnotCount:[["number"],"number"],FPDFPage_GetAnnotIndex:[["number","number"],"number"],FPDFPage_GetArtBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetBleedBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetCropBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetDecodedThumbnailData:[["number","number","number"],"number"],FPDFPage_GetMediaBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetObject:[["number","number"],"number"],FPDFPage_GetRawThumbnailData:[["number","number","number"],"number"],FPDFPage_GetRotation:[["number"],"number"],FPDFPage_GetThumbnailAsBitmap:[["number"],"number"],FPDFPage_GetTrimBox:[["number","number","number","number","number"],"boolean"],FPDFPage_HasFormFieldAtPoint:[["number","number","number","number"],"number"],FPDFPage_HasTransparency:[["number"],"boolean"],FPDFPage_InsertClipPath:[["number","number"],null],FPDFPage_InsertObject:[["number","number"],null],FPDFPage_InsertObjectAtIndex:[["number","number","number"],"boolean"],FPDFPage_New:[["number","number","number","number"],"number"],FPDFPage_RemoveAnnot:[["number","number"],"boolean"],FPDFPage_RemoveObject:[["number","number"],"boolean"],FPDFPage_SetArtBox:[["number","number","number","number","number"],null],FPDFPage_SetBleedBox:[["number","number","number","number","number"],null],FPDFPage_SetCropBox:[["number","number","number","number","number"],null],FPDFPage_SetMediaBox:[["number","number","number","number","number"],null],FPDFPage_SetRotation:[["number","number"],null],FPDFPage_SetTrimBox:[["number","number","number","number","number"],null],FPDFPage_TransformAnnots:[["number","number","number","number","number","number","number"],null],FPDFPage_TransFormWithClip:[["number","number","number"],"boolean"],FPDFPageObj_AddMark:[["number","string"],"number"],FPDFPageObj_CountMarks:[["number"],"number"],FPDFPageObj_CreateNewPath:[["number","number"],"number"],FPDFPageObj_CreateNewRect:[["number","number","number","number"],"number"],FPDFPageObj_CreateTextObj:[["number","number","number"],"number"],FPDFPageObj_Destroy:[["number"],null],FPDFPageObj_GetBounds:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetClipPath:[["number"],"number"],FPDFPageObj_GetDashArray:[["number","number","number"],"boolean"],FPDFPageObj_GetDashCount:[["number"],"number"],FPDFPageObj_GetDashPhase:[["number","number"],"boolean"],FPDFPageObj_GetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetIsActive:[["number","number"],"boolean"],FPDFPageObj_GetLineCap:[["number"],"number"],FPDFPageObj_GetLineJoin:[["number"],"number"],FPDFPageObj_GetMark:[["number","number"],"number"],FPDFPageObj_GetMarkedContentID:[["number"],"number"],FPDFPageObj_GetMatrix:[["number","number"],"boolean"],FPDFPageObj_GetRotatedBounds:[["number","number"],"boolean"],FPDFPageObj_GetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_GetType:[["number"],"number"],FPDFPageObj_HasTransparency:[["number"],"boolean"],FPDFPageObj_NewImageObj:[["number"],"number"],FPDFPageObj_NewTextObj:[["number","string","number"],"number"],FPDFPageObj_RemoveMark:[["number","number"],"boolean"],FPDFPageObj_SetBlendMode:[["number","string"],null],FPDFPageObj_SetDashArray:[["number","number","number","number"],"boolean"],FPDFPageObj_SetDashPhase:[["number","number"],"boolean"],FPDFPageObj_SetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetIsActive:[["number","boolean"],"boolean"],FPDFPageObj_SetLineCap:[["number","number"],"boolean"],FPDFPageObj_SetLineJoin:[["number","number"],"boolean"],FPDFPageObj_SetMatrix:[["number","number"],"boolean"],FPDFPageObj_SetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_Transform:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformClipPath:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformF:[["number","number"],"boolean"],FPDFPageObjMark_CountParams:[["number"],"number"],FPDFPageObjMark_GetName:[["number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamBlobValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamIntValue:[["number","string","number"],"boolean"],FPDFPageObjMark_GetParamKey:[["number","number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamStringValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamValueType:[["number","string"],"number"],FPDFPageObjMark_RemoveParam:[["number","number","string"],"boolean"],FPDFPageObjMark_SetBlobParam:[["number","number","number","string","number","number"],"boolean"],FPDFPageObjMark_SetIntParam:[["number","number","number","string","number"],"boolean"],FPDFPageObjMark_SetStringParam:[["number","number","number","string","string"],"boolean"],FPDFPath_BezierTo:[["number","number","number","number","number","number","number"],"boolean"],FPDFPath_Close:[["number"],"boolean"],FPDFPath_CountSegments:[["number"],"number"],FPDFPath_GetDrawMode:[["number","number","number"],"boolean"],FPDFPath_GetPathSegment:[["number","number"],"number"],FPDFPath_LineTo:[["number","number","number"],"boolean"],FPDFPath_MoveTo:[["number","number","number"],"boolean"],FPDFPath_SetDrawMode:[["number","number","boolean"],"boolean"],FPDFPathSegment_GetClose:[["number"],"boolean"],FPDFPathSegment_GetPoint:[["number","number","number"],"boolean"],FPDFPathSegment_GetType:[["number"],"number"],FPDFSignatureObj_GetByteRange:[["number","number","number"],"number"],FPDFSignatureObj_GetContents:[["number","number","number"],"number"],FPDFSignatureObj_GetDocMDPPermission:[["number"],"number"],FPDFSignatureObj_GetReason:[["number","number","number"],"number"],FPDFSignatureObj_GetSubFilter:[["number","number","number"],"number"],FPDFSignatureObj_GetTime:[["number","number","number"],"number"],FPDFText_ClosePage:[["number"],null],FPDFText_CountChars:[["number"],"number"],FPDFText_CountRects:[["number","number","number"],"number"],FPDFText_FindClose:[["number"],null],FPDFText_FindNext:[["number"],"boolean"],FPDFText_FindPrev:[["number"],"boolean"],FPDFText_FindStart:[["number","number","number","number"],"number"],FPDFText_GetBoundedText:[["number","number","number","number","number","number","number"],"number"],FPDFText_GetCharAngle:[["number","number"],"number"],FPDFText_GetCharBox:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetCharIndexAtPos:[["number","number","number","number","number"],"number"],FPDFText_GetCharIndexFromTextIndex:[["number","number"],"number"],FPDFText_GetCharOrigin:[["number","number","number","number"],"boolean"],FPDFText_GetFillColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetFontInfo:[["number","number","number","number","number"],"number"],FPDFText_GetFontSize:[["number","number"],"number"],FPDFText_GetFontWeight:[["number","number"],"number"],FPDFText_GetLooseCharBox:[["number","number","number"],"boolean"],FPDFText_GetMatrix:[["number","number","number"],"boolean"],FPDFText_GetRect:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetSchCount:[["number"],"number"],FPDFText_GetSchResultIndex:[["number"],"number"],FPDFText_GetStrokeColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetText:[["number","number","number","number"],"number"],FPDFText_GetTextIndexFromCharIndex:[["number","number"],"number"],FPDFText_GetTextObject:[["number","number"],"number"],FPDFText_GetUnicode:[["number","number"],"number"],FPDFText_HasUnicodeMapError:[["number","number"],"number"],FPDFText_IsGenerated:[["number","number"],"number"],FPDFText_IsHyphen:[["number","number"],"number"],FPDFText_LoadCidType2Font:[["number","number","number","string","number","number"],"number"],FPDFText_LoadFont:[["number","number","number","number","boolean"],"number"],FPDFText_LoadPage:[["number"],"number"],FPDFText_LoadStandardFont:[["number","string"],"number"],FPDFText_SetCharcodes:[["number","number","number"],"boolean"],FPDFText_SetText:[["number","number"],"boolean"],FPDFTextObj_GetFont:[["number"],"number"],FPDFTextObj_GetFontSize:[["number","number"],"boolean"],FPDFTextObj_GetRenderedBitmap:[["number","number","number","number"],"number"],FPDFTextObj_GetText:[["number","number","number","number"],"number"],FPDFTextObj_GetTextRenderMode:[["number"],"number"],FPDFTextObj_SetTextRenderMode:[["number","number"],"boolean"],PDFiumExt_CloseFileWriter:[["number"],null],PDFiumExt_CloseFormFillInfo:[["number"],null],PDFiumExt_ExitFormFillEnvironment:[["number"],null],PDFiumExt_GetFileWriterData:[["number","number","number"],"number"],PDFiumExt_GetFileWriterSize:[["number"],"number"],PDFiumExt_Init:[[],null],PDFiumExt_InitFormFillEnvironment:[["number","number"],"number"],PDFiumExt_OpenFileWriter:[[],"number"],PDFiumExt_OpenFormFillInfo:[[],"number"],PDFiumExt_SaveAsCopy:[["number","number"],"number"]};function l(e,t,n,o=100){let r=e.wasmExports.malloc(o);for(let t=0;t<o;t++)e.HEAP8[r+t]=0;const a=t(r,o);let i;if(a>o){e.wasmExports.free(r),r=e.wasmExports.malloc(a);for(let t=0;t<a;t++)e.HEAP8[r+t]=0;t(r,a),i=n(r)}else i=n(r);return e.wasmExports.free(r),i}function d(e,t){const n=t(0,0),o=e.wasmExports.malloc(n);t(o,n);const r=new ArrayBuffer(n),a=new DataView(r);for(let t=0;t<n;t++)a.setInt8(t,e.getValue(o+t,"i8"));return e.wasmExports.free(o),r}const c=new Set(["Title","Author","Subject","Keywords","Producer","Creator","CreationDate","ModDate","Trapped"]);function u(e){if(!e||e.length>127)return!1;if(c.has(e))return!1;if("/"===e[0])return!1;for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}const m={pageTtl:5e3,maxPagesPerDocument:10};class p{constructor(e,t,n={}){this.pdfium=e,this.memoryManager=t,this.docs=new Map,this.config={...m,...n}}setDocument(e,t,n){let o=this.docs.get(e);o||(o=new h(t,n,this.pdfium,this.memoryManager,this.config),this.docs.set(e,o))}getContext(e){return this.docs.get(e)}closeDocument(e){const t=this.docs.get(e);return!!t&&(t.dispose(),this.docs.delete(e),!0)}closeAllDocuments(){for(const e of this.docs.values())e.dispose();this.docs.clear()}updateConfig(e){Object.assign(this.config,e);for(const e of this.docs.values())e.updateConfig(this.config)}getCacheStats(){const e={};let t=0;for(const[n,o]of this.docs.entries()){const r=o.getCacheSize();e[n]=r,t+=r}return{documents:this.docs.size,totalPages:t,pagesByDocument:e}}}class h{constructor(e,t,n,o,r){this.filePtr=e,this.docPtr=t,this.memoryManager=o,this.pageCache=new g(n,t,r)}acquirePage(e){return this.pageCache.acquire(e)}borrowPage(e,t){return this.pageCache.borrowPage(e,t)}updateConfig(e){this.pageCache.updateConfig(e)}getCacheSize(){return this.pageCache.size()}dispose(){this.pageCache.forceReleaseAll(),this.pageCache.pdf.FPDF_CloseDocument(this.docPtr),this.memoryManager.free(this.filePtr)}}class g{constructor(e,t,n){this.pdf=e,this.docPtr=t,this.cache=new Map,this.accessOrder=[],this.config=n}acquire(e){let t=this.cache.get(e);if(!t){this.evictIfNeeded();const n=this.pdf.FPDF_LoadPage(this.docPtr,e);t=new f(this.pdf,this.docPtr,e,n,this.config.pageTtl,()=>{this.cache.delete(e),this.removeFromAccessOrder(e)}),this.cache.set(e,t)}return this.updateAccessOrder(e),t.clearExpiryTimer(),t.bumpRefCount(),t}borrowPage(e,t){const n=this.cache.has(e),o=this.acquire(e);try{return t(o)}finally{n?o.release():o.disposeImmediate()}}forceReleaseAll(){for(const e of this.cache.values())e.disposeImmediate();this.cache.clear(),this.accessOrder.length=0}updateConfig(e){this.config=e;for(const t of this.cache.values())t.updateTtl(e.pageTtl);this.evictIfNeeded()}size(){return this.cache.size}evictIfNeeded(){for(;this.cache.size>=this.config.maxPagesPerDocument;){const e=this.accessOrder[0];if(void 0===e)break;{const t=this.cache.get(e);if(t){if(0!==t.getRefCount())break;t.disposeImmediate()}else this.removeFromAccessOrder(e)}}}updateAccessOrder(e){this.removeFromAccessOrder(e),this.accessOrder.push(e)}removeFromAccessOrder(e){const t=this.accessOrder.indexOf(e);t>-1&&this.accessOrder.splice(t,1)}}class f{constructor(e,t,n,o,r,a){this.pdf=e,this.docPtr=t,this.pageIdx=n,this.pagePtr=o,this.onFinalDispose=a,this.refCount=0,this.disposed=!1,this.ttl=r}bumpRefCount(){if(this.disposed)throw new Error("Context already disposed");this.refCount++}getRefCount(){return this.refCount}clearExpiryTimer(){this.expiryTimer&&(clearTimeout(this.expiryTimer),this.expiryTimer=void 0)}updateTtl(e){this.ttl=e,this.expiryTimer&&0===this.refCount&&(this.clearExpiryTimer(),this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl))}release(){this.disposed||(this.refCount--,0===this.refCount&&(this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl)))}disposeImmediate(){this.disposed||(this.disposed=!0,this.clearExpiryTimer(),void 0!==this.textPagePtr&&this.pdf.FPDFText_ClosePage(this.textPagePtr),void 0!==this.formHandle&&(this.pdf.FORM_OnBeforeClosePage(this.pagePtr,this.formHandle),this.pdf.PDFiumExt_ExitFormFillEnvironment(this.formHandle)),void 0!==this.formInfoPtr&&this.pdf.PDFiumExt_CloseFormFillInfo(this.formInfoPtr),this.pdf.FPDF_ClosePage(this.pagePtr),this.onFinalDispose())}getTextPage(){return this.ensureAlive(),void 0===this.textPagePtr&&(this.textPagePtr=this.pdf.FPDFText_LoadPage(this.pagePtr)),this.textPagePtr}getFormHandle(){return this.ensureAlive(),void 0===this.formHandle&&(this.formInfoPtr=this.pdf.PDFiumExt_OpenFormFillInfo(),this.formHandle=this.pdf.PDFiumExt_InitFormFillEnvironment(this.docPtr,this.formInfoPtr),this.pdf.FORM_OnAfterLoadPage(this.pagePtr,this.formHandle)),this.formHandle}withAnnotation(e,t){this.ensureAlive();const n=this.pdf.FPDFPage_GetAnnot(this.pagePtr,e);try{return t(n)}finally{this.pdf.FPDFPage_CloseAnnot(n)}}ensureAlive(){if(this.disposed)throw new Error("PageContext already disposed")}}const F=2147483648,P="PDFiumEngine",b="MemoryManager";class _{constructor(e,t){this.pdfiumModule=e,this.logger=t,this.allocations=new Map,this.totalAllocated=0}malloc(e){if(this.totalAllocated+e>F)throw new Error(`Total memory usage would exceed limit: ${this.totalAllocated+e} > 2147483648`);const t=this.pdfiumModule.pdfium.wasmExports.malloc(e);if(!t)throw new Error(`Failed to allocate ${e} bytes`);const n={ptr:t,size:e,timestamp:Date.now(),stack:this.logger.isEnabled("debug")?(new Error).stack:void 0};return this.allocations.set(t,n),this.totalAllocated+=e,t}free(e){const t=this.allocations.get(e);t?(this.totalAllocated-=t.size,this.allocations.delete(e)):this.logger.warn(P,b,`Freeing untracked pointer: ${e}`),this.pdfiumModule.pdfium.wasmExports.free(e)}getStats(){return{totalAllocated:this.totalAllocated,allocationCount:this.allocations.size,allocations:this.logger.isEnabled("debug")?Array.from(this.allocations.values()):[]}}checkLeaks(){if(this.allocations.size>0){this.logger.warn(P,b,`Potential memory leak: ${this.allocations.size} unfreed allocations`);for(const[e,t]of this.allocations)this.logger.warn(P,b,`  - ${e}: ${t.size} bytes`,t.stack)}}}const v="pdfium",y="font-fallback";class D{constructor(e,t=new r.N){this.fontHandles=new Map,this.fontCache=new Map,this.nextHandleId=1,this.module=null,this.enabled=!1,this.structPtr=0,this.releaseFnPtr=0,this.enumFontsFnPtr=0,this.mapFontFnPtr=0,this.getFontFnPtr=0,this.getFontDataFnPtr=0,this.getFaceNameFnPtr=0,this.getFontCharsetFnPtr=0,this.deleteFontFnPtr=0,this.fontConfig=e,this.logger=t}initialize(e){if(this.enabled)return void this.logger.warn(v,y,"Font fallback already initialized");this.module=e;const t=e.pdfium;if("function"==typeof t.addFunction)try{if(this.structPtr=t.wasmExports.malloc(36),!this.structPtr)throw new Error("Failed to allocate FPDF_SYSFONTINFO struct");for(let e=0;e<36;e++)t.setValue(this.structPtr+e,0,"i8");this.releaseFnPtr=t.addFunction(e=>{},"vi"),this.enumFontsFnPtr=t.addFunction((e,t)=>{},"vii"),this.mapFontFnPtr=t.addFunction((e,n,o,r,a,i,s)=>{const l=i?t.UTF8ToString(i):"",d=this.mapFont(n,o,r,a,l);return s&&t.setValue(s,0,"i32"),d},"iiiiiiii"),this.getFontFnPtr=t.addFunction((e,n)=>{const o=n?t.UTF8ToString(n):"";return this.mapFont(400,0,0,0,o)},"iii"),this.getFontDataFnPtr=t.addFunction((e,t,n,o,r)=>this.getFontData(t,n,o,r),"iiiiii"),this.getFaceNameFnPtr=t.addFunction((e,t,n,o)=>0,"iiiii"),this.getFontCharsetFnPtr=t.addFunction((e,t)=>{const n=this.fontHandles.get(t);return(null==n?void 0:n.charset)??0},"iii"),this.deleteFontFnPtr=t.addFunction((e,t)=>{this.deleteFont(t)},"vii"),t.setValue(this.structPtr+0,1,"i32"),t.setValue(this.structPtr+4,this.releaseFnPtr,"i32"),t.setValue(this.structPtr+8,this.enumFontsFnPtr,"i32"),t.setValue(this.structPtr+12,this.mapFontFnPtr,"i32"),t.setValue(this.structPtr+16,this.getFontFnPtr,"i32"),t.setValue(this.structPtr+20,this.getFontDataFnPtr,"i32"),t.setValue(this.structPtr+24,this.getFaceNameFnPtr,"i32"),t.setValue(this.structPtr+28,this.getFontCharsetFnPtr,"i32"),t.setValue(this.structPtr+32,this.deleteFontFnPtr,"i32"),e.FPDF_SetSystemFontInfo(this.structPtr),this.enabled=!0,this.logger.info(v,y,"Font fallback system initialized (pure TypeScript)",Object.keys(this.fontConfig.fonts))}catch(e){throw this.logger.error(v,y,"Failed to initialize font fallback",e),this.cleanup(),e}else this.logger.error(v,y,"addFunction not available. Make sure WASM is compiled with -sALLOW_TABLE_GROWTH")}disable(){this.enabled&&this.module&&(this.module.FPDF_SetSystemFontInfo(0),this.cleanup(),this.enabled=!1,this.logger.debug(v,y,"Font fallback system disabled"))}cleanup(){if(!this.module)return;const e=this.module.pdfium;this.structPtr&&(e.wasmExports.free(this.structPtr),this.structPtr=0);const t=t=>{if(t&&"function"==typeof e.removeFunction)try{e.removeFunction(t)}catch{}};t(this.releaseFnPtr),t(this.enumFontsFnPtr),t(this.mapFontFnPtr),t(this.getFontFnPtr),t(this.getFontDataFnPtr),t(this.getFaceNameFnPtr),t(this.getFontCharsetFnPtr),t(this.deleteFontFnPtr),this.releaseFnPtr=0,this.enumFontsFnPtr=0,this.mapFontFnPtr=0,this.getFontFnPtr=0,this.getFontDataFnPtr=0,this.getFaceNameFnPtr=0,this.getFontCharsetFnPtr=0,this.deleteFontFnPtr=0}isEnabled(){return this.enabled}getStats(){return{handleCount:this.fontHandles.size,cacheSize:this.fontCache.size,cachedUrls:Array.from(this.fontCache.keys())}}async preloadFonts(e){const t=e.map(e=>this.getFontUrlForCharset(e)).filter(e=>null!==e),n=[...new Set(t)];await Promise.all(n.map(async e=>{if(!this.fontCache.has(e))try{const t=await this.fetchFontAsync(e);t&&(this.fontCache.set(e,t),this.logger.debug(v,y,`Pre-loaded font: ${e}`))}catch(t){this.logger.warn(v,y,`Failed to pre-load font: ${e}`,t)}}))}mapFont(e,t,n,o,r){const a=0!==t;this.logger.debug(v,y,"MapFont called",{weight:e,italic:a,charset:n,pitchFamily:o,face:r});const i=this.findBestFontMatch(n,e,a);if(!i)return this.logger.debug(v,y,`No font configured for charset ${n}`),0;const s={id:this.nextHandleId++,charset:n,weight:e,italic:a,url:i.url,data:null};return this.fontHandles.set(s.id,s),this.logger.debug(v,y,`Created font handle ${s.id} for ${i.url} (requested: weight=${e}, italic=${a}, matched: weight=${i.matchedWeight}, italic=${i.matchedItalic})`),s.id}getFontData(e,t,n,o){const r=this.fontHandles.get(e);if(!r)return this.logger.warn(v,y,`Unknown font handle: ${e}`),0;if(r.data||(this.fontCache.has(r.url)?r.data=this.fontCache.get(r.url):(r.data=this.fetchFontSync(r.url),r.data&&this.fontCache.set(r.url,r.data))),!r.data)return this.logger.warn(v,y,`Failed to load font: ${r.url}`),0;const a=r.data;return 0!==t?(this.logger.debug(v,y,`Table ${t} requested - returning 0 to request whole file`),0):(0===n||o<a.length||this.module&&(this.module.pdfium.HEAPU8.set(a,n),this.logger.debug(v,y,`Copied ${a.length} bytes to buffer for handle ${e}`)),a.length)}deleteFont(e){this.fontHandles.get(e)&&(this.logger.debug(v,y,`Deleting font handle ${e}`),this.fontHandles.delete(e))}findBestFontMatch(e,t,n){const{fonts:o,defaultFont:r,baseUrl:a}=this.fontConfig,i=o[e]??r;if(!i)return null;const s=this.normalizeToVariants(i);if(0===s.length)return null;const l=this.selectBestVariant(s,t,n);let d=l.url;return!a||d.startsWith("http://")||d.startsWith("https://")||d.startsWith("/")||(d=`${a}/${d}`),{url:d,matchedWeight:l.weight??400,matchedItalic:l.italic??!1}}normalizeToVariants(e){return"string"==typeof e?[{url:e,weight:400,italic:!1}]:Array.isArray(e)?e.map(e=>({url:e.url,weight:e.weight??400,italic:e.italic??!1})):[{url:e.url,weight:e.weight??400,italic:e.italic??!1}]}selectBestVariant(e,t,n){if(1===e.length)return e[0];const o=e.filter(e=>(e.italic??!1)===n),r=o.length>0?o:e;let a=r[0],i=Math.abs((a.weight??400)-t);for(const e of r){const n=e.weight??400,o=Math.abs(n-t);if(o<i)a=e,i=o;else if(o===i){const o=a.weight??400;t>=500?n>o&&(a=e):n<o&&(a=e)}}return a}getFontUrlForCharset(e){const t=this.findBestFontMatch(e,400,!1);return(null==t?void 0:t.url)??null}fetchFontSync(e){if(this.logger.debug(v,y,`Fetching font synchronously: ${e}`),this.fontConfig.fontLoader)try{const t=this.fontConfig.fontLoader(e);return t?this.logger.info(v,y,`Loaded font via custom loader: ${e} (${t.length} bytes)`):this.logger.warn(v,y,`Custom font loader returned null for: ${e}`),t}catch(t){return this.logger.error(v,y,`Error in custom font loader: ${e}`,t),null}try{const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.responseType="arraybuffer",t.send(),200===t.status){const n=new Uint8Array(t.response);return this.logger.info(v,y,`Loaded font: ${e} (${n.length} bytes)`),n}return this.logger.error(v,y,`Failed to load font: ${e} (HTTP ${t.status})`),null}catch(t){return this.logger.error(v,y,`Error fetching font: ${e}`,t),null}}async fetchFontAsync(e){if(this.fontConfig.fontLoader)try{return this.fontConfig.fontLoader(e)}catch{return null}try{const t=await fetch(e);if(t.ok){const e=await t.arrayBuffer();return new Uint8Array(e)}return null}catch{return null}}}const x="PDFiumEngine",A="Engine";class w{constructor(e,t={}){this.pdfiumModule=e,this.memoryLeakCheckInterval=null,this.fontFallbackManager=null;const{logger:n=new r.N,fontFallback:o}=t;this.logger=n,this.memoryManager=new _(this.pdfiumModule,this.logger),this.cache=new p(this.pdfiumModule,this.memoryManager),this.logger.isEnabled("debug")&&(this.memoryLeakCheckInterval=setInterval(()=>{this.memoryManager.checkLeaks()},1e4)),this.logger.debug(x,A,"initialize"),this.logger.perf(x,A,"Initialize","Begin","General"),this.pdfiumModule.PDFiumExt_Init(),this.logger.perf(x,A,"Initialize","End","General"),o&&(this.fontFallbackManager=new D(o,this.logger),this.fontFallbackManager.initialize(this.pdfiumModule),this.logger.info(x,A,"Font fallback system enabled"))}destroy(){return this.logger.debug(x,A,"destroy"),this.logger.perf(x,A,"Destroy","Begin","General"),this.fontFallbackManager&&(this.fontFallbackManager.disable(),this.fontFallbackManager=null),this.pdfiumModule.FPDF_DestroyLibrary(),this.memoryLeakCheckInterval&&(clearInterval(this.memoryLeakCheckInterval),this.memoryLeakCheckInterval=null),this.logger.perf(x,A,"Destroy","End","General"),r.a.resolve(!0)}getFontFallbackManager(){return this.fontFallbackManager}withWString(e,t){const n=2*(e.length+1),o=this.memoryManager.malloc(n);try{return this.pdfiumModule.pdfium.stringToUTF16(e,o,n),t(o)}finally{this.memoryManager.free(o)}}withFloatArray(e,t){const n=e??[],o=4*n.length,r=o?this.memoryManager.malloc(o):0;try{if(o)for(let e=0;e<n.length;e++)this.pdfiumModule.pdfium.setValue(r+4*e,n[e],"float");return t(r,n.length)}finally{o&&this.memoryManager.free(r)}}openDocumentBuffer(e,t){this.logger.debug(x,A,"openDocumentBuffer",e,t),this.logger.perf(x,A,"OpenDocumentBuffer","Begin",e.id);const n=new Uint8Array(e.content),o=n.length,a=this.memoryManager.malloc(o);this.pdfiumModule.pdfium.HEAPU8.set(n,a);const i=this.pdfiumModule.FPDF_LoadMemDocument(a,o,(null==t?void 0:t.password)??"");if(!i){const t=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(x,A,`FPDF_LoadMemDocument failed with ${t}`),this.memoryManager.free(a),this.logger.perf(x,A,"OpenDocumentBuffer","End",e.id),r.a.reject({code:t,message:"FPDF_LoadMemDocument failed"})}const s=this.pdfiumModule.FPDF_GetPageCount(i),l=[],d=this.memoryManager.malloc(8);for(let t=0;t<s;t++){if(!this.pdfiumModule.FPDF_GetPageSizeByIndexF(i,t,d)){const t=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(x,A,`FPDF_GetPageSizeByIndexF failed with ${t}`),this.memoryManager.free(d),this.pdfiumModule.FPDF_CloseDocument(i),this.memoryManager.free(a),this.logger.perf(x,A,"OpenDocumentBuffer","End",e.id),r.a.reject({code:t,message:"FPDF_GetPageSizeByIndexF failed"})}const n=this.pdfiumModule.EPDF_GetPageRotationByIndex(i,t),o={index:t,size:{width:this.pdfiumModule.pdfium.getValue(d,"float"),height:this.pdfiumModule.pdfium.getValue(d+4,"float")},rotation:n};l.push(o)}this.memoryManager.free(d);const c={id:e.id,pageCount:s,pages:l};return this.cache.setDocument(e.id,a,i),this.logger.perf(x,A,"OpenDocumentBuffer","End",e.id),r.a.resolve(c)}getMetadata(e){this.logger.debug(x,A,"getMetadata",e),this.logger.perf(x,A,"GetMetadata","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"GetMetadata","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=this.readMetaText(t.docPtr,"CreationDate"),o=this.readMetaText(t.docPtr,"ModDate"),a={title:this.readMetaText(t.docPtr,"Title"),author:this.readMetaText(t.docPtr,"Author"),subject:this.readMetaText(t.docPtr,"Subject"),keywords:this.readMetaText(t.docPtr,"Keywords"),producer:this.readMetaText(t.docPtr,"Producer"),creator:this.readMetaText(t.docPtr,"Creator"),creationDate:n?(0,r.p)(n)??null:null,modificationDate:o?(0,r.p)(o)??null:null,trapped:this.getMetaTrapped(t.docPtr),custom:this.readAllMeta(t.docPtr,!0)};return this.logger.perf(x,A,"GetMetadata","End",e.id),r.a.resolve(a)}setMetadata(e,t){this.logger.debug(x,A,"setMetadata",e,t),this.logger.perf(x,A,"SetMetadata","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"SetMetadata","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=[["title","Title"],["author","Author"],["subject","Subject"],["keywords","Keywords"],["producer","Producer"],["creator","Creator"]];let a=!0;for(const[e,r]of o){const o=t[e];if(void 0===o)continue;const i=null===o?null:o;this.setMetaText(n.docPtr,r,i)||(a=!1)}const i=(e,o)=>{const i=t[e];if(void 0===i)return;if(null===i)return void(this.setMetaText(n.docPtr,o,null)||(a=!1));const s=(0,r.n)(i);this.setMetaText(n.docPtr,o,s)||(a=!1)};if(i("creationDate","CreationDate"),i("modificationDate","ModDate"),void 0!==t.trapped&&(this.setMetaTrapped(n.docPtr,t.trapped??null)||(a=!1)),void 0!==t.custom)for(const[e,o]of Object.entries(t.custom))u(e)?this.setMetaText(n.docPtr,e,o??null)||(a=!1):this.logger.warn(x,A,"Invalid custom metadata key skipped",e);return this.logger.perf(x,A,"SetMetadata","End",e.id),a?r.a.resolve(!0):r.a.reject({code:r.P.Unknown,message:"one or more metadata fields could not be written"})}getDocPermissions(e){this.logger.debug(x,A,"getDocPermissions",e),this.logger.perf(x,A,"getDocPermissions","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"getDocPermissions","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=this.pdfiumModule.FPDF_GetDocPermissions(t.docPtr);return r.a.resolve(n)}getDocUserPermissions(e){this.logger.debug(x,A,"getDocUserPermissions",e),this.logger.perf(x,A,"getDocUserPermissions","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"getDocUserPermissions","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=this.pdfiumModule.FPDF_GetDocUserPermissions(t.docPtr);return r.a.resolve(n)}getSignatures(e){this.logger.debug(x,A,"getSignatures",e),this.logger.perf(x,A,"GetSignatures","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"GetSignatures","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=[],o=this.pdfiumModule.FPDF_GetSignatureCount(t.docPtr);for(let e=0;e<o;e++){const o=this.pdfiumModule.FPDF_GetSignatureObject(t.docPtr,e),r=d(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFSignatureObj_GetContents(o,e,t)),a=d(this.pdfiumModule.pdfium,(e,t)=>4*this.pdfiumModule.FPDFSignatureObj_GetByteRange(o,e,t)),i=d(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFSignatureObj_GetSubFilter(o,e,t)),s=l(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFSignatureObj_GetReason(o,e,t),this.pdfiumModule.pdfium.UTF16ToString),c=l(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFSignatureObj_GetTime(o,e,t),this.pdfiumModule.pdfium.UTF8ToString),u=this.pdfiumModule.FPDFSignatureObj_GetDocMDPPermission(o);n.push({contents:r,byteRange:a,subFilter:i,reason:s,time:c,docMDP:u})}return this.logger.perf(x,A,"GetSignatures","End",e.id),r.a.resolve(n)}getBookmarks(e){this.logger.debug(x,A,"getBookmarks",e),this.logger.perf(x,A,"GetBookmarks","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"getBookmarks","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=this.readPdfBookmarks(t.docPtr,0);return this.logger.perf(x,A,"GetBookmarks","End",e.id),r.a.resolve({bookmarks:n})}setBookmarks(e,t){this.logger.debug(x,A,"setBookmarks",e,t),this.logger.perf(x,A,"SetBookmarks","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"SetBookmarks","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});if(!this.pdfiumModule.EPDFBookmark_Clear(n.docPtr))return this.logger.perf(x,A,"SetBookmarks","End",e.id),r.a.reject({code:r.P.Unknown,message:"failed to clear existing bookmarks"});const o=(e,t)=>{var r;for(const a of t){const t=this.withWString(a.title??"",t=>this.pdfiumModule.EPDFBookmark_AppendChild(n.docPtr,e,t));if(!t)return!1;if(a.target&&!this.applyBookmarkTarget(n.docPtr,t,a.target))return!1;if((null==(r=a.children)?void 0:r.length)&&!o(t,a.children))return!1}return!0},a=o(0,t);return this.logger.perf(x,A,"SetBookmarks","End",e.id),a?r.a.resolve(!0):r.a.reject({code:r.P.Unknown,message:"failed to build bookmark tree"})}deleteBookmarks(e){this.logger.debug(x,A,"deleteBookmarks",e),this.logger.perf(x,A,"DeleteBookmarks","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"DeleteBookmarks","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=this.pdfiumModule.EPDFBookmark_Clear(t.docPtr);return this.logger.perf(x,A,"DeleteBookmarks","End",e.id),n?r.a.resolve(!0):r.a.reject({code:r.P.Unknown,message:"failed to clear bookmarks"})}renderPageRaw(e,t,n){this.logger.debug(x,A,"renderPage",e,t,n),this.logger.perf(x,A,"RenderPage","Begin",`${e.id}-${t.index}`);const o={origin:{x:0,y:0},size:t.size},r=this.renderRectEncoded(e,t,o,n);return this.logger.perf(x,A,"RenderPage","End",`${e.id}-${t.index}`),r}renderPageRect(e,t,n,o){this.logger.debug(x,A,"renderPageRect",e,t,n,o),this.logger.perf(x,A,"RenderPageRect","Begin",`${e.id}-${t.index}`);const r=this.renderRectEncoded(e,t,n,o);return this.logger.perf(x,A,"RenderPageRect","End",`${e.id}-${t.index}`),r}getPageAnnotations(e,t){this.logger.debug(x,A,"getPageAnnotations",e,t),this.logger.perf(x,A,"GetPageAnnotations","Begin",`${e.id}-${t.index}`);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"GetPageAnnotations","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=this.readPageAnnotations(n,t);return this.logger.perf(x,A,"GetPageAnnotations","End",`${e.id}-${t.index}`),this.logger.debug(x,A,"GetPageAnnotations",`${e.id}-${t.index}`,o),r.a.resolve(o)}createPageAnnotation(e,t,n,o){this.logger.debug(x,A,"createPageAnnotation",e,t,n),this.logger.perf(x,A,"CreatePageAnnotation","Begin",`${e.id}-${t.index}`);const a=this.cache.getContext(e.id);if(!a)return this.logger.perf(x,A,"CreatePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const i=a.acquirePage(t.index),s=this.pdfiumModule.EPDFPage_CreateAnnot(i.pagePtr,n.type);if(!s)return this.logger.perf(x,A,"CreatePageAnnotation","End",`${e.id}-${t.index}`),i.release(),r.a.reject({code:r.P.CantCreateAnnot,message:"can not create annotation with specified type"});if((0,r.i)(n.id)||(n.id=(0,r.u)()),!this.setAnnotString(s,"NM",n.id))return this.pdfiumModule.FPDFPage_CloseAnnot(s),i.release(),r.a.reject({code:r.P.CantSetAnnotString,message:"can not set the name of the annotation"});if(!this.setPageAnnoRect(t,s,n.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(s),i.release(),this.logger.perf(x,A,"CreatePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.CantSetAnnotRect,message:"can not set the rect of the annotation"});let l=!1;switch(n.type){case r.b.INK:l=this.addInkStroke(t,i.pagePtr,s,n);break;case r.b.STAMP:l=this.addStampContent(a.docPtr,t,i.pagePtr,s,n,null==o?void 0:o.imageData);break;case r.b.TEXT:l=this.addTextContent(t,i.pagePtr,s,n);break;case r.b.FREETEXT:l=this.addFreeTextContent(t,i.pagePtr,s,n);break;case r.b.LINE:l=this.addLineContent(t,i.pagePtr,s,n);break;case r.b.POLYLINE:case r.b.POLYGON:l=this.addPolyContent(t,i.pagePtr,s,n);break;case r.b.CIRCLE:case r.b.SQUARE:l=this.addShapeContent(t,i.pagePtr,s,n);break;case r.b.UNDERLINE:case r.b.STRIKEOUT:case r.b.SQUIGGLY:case r.b.HIGHLIGHT:l=this.addTextMarkupContent(t,i.pagePtr,s,n)}return l?(void 0!==n.blendMode?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(s,n.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(s),this.pdfiumModule.FPDFPage_GenerateContent(i.pagePtr),this.pdfiumModule.FPDFPage_CloseAnnot(s),i.release(),this.logger.perf(x,A,"CreatePageAnnotation","End",`${e.id}-${t.index}`),r.a.resolve(n.id)):(this.pdfiumModule.FPDFPage_RemoveAnnot(i.pagePtr,s),i.release(),this.logger.perf(x,A,"CreatePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.CantSetAnnotContent,message:"can not add content of the annotation"}))}updatePageAnnotation(e,t,n){this.logger.debug(x,A,"updatePageAnnotation",e,t,n),this.logger.perf(x,A,"UpdatePageAnnotation","Begin",`${e.id}-${t.index}`);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(x,A,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const a=o.acquirePage(t.index),i=this.getAnnotationByName(a.pagePtr,n.id);if(!i)return a.release(),this.logger.perf(x,A,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.NotFound,message:"annotation not found"});if(!this.setPageAnnoRect(t,i,n.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(i),a.release(),this.logger.perf(x,A,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.CantSetAnnotRect,message:"failed to move annotation"});let s=!1;switch(n.type){case r.b.INK:if(!this.pdfiumModule.FPDFAnnot_RemoveInkList(i))break;s=this.addInkStroke(t,a.pagePtr,i,n);break;case r.b.STAMP:s=this.addStampContent(o.docPtr,t,a.pagePtr,i,n);break;case r.b.TEXT:s=this.addTextContent(t,a.pagePtr,i,n);break;case r.b.FREETEXT:s=this.addFreeTextContent(t,a.pagePtr,i,n);break;case r.b.CIRCLE:case r.b.SQUARE:s=this.addShapeContent(t,a.pagePtr,i,n);break;case r.b.LINE:s=this.addLineContent(t,a.pagePtr,i,n);break;case r.b.POLYGON:case r.b.POLYLINE:s=this.addPolyContent(t,a.pagePtr,i,n);break;case r.b.HIGHLIGHT:case r.b.UNDERLINE:case r.b.STRIKEOUT:case r.b.SQUIGGLY:s=this.addTextMarkupContent(t,a.pagePtr,i,n);break;default:s=!1}return s&&(void 0!==n.blendMode?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(i,n.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(i),this.pdfiumModule.FPDFPage_GenerateContent(a.pagePtr)),this.pdfiumModule.FPDFPage_CloseAnnot(i),a.release(),this.logger.perf(x,A,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),s?r.a.resolve(!0):r.a.reject({code:r.P.CantSetAnnotContent,message:"failed to update annotation"})}removePageAnnotation(e,t,n){this.logger.debug(x,A,"removePageAnnotation",e,t,n),this.logger.perf(x,A,"RemovePageAnnotation","Begin",`${e.id}-${t.index}`);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(x,A,"RemovePageAnnotation","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const a=o.acquirePage(t.index);let i=!1;return i=this.removeAnnotationByName(a.pagePtr,n.id),i?(i=this.pdfiumModule.FPDFPage_GenerateContent(a.pagePtr),i||this.logger.error(x,A,"FPDFPage_GenerateContent Failed",`${e.id}-${t.index}`)):this.logger.error(x,A,"FPDFPage_RemoveAnnot Failed",`${e.id}-${t.index}`),a.release(),this.logger.perf(x,A,"RemovePageAnnotation","End",`${e.id}-${t.index}`),r.a.resolve(i)}getPageTextRects(e,t){this.logger.debug(x,A,"getPageTextRects",e,t),this.logger.perf(x,A,"GetPageTextRects","Begin",`${e.id}-${t.index}`);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"GetPageTextRects","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=n.acquirePage(t.index),a=this.pdfiumModule.FPDFText_LoadPage(o.pagePtr),i=this.readPageTextRects(t,o.docPtr,o.pagePtr,a);return this.pdfiumModule.FPDFText_ClosePage(a),o.release(),this.logger.perf(x,A,"GetPageTextRects","End",`${e.id}-${t.index}`),r.a.resolve(i)}renderThumbnailRaw(e,t,n){const{scaleFactor:o=1,...a}=n??{};if(this.logger.debug(x,A,"renderThumbnail",e,t,n),this.logger.perf(x,A,"RenderThumbnail","Begin",`${e.id}-${t.index}`),!this.cache.getContext(e.id))return this.logger.perf(x,A,"RenderThumbnail","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const i=this.renderPageRaw(e,t,{scaleFactor:Math.max(o,.5),...a});return this.logger.perf(x,A,"RenderThumbnail","End",`${e.id}-${t.index}`),i}getAttachments(e){this.logger.debug(x,A,"getAttachments",e),this.logger.perf(x,A,"GetAttachments","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"GetAttachments","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=[],o=this.pdfiumModule.FPDFDoc_GetAttachmentCount(t.docPtr);for(let e=0;e<o;e++){const o=this.readPdfAttachment(t.docPtr,e);n.push(o)}return this.logger.perf(x,A,"GetAttachments","End",e.id),r.a.resolve(n)}addAttachment(e,t){this.logger.debug(x,A,"addAttachment",e,null==t?void 0:t.name),this.logger.perf(x,A,"AddAttachment","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"AddAttachment","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const{name:o,description:a,mimeType:i,data:s}=t??{};if(!o)return this.logger.perf(x,A,"AddAttachment","End",e.id),r.a.reject({code:r.P.NotFound,message:"attachment name is required"});if(!s||(Uint8Array,0===s.byteLength))return this.logger.perf(x,A,"AddAttachment","End",e.id),r.a.reject({code:r.P.NotFound,message:"attachment data is empty"});const l=this.withWString(o,e=>this.pdfiumModule.FPDFDoc_AddAttachment(n.docPtr,e));if(!l)return this.logger.perf(x,A,"AddAttachment","End",e.id),r.a.reject({code:r.P.Unknown,message:`An attachment named "${o}" already exists`});this.withWString(a,e=>this.pdfiumModule.EPDFAttachment_SetDescription(l,e)),this.pdfiumModule.EPDFAttachment_SetSubtype(l,i);const d=s instanceof Uint8Array?s:new Uint8Array(s),c=d.byteLength,u=this.memoryManager.malloc(c);try{if(this.pdfiumModule.pdfium.HEAPU8.set(d,u),!this.pdfiumModule.FPDFAttachment_SetFile(l,n.docPtr,u,c))return this.logger.perf(x,A,"AddAttachment","End",e.id),r.a.reject({code:r.P.Unknown,message:"failed to write attachment bytes"})}finally{this.memoryManager.free(u)}return this.logger.perf(x,A,"AddAttachment","End",e.id),r.a.resolve(!0)}removeAttachment(e,t){this.logger.debug(x,A,"deleteAttachment",e,t),this.logger.perf(x,A,"DeleteAttachment","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"DeleteAttachment","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.FPDFDoc_GetAttachmentCount(n.docPtr);if(t.index<0||t.index>=o)return this.logger.perf(x,A,"DeleteAttachment","End",e.id),r.a.reject({code:r.P.Unknown,message:`attachment index ${t.index} out of range`});const a=this.pdfiumModule.FPDFDoc_DeleteAttachment(n.docPtr,t.index);return this.logger.perf(x,A,"DeleteAttachment","End",e.id),a?r.a.resolve(!0):r.a.reject({code:r.P.Unknown,message:"failed to delete attachment"})}readAttachmentContent(e,t){this.logger.debug(x,A,"readAttachmentContent",e,t),this.logger.perf(x,A,"ReadAttachmentContent","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"ReadAttachmentContent","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.FPDFDoc_GetAttachment(n.docPtr,t.index),a=this.memoryManager.malloc(4);if(!this.pdfiumModule.FPDFAttachment_GetFile(o,0,0,a))return this.memoryManager.free(a),this.logger.perf(x,A,"ReadAttachmentContent","End",e.id),r.a.reject({code:r.P.CantReadAttachmentSize,message:"can not read attachment size"});const i=this.pdfiumModule.pdfium.getValue(a,"i32")>>>0,s=this.memoryManager.malloc(i);if(!this.pdfiumModule.FPDFAttachment_GetFile(o,s,i,a))return this.memoryManager.free(a),this.memoryManager.free(s),this.logger.perf(x,A,"ReadAttachmentContent","End",e.id),r.a.reject({code:r.P.CantReadAttachmentContent,message:"can not read attachment content"});const l=new ArrayBuffer(i),d=new DataView(l);for(let e=0;e<i;e++)d.setInt8(e,this.pdfiumModule.pdfium.getValue(s+e,"i8"));return this.memoryManager.free(a),this.memoryManager.free(s),this.logger.perf(x,A,"ReadAttachmentContent","End",e.id),r.a.resolve(l)}setFormFieldValue(e,t,n,o){this.logger.debug(x,A,"SetFormFieldValue",e,n,o),this.logger.perf(x,A,"SetFormFieldValue","Begin",`${e.id}-${n.id}`);const a=this.cache.getContext(e.id);if(!a)return this.logger.debug(x,A,"SetFormFieldValue","document is not opened"),this.logger.perf(x,A,"SetFormFieldValue","End",`${e.id}-${n.id}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const i=this.pdfiumModule.PDFiumExt_OpenFormFillInfo(),s=this.pdfiumModule.PDFiumExt_InitFormFillEnvironment(a.docPtr,i),l=a.acquirePage(t.index);this.pdfiumModule.FORM_OnAfterLoadPage(l.pagePtr,s);const d=this.getAnnotationByName(l.pagePtr,n.id);if(!d)return l.release(),this.logger.perf(x,A,"SetFormFieldValue","End",`${e.id}-${t.index}`),r.a.reject({code:r.P.NotFound,message:"annotation not found"});if(!this.pdfiumModule.FORM_SetFocusedAnnot(s,d))return this.logger.debug(x,A,"SetFormFieldValue","failed to set focused annotation"),this.logger.perf(x,A,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FPDFPage_CloseAnnot(d),this.pdfiumModule.FORM_OnBeforeClosePage(l.pagePtr,s),l.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(s),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(i),r.a.reject({code:r.P.CantFocusAnnot,message:"failed to set focused annotation"});switch(o.kind){case"text":{if(!this.pdfiumModule.FORM_SelectAllText(s,l.pagePtr))return this.logger.debug(x,A,"SetFormFieldValue","failed to select all text"),this.logger.perf(x,A,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FORM_ForceToKillFocus(s),this.pdfiumModule.FPDFPage_CloseAnnot(d),this.pdfiumModule.FORM_OnBeforeClosePage(l.pagePtr,s),l.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(s),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(i),r.a.reject({code:r.P.CantSelectText,message:"failed to select all text"});const t=2*(o.text.length+1),a=this.memoryManager.malloc(t);this.pdfiumModule.pdfium.stringToUTF16(o.text,a,t),this.pdfiumModule.FORM_ReplaceSelection(s,l.pagePtr,a),this.memoryManager.free(a)}break;case"selection":if(!this.pdfiumModule.FORM_SetIndexSelected(s,l.pagePtr,o.index,o.isSelected))return this.logger.debug(x,A,"SetFormFieldValue","failed to set index selected"),this.logger.perf(x,A,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FORM_ForceToKillFocus(s),this.pdfiumModule.FPDFPage_CloseAnnot(d),this.pdfiumModule.FORM_OnBeforeClosePage(l.pagePtr,s),l.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(s),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(i),r.a.reject({code:r.P.CantSelectOption,message:"failed to set index selected"});break;case"checked":{const t=13;if(!this.pdfiumModule.FORM_OnChar(s,l.pagePtr,t,0))return this.logger.debug(x,A,"SetFormFieldValue","failed to set field checked"),this.logger.perf(x,A,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FORM_ForceToKillFocus(s),this.pdfiumModule.FPDFPage_CloseAnnot(d),this.pdfiumModule.FORM_OnBeforeClosePage(l.pagePtr,s),l.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(s),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(i),r.a.reject({code:r.P.CantCheckField,message:"failed to set field checked"})}}return this.pdfiumModule.FORM_ForceToKillFocus(s),this.pdfiumModule.FPDFPage_CloseAnnot(d),this.pdfiumModule.FORM_OnBeforeClosePage(l.pagePtr,s),l.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(s),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(i),r.a.resolve(!0)}flattenPage(e,t,n){const{flag:o=r.c.Display}=n??{};this.logger.debug(x,A,"flattenPage",e,t,o),this.logger.perf(x,A,"flattenPage","Begin",e.id);const a=this.cache.getContext(e.id);if(!a)return this.logger.perf(x,A,"flattenPage","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const i=a.acquirePage(t.index),s=this.pdfiumModule.FPDFPage_Flatten(i.pagePtr,o);return i.release(),this.logger.perf(x,A,"flattenPage","End",e.id),r.a.resolve(s)}extractPages(e,t){this.logger.debug(x,A,"extractPages",e,t),this.logger.perf(x,A,"ExtractPages","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"ExtractPages","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=this.pdfiumModule.FPDF_CreateNewDocument();if(!o)return this.logger.perf(x,A,"ExtractPages","End",e.id),r.a.reject({code:r.P.CantCreateNewDoc,message:"can not create new document"});const a=this.memoryManager.malloc(4*t.length);for(let e=0;e<t.length;e++)this.pdfiumModule.pdfium.setValue(a+4*e,t[e],"i32");if(!this.pdfiumModule.FPDF_ImportPagesByIndex(o,n.docPtr,a,t.length,0))return this.pdfiumModule.FPDF_CloseDocument(o),this.logger.perf(x,A,"ExtractPages","End",e.id),r.a.reject({code:r.P.CantImportPages,message:"can not import pages to new document"});const i=this.saveDocument(o);return this.pdfiumModule.FPDF_CloseDocument(o),this.logger.perf(x,A,"ExtractPages","End",e.id),r.a.resolve(i)}extractText(e,t){this.logger.debug(x,A,"extractText",e,t),this.logger.perf(x,A,"ExtractText","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"ExtractText","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=[];for(let e=0;e<t.length;e++){const r=n.acquirePage(t[e]),a=this.pdfiumModule.FPDFText_LoadPage(r.pagePtr),i=this.pdfiumModule.FPDFText_CountChars(a),s=this.memoryManager.malloc(2*(i+1));this.pdfiumModule.FPDFText_GetText(a,0,i,s);const l=this.pdfiumModule.pdfium.UTF16ToString(s);this.memoryManager.free(s),o.push(l),this.pdfiumModule.FPDFText_ClosePage(a),r.release()}const a=o.join("\n\n");return this.logger.perf(x,A,"ExtractText","End",e.id),r.a.resolve(a)}getTextSlices(e,t){if(this.logger.debug(x,A,"getTextSlices",e,t),this.logger.perf(x,A,"GetTextSlices","Begin",e.id),0===t.length)return this.logger.perf(x,A,"GetTextSlices","End",e.id),r.a.resolve([]);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"GetTextSlices","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});try{const o=new Array(t.length),a=new Map;t.forEach((e,t)=>{(a.get(e.pageIndex)??a.set(e.pageIndex,[]).get(e.pageIndex)).push({slice:e,pos:t})});for(const[e,t]of a){const a=n.acquirePage(e),i=a.getTextPage();for(const{slice:e,pos:n}of t){const t=this.memoryManager.malloc(2*(e.charCount+1));this.pdfiumModule.FPDFText_GetText(i,e.charIndex,e.charCount,t),o[n]=(0,r.d)(this.pdfiumModule.pdfium.UTF16ToString(t)),this.memoryManager.free(t)}a.release()}return this.logger.perf(x,A,"GetTextSlices","End",e.id),r.a.resolve(o)}catch(t){return this.logger.error(x,A,"getTextSlices error",t),this.logger.perf(x,A,"GetTextSlices","End",e.id),r.a.reject({code:r.P.Unknown,message:String(t)})}}merge(e){this.logger.debug(x,A,"merge",e);const t=e.map(e=>e.id).join(".");this.logger.perf(x,A,"Merge","Begin",t);const n=this.pdfiumModule.FPDF_CreateNewDocument();if(!n)return this.logger.perf(x,A,"Merge","End",t),r.a.reject({code:r.P.CantCreateNewDoc,message:"can not create new document"});const o=[];for(const a of e.reverse()){const e=new Uint8Array(a.content),i=e.length,s=this.memoryManager.malloc(i);this.pdfiumModule.pdfium.HEAPU8.set(e,s);const l=this.pdfiumModule.FPDF_LoadMemDocument(s,i,"");if(!l){const e=this.pdfiumModule.FPDF_GetLastError();this.logger.error(x,A,`FPDF_LoadMemDocument failed with ${e}`),this.memoryManager.free(s);for(const e of o)this.pdfiumModule.FPDF_CloseDocument(e.docPtr),this.memoryManager.free(e.filePtr);return this.logger.perf(x,A,"Merge","End",t),r.a.reject({code:e,message:"FPDF_LoadMemDocument failed"})}if(o.push({filePtr:s,docPtr:l}),!this.pdfiumModule.FPDF_ImportPages(n,l,"",0)){this.pdfiumModule.FPDF_CloseDocument(n);for(const e of o)this.pdfiumModule.FPDF_CloseDocument(e.docPtr),this.memoryManager.free(e.filePtr);return this.logger.perf(x,A,"Merge","End",t),r.a.reject({code:r.P.CantImportPages,message:"can not import pages to new document"})}}const a=this.saveDocument(n);this.pdfiumModule.FPDF_CloseDocument(n);for(const e of o)this.pdfiumModule.FPDF_CloseDocument(e.docPtr),this.memoryManager.free(e.filePtr);const i={id:`${Math.random()}`,content:a};return this.logger.perf(x,A,"Merge","End",t),r.a.resolve(i)}mergePages(e){const t=e.map(e=>`${e.docId}:${e.pageIndices.join(",")}`).join("|");this.logger.debug(x,A,"mergePages",e),this.logger.perf(x,A,"MergePages","Begin",t);const n=this.pdfiumModule.FPDF_CreateNewDocument();if(!n)return this.logger.perf(x,A,"MergePages","End",t),r.a.reject({code:r.P.CantCreateNewDoc,message:"Cannot create new document"});try{for(const t of[...e].reverse()){const e=this.cache.getContext(t.docId);if(!e){this.logger.warn(x,A,`Document ${t.docId} is not open, skipping`);continue}const o=this.pdfiumModule.FPDF_GetPageCount(e.docPtr),r=t.pageIndices.filter(e=>e>=0&&e<o);if(0===r.length)continue;const a=r.map(e=>e+1).join(",");try{if(!this.pdfiumModule.FPDF_ImportPages(n,e.docPtr,a,0))throw new Error(`Failed to import pages ${a} from document ${t.docId}`)}finally{}}const o=this.saveDocument(n),a={id:`${Math.random()}`,content:o};return this.logger.perf(x,A,"MergePages","End",t),r.a.resolve(a)}catch(e){return this.logger.error(x,A,"mergePages failed",e),this.logger.perf(x,A,"MergePages","End",t),r.a.reject({code:r.P.CantImportPages,message:e instanceof Error?e.message:"Failed to merge pages"})}finally{n&&this.pdfiumModule.FPDF_CloseDocument(n)}}saveAsCopy(e){this.logger.debug(x,A,"saveAsCopy",e),this.logger.perf(x,A,"SaveAsCopy","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(x,A,"SaveAsCopy","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const n=this.saveDocument(t.docPtr);return this.logger.perf(x,A,"SaveAsCopy","End",e.id),r.a.resolve(n)}closeDocument(e){this.logger.debug(x,A,"closeDocument",e),this.logger.perf(x,A,"CloseDocument","Begin",e.id);const t=this.cache.getContext(e.id);return t?(t.dispose(),this.logger.perf(x,A,"CloseDocument","End",e.id),r.a.resolve(!0)):r.a.resolve(!0)}closeAllDocuments(){return this.logger.debug(x,A,"closeAllDocuments"),this.logger.perf(x,A,"CloseAllDocuments","Begin"),this.cache.closeAllDocuments(),this.logger.perf(x,A,"CloseAllDocuments","End"),r.a.resolve(!0)}addTextContent(e,t,n,o){return!(!this.setAnnotString(n,"Contents",o.contents??"")||o.custom&&!this.setAnnotCustom(n,o.custom)||!this.setAnnotString(n,"T",o.author||"")||o.modified&&!this.setAnnotationDate(n,"M",o.modified)||o.created&&!this.setAnnotationDate(n,"CreationDate",o.created)||o.inReplyToId&&!this.setInReplyToId(t,n,o.inReplyToId)||!this.setAnnotationIcon(n,o.icon||r.e.Comment)||!this.setAnnotationFlags(n,o.flags||["print","noZoom","noRotate"])||o.state&&!this.setAnnotString(n,"State",o.state)||o.stateModel&&!this.setAnnotString(n,"StateModel",o.stateModel))}addFreeTextContent(e,t,n,o){if(o.created&&!this.setAnnotationDate(n,"CreationDate",o.created))return!1;if(o.custom&&!this.setAnnotCustom(n,o.custom))return!1;if(o.flags&&!this.setAnnotationFlags(n,o.flags))return!1;if(o.modified&&!this.setAnnotationDate(n,"M",o.modified))return!1;if(!this.setBorderStyle(n,r.f.SOLID,0))return!1;if(!this.setAnnotString(n,"Contents",o.contents??""))return!1;if(!this.setAnnotString(n,"T",o.author||""))return!1;if(!this.setAnnotationOpacity(n,o.opacity??1))return!1;if(!this.setAnnotationTextAlignment(n,o.textAlign))return!1;if(!this.setAnnotationVerticalAlignment(n,o.verticalAlign))return!1;if(!this.setAnnotationDefaultAppearance(n,o.fontFamily,o.fontSize,o.fontColor))return!1;if(o.intent&&!this.setAnnotIntent(n,o.intent))return!1;if(o.backgroundColor&&"transparent"!==o.backgroundColor){if(!this.setAnnotationColor(n,o.backgroundColor??"#FFFFFF",r.g.Color))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,r.g.Color))return!1;return!0}addInkStroke(e,t,n,o){return!(o.created&&!this.setAnnotationDate(n,"CreationDate",o.created)||o.custom&&!this.setAnnotCustom(n,o.custom)||o.flags&&!this.setAnnotationFlags(n,o.flags)||o.modified&&!this.setAnnotationDate(n,"M",o.modified)||!this.setAnnotString(n,"Contents",o.contents??"")||!this.setBorderStyle(n,r.f.SOLID,o.strokeWidth)||!this.setInkList(e,n,o.inkList)||!this.setAnnotString(n,"T",o.author||"")||!this.setAnnotationOpacity(n,o.opacity??1)||!this.setAnnotationColor(n,o.color??"#FFFF00",r.g.Color))}addLineContent(e,t,n,o){var a,i;if(o.created&&!this.setAnnotationDate(n,"CreationDate",o.created))return!1;if(o.custom&&!this.setAnnotCustom(n,o.custom))return!1;if(o.flags&&!this.setAnnotationFlags(n,o.flags))return!1;if(o.modified&&!this.setAnnotationDate(n,"M",o.modified))return!1;if(!this.setLinePoints(e,n,o.linePoints.start,o.linePoints.end))return!1;if(!this.setLineEndings(n,(null==(a=o.lineEndings)?void 0:a.start)??r.h.None,(null==(i=o.lineEndings)?void 0:i.end)??r.h.None))return!1;if(!this.setAnnotString(n,"Contents",o.contents??""))return!1;if(!this.setAnnotString(n,"T",o.author||""))return!1;if(!this.setBorderStyle(n,o.strokeStyle,o.strokeWidth))return!1;if(!this.setBorderDashPattern(n,o.strokeDashArray??[]))return!1;if(o.intent&&!this.setAnnotIntent(n,o.intent))return!1;if(o.color&&"transparent"!==o.color){if(!this.setAnnotationColor(n,o.color??"#FFFF00",r.g.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,r.g.InteriorColor))return!1;return!!this.setAnnotationOpacity(n,o.opacity??1)&&!!this.setAnnotationColor(n,o.strokeColor??"#FFFF00",r.g.Color)}addPolyContent(e,t,n,o){var a,i;if(o.created&&!this.setAnnotationDate(n,"CreationDate",o.created))return!1;if(o.custom&&!this.setAnnotCustom(n,o.custom))return!1;if(o.modified&&!this.setAnnotationDate(n,"M",o.modified))return!1;if(o.flags&&!this.setAnnotationFlags(n,o.flags))return!1;if(o.type===r.b.POLYLINE&&!this.setLineEndings(n,(null==(a=o.lineEndings)?void 0:a.start)??r.h.None,(null==(i=o.lineEndings)?void 0:i.end)??r.h.None))return!1;if(!this.setPdfAnnoVertices(e,n,o.vertices))return!1;if(!this.setAnnotString(n,"Contents",o.contents??""))return!1;if(!this.setAnnotString(n,"T",o.author||""))return!1;if(!this.setBorderStyle(n,o.strokeStyle,o.strokeWidth))return!1;if(!this.setBorderDashPattern(n,o.strokeDashArray??[]))return!1;if(o.intent&&!this.setAnnotIntent(n,o.intent))return!1;if(o.color&&"transparent"!==o.color){if(!this.setAnnotationColor(n,o.color??"#FFFF00",r.g.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,r.g.InteriorColor))return!1;return!!this.setAnnotationOpacity(n,o.opacity??1)&&!!this.setAnnotationColor(n,o.strokeColor??"#FFFF00",r.g.Color)}addShapeContent(e,t,n,o){if(o.created&&!this.setAnnotationDate(n,"CreationDate",o.created))return!1;if(o.custom&&!this.setAnnotCustom(n,o.custom))return!1;if(o.modified&&!this.setAnnotationDate(n,"M",o.modified))return!1;if(!this.setAnnotString(n,"Contents",o.contents??""))return!1;if(!this.setAnnotString(n,"T",o.author||""))return!1;if(!this.setBorderStyle(n,o.strokeStyle,o.strokeWidth))return!1;if(!this.setBorderDashPattern(n,o.strokeDashArray??[]))return!1;if(!this.setAnnotationFlags(n,o.flags))return!1;if(o.color&&"transparent"!==o.color){if(!this.setAnnotationColor(n,o.color??"#FFFF00",r.g.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,r.g.InteriorColor))return!1;return!!this.setAnnotationOpacity(n,o.opacity??1)&&!!this.setAnnotationColor(n,o.strokeColor??"#FFFF00",r.g.Color)}addTextMarkupContent(e,t,n,o){return!(o.created&&!this.setAnnotationDate(n,"CreationDate",o.created)||o.custom&&!this.setAnnotCustom(n,o.custom)||o.flags&&!this.setAnnotationFlags(n,o.flags)||o.modified&&!this.setAnnotationDate(n,"M",o.modified)||!this.syncQuadPointsAnno(e,n,o.segmentRects)||!this.setAnnotString(n,"Contents",o.contents??"")||!this.setAnnotString(n,"T",o.author||"")||!this.setAnnotationOpacity(n,o.opacity??1)||!this.setAnnotationColor(n,o.color??"#FFFF00",r.g.Color))}addStampContent(e,t,n,o,a,i){if(a.created&&!this.setAnnotationDate(o,"CreationDate",a.created))return!1;if(a.custom&&!this.setAnnotCustom(o,a.custom))return!1;if(a.flags&&!this.setAnnotationFlags(o,a.flags))return!1;if(a.modified&&!this.setAnnotationDate(o,"M",a.modified))return!1;if(a.icon&&!this.setAnnotationIcon(o,a.icon))return!1;if(!this.setAnnotString(o,"T",a.author||""))return!1;if(a.subject&&!this.setAnnotString(o,"Subj",a.subject))return!1;if(!this.setAnnotString(o,"Contents",a.contents??""))return!1;if(i){for(let e=this.pdfiumModule.FPDFAnnot_GetObjectCount(o)-1;e>=0;e--)this.pdfiumModule.FPDFAnnot_RemoveObject(o,e);if(!this.addImageObject(e,t,n,o,a.rect,i))return!1}return!!this.pdfiumModule.EPDFAnnot_UpdateAppearanceToRect(o,r.j.Cover)}addImageObject(e,t,n,o,r,a){const i=a.width*a.height,s=this.memoryManager.malloc(4*i);if(!s)return!1;for(let e=0;e<i;e++){const t=a.data[4*e],n=a.data[4*e+1],o=a.data[4*e+2],r=a.data[4*e+3];this.pdfiumModule.pdfium.setValue(s+4*e,o,"i8"),this.pdfiumModule.pdfium.setValue(s+4*e+1,n,"i8"),this.pdfiumModule.pdfium.setValue(s+4*e+2,t,"i8"),this.pdfiumModule.pdfium.setValue(s+4*e+3,r,"i8")}const l=this.pdfiumModule.FPDFBitmap_CreateEx(a.width,a.height,4,s,0);if(!l)return this.memoryManager.free(s),!1;const d=this.pdfiumModule.FPDFPageObj_NewImageObj(e);if(!d)return this.pdfiumModule.FPDFBitmap_Destroy(l),this.memoryManager.free(s),!1;if(!this.pdfiumModule.FPDFImageObj_SetBitmap(n,0,d,l))return this.pdfiumModule.FPDFBitmap_Destroy(l),this.pdfiumModule.FPDFPageObj_Destroy(d),this.memoryManager.free(s),!1;const c=this.memoryManager.malloc(24);if(this.pdfiumModule.pdfium.setValue(c,a.width,"float"),this.pdfiumModule.pdfium.setValue(c+4,0,"float"),this.pdfiumModule.pdfium.setValue(c+8,0,"float"),this.pdfiumModule.pdfium.setValue(c+12,a.height,"float"),this.pdfiumModule.pdfium.setValue(c+16,0,"float"),this.pdfiumModule.pdfium.setValue(c+20,0,"float"),!this.pdfiumModule.FPDFPageObj_SetMatrix(d,c))return this.memoryManager.free(c),this.pdfiumModule.FPDFBitmap_Destroy(l),this.pdfiumModule.FPDFPageObj_Destroy(d),this.memoryManager.free(s),!1;this.memoryManager.free(c);const u=this.convertDevicePointToPagePoint(t,{x:r.origin.x,y:r.origin.y+a.height});return this.pdfiumModule.FPDFPageObj_Transform(d,1,0,0,1,u.x,u.y),this.pdfiumModule.FPDFAnnot_AppendObject(o,d)?(this.pdfiumModule.FPDFBitmap_Destroy(l),this.memoryManager.free(s),!0):(this.pdfiumModule.FPDFBitmap_Destroy(l),this.pdfiumModule.FPDFPageObj_Destroy(d),this.memoryManager.free(s),!1)}saveDocument(e){const t=this.pdfiumModule.PDFiumExt_OpenFileWriter();this.pdfiumModule.PDFiumExt_SaveAsCopy(e,t);const n=this.pdfiumModule.PDFiumExt_GetFileWriterSize(t),o=this.memoryManager.malloc(n);this.pdfiumModule.PDFiumExt_GetFileWriterData(t,o,n);const r=new ArrayBuffer(n),a=new DataView(r);for(let e=0;e<n;e++)a.setInt8(e,this.pdfiumModule.pdfium.getValue(o+e,"i8"));return this.memoryManager.free(o),this.pdfiumModule.PDFiumExt_CloseFileWriter(t),r}readCatalogLanguage(e){const t=this.pdfiumModule.EPDFCatalog_GetLanguage(e,0,0)>>>0;return 0===t?null:2===t?"":l(this.pdfiumModule.pdfium,(t,n)=>this.pdfiumModule.EPDFCatalog_GetLanguage(e,t,n),this.pdfiumModule.pdfium.UTF16ToString,t)}readMetaText(e,t){if(!this.pdfiumModule.EPDF_HasMetaText(e,t))return null;const n=this.pdfiumModule.FPDF_GetMetaText(e,t,0,0);return 2===n?"":l(this.pdfiumModule.pdfium,(n,o)=>this.pdfiumModule.FPDF_GetMetaText(e,t,n,o),this.pdfiumModule.pdfium.UTF16ToString,n)}setMetaText(e,t,n){if(null==n||0===n.length)return!!this.pdfiumModule.EPDF_SetMetaText(e,t,0);const o=2*(n.length+1),r=this.memoryManager.malloc(o);try{return this.pdfiumModule.pdfium.stringToUTF16(n,r,o),!!this.pdfiumModule.EPDF_SetMetaText(e,t,r)}finally{this.memoryManager.free(r)}}getMetaTrapped(e){const t=Number(this.pdfiumModule.EPDF_GetMetaTrapped(e));switch(t){case r.k.NotSet:case r.k.True:case r.k.False:case r.k.Unknown:return t;default:return r.k.Unknown}}setMetaTrapped(e,t){const n=null==t||void 0===t?r.k.NotSet:t;return!(n!==r.k.NotSet&&n!==r.k.True&&n!==r.k.False&&n!==r.k.Unknown||!this.pdfiumModule.EPDF_SetMetaTrapped(e,n))}getMetaKeyCount(e,t){return 0|Number(this.pdfiumModule.EPDF_GetMetaKeyCount(e,t))}getMetaKeyName(e,t,n){const o=this.pdfiumModule.EPDF_GetMetaKeyName(e,t,n,0,0);return o?l(this.pdfiumModule.pdfium,(o,r)=>this.pdfiumModule.EPDF_GetMetaKeyName(e,t,n,o,r),this.pdfiumModule.pdfium.UTF8ToString,o):null}readAllMeta(e,t=!0){const n=this.getMetaKeyCount(e,t),o={};for(let r=0;r<n;r++){const n=this.getMetaKeyName(e,r,t);n&&(o[n]=this.readMetaText(e,n))}return o}readPdfBookmarks(e,t=0){let n=this.pdfiumModule.FPDFBookmark_GetFirstChild(e,t);const o=[];for(;n;){const t=this.readPdfBookmark(e,n);o.push(t),n=this.pdfiumModule.FPDFBookmark_GetNextSibling(e,n)}return o}readPdfBookmark(e,t){const n=l(this.pdfiumModule.pdfium,(e,n)=>this.pdfiumModule.FPDFBookmark_GetTitle(t,e,n),this.pdfiumModule.pdfium.UTF16ToString),o=this.readPdfBookmarks(e,t);return{title:n,target:this.readPdfBookmarkTarget(e,()=>this.pdfiumModule.FPDFBookmark_GetAction(t),()=>this.pdfiumModule.FPDFBookmark_GetDest(e,t)),children:o}}readPageTextRects(e,t,n,o){const r=this.pdfiumModule.FPDFText_CountRects(o,0,-1),a=[];for(let t=0;t<r;t++){const r=this.memoryManager.malloc(8),i=this.memoryManager.malloc(8),s=this.memoryManager.malloc(8),l=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDFText_GetRect(o,t,i,r,s,l)){this.memoryManager.free(i),this.memoryManager.free(r),this.memoryManager.free(s),this.memoryManager.free(l);continue}const d=this.pdfiumModule.pdfium.getValue(i,"double"),c=this.pdfiumModule.pdfium.getValue(r,"double"),u=this.pdfiumModule.pdfium.getValue(s,"double"),m=this.pdfiumModule.pdfium.getValue(l,"double");this.memoryManager.free(i),this.memoryManager.free(r),this.memoryManager.free(s),this.memoryManager.free(l);const p=this.memoryManager.malloc(4),h=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(n,0,0,e.size.width,e.size.height,0,d,c,p,h);const g=this.pdfiumModule.pdfium.getValue(p,"i32"),f=this.pdfiumModule.pdfium.getValue(h,"i32");this.memoryManager.free(p),this.memoryManager.free(h);const F={origin:{x:g,y:f},size:{width:Math.ceil(Math.abs(u-d)),height:Math.ceil(Math.abs(c-m))}},P=this.pdfiumModule.FPDFText_GetBoundedText(o,d,c,u,m,0,0),b=2*(P+1),_=this.memoryManager.malloc(b);this.pdfiumModule.FPDFText_GetBoundedText(o,d,c,u,m,_,P);const v=this.pdfiumModule.pdfium.UTF16ToString(_);this.memoryManager.free(_);const y=this.pdfiumModule.FPDFText_GetCharIndexAtPos(o,d,c,2,2);let D="",x=F.size.height;if(y>=0){x=this.pdfiumModule.FPDFText_GetFontSize(o,y);const e=this.pdfiumModule.FPDFText_GetFontInfo(o,y,0,0,0)+1,t=this.memoryManager.malloc(e),n=this.memoryManager.malloc(4);this.pdfiumModule.FPDFText_GetFontInfo(o,y,t,e,n),D=this.pdfiumModule.pdfium.UTF8ToString(t),this.memoryManager.free(t),this.memoryManager.free(n)}const A={content:v,rect:F,font:{family:D,size:x}};a.push(A)}return a}getPageGeometry(e,t){const n="getPageGeometry";this.logger.perf(x,A,n,"Begin",e.id);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(x,A,n,"End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const a=o.acquirePage(t.index),i=a.getTextPage(),s=this.pdfiumModule.FPDFText_CountChars(i),l=[];for(let e=0;e<s;e++){const n=this.readGlyphInfo(t,a.pagePtr,i,e);l.push(n)}const d=this.buildRunsFromGlyphs(l,i);return a.release(),this.logger.perf(x,A,n,"End",e.id),r.a.resolve({runs:d})}buildRunsFromGlyphs(e,t){const n=[];let o=null,r=null,a=null;for(let i=0;i<e.length;i++){const s=e[i],l=this.pdfiumModule.FPDFText_GetTextObject(t,i);if(l!==r&&(r=l,o={rect:{x:s.origin.x,y:s.origin.y,width:s.size.width,height:s.size.height},charStart:i,glyphs:[]},a={minX:s.origin.x,minY:s.origin.y,maxX:s.origin.x+s.size.width,maxY:s.origin.y+s.size.height},n.push(o)),o.glyphs.push({x:s.origin.x,y:s.origin.y,width:s.size.width,height:s.size.height,flags:s.isEmpty?2:s.isSpace?1:0}),s.isEmpty)continue;const d=s.origin.x+s.size.width,c=s.origin.y+s.size.height;a.minX=Math.min(a.minX,s.origin.x),a.minY=Math.min(a.minY,s.origin.y),a.maxX=Math.max(a.maxX,d),a.maxY=Math.max(a.maxY,c),o.rect.x=a.minX,o.rect.y=a.minY,o.rect.width=a.maxX-a.minX,o.rect.height=a.maxY-a.minY}return n}readGlyphInfo(e,t,n,o){const r=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),s=this.memoryManager.malloc(4),l=this.memoryManager.malloc(16);let d=0,c=0,u=0,m=0,p=!1;if(this.pdfiumModule.FPDFText_GetLooseCharBox(n,o,l)){const h=this.pdfiumModule.pdfium.getValue(l,"float"),g=this.pdfiumModule.pdfium.getValue(l+4,"float"),f=this.pdfiumModule.pdfium.getValue(l+8,"float"),F=this.pdfiumModule.pdfium.getValue(l+12,"float");if(h===f||g===F)return[l,r,a,i,s].forEach(e=>this.memoryManager.free(e)),{origin:{x:0,y:0},size:{width:0,height:0},isEmpty:!0};this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,h,g,r,a),this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,f,F,i,s);const P=this.pdfiumModule.pdfium.getValue(r,"i32"),b=this.pdfiumModule.pdfium.getValue(a,"i32"),_=this.pdfiumModule.pdfium.getValue(i,"i32"),v=this.pdfiumModule.pdfium.getValue(s,"i32");d=Math.min(P,_),c=Math.min(b,v),u=Math.max(1,Math.abs(_-P)),m=Math.max(1,Math.abs(v-b)),p=32===this.pdfiumModule.FPDFText_GetUnicode(n,o)}return[l,r,a,i,s].forEach(e=>this.memoryManager.free(e)),{origin:{x:d,y:c},size:{width:u,height:m},...p&&{isSpace:p}}}getPageGlyphs(e,t){this.logger.debug(x,A,"getPageGlyphs",e,t),this.logger.perf(x,A,"getPageGlyphs","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(x,A,"getPageGlyphs","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=n.acquirePage(t.index),a=o.getTextPage(),i=this.pdfiumModule.FPDFText_CountChars(a),s=new Array(i);for(let e=0;e<i;e++){const n=this.readGlyphInfo(t,o.pagePtr,a,e);n.isEmpty||(s[e]={...n})}return o.release(),this.logger.perf(x,A,"getPageGlyphs","End",e.id),r.a.resolve(s)}readCharBox(e,t,n,o){const r=this.memoryManager.malloc(8),a=this.memoryManager.malloc(8),i=this.memoryManager.malloc(8),s=this.memoryManager.malloc(8);let l=0,d=0,c=0,u=0;if(this.pdfiumModule.FPDFText_GetCharBox(n,o,a,s,i,r)){const n=this.pdfiumModule.pdfium.getValue(r,"double"),o=this.pdfiumModule.pdfium.getValue(a,"double"),m=this.pdfiumModule.pdfium.getValue(i,"double"),p=this.pdfiumModule.pdfium.getValue(s,"double"),h=this.memoryManager.malloc(4),g=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,o,n,h,g),l=this.pdfiumModule.pdfium.getValue(h,"i32"),d=this.pdfiumModule.pdfium.getValue(g,"i32"),this.memoryManager.free(h),this.memoryManager.free(g),c=Math.ceil(Math.abs(p-o)),u=Math.ceil(Math.abs(n-m))}return this.memoryManager.free(r),this.memoryManager.free(a),this.memoryManager.free(i),this.memoryManager.free(s),{origin:{x:l,y:d},size:{width:c,height:u}}}readPageAnnotations(e,t){return e.borrowPage(t.index,n=>{const o=this.pdfiumModule.FPDFPage_GetAnnotCount(n.pagePtr),r=[];for(let a=0;a<o;a++)n.withAnnotation(a,o=>{const a=this.readPageAnnotation(e.docPtr,t,o,n);a&&r.push(a)});return r})}readPageAnnotationsRaw(e,t){const n=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(e.docPtr,t.index);if(n<=0)return[];const o=[];for(let r=0;r<n;++r){const n=this.pdfiumModule.EPDFPage_GetAnnotRaw(e.docPtr,t.index,r);if(n)try{const r=this.readPageAnnotation(e.docPtr,t,n);r&&o.push(r)}finally{this.pdfiumModule.FPDFPage_CloseAnnot(n)}}return o}getPageAnnotationsRaw(e,t){this.logger.debug(x,A,"getPageAnnotationsRaw",e,t),this.logger.perf(x,A,"GetPageAnnotationsRaw","Begin",`${e.id}-${t.index}`);const n=this.cache.getContext(e.id);if(!n)return r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const o=this.readPageAnnotationsRaw(n,t);return this.logger.perf(x,A,"GetPageAnnotationsRaw","End",`${e.id}-${t.index}`),this.logger.debug(x,A,"getPageAnnotationsRaw",`${e.id}-${t.index}`,o),r.a.resolve(o)}readPageAnnotation(e,t,n,o){let a=this.getAnnotString(n,"NM");a&&(0,r.i)(a)||(a=(0,r.u)(),this.setAnnotString(n,"NM",a));const i=this.pdfiumModule.FPDFAnnot_GetSubtype(n);let s;switch(i){case r.b.TEXT:s=this.readPdfTextAnno(t,n,a);break;case r.b.FREETEXT:s=this.readPdfFreeTextAnno(t,n,a);break;case r.b.LINK:s=this.readPdfLinkAnno(t,e,n,a);break;case r.b.WIDGET:if(o)return this.readPdfWidgetAnno(t,n,o.getFormHandle(),a);case r.b.FILEATTACHMENT:s=this.readPdfFileAttachmentAnno(t,n,a);break;case r.b.INK:s=this.readPdfInkAnno(t,n,a);break;case r.b.POLYGON:s=this.readPdfPolygonAnno(t,n,a);break;case r.b.POLYLINE:s=this.readPdfPolylineAnno(t,n,a);break;case r.b.LINE:s=this.readPdfLineAnno(t,n,a);break;case r.b.HIGHLIGHT:s=this.readPdfHighlightAnno(t,n,a);break;case r.b.STAMP:s=this.readPdfStampAnno(t,n,a);break;case r.b.SQUARE:s=this.readPdfSquareAnno(t,n,a);break;case r.b.CIRCLE:s=this.readPdfCircleAnno(t,n,a);break;case r.b.UNDERLINE:s=this.readPdfUnderlineAnno(t,n,a);break;case r.b.SQUIGGLY:s=this.readPdfSquigglyAnno(t,n,a);break;case r.b.STRIKEOUT:s=this.readPdfStrikeOutAnno(t,n,a);break;case r.b.CARET:s=this.readPdfCaretAnno(t,n,a);break;default:s=this.readPdfAnno(t,i,n,a)}return s}readAnnotationColor(e,t=r.g.Color){const n=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4);let i;return this.pdfiumModule.EPDFAnnot_GetColor(e,t,n,o,a)&&(i={red:255&this.pdfiumModule.pdfium.getValue(n,"i32"),green:255&this.pdfiumModule.pdfium.getValue(o,"i32"),blue:255&this.pdfiumModule.pdfium.getValue(a,"i32")}),this.memoryManager.free(n),this.memoryManager.free(o),this.memoryManager.free(a),i}getAnnotationColor(e,t=r.g.Color){const n=this.readAnnotationColor(e,t);return n?(0,r.l)(n):void 0}setAnnotationColor(e,t,n=r.g.Color){const o=(0,r.w)(t);return this.pdfiumModule.EPDFAnnot_SetColor(e,n,255&o.red,255&o.green,255&o.blue)}getAnnotationOpacity(e){const t=this.memoryManager.malloc(4),n=this.pdfiumModule.EPDFAnnot_GetOpacity(e,t)?this.pdfiumModule.pdfium.getValue(t,"i32"):255;return this.memoryManager.free(t),(0,r.m)(n)}setAnnotationOpacity(e,t){const n=(0,r.F)(t);return this.pdfiumModule.EPDFAnnot_SetOpacity(e,255&n)}getAnnotationTextAlignment(e){return this.pdfiumModule.EPDFAnnot_GetTextAlignment(e)}setAnnotationTextAlignment(e,t){return!!this.pdfiumModule.EPDFAnnot_SetTextAlignment(e,t)}getAnnotationVerticalAlignment(e){return this.pdfiumModule.EPDFAnnot_GetVerticalAlignment(e)}setAnnotationVerticalAlignment(e,t){return!!this.pdfiumModule.EPDFAnnot_SetVerticalAlignment(e,t)}getAnnotationDefaultAppearance(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4);if(!this.pdfiumModule.EPDFAnnot_GetDefaultAppearance(e,t,n,o,a,i))return void[t,n,o,a,i].forEach(e=>this.memoryManager.free(e));const s=this.pdfiumModule.pdfium,l=s.getValue(t,"i32"),d=s.getValue(n,"float"),c=255&s.getValue(o,"i32"),u=255&s.getValue(a,"i32"),m=255&s.getValue(i,"i32");return[t,n,o,a,i].forEach(e=>this.memoryManager.free(e)),{fontFamily:l,fontSize:d,fontColor:(0,r.l)({red:c,green:u,blue:m})}}setAnnotationDefaultAppearance(e,t,n,o){const{red:a,green:i,blue:s}=(0,r.w)(o);return!!this.pdfiumModule.EPDFAnnot_SetDefaultAppearance(e,t,n,255&a,255&i,255&s)}getBorderStyle(e){const t=this.memoryManager.malloc(4);let n=0,o=r.f.UNKNOWN,a=!1;return o=this.pdfiumModule.EPDFAnnot_GetBorderStyle(e,t),n=this.pdfiumModule.pdfium.getValue(t,"float"),a=o!==r.f.UNKNOWN,this.memoryManager.free(t),{ok:a,style:o,width:n}}setBorderStyle(e,t,n){return this.pdfiumModule.EPDFAnnot_SetBorderStyle(e,t,n)}getAnnotationIcon(e){return this.pdfiumModule.EPDFAnnot_GetIcon(e)}setAnnotationIcon(e,t){return this.pdfiumModule.EPDFAnnot_SetIcon(e,t)}getBorderEffect(e){const t=this.memoryManager.malloc(4),n=!!this.pdfiumModule.EPDFAnnot_GetBorderEffect(e,t),o=n?this.pdfiumModule.pdfium.getValue(t,"float"):0;return this.memoryManager.free(t),{ok:n,intensity:o}}getRectangleDifferences(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),r=this.memoryManager.malloc(4),a=!!this.pdfiumModule.EPDFAnnot_GetRectangleDifferences(e,t,n,o,r),i=this.pdfiumModule.pdfium,s=i.getValue(t,"float"),l=i.getValue(n,"float"),d=i.getValue(o,"float"),c=i.getValue(r,"float");return this.memoryManager.free(t),this.memoryManager.free(n),this.memoryManager.free(o),this.memoryManager.free(r),{ok:a,left:s,top:l,right:d,bottom:c}}getAnnotationDate(e,t){const n=this.getAnnotString(e,t);return n?(0,r.p)(n):void 0}setAnnotationDate(e,t,n){const o=(0,r.n)(n);return this.setAnnotString(e,t,o)}getAttachmentDate(e,t){const n=this.getAttachmentString(e,t);return n?(0,r.p)(n):void 0}setAttachmentDate(e,t,n){const o=(0,r.n)(n);return this.setAttachmentString(e,t,o)}getBorderDashPattern(e){const t=this.pdfiumModule.EPDFAnnot_GetBorderDashPatternCount(e);if(0===t)return{ok:!1,pattern:[]};const n=this.memoryManager.malloc(4*t),o=!!this.pdfiumModule.EPDFAnnot_GetBorderDashPattern(e,n,t),r=[];if(o){const e=this.pdfiumModule.pdfium;for(let o=0;o<t;o++)r.push(e.getValue(n+4*o,"float"))}return this.memoryManager.free(n),{ok:o,pattern:r}}setBorderDashPattern(e,t){if(!t||0===t.length)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,0,0);const n=t.map(e=>Number.isFinite(e)&&e>0?e:0).filter(e=>e>0);if(0===n.length)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,0,0);const o=4*n.length,r=this.memoryManager.malloc(o);for(let e=0;e<n.length;e++)this.pdfiumModule.pdfium.setValue(r+4*e,n[e],"float");const a=!!this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,r,n.length);return this.memoryManager.free(r),a}getLineEndings(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4);if(!this.pdfiumModule.EPDFAnnot_GetLineEndings(e,t,n))return this.memoryManager.free(t),void this.memoryManager.free(n);const o=this.pdfiumModule.pdfium.getValue(t,"i32"),r=this.pdfiumModule.pdfium.getValue(n,"i32");return this.memoryManager.free(t),this.memoryManager.free(n),{start:o,end:r}}setLineEndings(e,t,n){return!!this.pdfiumModule.EPDFAnnot_SetLineEndings(e,t,n)}getLinePoints(e,t){const n=this.memoryManager.malloc(8),o=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDFAnnot_GetLine(t,n,o))return this.memoryManager.free(n),void this.memoryManager.free(o);const r=this.pdfiumModule.pdfium,a=r.getValue(n+0,"float"),i=r.getValue(n+4,"float"),s=r.getValue(o+0,"float"),l=r.getValue(o+4,"float");return this.memoryManager.free(n),this.memoryManager.free(o),{start:this.convertPagePointToDevicePoint(e,{x:a,y:i}),end:this.convertPagePointToDevicePoint(e,{x:s,y:l})}}setLinePoints(e,t,n,o){const r=this.convertDevicePointToPagePoint(e,n),a=this.convertDevicePointToPagePoint(e,o);if(!r||!a)return!1;const i=this.memoryManager.malloc(16),s=this.pdfiumModule.pdfium;s.setValue(i+0,r.x,"float"),s.setValue(i+4,r.y,"float"),s.setValue(i+8,a.x,"float"),s.setValue(i+12,a.y,"float");const l=this.pdfiumModule.EPDFAnnot_SetLine(t,i,i+8);return this.memoryManager.free(i),!!l}getQuadPointsAnno(e,t){const n=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t);if(0===n)return[];const o=[];for(let r=0;r<n;r++){const n=this.memoryManager.malloc(32);if(this.pdfiumModule.FPDFAnnot_GetAttachmentPoints(t,r,n)){const t=[],r=[];for(let e=0;e<4;e++){const o=n+8*e;t.push(this.pdfiumModule.pdfium.getValue(o,"float")),r.push(this.pdfiumModule.pdfium.getValue(o+4,"float"))}const a=this.convertPagePointToDevicePoint(e,{x:t[0],y:r[0]}),i=this.convertPagePointToDevicePoint(e,{x:t[1],y:r[1]}),s=this.convertPagePointToDevicePoint(e,{x:t[2],y:r[2]}),l=this.convertPagePointToDevicePoint(e,{x:t[3],y:r[3]});o.push({p1:a,p2:i,p3:s,p4:l})}this.memoryManager.free(n)}return o.map(r.q)}syncQuadPointsAnno(e,t,n){const o=this.pdfiumModule.pdfium,a=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t),i=this.memoryManager.malloc(32),s=t=>{const n=(0,r.r)(t),a=this.convertDevicePointToPagePoint(e,n.p1),s=this.convertDevicePointToPagePoint(e,n.p2),l=this.convertDevicePointToPagePoint(e,n.p3),d=this.convertDevicePointToPagePoint(e,n.p4);o.setValue(i+0,a.x,"float"),o.setValue(i+4,a.y,"float"),o.setValue(i+8,s.x,"float"),o.setValue(i+12,s.y,"float"),o.setValue(i+16,d.x,"float"),o.setValue(i+20,d.y,"float"),o.setValue(i+24,l.x,"float"),o.setValue(i+28,l.y,"float")},l=Math.min(a,n.length);for(let e=0;e<l;e++)if(s(n[e]),!this.pdfiumModule.FPDFAnnot_SetAttachmentPoints(t,e,i))return this.memoryManager.free(i),!1;for(let e=a;e<n.length;e++)if(s(n[e]),!this.pdfiumModule.FPDFAnnot_AppendAttachmentPoints(t,i))return this.memoryManager.free(i),!1;return this.memoryManager.free(i),!0}redactTextInRects(e,t,n,o){const{recurseForms:a=!0,drawBlackBoxes:i=!1}=o??{};this.logger.debug("PDFiumEngine","Engine","redactTextInQuads",e.id,t.index,n.length);const s="RedactTextInQuads";this.logger.perf("PDFiumEngine","Engine",s,"Begin",`${e.id}-${t.index}`);const l=this.cache.getContext(e.id);if(!l)return this.logger.perf("PDFiumEngine","Engine",s,"End",`${e.id}-${t.index}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const d=(n??[]).filter(e=>{var t,n,o,r;return e&&Number.isFinite(null==(t=e.origin)?void 0:t.x)&&Number.isFinite(null==(n=e.origin)?void 0:n.y)&&Number.isFinite(null==(o=e.size)?void 0:o.width)&&Number.isFinite(null==(r=e.size)?void 0:r.height)&&e.size.width>0&&e.size.height>0});if(0===d.length)return this.logger.perf("PDFiumEngine","Engine",s,"End",`${e.id}-${t.index}`),r.a.resolve(!1);const c=l.acquirePage(t.index),{ptr:u,count:m}=this.allocFSQuadsBufferFromRects(t,d);let p=!1;try{p=!!this.pdfiumModule.EPDFText_RedactInQuads(c.pagePtr,u,m,!!a,!!i)}finally{this.memoryManager.free(u)}return p&&(p=!!this.pdfiumModule.FPDFPage_GenerateContent(c.pagePtr)),c.disposeImmediate(),this.logger.perf("PDFiumEngine","Engine",s,"End",`${e.id}-${t.index}`),r.a.resolve(!!p)}allocFSQuadsBufferFromRects(e,t){const n=t.length,o=this.memoryManager.malloc(32*n),a=this.pdfiumModule.pdfium;for(let i=0;i<n;i++){const n=t[i],s=(0,r.r)(n),l=this.convertDevicePointToPagePoint(e,s.p1),d=this.convertDevicePointToPagePoint(e,s.p2),c=this.convertDevicePointToPagePoint(e,s.p3),u=this.convertDevicePointToPagePoint(e,s.p4),m=o+32*i;a.setValue(m+0,l.x,"float"),a.setValue(m+4,l.y,"float"),a.setValue(m+8,d.x,"float"),a.setValue(m+12,d.y,"float"),a.setValue(m+16,u.x,"float"),a.setValue(m+20,u.y,"float"),a.setValue(m+24,c.x,"float"),a.setValue(m+28,c.y,"float")}return{ptr:o,count:n}}getInkList(e,t){const n=[],o=this.pdfiumModule.FPDFAnnot_GetInkListCount(t);if(o<=0)return n;const r=this.pdfiumModule.pdfium;for(let a=0;a<o;a++){const o=[],i=this.pdfiumModule.FPDFAnnot_GetInkListPath(t,a,0,0);if(i>0){const n=this.memoryManager.malloc(8*i);this.pdfiumModule.FPDFAnnot_GetInkListPath(t,a,n,i);for(let t=0;t<i;t++){const a=n+8*t,i=r.getValue(a+0,"float"),s=r.getValue(a+4,"float"),l=this.convertPagePointToDevicePoint(e,{x:i,y:s});o.push({x:l.x,y:l.y})}this.memoryManager.free(n)}n.push({points:o})}return n}setInkList(e,t,n){const o=this.pdfiumModule.pdfium;for(const r of n){const n=r.points.length;if(0===n)continue;const a=this.memoryManager.malloc(8*n);for(let t=0;t<n;t++){const n=r.points[t],i=this.convertDevicePointToPagePoint(e,n);o.setValue(a+8*t+0,i.x,"float"),o.setValue(a+8*t+4,i.y,"float")}const i=this.pdfiumModule.FPDFAnnot_AddInkStroke(t,a,n);if(this.memoryManager.free(a),-1===i)return!1}return!0}readPdfTextAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getAnnotString(t,"Contents")||"",u=this.getAnnotString(t,"State"),m=this.getAnnotString(t,"StateModel"),p=this.getAnnotationColor(t),h=this.getAnnotationOpacity(t),g=this.getInReplyToId(t),f=this.getAnnotationFlags(t),F=this.getAnnotationIcon(t);return{pageIndex:e.index,custom:o,id:n,type:r.b.TEXT,flags:f,contents:c,color:p??"#FFFF00",opacity:h,rect:i,inReplyToId:g,author:s,modified:l,created:d,state:u,stateModel:m,icon:F}}readPdfFreeTextAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"Contents")||"",l=this.getAnnotString(t,"T"),d=this.getAnnotationDate(t,"M"),c=this.getAnnotationDate(t,"CreationDate"),u=this.getAnnotString(t,"DS"),m=this.getAnnotationDefaultAppearance(t),p=this.getAnnotationColor(t),h=this.getAnnotationTextAlignment(t),g=this.getAnnotationVerticalAlignment(t),f=this.getAnnotationOpacity(t),F=this.getAnnotRichContent(t),P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,type:r.b.FREETEXT,fontFamily:(null==m?void 0:m.fontFamily)??r.o.Unknown,fontSize:(null==m?void 0:m.fontSize)??12,fontColor:(null==m?void 0:m.fontColor)??"#000000",verticalAlign:g,backgroundColor:p,flags:P,opacity:f,textAlign:h,defaultStyle:u,richContent:F,contents:s,author:l,modified:d,created:c,rect:i}}readPdfLinkAnno(e,t,n,o){const a=this.getAnnotCustom(n),i=this.pdfiumModule.FPDFAnnot_GetLink(n);if(!i)return;const s=this.readPageAnnoRect(n),l=this.convertPageRectToDeviceRect(e,s),d=this.getAnnotString(n,"T"),c=this.getAnnotationDate(n,"M"),u=this.getAnnotationDate(n,"CreationDate"),m=this.getAnnotationFlags(n),p=this.readPdfLinkAnnoTarget(t,()=>this.pdfiumModule.FPDFLink_GetAction(i),()=>this.pdfiumModule.FPDFLink_GetDest(t,i));return{pageIndex:e.index,custom:a,id:o,type:r.b.LINK,flags:m,target:p,rect:l,author:d,modified:c,created:u}}readPdfWidgetAnno(e,t,n,o){const a=this.getAnnotCustom(t),i=this.readPageAnnoRect(t),s=this.convertPageRectToDeviceRect(e,i),l=this.getAnnotString(t,"T"),d=this.getAnnotationDate(t,"M"),c=this.getAnnotationDate(t,"CreationDate"),u=this.getAnnotationFlags(t),m=this.readPdfWidgetAnnoField(n,t);return{pageIndex:e.index,custom:a,id:o,type:r.b.WIDGET,flags:u,rect:s,field:m,author:l,modified:d,created:c}}readPdfFileAttachmentAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,type:r.b.FILEATTACHMENT,flags:c,rect:i,author:s,modified:l,created:d}}readPdfInkAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getAnnotationColor(t),u=this.getAnnotationOpacity(t),{width:m}=this.getBorderStyle(t),p=this.getInkList(e,t),h=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),g=this.getAnnotIntent(t),f=this.getAnnotationFlags(t),F=this.getAnnotString(t,"Contents")||"";return{pageIndex:e.index,custom:o,id:n,type:r.b.INK,...g&&{intent:g},contents:F,blendMode:h,flags:f,color:c??"#FF0000",opacity:u,strokeWidth:0===m?1:m,rect:i,inkList:p,author:s,modified:l,created:d}}readPdfPolygonAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.readPdfAnnoVertices(e,t),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationFlags(t),p=this.getAnnotationColor(t),h=this.getAnnotationColor(t,r.g.InteriorColor),g=this.getAnnotationOpacity(t);let f,{style:F,width:P}=this.getBorderStyle(t);if(F===r.f.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(f=n)}if(c.length>1){const e=c[0],t=c[c.length-1];e.x===t.x&&e.y===t.y&&c.pop()}return{pageIndex:e.index,custom:o,id:n,type:r.b.POLYGON,contents:u,flags:m,strokeColor:p??"#FF0000",color:h??"transparent",opacity:g,strokeWidth:0===P?1:P,strokeStyle:F,strokeDashArray:f,rect:i,vertices:c,author:s,modified:l,created:d}}readPdfPolylineAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.readPdfAnnoVertices(e,t),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationColor(t),p=this.getAnnotationFlags(t),h=this.getAnnotationColor(t,r.g.InteriorColor),g=this.getAnnotationOpacity(t);let f,{style:F,width:P}=this.getBorderStyle(t);if(F===r.f.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(f=n)}const b=this.getLineEndings(t);return{pageIndex:e.index,custom:o,id:n,type:r.b.POLYLINE,contents:u,flags:p,strokeColor:m??"#FF0000",color:h??"transparent",opacity:g,strokeWidth:0===P?1:P,strokeStyle:F,strokeDashArray:f,lineEndings:b,rect:i,vertices:c,author:s,modified:l,created:d}}readPdfLineAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getLinePoints(e,t),u=this.getLineEndings(t),m=this.getAnnotString(t,"Contents")||"",p=this.getAnnotationColor(t),h=this.getAnnotationFlags(t),g=this.getAnnotationColor(t,r.g.InteriorColor),f=this.getAnnotationOpacity(t);let F,{style:P,width:b}=this.getBorderStyle(t);if(P===r.f.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(F=n)}return{pageIndex:e.index,custom:o,id:n,type:r.b.LINE,flags:h,rect:i,contents:m,strokeWidth:0===b?1:b,strokeStyle:P,strokeDashArray:F,strokeColor:p??"#FF0000",color:g??"transparent",opacity:f,linePoints:c||{start:{x:0,y:0},end:{x:0,y:0}},lineEndings:u||{start:r.h.None,end:r.h.None},author:s,modified:l,created:d}}readPdfHighlightAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getQuadPointsAnno(e,t),l=this.getAnnotationColor(t),d=this.getAnnotationOpacity(t),c=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),u=this.getAnnotString(t,"T"),m=this.getAnnotationDate(t,"M"),p=this.getAnnotationDate(t,"CreationDate"),h=this.getAnnotString(t,"Contents")||"",g=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,blendMode:c,type:r.b.HIGHLIGHT,rect:i,flags:g,contents:h,segmentRects:s,color:l??"#FFFF00",opacity:d,author:u,modified:m,created:p}}readPdfUnderlineAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getQuadPointsAnno(e,t),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationColor(t),p=this.getAnnotationOpacity(t),h=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),g=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,blendMode:h,type:r.b.UNDERLINE,rect:i,flags:g,contents:u,segmentRects:c,color:m??"#FF0000",opacity:p,author:s,modified:l,created:d}}readPdfStrikeOutAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getQuadPointsAnno(e,t),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationColor(t),p=this.getAnnotationOpacity(t),h=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),g=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,blendMode:h,type:r.b.STRIKEOUT,flags:g,rect:i,contents:u,segmentRects:c,color:m??"#FF0000",opacity:p,author:s,modified:l,created:d}}readPdfSquigglyAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getQuadPointsAnno(e,t),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationColor(t),p=this.getAnnotationOpacity(t),h=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),g=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,blendMode:h,type:r.b.SQUIGGLY,rect:i,flags:g,contents:u,segmentRects:c,color:m??"#FF0000",opacity:p,author:s,modified:l,created:d}}readPdfCaretAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:o,id:n,type:r.b.CARET,rect:i,flags:c,author:s,modified:l,created:d}}readPdfStampAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(t,"T"),l=this.getAnnotationDate(t,"M"),d=this.getAnnotationDate(t,"CreationDate"),c=this.getAnnotationFlags(t),u=this.getAnnotString(t,"Contents")||"";return{pageIndex:e.index,custom:o,id:n,type:r.b.STAMP,contents:u,rect:i,author:s,modified:l,created:d,flags:c}}readPdfPageObject(e){switch(this.pdfiumModule.FPDFPageObj_GetType(e)){case r.t.PATH:return this.readPathObject(e);case r.t.IMAGE:return this.readImageObject(e);case r.t.FORM:return this.readFormObject(e)}}readPathObject(e){const t=this.pdfiumModule.FPDFPath_CountSegments(e),n=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPageObj_GetBounds(e,n,o,a,i);const s={left:this.pdfiumModule.pdfium.getValue(n,"float"),bottom:this.pdfiumModule.pdfium.getValue(o,"float"),right:this.pdfiumModule.pdfium.getValue(a,"float"),top:this.pdfiumModule.pdfium.getValue(i,"float")};this.memoryManager.free(n),this.memoryManager.free(o),this.memoryManager.free(a),this.memoryManager.free(i);const l=[];for(let n=0;n<t;n++){const t=this.readPdfSegment(e,n);l.push(t)}const d=this.readPdfPageObjectTransformMatrix(e);return{type:r.t.PATH,bounds:s,segments:l,matrix:d}}readPdfSegment(e,t){const n=this.pdfiumModule.FPDFPath_GetPathSegment(e,t),o=this.pdfiumModule.FPDFPathSegment_GetType(n),r=this.pdfiumModule.FPDFPathSegment_GetClose(n),a=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPathSegment_GetPoint(n,a,i);const s=this.pdfiumModule.pdfium.getValue(a,"float"),l=this.pdfiumModule.pdfium.getValue(i,"float");return this.memoryManager.free(a),this.memoryManager.free(i),{type:o,point:{x:s,y:l},isClosed:r}}readImageObject(e){const t=this.pdfiumModule.FPDFImageObj_GetBitmap(e),n=this.pdfiumModule.FPDFBitmap_GetBuffer(t),o=this.pdfiumModule.FPDFBitmap_GetWidth(t),a=this.pdfiumModule.FPDFBitmap_GetHeight(t),i=this.pdfiumModule.FPDFBitmap_GetFormat(t),s=o*a,l=new Uint8ClampedArray(4*s);for(let e=0;e<s;e++)if(2===i){const t=this.pdfiumModule.pdfium.getValue(n+3*e,"i8"),o=this.pdfiumModule.pdfium.getValue(n+3*e+1,"i8"),r=this.pdfiumModule.pdfium.getValue(n+3*e+2,"i8");l[4*e]=r,l[4*e+1]=o,l[4*e+2]=t,l[4*e+3]=100}const d={data:l,width:o,height:a},c=this.readPdfPageObjectTransformMatrix(e);return{type:r.t.IMAGE,imageData:d,matrix:c}}readFormObject(e){const t=this.pdfiumModule.FPDFFormObj_CountObjects(e),n=[];for(let o=0;o<t;o++){const t=this.pdfiumModule.FPDFFormObj_GetObject(e,o),r=this.readPdfPageObject(t);r&&n.push(r)}const o=this.readPdfPageObjectTransformMatrix(e);return{type:r.t.FORM,objects:n,matrix:o}}readPdfPageObjectTransformMatrix(e){const t=this.memoryManager.malloc(24);if(this.pdfiumModule.FPDFPageObj_GetMatrix(e,t)){const e=this.pdfiumModule.pdfium.getValue(t,"float"),n=this.pdfiumModule.pdfium.getValue(t+4,"float"),o=this.pdfiumModule.pdfium.getValue(t+8,"float"),r=this.pdfiumModule.pdfium.getValue(t+12,"float"),a=this.pdfiumModule.pdfium.getValue(t+16,"float"),i=this.pdfiumModule.pdfium.getValue(t+20,"float");return this.memoryManager.free(t),{a:e,b:n,c:o,d:r,e:a,f:i}}return this.memoryManager.free(t),{a:1,b:0,c:0,d:1,e:0,f:0}}readStampAnnotationContents(e){const t=[],n=this.pdfiumModule.FPDFAnnot_GetObjectCount(e);for(let o=0;o<n;o++){const n=this.pdfiumModule.FPDFAnnot_GetObject(e,o),r=this.readPdfPageObject(n);r&&t.push(r)}return t}getStrokeWidth(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),r=this.pdfiumModule.FPDFAnnot_GetBorder(e,t,n,o)?this.pdfiumModule.pdfium.getValue(o,"float"):1;return this.memoryManager.free(t),this.memoryManager.free(n),this.memoryManager.free(o),r}getAnnotationFlags(e){const t=this.pdfiumModule.FPDFAnnot_GetFlags(e);return(0,r.v)(t)}setAnnotationFlags(e,t){const n=(0,r.x)(t);return this.pdfiumModule.FPDFAnnot_SetFlags(e,n)}readPdfCircleAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.getAnnotationFlags(t),i=this.readPageAnnoRect(t),s=this.convertPageRectToDeviceRect(e,i),l=this.getAnnotString(t,"T"),d=this.getAnnotationDate(t,"M"),c=this.getAnnotationDate(t,"CreationDate"),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationColor(t,r.g.InteriorColor),p=this.getAnnotationColor(t),h=this.getAnnotationOpacity(t);let g,{style:f,width:F}=this.getBorderStyle(t);if(f===r.f.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(g=n)}return{pageIndex:e.index,custom:o,id:n,type:r.b.CIRCLE,flags:a,color:m??"transparent",opacity:h,contents:u,strokeWidth:F,strokeColor:p??"#FF0000",strokeStyle:f,rect:s,author:l,modified:d,created:c,...void 0!==g&&{strokeDashArray:g}}}readPdfSquareAnno(e,t,n){const o=this.getAnnotCustom(t),a=this.getAnnotationFlags(t),i=this.readPageAnnoRect(t),s=this.convertPageRectToDeviceRect(e,i),l=this.getAnnotString(t,"T"),d=this.getAnnotationDate(t,"M"),c=this.getAnnotationDate(t,"CreationDate"),u=this.getAnnotString(t,"Contents")||"",m=this.getAnnotationColor(t,r.g.InteriorColor),p=this.getAnnotationColor(t),h=this.getAnnotationOpacity(t);let g,{style:f,width:F}=this.getBorderStyle(t);if(f===r.f.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(g=n)}return{pageIndex:e.index,custom:o,id:n,type:r.b.SQUARE,flags:a,color:m??"transparent",opacity:h,contents:u,strokeColor:p??"#FF0000",strokeWidth:F,strokeStyle:f,rect:s,author:l,modified:d,created:c,...void 0!==g&&{strokeDashArray:g}}}readPdfAnno(e,t,n,o){const r=this.getAnnotCustom(n),a=this.readPageAnnoRect(n),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(n,"T"),l=this.getAnnotationDate(n,"M"),d=this.getAnnotationDate(n,"CreationDate"),c=this.getAnnotationFlags(n);return{pageIndex:e.index,custom:r,id:o,flags:c,type:t,rect:i,author:s,modified:l,created:d}}getInReplyToId(e){const t=this.pdfiumModule.FPDFAnnot_GetLinkedAnnot(e,"IRT");if(t)return this.getAnnotString(t,"NM")}setInReplyToId(e,t,n){const o=this.getAnnotationByName(e,n);return!!o&&this.pdfiumModule.EPDFAnnot_SetLinkedAnnot(t,"IRT",o)}getAnnotString(e,t){const n=this.pdfiumModule.FPDFAnnot_GetStringValue(e,t,0,0);if(0===n)return;const o=2*(n+1),r=this.memoryManager.malloc(o);this.pdfiumModule.FPDFAnnot_GetStringValue(e,t,r,o);const a=this.pdfiumModule.pdfium.UTF16ToString(r);return this.memoryManager.free(r),a||void 0}getAttachmentString(e,t){const n=this.pdfiumModule.FPDFAttachment_GetStringValue(e,t,0,0);if(0===n)return;const o=2*(n+1),r=this.memoryManager.malloc(o);this.pdfiumModule.FPDFAttachment_GetStringValue(e,t,r,o);const a=this.pdfiumModule.pdfium.UTF16ToString(r);return this.memoryManager.free(r),a||void 0}getAttachmentNumber(e,t){const n=this.memoryManager.malloc(4);try{if(!this.pdfiumModule.EPDFAttachment_GetIntegerValue(e,t,n))return;return this.pdfiumModule.pdfium.getValue(n,"i32")>>>0}finally{this.memoryManager.free(n)}}getAnnotCustom(e){const t=this.getAnnotString(e,"EPDFCustom");if(t)try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse annotation custom data as JSON:",e),void console.warn("Invalid JSON string:",t)}}setAnnotCustom(e,t){if(null==t)return this.setAnnotString(e,"EPDFCustom","");try{const n=JSON.stringify(t);return this.setAnnotString(e,"EPDFCustom",n)}catch(e){return console.warn("Failed to stringify annotation custom data as JSON:",e),console.warn("Invalid data object:",t),!1}}getAnnotIntent(e){const t=this.pdfiumModule.EPDFAnnot_GetIntent(e,0,0);if(0===t)return;const n=2*(t+1),o=this.memoryManager.malloc(n);this.pdfiumModule.EPDFAnnot_GetIntent(e,o,n);const r=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),r&&"undefined"!==r?r:void 0}setAnnotIntent(e,t){return this.pdfiumModule.EPDFAnnot_SetIntent(e,t)}getAnnotRichContent(e){const t=this.pdfiumModule.EPDFAnnot_GetRichContent(e,0,0);if(0===t)return;const n=2*(t+1),o=this.memoryManager.malloc(n);this.pdfiumModule.EPDFAnnot_GetRichContent(e,o,n);const r=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),r||void 0}getAnnotationByName(e,t){return this.withWString(t,t=>this.pdfiumModule.EPDFPage_GetAnnotByName(e,t))}removeAnnotationByName(e,t){return this.withWString(t,t=>this.pdfiumModule.EPDFPage_RemoveAnnotByName(e,t))}setAnnotString(e,t,n){return this.withWString(n,n=>this.pdfiumModule.FPDFAnnot_SetStringValue(e,t,n))}setAttachmentString(e,t,n){return this.withWString(n,n=>this.pdfiumModule.FPDFAttachment_SetStringValue(e,t,n))}readPdfAnnoVertices(e,t){const n=[],o=this.pdfiumModule.FPDFAnnot_GetVertices(t,0,0),r=this.memoryManager.malloc(8*o);this.pdfiumModule.FPDFAnnot_GetVertices(t,r,o);for(let t=0;t<o;t++){const o=this.pdfiumModule.pdfium.getValue(r+8*t,"float"),a=this.pdfiumModule.pdfium.getValue(r+8*t+4,"float"),{x:i,y:s}=this.convertPagePointToDevicePoint(e,{x:o,y:a}),l=n[n.length-1];l&&l.x===i&&l.y===s||n.push({x:i,y:s})}return this.memoryManager.free(r),n}setPdfAnnoVertices(e,t,n){const o=this.pdfiumModule.pdfium,r=this.memoryManager.malloc(8*n.length);n.forEach((t,n)=>{const a=this.convertDevicePointToPagePoint(e,t);o.setValue(r+8*n+0,a.x,"float"),o.setValue(r+8*n+4,a.y,"float")});const a=this.pdfiumModule.EPDFAnnot_SetVertices(t,r,n.length);return this.memoryManager.free(r),a}readPdfBookmarkTarget(e,t,n){const o=t();if(o)return{type:"action",action:this.readPdfAction(e,o)};{const t=n();if(t)return{type:"destination",destination:this.readPdfDestination(e,t)}}}readPdfWidgetAnnoField(e,t){const n=this.pdfiumModule.FPDFAnnot_GetFormFieldFlags(e,t),o=this.pdfiumModule.FPDFAnnot_GetFormFieldType(e,t),a=l(this.pdfiumModule.pdfium,(n,o)=>this.pdfiumModule.FPDFAnnot_GetFormFieldName(e,t,n,o),this.pdfiumModule.pdfium.UTF16ToString),i=l(this.pdfiumModule.pdfium,(n,o)=>this.pdfiumModule.FPDFAnnot_GetFormFieldAlternateName(e,t,n,o),this.pdfiumModule.pdfium.UTF16ToString),s=l(this.pdfiumModule.pdfium,(n,o)=>this.pdfiumModule.FPDFAnnot_GetFormFieldValue(e,t,n,o),this.pdfiumModule.pdfium.UTF16ToString),d=[];if(o===r.y.COMBOBOX||o===r.y.LISTBOX){const n=this.pdfiumModule.FPDFAnnot_GetOptionCount(e,t);for(let o=0;o<n;o++){const n=l(this.pdfiumModule.pdfium,(n,r)=>this.pdfiumModule.FPDFAnnot_GetOptionLabel(e,t,o,n,r),this.pdfiumModule.pdfium.UTF16ToString),r=this.pdfiumModule.FPDFAnnot_IsOptionSelected(e,t,o);d.push({label:n,isSelected:r})}}let c=!1;return o!==r.y.CHECKBOX&&o!==r.y.RADIOBUTTON||(c=this.pdfiumModule.FPDFAnnot_IsChecked(e,t)),{flag:n,type:o,name:a,alternateName:i,value:s,isChecked:c,options:d}}renderPageAnnotationRaw(e,t,n,o){const{scaleFactor:a=1,rotation:i=r.R.Degree0,dpr:s=1,mode:l=r.A.Normal}=o??{};this.logger.debug(x,A,"renderPageAnnotation",e,t,n,o),this.logger.perf(x,A,"RenderPageAnnotation","Begin",`${e.id}-${t.index}-${n.id}`);const d=new r.T,c=this.cache.getContext(e.id);if(!c)return this.logger.perf(x,A,"RenderPageAnnotation","End",`${e.id}-${t.index}-${n.id}`),r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const u=c.acquirePage(t.index),m=this.getAnnotationByName(u.pagePtr,n.id);if(!m)return this.logger.perf(x,A,"RenderPageAnnotation","End",`${e.id}-${t.index}-${n.id}`),u.release(),r.a.reject({code:r.P.NotFound,message:"annotation not found"});const p=Math.max(.01,a*s),h=(0,r.z)(n.rect),g=(0,r.z)((0,r.B)(t.size,h,i,p)),f=Math.max(1,g.size.width),F=Math.max(1,g.size.height),P=4*f,b=P*F,_=this.memoryManager.malloc(b),v=this.pdfiumModule.FPDFBitmap_CreateEx(f,F,4,_,P);this.pdfiumModule.FPDFBitmap_FillRect(v,0,0,f,F,0);const y=(0,r.C)(h,i,f,F),D=this.memoryManager.malloc(24);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,D,6).set([y.a,y.b,y.c,y.d,y.e,y.f]);let w=!1;try{w=!!this.pdfiumModule.EPDF_RenderAnnotBitmap(v,u.pagePtr,m,l,D,16)}finally{this.memoryManager.free(D),this.pdfiumModule.FPDFBitmap_Destroy(v),this.pdfiumModule.FPDFPage_CloseAnnot(m),u.release()}if(!w)return this.memoryManager.free(_),this.logger.perf(x,A,"RenderPageAnnotation","End",`${e.id}-${t.index}-${n.id}`),r.a.reject({code:r.P.Unknown,message:"EPDF_RenderAnnotBitmap failed"});const S=this.pdfiumModule.pdfium.HEAPU8.subarray(_,_+b),E={data:new Uint8ClampedArray(S),width:f,height:F};return d.resolve(E),this.memoryManager.free(_),d}renderRectEncoded(e,t,n,o){const a=new r.T,i=(null==o?void 0:o.rotation)??r.R.Degree0,s=this.cache.getContext(e.id);if(!s)return r.a.reject({code:r.P.DocNotOpen,message:"document does not open"});const l=Math.max(.01,(null==o?void 0:o.scaleFactor)??1)*Math.max(1,(null==o?void 0:o.dpr)??1),d=n.size.width,c=n.size.height,u=!(1&~i),m=Math.max(1,Math.round((u?c:d)*l)),p=Math.max(1,Math.round((u?d:c)*l)),h=4*m,g=h*p,f=s.acquirePage(t.index),F=(null==o?void 0:o.withForms)?f.getFormHandle():void 0,P=this.memoryManager.malloc(g),b=this.pdfiumModule.FPDFBitmap_CreateEx(m,p,4,P,h);this.pdfiumModule.FPDFBitmap_FillRect(b,0,0,m,p,4294967295);const _=(0,r.C)(n,i,m,p),v=this.memoryManager.malloc(24);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,v,6).set([_.a,_.b,_.c,_.d,_.e,_.f]);const y=this.memoryManager.malloc(16);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,y,4).set([0,0,m,p]);let D=16;(null==o?void 0:o.withAnnotations)&&(D|=1);try{if(this.pdfiumModule.FPDF_RenderPageBitmapWithMatrix(b,f.pagePtr,v,y,D),void 0!==F){const e=function(e,t,n,o){const a=t.origin.x,i=t.origin.y,s=a+t.size.width,l=i+t.size.height,d=n.width,c=n.height,u=Math.hypot(e.a,e.b),m=Math.hypot(e.c,e.d),p=!(1&~o),h=p?Math.max(1,Math.round(c*u)):Math.max(1,Math.round(d*u)),g=p?Math.max(1,Math.round(d*m)):Math.max(1,Math.round(c*m));let f,F;switch(o){case r.R.Degree0:f=-Math.round(a*u),F=-Math.round(i*m);break;case r.R.Degree90:f=Math.round((l-c)*u),F=-Math.round(a*m);break;case r.R.Degree180:f=Math.round((s-d)*u),F=Math.round((l-c)*m);break;case r.R.Degree270:f=-Math.round(i*u),F=Math.round((s-d)*m);break;default:f=-Math.round(a*u),F=-Math.round(i*m)}return{startX:f,startY:F,formsWidth:h,formsHeight:g,scaleX:u,scaleY:m}}(_,n,t.size,i),{startX:o,startY:a,formsWidth:s,formsHeight:l,scaleX:d,scaleY:c}=e;this.pdfiumModule.FPDF_FFLDraw(F,b,f.pagePtr,o,a,s,l,i,D)}}finally{f.release(),this.memoryManager.free(v),this.memoryManager.free(y)}this.logger.perf(x,A,"RenderRectEncodedData","Begin",`${e.id}-${t.index}`);const w=this.pdfiumModule.pdfium.HEAPU8.subarray(P,P+g);this.logger.perf(x,A,"RenderRectEncodedData","End",`${e.id}-${t.index}`),this.logger.perf(x,A,"RenderRectEncodedImageData","Begin",`${e.id}-${t.index}`);const S={data:new Uint8ClampedArray(w),width:m,height:p};return this.logger.perf(x,A,"RenderRectEncodedImageData","End",`${e.id}-${t.index}`),a.resolve(S),this.pdfiumModule.FPDFBitmap_Destroy(b),this.memoryManager.free(P),a}readPdfLinkAnnoTarget(e,t,n){const o=n();if(o)return{type:"destination",destination:this.readPdfDestination(e,o)};{const n=t();if(n)return{type:"action",action:this.readPdfAction(e,n)}}}createLocalDestPtr(e,t){var n,o;const a=this.pdfiumModule.FPDF_LoadPage(e,t.pageIndex);if(!a)return 0;try{if(t.zoom.mode===r.D.XYZ){const{x:e,y:n,zoom:o}=t.zoom.params;return this.pdfiumModule.EPDFDest_CreateXYZ(a,!0,e,!0,n,!0,o)}let e,i=[];switch(t.zoom.mode){case r.D.FitPage:e=r.D.FitPage;break;case r.D.FitHorizontal:e=r.D.FitHorizontal,i=[(null==(n=t.view)?void 0:n[0])??0];break;case r.D.FitVertical:e=r.D.FitVertical,i=[(null==(o=t.view)?void 0:o[0])??0];break;case r.D.FitRectangle:{const n=t.view??[];i=[n[0]??0,n[1]??0,n[2]??0,n[3]??0],e=r.D.FitRectangle}break;case r.D.Unknown:default:return 0}return this.withFloatArray(i,(t,n)=>this.pdfiumModule.EPDFDest_CreateView(a,e,t,n))}finally{this.pdfiumModule.FPDF_ClosePage(a)}}applyBookmarkTarget(e,t,n){if("destination"===n.type){const o=this.createLocalDestPtr(e,n.destination);return!!o&&!!this.pdfiumModule.EPDFBookmark_SetDest(e,t,o)}const o=n.action;switch(o.type){case r.E.Goto:{const n=this.createLocalDestPtr(e,o.destination);if(!n)return!1;const r=this.pdfiumModule.EPDFAction_CreateGoTo(e,n);return!!r&&!!this.pdfiumModule.EPDFBookmark_SetAction(e,t,r)}case r.E.URI:{const n=this.pdfiumModule.EPDFAction_CreateURI(e,o.uri);return!!n&&!!this.pdfiumModule.EPDFBookmark_SetAction(e,t,n)}case r.E.LaunchAppOrOpenFile:{const n=this.withWString(o.path,t=>this.pdfiumModule.EPDFAction_CreateLaunch(e,t));return!!n&&!!this.pdfiumModule.EPDFBookmark_SetAction(e,t,n)}case r.E.RemoteGoto:case r.E.Unsupported:default:return!1}}readPdfAction(e,t){let n;switch(this.pdfiumModule.FPDFAction_GetType(t)){case r.E.Unsupported:n={type:r.E.Unsupported};break;case r.E.Goto:{const o=this.pdfiumModule.FPDFAction_GetDest(e,t);if(o){const t=this.readPdfDestination(e,o);n={type:r.E.Goto,destination:t}}else n={type:r.E.Unsupported}}break;case r.E.RemoteGoto:n={type:r.E.Unsupported};break;case r.E.URI:{const o=l(this.pdfiumModule.pdfium,(n,o)=>this.pdfiumModule.FPDFAction_GetURIPath(e,t,n,o),this.pdfiumModule.pdfium.UTF8ToString);n={type:r.E.URI,uri:o}}break;case r.E.LaunchAppOrOpenFile:{const e=l(this.pdfiumModule.pdfium,(e,n)=>this.pdfiumModule.FPDFAction_GetFilePath(t,e,n),this.pdfiumModule.pdfium.UTF8ToString);n={type:r.E.LaunchAppOrOpenFile,path:e}}}return n}readPdfDestination(e,t){const n=this.pdfiumModule.FPDFDest_GetDestPageIndex(e,t),o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(16),i=this.pdfiumModule.FPDFDest_GetView(t,o,a),s=this.pdfiumModule.pdfium.getValue(o,"i32"),l=[];for(let e=0;e<s;e++){const t=a+4*e;l.push(this.pdfiumModule.pdfium.getValue(t,"float"))}if(this.memoryManager.free(o),this.memoryManager.free(a),i===r.D.XYZ){const e=this.memoryManager.malloc(1),o=this.memoryManager.malloc(1),r=this.memoryManager.malloc(1),a=this.memoryManager.malloc(4),s=this.memoryManager.malloc(4),d=this.memoryManager.malloc(4);if(this.pdfiumModule.FPDFDest_GetLocationInPage(t,e,o,r,a,s,d)){const t=this.pdfiumModule.pdfium.getValue(e,"i8"),c=this.pdfiumModule.pdfium.getValue(o,"i8"),u=this.pdfiumModule.pdfium.getValue(r,"i8"),m=t?this.pdfiumModule.pdfium.getValue(a,"float"):0,p=c?this.pdfiumModule.pdfium.getValue(s,"float"):0,h=u?this.pdfiumModule.pdfium.getValue(d,"float"):0;return this.memoryManager.free(e),this.memoryManager.free(o),this.memoryManager.free(r),this.memoryManager.free(a),this.memoryManager.free(s),this.memoryManager.free(d),{pageIndex:n,zoom:{mode:i,params:{x:m,y:p,zoom:h}},view:l}}return this.memoryManager.free(e),this.memoryManager.free(o),this.memoryManager.free(r),this.memoryManager.free(a),this.memoryManager.free(s),this.memoryManager.free(d),{pageIndex:n,zoom:{mode:i,params:{x:0,y:0,zoom:0}},view:l}}return{pageIndex:n,zoom:{mode:i},view:l}}readPdfAttachment(e,t){const n=this.pdfiumModule.FPDFDoc_GetAttachment(e,t),o=l(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFAttachment_GetName(n,e,t),this.pdfiumModule.pdfium.UTF16ToString),r=l(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.EPDFAttachment_GetDescription(n,e,t),this.pdfiumModule.pdfium.UTF16ToString),a=l(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFAttachment_GetSubtype(n,e,t),this.pdfiumModule.pdfium.UTF16ToString),i=this.getAttachmentDate(n,"CreationDate"),s=l(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFAttachment_GetStringValue(n,"Checksum",e,t),this.pdfiumModule.pdfium.UTF16ToString);return{index:t,name:o,description:r,mimeType:a,size:this.getAttachmentNumber(n,"Size"),creationDate:i,checksum:s}}convertDevicePointToPagePoint(e,t){const n=e.size.width,o=e.size.height,r=3&e.rotation;return 0===r?{x:t.x,y:o-t.y}:1===r?{x:t.y,y:t.x}:2===r?{x:n-t.x,y:t.y}:{x:o-t.y,y:n-t.x}}convertPagePointToDevicePoint(e,t){const n=e.size.width,o=e.size.height,r=3&e.rotation;return 0===r?{x:t.x,y:o-t.y}:1===r?{x:t.y,y:t.x}:2===r?{x:n-t.x,y:t.y}:{x:n-t.y,y:o-t.x}}convertPageRectToDeviceRect(e,t){const{x:n,y:o}=this.convertPagePointToDevicePoint(e,{x:t.left,y:t.top});return{origin:{x:n,y:o},size:{width:Math.abs(t.right-t.left),height:Math.abs(t.top-t.bottom)}}}readPageAnnoAppearanceStreams(e){return{normal:this.readPageAnnoAppearanceStream(e,r.A.Normal),rollover:this.readPageAnnoAppearanceStream(e,r.A.Rollover),down:this.readPageAnnoAppearanceStream(e,r.A.Down)}}readPageAnnoAppearanceStream(e,t=r.A.Normal){const n=2*(this.pdfiumModule.FPDFAnnot_GetAP(e,t,0,0)+1),o=this.memoryManager.malloc(n);this.pdfiumModule.FPDFAnnot_GetAP(e,t,o,n);const a=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),a}setPageAnnoAppearanceStream(e,t=r.A.Normal,n){const o=2*(n.length+1),a=this.memoryManager.malloc(o);try{return this.pdfiumModule.pdfium.stringToUTF16(n,a,o),!!this.pdfiumModule.FPDFAnnot_SetAP(e,t,a)}finally{this.memoryManager.free(a)}}setPageAnnoRect(e,t,n){const o=Math.floor(n.origin.x),r=Math.floor(n.origin.y),a=Math.floor(n.origin.x+n.size.width),i=Math.floor(n.origin.y+n.size.height),s=this.convertDevicePointToPagePoint(e,{x:o,y:r}),l=this.convertDevicePointToPagePoint(e,{x:a,y:r}),d=this.convertDevicePointToPagePoint(e,{x:a,y:i}),c=this.convertDevicePointToPagePoint(e,{x:o,y:i});let u=Math.min(s.x,l.x,d.x,c.x),m=Math.max(s.x,l.x,d.x,c.x),p=Math.min(s.y,l.y,d.y,c.y),h=Math.max(s.y,l.y,d.y,c.y);u>m&&([u,m]=[m,u]),p>h&&([p,h]=[h,p]);const g=this.memoryManager.malloc(16),f=this.pdfiumModule.pdfium;f.setValue(g+0,u,"float"),f.setValue(g+4,h,"float"),f.setValue(g+8,m,"float"),f.setValue(g+12,p,"float");const F=this.pdfiumModule.FPDFAnnot_SetRect(t,g);return this.memoryManager.free(g),!!F}readPageAnnoRect(e){const t=this.memoryManager.malloc(16),n={left:0,top:0,right:0,bottom:0};return this.pdfiumModule.FPDFAnnot_GetRect(e,t)&&(n.left=this.pdfiumModule.pdfium.getValue(t,"float"),n.top=this.pdfiumModule.pdfium.getValue(t+4,"float"),n.right=this.pdfiumModule.pdfium.getValue(t+8,"float"),n.bottom=this.pdfiumModule.pdfium.getValue(t+12,"float")),this.memoryManager.free(t),n}getHighlightRects(e,t,n,o){const r=this.pdfiumModule.FPDFText_CountRects(t,n,o),a=[],i=this.memoryManager.malloc(8),s=this.memoryManager.malloc(8),l=this.memoryManager.malloc(8),d=this.memoryManager.malloc(8);for(let n=0;n<r;n++){if(!this.pdfiumModule.FPDFText_GetRect(t,n,i,s,l,d))continue;const o=this.pdfiumModule.pdfium.getValue(i,"double"),r=this.pdfiumModule.pdfium.getValue(s,"double"),c=this.pdfiumModule.pdfium.getValue(l,"double"),u=this.pdfiumModule.pdfium.getValue(d,"double"),m=this.convertPagePointToDevicePoint(e,{x:o,y:r}),p=this.convertPagePointToDevicePoint(e,{x:c,y:r}),h=this.convertPagePointToDevicePoint(e,{x:c,y:u}),g=this.convertPagePointToDevicePoint(e,{x:o,y:u}),f=[m.x,p.x,h.x,g.x],F=[m.y,p.y,h.y,g.y],P=Math.min(...f),b=Math.min(...F),_=Math.max(...f)-P,v=Math.max(...F)-b;a.push({origin:{x:P,y:b},size:{width:Math.ceil(_),height:Math.ceil(v)}})}return this.memoryManager.free(i),this.memoryManager.free(s),this.memoryManager.free(l),this.memoryManager.free(d),a}searchInPage(e,t,n,o){this.logger.debug(x,A,"searchInPage",e,t,n,o),this.logger.perf(x,A,"SearchInPage","Begin",`${e.id}-${t.index}`);const a=this.cache.getContext(e.id);if(!a)return this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"Document is not open"});const i=2*(n.length+1),s=this.memoryManager.malloc(i);this.pdfiumModule.pdfium.stringToUTF16(n,s,i);try{const e=this.searchAllInPage(a,t,s,o);return r.a.resolve(e)}finally{this.memoryManager.free(s)}}getAnnotationsBatch(e,t){this.logger.debug(x,A,"getAnnotationsBatch",e.id,t.length);const n=new r.T;return queueMicrotask(()=>{this.logger.perf(x,A,"GetAnnotationsBatch","Begin",e.id);const o=this.cache.getContext(e.id);if(!o)return void n.reject({code:r.P.DocNotOpen,message:"Document is not open"});const a={},i=t.length;for(let e=0;e<t.length;e++){const r=t[e],s=this.readPageAnnotationsRaw(o,r);a[r.index]=s,n.progress({pageIndex:r.index,result:s,completed:e+1,total:i})}this.logger.perf(x,A,"GetAnnotationsBatch","End",e.id),n.resolve(a)}),n}searchBatch(e,t,n,o){this.logger.debug(x,A,"searchBatch",e.id,t.length,n);const a=new r.T;return queueMicrotask(()=>{this.logger.perf(x,A,"SearchBatch","Begin",e.id);const i=this.cache.getContext(e.id);if(!i)return void a.reject({code:r.P.DocNotOpen,message:"Document is not open"});const s=2*(n.length+1),l=this.memoryManager.malloc(s);this.pdfiumModule.pdfium.stringToUTF16(n,l,s);try{const n={},r=t.length;for(let e=0;e<t.length;e++){const s=t[e],d=this.searchAllInPage(i,s,l,o);n[s.index]=d,a.progress({pageIndex:s.index,result:d,completed:e+1,total:r})}this.logger.perf(x,A,"SearchBatch","End",e.id),a.resolve(n)}finally{this.memoryManager.free(l)}}),a}buildContext(e,t,n,o=30){const r=/[\s\u00A0.,;:!?()\[\]{}<>/\\\-"'`"”\u2013\u2014]/;let a=t;for(;a>0&&r.test(e[a-1]);)a--;let i=0;for(;a>0&&i<o;)a--,r.test(e[a])||i++;a=(t=>{for(;t>0&&!r.test(e[t-1]);)t--;return t})(a);let s=t+n;for(;s<e.length&&r.test(e[s]);)s++;for(i=0;s<e.length&&i<o;)r.test(e[s])||i++,s++;s=(t=>{for(;t<e.length&&!r.test(e[t]);)t++;return t})(s);const l=e.slice(a,t).replace(/\s+/g," ").trimStart(),d=e.slice(t,t+n),c=e.slice(t+n,s).replace(/\s+/g," ").trimEnd();return{before:this.tidy(l),match:this.tidy(d),after:this.tidy(c),truncatedLeft:a>0,truncatedRight:s<e.length}}tidy(e){return e.replace(/-\uFFFE\s*/g,"").replace(/[\uFFFE\u00AD\u200B\u2060\uFEFF]/g,"").replace(/\s+/g," ")}searchAllInPage(e,t,n,o){return e.borrowPage(t.index,e=>{const r=e.getTextPage(),a=this.pdfiumModule.FPDFText_CountChars(r),i=this.memoryManager.malloc(2*(a+1));this.pdfiumModule.FPDFText_GetText(r,0,a,i);const s=this.pdfiumModule.pdfium.UTF16ToString(i);this.memoryManager.free(i);const l=[],d=this.pdfiumModule.FPDFText_FindStart(r,n,o,0);for(;this.pdfiumModule.FPDFText_FindNext(d);){const e=this.pdfiumModule.FPDFText_GetSchResultIndex(d),n=this.pdfiumModule.FPDFText_GetSchCount(d),o=this.getHighlightRects(t,r,e,n),a=this.buildContext(s,e,n);l.push({pageIndex:t.index,charIndex:e,charCount:n,rects:o,context:a})}return this.pdfiumModule.FPDFText_FindClose(d),l})}preparePrintDocument(e,t){const{includeAnnotations:n=!0,pageRange:o=null}=t??{};this.logger.debug(x,A,"preparePrintDocument",e,t),this.logger.perf(x,A,"PreparePrintDocument","Begin",e.id);const a=this.cache.getContext(e.id);if(!a)return this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.reject({code:r.P.DocNotOpen,message:"Document is not open"});const i=this.pdfiumModule.FPDF_CreateNewDocument();if(!i)return this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.reject({code:r.P.CantCreateNewDoc,message:"Cannot create print document"});try{const t=this.sanitizePageRange(o,e.pageCount);if(!this.pdfiumModule.FPDF_ImportPages(i,a.docPtr,t??"",0))return this.pdfiumModule.FPDF_CloseDocument(i),this.logger.error(x,A,"Failed to import pages for printing"),this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.reject({code:r.P.CantImportPages,message:"Failed to import pages for printing"});if(!n){const t=this.removeAnnotationsFromPrintDocument(i);if(!t.success)return this.pdfiumModule.FPDF_CloseDocument(i),this.logger.error(x,A,`Failed to remove annotations: ${t.error}`),this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.reject({code:r.P.Unknown,message:`Failed to prepare print document: ${t.error}`});this.logger.debug(x,A,`Removed ${t.annotationsRemoved} annotations from ${t.pagesProcessed} pages`)}const s=this.saveDocument(i);return this.pdfiumModule.FPDF_CloseDocument(i),this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.resolve(s)}catch(t){return i&&this.pdfiumModule.FPDF_CloseDocument(i),this.logger.error(x,A,"preparePrintDocument failed",t),this.logger.perf(x,A,"PreparePrintDocument","End",e.id),r.a.reject({code:r.P.Unknown,message:t instanceof Error?t.message:"Failed to prepare print document"})}}removeAnnotationsFromPrintDocument(e){let t=0,n=0;try{const o=this.pdfiumModule.FPDF_GetPageCount(e);for(let r=0;r<o;r++){const o=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(e,r);if(o<=0){n++;continue}let a=0;for(let n=o-1;n>=0;n--)this.pdfiumModule.EPDFPage_RemoveAnnotRaw(e,r,n)?(a++,t++):this.logger.warn(x,A,`Failed to remove annotation ${n} from page ${r}`);if(a>0){const t=this.pdfiumModule.FPDF_LoadPage(e,r);t&&(this.pdfiumModule.FPDFPage_GenerateContent(t),this.pdfiumModule.FPDF_ClosePage(t))}n++}return{success:!0,annotationsRemoved:t,pagesProcessed:n}}catch(e){return{success:!1,annotationsRemoved:t,pagesProcessed:n,error:e instanceof Error?e.message:"Unknown error during annotation removal"}}}sanitizePageRange(e,t){if(!e||""===e.trim())return null;try{const n=[],o=e.split(",");for(const e of o){const o=e.trim();if(o.includes("-")){const[e,r]=o.split("-").map(e=>e.trim()),a=parseInt(e,10),i=parseInt(r,10);if(isNaN(a)||isNaN(i)){this.logger.warn(x,A,`Invalid range: ${o}`);continue}const s=Math.max(1,Math.min(a,t)),l=Math.max(1,Math.min(i,t));for(let e=s;e<=l;e++)n.includes(e)||n.push(e)}else{const e=parseInt(o,10);if(isNaN(e)){this.logger.warn(x,A,`Invalid page number: ${o}`);continue}const r=Math.max(1,Math.min(e,t));n.includes(r)||n.push(r)}}if(0===n.length)return this.logger.warn(x,A,"No valid pages in range, using all pages"),null;n.sort((e,t)=>e-t);const r=[];let a=n[0],i=n[0];for(let e=1;e<n.length;e++)n[e]===i+1||(a===i?r.push(a.toString()):i-a===1?(r.push(a.toString()),r.push(i.toString())):r.push(`${a}-${i}`),a=n[e]),i=n[e];a===i?r.push(a.toString()):i-a===1?(r.push(a.toString()),r.push(i.toString())):r.push(`${a}-${i}`);const s=r.join(",");return this.logger.debug(x,A,`Sanitized page range: "${e}" -> "${s}"`),s}catch(e){return this.logger.error(x,A,`Error sanitizing page range: ${e}`),null}}}async function S(e,t){const n=await fetch(e),o=await n.arrayBuffer(),r=await async function(e){return async function(e){const t={pdfium:e};for(const n in s){const o=n,r=s[o][0],a=s[o][1];t[o]=e.cwrap(n,a,r)}return t}(await i(e))}({wasmBinary:o}),l=new w(r,{logger:null==t?void 0:t.logger,fontFallback:null==t?void 0:t.fontFallback});return new a.P(l,{imageConverter:a.b,logger:null==t?void 0:t.logger})}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.m=e,n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href;const o=globalThis.process?.env?.NODE_ENV,r=o&&!o.toLowerCase().startsWith("prod");var a=Array.isArray,i=Array.prototype.indexOf,s=Array.from,l=Object.keys,d=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u=(Object.getOwnPropertyDescriptors,Object.prototype),m=Array.prototype,p=Object.getPrototypeOf,h=Object.isExtensible;function g(){var e,t;return{promise:new Promise((n,o)=>{e=n,t=o}),resolve:e,reject:t}}const f=16,F=512,P=1024,b=2048,_=4096,v=8192,y=16384,D=32768,x=65536,A=1<<17,w=1<<18,S=1<<19,E=32768,C=1<<21,M=1<<23,k=Symbol("$state"),T=Symbol("legacy props"),I=(Symbol(""),Symbol("proxy path")),O=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function R(e){if(r){const t=new Error(`lifecycle_outside_component\n\`${e}(...)\` can only be used during component initialisation\nhttps://svelte.dev/e/lifecycle_outside_component`);throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/lifecycle_outside_component")}const G="[!",L={},N=Symbol(),z=Symbol("filename");Symbol("hmr");var j="font-weight: bold",B="font-weight: normal";function $(e){r?console.warn(`%c[svelte] hydration_mismatch\n%c${e?`Hydration failed because the initial UI does not match what was rendered on the server. The error occurred near ${e}`:"Hydration failed because the initial UI does not match what was rendered on the server"}\nhttps://svelte.dev/e/hydration_mismatch`,j,B):console.warn("https://svelte.dev/e/hydration_mismatch")}function U(e){r?console.warn(`%c[svelte] state_proxy_equality_mismatch\n%cReactive \`$state(...)\` proxies and the values they proxy have different identities. Because of this, comparisons with \`${e}\` will produce unexpected results\nhttps://svelte.dev/e/state_proxy_equality_mismatch`,j,B):console.warn("https://svelte.dev/e/state_proxy_equality_mismatch")}let W,H=!1;function V(e){H=e}function Y(e){if(null===e)throw $(),L;return W=e}function q(){return Y(Pt(W))}function K(e){if(H){if(null!==Pt(W))throw $(),L;W=e}}function X(e=!0){for(var t=0,n=W;;){if(8===n.nodeType){var o=n.data;if("]"===o){if(0===t)return n;t-=1}else"["!==o&&o!==G||(t+=1)}var r=Pt(n);e&&n.remove(),n=r}}function Z(e){return e===this.v}function Q(e){return t=e,n=this.v,!(t!=t?n==n:t!==n||null!==t&&"object"==typeof t||"function"==typeof t);var t,n}let J=!1,ee=!1,te=null;function ne(e,t){return e.label=t,oe(e.v,t),e}function oe(e,t){return e?.[I]?.(t),e}function re(e){const t=new Error,n=function(){const e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;const t=(new Error).stack;if(Error.stackTraceLimit=e,!t)return[];const n=t.split("\n"),o=[];for(let e=0;e<n.length;e++){const t=n[e],r=t.replaceAll("\\","/");if("Error"!==t.trim()){if(t.includes("validate_each_keys"))return[];r.includes("svelte/src/internal")||r.includes("node_modules/.vite")||o.push(t)}}return o}();return 0===n.length?null:(n.unshift("\n"),d(t,"stack",{value:n.join("\n")}),d(t,"name",{value:e}),t)}let ae=null;function ie(e){ae=e}let se=null;function le(e){se=e}let de=null;function ce(e){de=e}function ue(e,t=!1,n){ae={p:ae,i:!1,c:null,e:null,s:e,x:null,l:null},r&&(ae.function=n,de=n)}function me(e){var t=ae,n=t.e;if(null!==n)for(var o of(t.e=null,n))At(o);return void 0!==e&&(t.x=e),t.i=!0,ae=t.p,r&&(de=ae?.function??null),e??{}}let pe=[];function he(){var e=pe;pe=[],function(e){for(var t=0;t<e.length;t++)e[t]()}(e)}function ge(e){if(0===pe.length&&!Ee){var t=pe;queueMicrotask(()=>{t===pe&&he()})}pe.push(e)}function fe(){for(;pe.length>0;)he()}const Fe=new WeakMap;function Pe(e){var t=qt;if(null===t)return Ht.f|=M,e;if(r&&e instanceof Error&&!Fe.has(e)&&Fe.set(e,function(e,t){const n=c(e,"message");if(!n||n.configurable){for(var o=mt?"  ":"\t",r=`\n${o}in ${t.fn?.name||"<unknown>"}`,a=t.ctx;null!==a;)r+=`\n${o}in ${a.function?.[z].split("/").pop()}`,a=a.p;return{message:e.message+`\n${r}\n`,stack:e.stack?.split("\n").filter(e=>!e.includes("svelte/src/internal")).join("\n")}}}(e,t)),0===(t.f&D)){if(!(128&t.f))throw r&&!t.parent&&e instanceof Error&&_e(e),e;t.b.error(e)}else be(e,t)}function be(e,t){for(;null!==t;){if(128&t.f)try{return void t.b.error(e)}catch(t){e=t}t=t.parent}throw r&&e instanceof Error&&_e(e),e}function _e(e){const t=Fe.get(e);t&&(d(e,"message",{value:t.message}),d(e,"stack",{value:t.stack}))}const ve=new Set;let ye=null,De=null,xe=null,Ae=[],we=null,Se=!1,Ee=!1;class Ce{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#o=0;#r=null;#a=new Set;#i=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#o>0}process(e){Ae=[],De=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[]};for(const n of e)this.#s(n,t);this.is_fork||this.#l(),this.is_deferred()?(this.#d(t.effects),this.#d(t.render_effects)):(De=this,ye=null,Ie(t.render_effects),Ie(t.effects),De=null,this.#r?.resolve()),xe=null}#s(e,t){e.f^=P;for(var n=e.first;null!==n;){var o=n.f,r=!!(96&o),a=r&&0!==(o&P)||0!==(o&v)||this.skipped_effects.has(n);if(!!(128&n.f)&&n.b?.is_pending()&&(t={parent:t,effect:n,effects:[],render_effects:[]}),!a&&null!==n.fn){r?n.f^=P:4&o?t.effects.push(n):sn(n)&&(0!==(n.f&f)&&this.#a.add(n),mn(n));var i=n.first;if(null!==i){n=i;continue}}var s=n.parent;for(n=n.next;null===n&&null!==s;)s===t.effect&&(this.#d(t.effects),this.#d(t.render_effects),t=t.parent),n=s.next,s=s.parent}}#d(e){for(const t of e)0!==(t.f&b)?this.#a.add(t):0!==(t.f&_)&&this.#i.add(t),this.#c(t.deps),Pn(t,P)}#c(e){if(null!==e)for(const t of e)2&t.f&&0!==(t.f&E)&&(t.f^=E,this.#c(t.deps))}capture(e,t){this.previous.has(e)||this.previous.set(e,t),0===(e.f&M)&&(this.current.set(e,e.v),xe?.set(e,e.v))}activate(){ye=this,this.apply()}deactivate(){ye===this&&(ye=null,xe=null)}flush(){if(this.activate(),Ae.length>0){if(Me(),null!==ye&&ye!==this)return}else 0===this.#n&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#l(){if(0===this.#o){for(const e of this.#e)e();this.#e.clear()}0===this.#n&&this.#u()}#u(){if(ve.size>1){this.previous.clear();var e=xe,t=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const e of ve){if(e===this){t=!1;continue}const r=[];for(const[n,o]of this.current){if(e.current.has(n)){if(!t||o===e.current.get(n))continue;e.current.set(n,o)}r.push(n)}if(0===r.length)continue;const a=[...e.current.keys()].filter(e=>!this.current.has(e));if(a.length>0){var o=Ae;Ae=[];const t=new Set,i=new Map;for(const e of r)Oe(e,a,t,i);if(Ae.length>0){ye=e,e.apply();for(const t of Ae)e.#s(t,n);e.deactivate()}Ae=o}}ye=null,xe=e}this.committed=!0,ve.delete(this)}increment(e){this.#n+=1,e&&(this.#o+=1)}decrement(e){this.#n-=1,e&&(this.#o-=1),this.revive()}revive(){for(const e of this.#a)this.#i.delete(e),Pn(e,b),Ge(e);for(const e of this.#i)Pn(e,_),Ge(e);this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#r??=g()).promise}static ensure(){if(null===ye){const e=ye=new Ce;ve.add(ye),Ee||Ce.enqueue(()=>{ye===e&&e.flush()})}return ye}static enqueue(e){ge(e)}apply(){J}}function Me(){var e=Bt;Se=!0;var t=r?new Set:null;try{var n=0;for($t(!0);Ae.length>0;){var o=Ce.ensure();if(n++>1e3){if(r){var a=new Map;for(const e of o.current.keys())for(const[t,n]of e.updated??[]){var i=a.get(t);i||(i={error:n.error,count:0},a.set(t,i)),i.count+=n.count}for(const e of a.values())e.error&&console.error(e.error)}ke()}if(o.process(Ae),Xe.clear(),r)for(const e of o.current.keys())t.add(e)}}finally{if(Se=!1,$t(e),we=null,r)for(const e of t)e.updated=null}}function ke(){try{!function(){if(r){const e=new Error("effect_update_depth_exceeded\nMaximum update depth exceeded. This typically indicates that an effect reads and writes the same piece of state\nhttps://svelte.dev/e/effect_update_depth_exceeded");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(e){r&&d(e,"stack",{value:""}),be(e,we)}}let Te=null;function Ie(e){var t=e.length;if(0!==t){for(var n=0;n<t;){var o=e[n++];if(!(24576&o.f)&&sn(o)&&(Te=new Set,mn(o),null===o.deps&&null===o.first&&null===o.nodes&&(null===o.teardown&&null===o.ac?Ot(o):o.fn=null),Te?.size>0)){Xe.clear();for(const e of Te){if(24576&e.f)continue;const t=[e];let n=e.parent;for(;null!==n;)Te.has(n)&&(Te.delete(n),t.push(n)),n=n.parent;for(let e=t.length-1;e>=0;e--){const n=t[e];24576&n.f||mn(n)}}Te.clear()}}Te=null}}function Oe(e,t,n,o){if(!n.has(e)&&(n.add(e),null!==e.reactions))for(const r of e.reactions){const e=r.f;2&e?Oe(r,t,n,o):4194320&e&&0===(e&b)&&Re(r,t,o)&&(Pn(r,b),Ge(r))}}function Re(e,t,n){const o=n.get(e);if(void 0!==o)return o;if(null!==e.deps)for(const o of e.deps){if(t.includes(o))return!0;if(2&o.f&&Re(o,t,n))return n.set(o,!0),!0}return n.set(e,!1),!1}function Ge(e){for(var t=we=e;null!==t.parent;){var n=(t=t.parent).f;if(Se&&t===qt&&0!==(n&f)&&0===(n&w))return;if(96&n){if(0===(n&P))return;t.f^=P}}Ae.push(t)}class Le{parent;#n=!1;#m;#p=H?W:null;#h;#g;#f;#F=null;#P=null;#b=null;#_=null;#v=null;#y=0;#D=0;#x=!1;#A=null;#w=function(e){let t,n=0,o=Je(0);return r&&ne(o,"createSubscriber version"),()=>{Dt()&&(pn(o),St(()=>(0===n&&(t=fn(()=>e())),n+=1,()=>{ge(()=>{n-=1,0===n&&(t?.(),t=void 0,rt(o))})})))}}(()=>(this.#A=Je(this.#y),r&&ne(this.#A,"$effect.pending()"),()=>{this.#A=null}));constructor(e,t,n){this.#m=e,this.#h=t,this.#g=n,this.parent=qt.b,this.#n=!!this.#h.pending,this.#f=Ct(()=>{if(qt.b=this,H){const e=this.#p;q(),8===e.nodeType&&e.data===G?this.#S():this.#E()}else{var e=this.#C();try{this.#F=Mt(()=>n(e))}catch(e){this.error(e)}this.#D>0?this.#M():this.#n=!1}return()=>{this.#v?.remove()}},589952),H&&(this.#m=W)}#E(){try{this.#F=Mt(()=>this.#g(this.#m))}catch(e){this.error(e)}this.#n=!1}#S(){const e=this.#h.pending;e&&(this.#P=Mt(()=>e(this.#m)),Ce.enqueue(()=>{var e=this.#C();this.#F=this.#k(()=>(Ce.ensure(),Mt(()=>this.#g(e)))),this.#D>0?this.#M():(Rt(this.#P,()=>{this.#P=null}),this.#n=!1)}))}#C(){var e=this.#m;return this.#n&&(this.#v=ft(),this.#m.before(this.#v),e=this.#v),e}is_pending(){return this.#n||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#h.pending}#k(e){var t=qt,n=Ht,o=ae;Kt(this.#f),Yt(this.#f),ie(this.#f.ctx);try{return e()}catch(e){return Pe(e),null}finally{Kt(t),Yt(n),ie(o)}}#M(){const e=this.#h.pending;null!==this.#F&&(this.#_=document.createDocumentFragment(),this.#_.append(this.#v),zt(this.#F,this.#_)),null===this.#P&&(this.#P=Mt(()=>e(this.#m)))}#T(e){this.has_pending_snippet()?(this.#D+=e,0===this.#D&&(this.#n=!1,this.#P&&Rt(this.#P,()=>{this.#P=null}),this.#_&&(this.#m.before(this.#_),this.#_=null))):this.parent&&this.parent.#T(e)}update_pending_count(e){this.#T(e),this.#y+=e,this.#A&&nt(this.#A,this.#y)}get_effect_pending(){return this.#w(),pn(this.#A)}error(e){var t=this.#h.onerror;let n=this.#h.failed;if(this.#x||!t&&!n)throw e;this.#F&&(It(this.#F),this.#F=null),this.#P&&(It(this.#P),this.#P=null),this.#b&&(It(this.#b),this.#b=null),H&&(Y(this.#p),function(e=1){if(H){for(var t=e,n=W;t--;)n=Pt(n);W=n}}(),Y(X()));var o=!1,a=!1;const i=()=>{o?r?console.warn("%c[svelte] svelte_boundary_reset_noop\n%cA `<svelte:boundary>` `reset` function only resets the boundary the first time it is called\nhttps://svelte.dev/e/svelte_boundary_reset_noop",j,B):console.warn("https://svelte.dev/e/svelte_boundary_reset_noop"):(o=!0,a&&function(){if(r){const e=new Error("svelte_boundary_reset_onerror\nA `<svelte:boundary>` `reset` function cannot be called while an error is still being handled\nhttps://svelte.dev/e/svelte_boundary_reset_onerror");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}(),Ce.ensure(),this.#y=0,null!==this.#b&&Rt(this.#b,()=>{this.#b=null}),this.#n=this.has_pending_snippet(),this.#F=this.#k(()=>(this.#x=!1,Mt(()=>this.#g(this.#m)))),this.#D>0?this.#M():this.#n=!1)};var s=Ht;try{Yt(null),a=!0,t?.(e,i),a=!1}catch(e){be(e,this.#f&&this.#f.parent)}finally{Yt(s)}n&&ge(()=>{this.#b=this.#k(()=>{Ce.ensure(),this.#x=!0;try{return Mt(()=>{n(this.#m,()=>e,()=>i)})}catch(e){return be(e,this.#f.parent),null}finally{this.#x=!1}})})}}function Ne(e,t,n,o){const a=Ue;if(0!==n.length||0!==e.length){var i=ye,s=qt,l=function(){var e=qt,t=Ht,n=ae,o=ye;if(r)var a=se;return function(i=!0){Kt(e),Yt(t),ie(n),i&&o?.activate(),r&&(Be(null),le(a))}}();e.length>0?Promise.all(e).then(()=>{l();try{return d()}finally{i?.deactivate(),ze()}}):d()}else o(t.map(a));function d(){Promise.all(n.map(e=>function(e){let t=qt;null===t&&function(){if(r){const e=new Error("async_derived_orphan\nCannot create a `$derived(...)` with an `await` expression outside of an effect tree\nhttps://svelte.dev/e/async_derived_orphan");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/async_derived_orphan")}();var n=t.b,o=void 0,a=Je(N),i=!Ht,s=new Map;return function(e){yt(4718592,e,!0)}(()=>{r&&(je=qt);var t=g();o=t.promise;try{Promise.resolve(e()).then(t.resolve,t.reject).then(()=>{l===ye&&l.committed&&l.deactivate(),ze()})}catch(e){t.reject(e),ze()}r&&(je=null);var l=ye;if(i){var d=!n.is_pending();n.update_pending_count(1),l.increment(d),s.get(l)?.reject(O),s.delete(l),s.set(l,t)}const c=(e,t=void 0)=>{if(je=null,l.activate(),t)t!==O&&(a.f|=M,nt(a,t));else{0!==(a.f&M)&&(a.f^=M),nt(a,e);for(const[e,t]of s){if(s.delete(e),e===l)break;t.reject(O)}}i&&(n.update_pending_count(-1),l.decrement(d))};t.promise.then(c,e=>c(null,e||"unknown"))}),function(){const e=yt(8,null,!1);Pn(e,P),e.teardown=()=>{for(const e of s.values())e.reject(O)}}(),r&&(a.f|=4194304),new Promise(e=>{!function t(n){function r(){n===o?e(a):t(o)}n.then(r,r)}(o)})}(e))).then(e=>{l();try{o([...t.map(a),...e])}catch(e){0===(s.f&y)&&be(e,s)}i?.deactivate(),ze()}).catch(e=>{be(e,s)})}}function ze(){Kt(null),Yt(null),ie(null),r&&(Be(null),le(null))}let je=null;function Be(e){je=e}const $e=new Set;function Ue(e){var t=null!==Ht&&2&Ht.f?Ht:null;null!==qt&&(qt.f|=S);const n={ctx:ae,deps:null,effects:null,equals:Z,f:2050,fn:e,reactions:null,rv:0,v:N,wv:0,parent:t??qt,ac:null};return n}function We(e){const t=Ue(e);return t.equals=Q,t}function He(e){var t=e.effects;if(null!==t){e.effects=null;for(var n=0;n<t.length;n+=1)It(t[n])}}let Ve=[];function Ye(e){var t,n=qt;if(Kt(function(e){for(var t=e.parent;null!==t;){if(!(2&t.f))return 0===(t.f&y)?t:null;t=t.parent}return null}(e)),r){let o=Ke;Ze(new Set);try{Ve.includes(e)&&function(){if(r){const e=new Error("derived_references_self\nA derived value cannot reference itself recursively\nhttps://svelte.dev/e/derived_references_self");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/derived_references_self")}(),Ve.push(e),e.f&=-32769,He(e),t=dn(e)}finally{Kt(n),Ze(o),Ve.pop()}}else try{e.f&=-32769,He(e),t=dn(e)}finally{Kt(n)}return t}function qe(e){var t=Ye(e);e.equals(t)||(ye?.is_fork||(e.v=t),e.wv=an()),Ut||(null!==xe?(Dt()||ye?.is_fork)&&xe.set(e,t):Pn(e,0===(e.f&F)?_:P))}let Ke=new Set;const Xe=new Map;function Ze(e){Ke=e}let Qe=!1;function Je(e,t){var n={f:0,v:e,reactions:null,equals:Z,rv:0,wv:0};return n}function et(e,t){const n=Je(e);return Zt(n),n}function tt(e,t,n=!1){null!==Ht&&(!Vt||0!==(Ht.f&A))&&4325394&Ht.f&&!Xt?.includes(e)&&function(){if(r){const e=new Error("state_unsafe_mutation\nUpdating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/state_unsafe_mutation")}();let o=n?st(t):t;return r&&oe(o,e.label),nt(e,o)}function nt(e,t){if(!e.equals(t)){var n=e.v;Ut?Xe.set(e,t):Xe.set(e,n),e.v=t;var o=Ce.ensure();if(o.capture(e,n),r){if(null!==qt){e.updated??=new Map;const t=(e.updated.get("")?.count??0)+1;if(e.updated.set("",{error:null,count:t}),t>5){const t=re("updated at");if(null!==t){let n=e.updated.get(t.stack);n||(n={error:t,count:0},e.updated.set(t.stack,n)),n.count++}}}null!==qt&&(e.set_during_effect=!0)}2&e.f&&(0!==(e.f&b)&&Ye(e),Pn(e,0!==(e.f&F)?P:_)),e.wv=an(),at(e,b),null===qt||0===(qt.f&P)||96&qt.f||(null===en?function(e){en=e}([e]):en.push(e)),!o.is_fork&&Ke.size>0&&!Qe&&ot()}return t}function ot(){Qe=!1;var e=Bt;$t(!0);const t=Array.from(Ke);try{for(const e of t)0!==(e.f&P)&&Pn(e,_),sn(e)&&mn(e)}finally{$t(e)}Ke.clear()}function rt(e){tt(e,e.v+1)}function at(e,t){var n=e.reactions;if(null!==n)for(var o=n.length,a=0;a<o;a++){var i=n[a],s=i.f;if(r&&0!==(s&A))Ke.add(i);else{var l=0===(s&b);if(l&&Pn(i,t),2&s){var d=i;xe?.delete(d),0===(s&E)&&(s&F&&(i.f|=E),at(d,_))}else l&&(0!==(s&f)&&null!==Te&&Te.add(i),Ge(i))}}}const it=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function st(e){if("object"!=typeof e||null===e||k in e)return e;const t=p(e);if(t!==u&&t!==m)return e;var n=new Map,o=a(e),i=et(0),s=on,l=e=>{if(on===s)return e();var t=Ht,n=on;Yt(null),rn(s);var o=e();return Yt(t),rn(n),o};o&&(n.set("length",et(e.length)),r&&(e=new Proxy(e,{get(e,t,n){var o=Reflect.get(e,t,n);return ct.has(t)?function(...e){Qe=!0;var t=o.apply(this,e);return ot(),t}:o}})));var d="";let h=!1;function g(e){if(!h){h=!0,ne(i,`${d=e} version`);for(const[e,t]of n)ne(t,lt(d,e));h=!1}}return new Proxy(e,{defineProperty(e,t,o){"value"in o&&!1!==o.configurable&&!1!==o.enumerable&&!1!==o.writable||function(){if(r){const e=new Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var a=n.get(t);return void 0===a?a=l(()=>{var e=et(o.value);return n.set(t,e),r&&"string"==typeof t&&ne(e,lt(d,t)),e}):tt(a,o.value,!0),!0},deleteProperty(e,t){var o=n.get(t);if(void 0===o){if(t in e){const e=l(()=>et(N));n.set(t,e),rt(i),r&&ne(e,lt(d,t))}}else tt(o,N),rt(i);return!0},get(t,o,a){if(o===k)return e;if(r&&o===I)return g;var i=n.get(o),s=o in t;if(void 0!==i||s&&!c(t,o)?.writable||(i=l(()=>{var e=et(st(s?t[o]:N));return r&&ne(e,lt(d,o)),e}),n.set(o,i)),void 0!==i){var u=pn(i);return u===N?void 0:u}return Reflect.get(t,o,a)},getOwnPropertyDescriptor(e,t){var o=Reflect.getOwnPropertyDescriptor(e,t);if(o&&"value"in o){var r=n.get(t);r&&(o.value=pn(r))}else if(void 0===o){var a=n.get(t),i=a?.v;if(void 0!==a&&i!==N)return{enumerable:!0,configurable:!0,value:i,writable:!0}}return o},has(e,t){if(t===k)return!0;var o=n.get(t),a=void 0!==o&&o.v!==N||Reflect.has(e,t);return!((void 0!==o||null!==qt&&(!a||c(e,t)?.writable))&&(void 0===o&&(o=l(()=>{var n=et(a?st(e[t]):N);return r&&ne(n,lt(d,t)),n}),n.set(t,o)),pn(o)===N))&&a},set(e,t,a,s){var u=n.get(t),m=t in e;if(o&&"length"===t)for(var p=a;p<u.v;p+=1){var h=n.get(p+"");void 0!==h?tt(h,N):p in e&&(h=l(()=>et(N)),n.set(p+"",h),r&&ne(h,lt(d,p)))}void 0===u?m&&!c(e,t)?.writable||(u=l(()=>et(void 0)),r&&ne(u,lt(d,t)),tt(u,st(a)),n.set(t,u)):(m=u.v!==N,tt(u,l(()=>st(a))));var g=Reflect.getOwnPropertyDescriptor(e,t);if(g?.set&&g.set.call(s,a),!m){if(o&&"string"==typeof t){var f=n.get("length"),F=Number(t);Number.isInteger(F)&&F>=f.v&&tt(f,F+1)}rt(i)}return!0},ownKeys(e){pn(i);var t=Reflect.ownKeys(e).filter(e=>{var t=n.get(e);return void 0===t||t.v!==N});for(var[o,r]of n)r.v===N||o in e||t.push(o);return t},setPrototypeOf(){!function(){if(r){const e=new Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}function lt(e,t){return"symbol"==typeof t?`${e}[Symbol(${t.description??""})]`:it.test(t)?`${e}.${t}`:/^\d+$/.test(t)?`${e}[${t}]`:`${e}['${t}']`}function dt(e){try{if(null!==e&&"object"==typeof e&&k in e)return e[k]}catch{}return e}const ct=new Set(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"]);var ut,mt,pt,ht;function gt(){if(void 0===ut){ut=window,document,mt=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;pt=c(t,"firstChild").get,ht=c(t,"nextSibling").get,h(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),h(n)&&(n.__t=void 0),r&&(e.__svelte_meta=null,function(){const e=Array.prototype,t=Array.__svelte_cleanup;t&&t();const{indexOf:n,lastIndexOf:o,includes:r}=e;e.indexOf=function(e,t){const o=n.call(this,e,t);if(-1===o)for(let n=t??0;n<this.length;n+=1)if(dt(this[n])===e){U("array.indexOf(...)");break}return o},e.lastIndexOf=function(e,t){const n=o.call(this,e,t??this.length-1);if(-1===n)for(let n=0;n<=(t??this.length-1);n+=1)if(dt(this[n])===e){U("array.lastIndexOf(...)");break}return n},e.includes=function(e,t){const n=r.call(this,e,t);if(!n)for(let t=0;t<this.length;t+=1)if(dt(this[t])===e){U("array.includes(...)");break}return n},Array.__svelte_cleanup=()=>{e.indexOf=n,e.lastIndexOf=o,e.includes=r}}())}}function ft(e=""){return document.createTextNode(e)}function Ft(e){return pt.call(e)}function Pt(e){return ht.call(e)}function bt(e,t){if(!H)return Ft(e);var n=Ft(W);if(null===n)n=W.appendChild(ft());else if(t&&3!==n.nodeType){var o=ft();return n?.before(o),Y(o),o}return Y(n),n}function _t(e,t=1,n=!1){let o=H?W:e;for(var r;t--;)r=o,o=Pt(o);if(!H)return o;if(n&&3!==o?.nodeType){var a=ft();return null===o?r?.after(a):o.before(a),Y(a),a}return Y(o),o}function vt(e){var t=Ht,n=qt;Yt(null),Kt(null);try{return e()}finally{Yt(t),Kt(n)}}function yt(e,t,n){var o=qt;if(r)for(;null!==o&&0!==(o.f&A);)o=o.parent;null!==o&&0!==(o.f&v)&&(e|=v);var a={ctx:ae,deps:null,nodes:null,f:e|b|F,first:null,fn:t,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,wv:0,ac:null};if(r&&(a.component_function=de),n)try{mn(a),a.f|=D}catch(i){throw It(a),i}else null!==t&&Ge(a);var i=a;if(n&&null===i.deps&&null===i.teardown&&null===i.nodes&&i.first===i.last&&0===(i.f&S)&&(i=i.first,0!==(e&f)&&0!==(e&x)&&null!==i&&(i.f|=x)),null!==i&&(i.parent=o,null!==o&&function(e,t){var n=t.last;null===n?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}(i,o),null!==Ht&&2&Ht.f&&!(64&e))){var s=Ht;(s.effects??=[]).push(i)}return a}function Dt(){return null!==Ht&&!Vt}function xt(e){var t;t="$effect",null===qt&&(null===Ht&&function(e){if(r){const t=new Error(`effect_orphan\n\`${e}\` can only be used inside an effect (e.g. during component initialisation)\nhttps://svelte.dev/e/effect_orphan`);throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/effect_orphan")}(t),function(){if(r){const e=new Error("effect_in_unowned_derived\nEffect cannot be created inside a `$derived` value that was not itself created inside an effect\nhttps://svelte.dev/e/effect_in_unowned_derived");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}()),Ut&&function(e){if(r){const t=new Error(`effect_in_teardown\n\`${e}\` cannot be used inside an effect cleanup function\nhttps://svelte.dev/e/effect_in_teardown`);throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/effect_in_teardown")}(t),r&&d(e,"name",{value:"$effect"});var n=qt.f;if(Ht||!(32&n)||0!==(n&D))return At(e);var o=ae;(o.e??=[]).push(e)}function At(e){return yt(1048580,e,!1)}function wt(e){return yt(4,e,!1)}function St(e,t=0){return yt(8|t,e,!0)}function Et(e,t=[],n=[],o=[]){Ne(o,t,n,t=>{yt(8,()=>e(...t.map(pn)),!0)})}function Ct(e,t=0){var n=yt(f|t,e,!0);return r&&(n.dev_stack=se),n}function Mt(e){return yt(524320,e,!0)}function kt(e){var t=e.teardown;if(null!==t){const e=Ut,n=Ht;Wt(!0),Yt(null);try{t.call(null)}finally{Wt(e),Yt(n)}}}function Tt(e,t=!1){var n=e.first;for(e.first=e.last=null;null!==n;){const e=n.ac;null!==e&&vt(()=>{e.abort(O)});var o=n.next;64&n.f?n.parent=null:It(n,t),n=o}}function It(e,t=!0){var n=!1;!t&&0===(e.f&w)||null===e.nodes||null===e.nodes.end||(function(e,t){for(;null!==e;){var n=e===t?null:Pt(e);e.remove(),e=n}}(e.nodes.start,e.nodes.end),n=!0),Tt(e,t&&!n),un(e,0),Pn(e,y);var o=e.nodes&&e.nodes.t;if(null!==o)for(const e of o)e.stop();kt(e);var a=e.parent;null!==a&&null!==a.first&&Ot(e),r&&(e.component_function=null),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Ot(e){var t=e.parent,n=e.prev,o=e.next;null!==n&&(n.next=o),null!==o&&(o.prev=n),null!==t&&(t.first===e&&(t.first=o),t.last===e&&(t.last=n))}function Rt(e,t,n=!0){var o=[];Gt(e,o,!0);var r=()=>{n&&It(e),t&&t()},a=o.length;if(a>0){var i=()=>--a||r();for(var s of o)s.out(i)}else r()}function Gt(e,t,n){if(0===(e.f&v)){e.f^=v;var o=e.nodes&&e.nodes.t;if(null!==o)for(const e of o)(e.is_global||n)&&t.push(e);for(var r=e.first;null!==r;){var a=r.next;Gt(r,t,!!(0!==(r.f&x)||32&r.f&&0!==(e.f&f))&&n),r=a}}}function Lt(e){Nt(e,!0)}function Nt(e,t){if(0!==(e.f&v)){e.f^=v,0===(e.f&P)&&(Pn(e,b),Ge(e));for(var n=e.first;null!==n;){var o=n.next;Nt(n,!!(0!==(n.f&x)||32&n.f)&&t),n=o}var r=e.nodes&&e.nodes.t;if(null!==r)for(const e of r)(e.is_global||t)&&e.in()}}function zt(e,t){if(e.nodes)for(var n=e.nodes.start,o=e.nodes.end;null!==n;){var r=n===o?null:Pt(n);t.append(n),n=r}}let jt=null,Bt=!1;function $t(e){Bt=e}let Ut=!1;function Wt(e){Ut=e}let Ht=null,Vt=!1;function Yt(e){Ht=e}let qt=null;function Kt(e){qt=e}let Xt=null;function Zt(e){null!==Ht&&(null===Xt?Xt=[e]:Xt.push(e))}let Qt=null,Jt=0,en=null,tn=1,nn=0,on=nn;function rn(e){on=e}function an(){return++tn}function sn(e){var t=e.f;if(0!==(t&b))return!0;if(2&t&&(e.f&=-32769),0!==(t&_)){var n=e.deps;if(null!==n)for(var o=n.length,r=0;r<o;r++){var a=n[r];if(sn(a)&&qe(a),a.wv>e.wv)return!0}0!==(t&F)&&null===xe&&Pn(e,P)}return!1}function ln(e,t,n=!0){var o=e.reactions;if(null!==o&&!Xt?.includes(e))for(var r=0;r<o.length;r++){var a=o[r];2&a.f?ln(a,t,!1):t===a&&(n?Pn(a,b):0!==(a.f&P)&&Pn(a,_),Ge(a))}}function dn(e){var t=Qt,n=Jt,o=en,r=Ht,a=Xt,i=ae,s=Vt,l=on,d=e.f;Qt=null,Jt=0,en=null,Ht=96&d?null:e,Xt=null,ie(e.ctx),Vt=!1,on=++nn,null!==e.ac&&(vt(()=>{e.ac.abort(O)}),e.ac=null);try{e.f|=C;var c=(0,e.fn)(),u=e.deps;if(null!==Qt){var m;if(un(e,Jt),null!==u&&Jt>0)for(u.length=Jt+Qt.length,m=0;m<Qt.length;m++)u[Jt+m]=Qt[m];else e.deps=u=Qt;if(Dt()&&0!==(e.f&F))for(m=Jt;m<u.length;m++)(u[m].reactions??=[]).push(e)}else null!==u&&Jt<u.length&&(un(e,Jt),u.length=Jt);if(!(null===en||Vt||null===u||6146&e.f))for(m=0;m<en.length;m++)ln(en[m],e);return null!==r&&r!==e&&(nn++,null!==en&&(null===o?o=en:o.push(...en))),0!==(e.f&M)&&(e.f^=M),c}catch(e){return Pe(e)}finally{e.f^=C,Qt=t,Jt=n,en=o,Ht=r,Xt=a,ie(i),Vt=s,on=l}}function cn(e,t){let n=t.reactions;if(null!==n){var o=i.call(n,e);if(-1!==o){var r=n.length-1;0===r?n=t.reactions=null:(n[o]=n[r],n.pop())}}null===n&&2&t.f&&(null===Qt||!Qt.includes(t))&&(Pn(t,_),0!==(t.f&F)&&(t.f^=F,t.f&=-32769),He(t),un(t,0))}function un(e,t){var n=e.deps;if(null!==n)for(var o=t;o<n.length;o++)cn(e,n[o])}function mn(e){var t=e.f;if(0===(t&y)){Pn(e,P);var n=qt,o=Bt;if(qt=e,Bt=!0,r){var a=de;ce(e.component_function);var i=se;le(e.dev_stack??se)}try{16777232&t?function(e){for(var t=e.first;null!==t;){var n=t.next;!(32&t.f)&&It(t),t=n}}(e):Tt(e),kt(e);var s=dn(e);e.teardown="function"==typeof s?s:null,e.wv=tn}finally{Bt=o,qt=n,r&&(ce(a),le(i))}}}function pn(e){var t=!!(2&e.f);if(!(jt?.add(e),null===Ht||Vt||null!==qt&&0!==(qt.f&y)||Xt?.includes(e))){var n=Ht.deps;if(0!==(Ht.f&C))e.rv<nn&&(e.rv=nn,null===Qt&&null!==n&&n[Jt]===e?Jt++:null===Qt?Qt=[e]:Qt.includes(e)||Qt.push(e));else{(Ht.deps??=[]).push(e);var o=e.reactions;null===o?e.reactions=[Ht]:o.includes(Ht)||o.push(Ht)}}if(r&&($e.delete(e),ee))if(e.trace)e.trace();else{var a=re("traced at");if(a){var i=te.entries.get(e);void 0===i&&(i={traces:[]},te.entries.set(e,i));var s=i.traces[i.traces.length-1];a.stack!==s?.stack&&i.traces.push(a)}}if(Ut){if(Xe.has(e))return Xe.get(e);if(t){var l=e,d=l.v;return(0===(l.f&P)&&null!==l.reactions||gn(l))&&(d=Ye(l)),Xe.set(l,d),d}}else t&&(!xe?.has(e)||ye?.is_fork&&!Dt())&&(sn(l=e)&&qe(l),Bt&&Dt()&&0===(l.f&F)&&hn(l));if(xe?.has(e))return xe.get(e);if(0!==(e.f&M))throw e.v;return e.v}function hn(e){if(null!==e.deps){e.f^=F;for(const t of e.deps)(t.reactions??=[]).push(e),2&t.f&&0===(t.f&F)&&hn(t)}}function gn(e){if(e.v===N)return!0;if(null===e.deps)return!1;for(const t of e.deps){if(Xe.has(t))return!0;if(2&t.f&&gn(t))return!0}return!1}function fn(e){var t=Vt;try{return Vt=!0,e()}finally{Vt=t}}const Fn=-7169;function Pn(e,t){e.f=e.f&Fn|t}const bn=["touchstart","touchmove"];function _n(e){return bn.includes(e)}var vn=new Map;const yn=new Set,Dn=new Set;let xn=null;function An(e){var t=this,n=t.ownerDocument,o=e.type,r=e.composedPath?.()||[],a=r[0]||e.target;xn=e;var i=0,s=xn===e&&e.__root;if(s){var l=r.indexOf(s);if(-1!==l&&(t===document||t===window))return void(e.__root=t);var c=r.indexOf(t);if(-1===c)return;l<=c&&(i=l)}if((a=r[i]||e.target)!==t){d(e,"currentTarget",{configurable:!0,get:()=>a||n});var u=Ht,m=qt;Yt(null),Kt(null);try{for(var p,h=[];null!==a;){var g=a.assignedSlot||a.parentNode||a.host||null;try{var f=a["__"+o];null==f||a.disabled&&e.target!==a||f.call(a,e)}catch(e){p?h.push(e):p=e}if(e.cancelBubble||g===t||null===g)break;a=g}if(p){for(let e of h)queueMicrotask(()=>{throw e});throw p}}finally{e.__root=t,delete e.currentTarget,Yt(u),Kt(m)}}}function wn(e,t){var n=qt;null===n.nodes&&(n.nodes={start:e,end:t,a:null,t:null})}function Sn(e,t){var n,o=!!(1&t),r=!!(2&t),a=!e.startsWith("<!>");return()=>{if(H)return wn(W,null),W;var t,i;void 0===n&&(t=a?e:"<!>"+e,(i=document.createElement("template")).innerHTML=t.replaceAll("<!>","\x3c!----\x3e"),n=i.content,o||(n=Ft(n)));var s=r||mt?document.importNode(n,!0):n.cloneNode(!0);return o?wn(Ft(s),s.lastChild):wn(s,s),s}}function En(e,t){if(H){var n=qt;return 0!==(n.f&D)&&null!==n.nodes.end||(n.nodes.end=W),void q()}null!==e&&e.before(t)}let Cn=!0;function Mn(e,t){return In(e,t)}function kn(e,t){gt(),t.intro=t.intro??!1;const n=t.target,o=H,a=W;try{for(var i=Ft(n);i&&(8!==i.nodeType||"["!==i.data);)i=Pt(i);if(!i)throw L;V(!0),Y(i);const o=In(e,{...t,anchor:i});return V(!1),o}catch(o){if(o instanceof Error&&o.message.split("\n").some(e=>e.startsWith("https://svelte.dev/e/")))throw o;return o!==L&&console.warn("Failed to hydrate: ",o),!1===t.recover&&function(){if(r){const e=new Error("hydration_failed\nFailed to hydrate the application\nhttps://svelte.dev/e/hydration_failed");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/hydration_failed")}(),gt(),n.textContent="",V(!1),Mn(e,t)}finally{V(o),Y(a)}}const Tn=new Map;function In(e,{target:t,anchor:n,props:o={},events:r,context:a,intro:i=!0}){gt();var l=new Set,d=e=>{for(var n=0;n<e.length;n++){var o=e[n];if(!l.has(o)){l.add(o);var r=_n(o);t.addEventListener(o,An,{passive:r});var a=Tn.get(o);void 0===a?(document.addEventListener(o,An,{passive:r}),Tn.set(o,1)):Tn.set(o,a+1)}}};d(s(yn)),Dn.add(d);var c=void 0,u=function(){Ce.ensure();const s=yt(524352,()=>{var s=n??t.appendChild(ft());return u=s,m=t=>{if(a&&(ue({}),ae.c=a),r&&(o.$$events=r),H&&wn(t,null),Cn=i,c=e(t,o)||{},Cn=!0,H&&(qt.nodes.end=W,null===W||8!==W.nodeType||"]"!==W.data))throw $(),L;a&&me()},new Le(u,{pending:()=>{}},m),()=>{for(var e of l){t.removeEventListener(e,An);var o=Tn.get(e);0===--o?(document.removeEventListener(e,An),Tn.delete(e)):Tn.set(e,o)}Dn.delete(d),s!==n&&s.parentNode?.removeChild(s)};var u,m},!0);return(e={})=>new Promise(t=>{e.outro?Rt(s,()=>{It(s),t(void 0)}):(It(s),t(void 0))})}();return On.set(c,u),c}let On=new WeakMap;class Rn{anchor;#I=new Map;#O=new Map;#R=new Map;#G=new Set;#L=!0;constructor(e,t=!0){this.anchor=e,this.#L=t}#u=()=>{var e=ye;if(this.#I.has(e)){var t=this.#I.get(e),n=this.#O.get(t);if(n)Lt(n),this.#G.delete(t);else{var o=this.#R.get(t);o&&(this.#O.set(t,o.effect),this.#R.delete(t),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),n=o.effect)}for(const[t,n]of this.#I){if(this.#I.delete(t),t===e)break;const o=this.#R.get(n);o&&(It(o.effect),this.#R.delete(n))}for(const[e,o]of this.#O){if(e===t||this.#G.has(e))continue;const r=()=>{if(Array.from(this.#I.values()).includes(e)){var t=document.createDocumentFragment();zt(o,t),t.append(ft()),this.#R.set(e,{effect:o,fragment:t})}else It(o);this.#G.delete(e),this.#O.delete(e)};this.#L||!n?(this.#G.add(e),Rt(o,r,!1)):r()}}};#N=e=>{this.#I.delete(e);const t=Array.from(this.#I.values());for(const[e,n]of this.#R)t.includes(e)||(It(n.effect),this.#R.delete(e))};ensure(e,t){var n=ye;!t||this.#O.has(e)||this.#R.has(e)||this.#O.set(e,Mt(()=>t(this.anchor)));this.#I.set(n,e),H&&(this.anchor=W),this.#u()}}function Gn(e,t,n=!1){H&&q();var o=new Rn(e);function r(t,n){if(H){const a=function(e){if(!e||8!==e.nodeType)throw $(),L;return e.data}(e)===G;if(t===a){var r=X();return Y(r),o.anchor=r,V(!1),o.ensure(t,n),void V(!0)}}o.ensure(t,n)}Ct(()=>{var e=!1;t((t,n=!0)=>{e=!0,r(n,t)}),e||r(!1,null)},n?x:0)}function Ln(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Ln(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}new Set,new Map([[!0,"yes"],[!1,"no"]]);const Nn=[..." \t\n\r\f \v\ufeff"];function zn(e,t=!1){var n=t?" !important;":";",o="";for(var r in e){var a=e[r];null!=a&&""!==a&&(o+=" "+r+": "+a+n)}return o}function jn(e){return"-"!==e[0]||"-"!==e[1]?e.toLowerCase():e}function Bn(e,t={},n,o){for(var r in n){var a=n[r];t[r]!==a&&(null==n[r]?e.style.removeProperty(r):e.style.setProperty(r,a,o))}}function $n(e,t){return e===t||e?.[k]===t}Symbol("class"),Symbol("style"),Symbol("is custom element"),Symbol("is html"),new Map,new Set,new WeakMap;let Un,Wn=!1;function Hn(e,t,n,o){var a,i,s=!!(8&n),l=!!(16&n),d=o,u=!0,m=()=>(u&&(u=!1,d=l?fn(o):o),d);if(s){var p=k in e||T in e;a=c(e,t)?.set??(p&&t in e?n=>e[t]=n:void 0)}var h,g=!1;if(s?[i,g]=function(){var n=Wn;try{return Wn=!1,[e[t],Wn]}finally{Wn=n}}():i=e[t],void 0===i&&void 0!==o&&(i=m(),a&&(function(e){if(r){const t=new Error(`props_invalid_value\nCannot do \`bind:${e}={undefined}\` when \`${e}\` has a fallback value\nhttps://svelte.dev/e/props_invalid_value`);throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/props_invalid_value")}(t),a(i))),h=()=>{var n=e[t];return void 0===n?m():(u=!0,n)},!(4&n))return h;if(a){var f=e.$$legacy;return function(e,t){return arguments.length>0?(t&&!f&&!g||a(t?h():e),e):h()}}var F=!1,P=(1&n?Ue:We)(()=>(F=!1,h()));r&&(P.label=t),s&&pn(P);var b=qt;return function(e,t){if(arguments.length>0){const n=t?pn(P):s?st(e):e;return tt(P,n),F=!0,void 0!==d&&(d=n),e}return Ut&&F||0!==(b.f&y)?P.v:pn(P)}}Symbol();class Vn{#z;#j;constructor(e){var t=new Map,n=(e,n)=>{var o=function(e,t=!1){const n=Je(e);return t||(n.equals=Q),n}(n,!1,!1);return t.set(e,o),o};const o=new Proxy({...e.props||{},$$events:{}},{get:(e,o)=>pn(t.get(o)??n(o,Reflect.get(e,o))),has:(e,o)=>o===T||(pn(t.get(o)??n(o,Reflect.get(e,o))),Reflect.has(e,o)),set:(e,o,r)=>(tt(t.get(o)??n(o,r),r),Reflect.set(e,o,r))});this.#j=(e.hydrate?kn:Mn)(e.component,{target:e.target,anchor:e.anchor,props:o,context:e.context,intro:e.intro??!1,recover:e.recover}),e?.props?.$$host&&!1!==e.sync||function(e){var t=Ee;Ee=!0;try{var n;for(e&&(null!==ye&&Me(),n=e());;){if(fe(),0===Ae.length&&(ye?.flush(),0===Ae.length))return we=null,n;Me()}}finally{Ee=t}}(),this.#z=o.$$events;for(const e of Object.keys(this.#j))"$set"!==e&&"$destroy"!==e&&"$on"!==e&&d(this,e,{get(){return this.#j[e]},set(t){this.#j[e]=t},enumerable:!0});this.#j.$set=e=>{Object.assign(o,e)},this.#j.$destroy=()=>{!function(e,t){const n=On.get(e);n?(On.delete(e),n(t)):(r&&(k in e?r?console.warn("%c[svelte] state_proxy_unmount\n%cTried to unmount a state proxy, rather than a component\nhttps://svelte.dev/e/state_proxy_unmount",j,B):console.warn("https://svelte.dev/e/state_proxy_unmount"):r?console.warn("%c[svelte] lifecycle_double_unmount\n%cTried to unmount a component that was not mounted\nhttps://svelte.dev/e/lifecycle_double_unmount",j,B):console.warn("https://svelte.dev/e/lifecycle_double_unmount")),Promise.resolve())}(this.#j)}}$set(e){this.#j.$set(e)}$on(e,t){this.#z[e]=this.#z[e]||[];const n=(...e)=>t.call(this,...e);return this.#z[e].push(n),()=>{this.#z[e]=this.#z[e].filter(e=>e!==n)}}$destroy(){this.#j.$destroy()}}function Yn(e,t,n,o){const r=n[e]?.type;if(t="Boolean"===r&&"boolean"!=typeof t?null!=t:t,!o||!n[e])return t;if("toAttribute"===o)switch(r){case"Object":case"Array":return null==t?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return null==t?null:t;default:return t}else switch(r){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":default:return t;case"Number":return null!=t?+t:t}}if("function"==typeof HTMLElement&&(Un=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(e,t,n){super(),this.$$ctor=e,this.$$s=t,n&&this.attachShadow({mode:"open"})}addEventListener(e,t,n){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){const n=this.$$c.$on(e,t);this.$$l_u.set(t,n)}super.addEventListener(e,t,n)}removeEventListener(e,t,n){if(super.removeEventListener(e,t,n),this.$$c){const e=this.$$l_u.get(t);e&&(e(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(e){return t=>{const n=document.createElement("slot");"default"!==e&&(n.name=e),En(t,n)}}const n={},o=function(e){const t={};return e.childNodes.forEach(e=>{t[e.slot||"default"]=!0}),t}(this);for(const r of this.$$s)r in o&&("default"!==r||this.$$d.children?n[r]=t(r):(this.$$d.children=t(r),n.default=!0));for(const a of this.attributes){const i=this.$$g_p(a.name);i in this.$$d||(this.$$d[i]=Yn(i,a.value,this.$$p_d,"toProp"))}for(const s in this.$$p_d)s in this.$$d||void 0===this[s]||(this.$$d[s]=this[s],delete this[s]);this.$$c=(e={component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:n,$$host:this}},new Vn(e)),this.$$me=function(e){Ce.ensure();const t=yt(524352,e,!0);return()=>{It(t)}}(()=>{St(()=>{this.$$r=!0;for(const e of l(this.$$c)){if(!this.$$p_d[e]?.reflect)continue;this.$$d[e]=this.$$c[e];const t=Yn(e,this.$$d[e],this.$$p_d,"toAttribute");null==t?this.removeAttribute(this.$$p_d[e].attribute||e):this.setAttribute(this.$$p_d[e].attribute||e,t)}this.$$r=!1})});for(const d in this.$$l)for(const c of this.$$l[d]){const u=this.$$c.$on(d,c);this.$$l_u.set(c,u)}this.$$l={}}var e}attributeChangedCallback(e,t,n){this.$$r||(e=this.$$g_p(e),this.$$d[e]=Yn(e,n,this.$$p_d,"toProp"),this.$$c?.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(e){return l(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}}),r){function oo(e){if(!(e in globalThis)){let t;Object.defineProperty(globalThis,e,{configurable:!0,get:()=>{if(void 0!==t)return t;!function(e){if(r){const t=new Error(`rune_outside_svelte\nThe \`${e}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files\nhttps://svelte.dev/e/rune_outside_svelte`);throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/rune_outside_svelte")}(e)},set:e=>{t=e}})}}oo("$state"),oo("$effect"),oo("$derived"),oo("$inspect"),oo("$props"),oo("$bindable")}function qn(e){null===ae&&R("onMount"),xt(()=>{const t=fn(e);if("function"==typeof t)return t})}"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5");var Kn=n(754),Xn=Sn("<div></div>");function Zn(e,t){ue(t,!0);let n,o=Hn(t,"config",19,()=>({})),r=Hn(t,"class",3,""),i=Hn(t,"style",3,""),s=null;const l=function(){const e=ae;return null===e&&R("createEventDispatcher"),(t,n,o)=>{const r=e.s.$$events?.[t];if(r){const i=a(r)?r.slice():[r],s=function(e,t,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:o})}(t,n,o);for(const t of i)t.call(e.x,s);return!s.defaultPrevented}return!0}}();var d;qn(()=>{const e=Kn.K.init({type:"container",target:n,...o()});e&&(s=e,t.oninit?.(e),l("init",e),e.registry.then(e=>{t.onready?.(e),l("ready",e)}))}),d=()=>{s&&n&&(n.innerHTML="",s=null)},null===ae&&R("onDestroy"),qn(()=>()=>fn(d));var c=Xn();!function(e={},t,n,o){wt(()=>{var r,a;return St(()=>{r=a,a=o?.()||[],fn(()=>{e!==n(...a)&&(t(e,...a),r&&$n(n(...r),e)&&t(null,...r))})}),()=>{ge(()=>{a&&$n(n(...a),e)&&t(null,...a)})}})}(c,e=>n=e,()=>n),Et(()=>{var e;(function(e,t,n,o,r,a){var i=e.__className;if(H||i!==n||void 0===i){var s=function(e,t,n){var o=null==e?"":""+e;if(t&&(o=o?o+" "+t:t),n)for(var r in n)if(n[r])o=o?o+" "+r:r;else if(o.length)for(var a=r.length,i=0;(i=o.indexOf(r,i))>=0;){var s=i+a;0!==i&&!Nn.includes(o[i-1])||s!==o.length&&!Nn.includes(o[s])?i=s:o=(0===i?"":o.substring(0,i))+o.substring(s+1)}return""===o?null:o}(n,o,a);H&&s===e.getAttribute("class")||(null==s?e.removeAttribute("class"):t?e.className=s:e.setAttribute("class",s)),e.__className=n}else if(a&&r!==a)for(var l in a){var d=!!a[l];null!=r&&d===!!r[l]||e.classList.toggle(l,d)}})(c,1,"object"==typeof(e=r())?function(){for(var e,t,n=0,o="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Ln(e))&&(o&&(o+=" "),o+=t);return o}(e):e??""),function(e,t,n,o){var r=e.__style;if(H||r!==t){var a=function(e,t){if(t){var n,o,r="";if(Array.isArray(t)?(n=t[0],o=t[1]):n=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,i=0,s=!1,l=[];n&&l.push(...Object.keys(n).map(jn)),o&&l.push(...Object.keys(o).map(jn));var d=0,c=-1;const t=e.length;for(var u=0;u<t;u++){var m=e[u];if(s?"/"===m&&"*"===e[u-1]&&(s=!1):a?a===m&&(a=!1):"/"===m&&"*"===e[u+1]?s=!0:'"'===m||"'"===m?a=m:"("===m?i++:")"===m&&i--,!s&&!1===a&&0===i)if(":"===m&&-1===c)c=u;else if(";"===m||u===t-1){if(-1!==c){var p=jn(e.substring(d,c).trim());l.includes(p)||(";"!==m&&u++,r+=" "+e.substring(d,u).trim()+";")}d=u+1,c=-1}}}return n&&(r+=zn(n)),o&&(r+=zn(o,!0)),""===(r=r.trim())?null:r}return null==e?null:String(e)}(t,o);H&&a===e.getAttribute("style")||(null==a?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}else o&&(Array.isArray(o)?(Bn(e,n?.[0],o[0]),Bn(e,n?.[1],o[1],"important")):Bn(e,n,o))}(c,i())}),En(e,c),me()}var Qn=Sn('<div id="loading" class="svelte-db2r4i"><h1>Your PDF is loading...</h1> <p>If you see this screen for more than a few seconds, close this editor\n        tab and reopen the file.</p></div>'),Jn=Sn('<div id="error" class="svelte-db2r4i"><h1>Error Loading PDF</h1> <pre class="svelte-db2r4i"> </pre></div>'),eo=Sn('<div id="pdf-container" class="viewer-wrapper svelte-db2r4i"><!></div>'),to=Sn('<main class="svelte-db2r4i"><!> <!> <!></main>');const no={hash:"svelte-db2r4i",code:"body {margin:0;padding:0;overflow:hidden;background-color:var(--vscode-editor-background);}main.svelte-db2r4i {width:100vw;height:100vh;overflow:hidden;position:relative;}.viewer-wrapper.svelte-db2r4i {width:100%;height:100%;}#loading.svelte-db2r4i,\n  #error.svelte-db2r4i {position:absolute;top:0;left:0;width:100%;height:100%;padding:20px;z-index:10;color:var(--vscode-foreground);background:var(--vscode-editor-background);font-family:var(--vscode-font-family);box-sizing:border-box;}#error.svelte-db2r4i {color:var(--vscode-errorForeground);}pre.svelte-db2r4i {white-space:pre-wrap;word-break:break-all;}"};window.mediaUri&&(n.p=window.mediaUri+"/"),Mn(function(e,t){var n,o;ue(t,!0),n=e,o=no,wt(()=>{var e=n.getRootNode(),t=e.host?e:e.head??e.ownerDocument.head;if(!t.querySelector("#"+o.hash)){const e=document.createElement("style");e.id=o.hash,e.textContent=o.code,t.appendChild(e),r&&function(e,t){var n=vn.get(e);n||(n=new Set,vn.set(e,n)),n.add(t)}(o.hash,e)}});const a=void 0!==window.acquireVsCodeApi?window.acquireVsCodeApi():null;let i=et(st(h())),s=et(null),l=et(""),d=et(null),c=et(!0),u=et(null),m=null,p=et(null);function h(){return"undefined"!=typeof document&&(document.body.classList.contains("vscode-dark")||document.body.classList.contains("vscode-high-contrast"))?"dark":"light"}function g(){const e=h();pn(i)!==e&&(console.log("[Webview] Theme changed to:",e),tt(i,e,!0))}const f=e=>{console.log("[Webview] PDF Viewer Initialized"),tt(d,e,!0)},F=e=>{console.log("[Webview] PDF Viewer Ready with Registry")};async function P(e){const t=e.data;if(t&&t.command)switch(console.log("[Webview] Received message command:",t.command),t.command){case"preview":const e=t.pdfUri||"base64-data";if(m===e&&pn(s))return void console.log("[Webview] Ignoring duplicate document URI");console.log("[Webview] Processing preview for:",e),m=e,tt(l,t.wasmUri,!0),tt(p,t.config,!0),console.log("[Webview] Received config:",JSON.stringify(pn(p)));let n=t.pdfUri;if(!n&&t.data){let e;console.log("[Webview] Processing injected data"),t.data instanceof Uint8Array?(console.log("[Webview] Data is already Uint8Array (Zero-copy)"),e=t.data):t.data instanceof ArrayBuffer?(console.log("[Webview] Data is already ArrayBuffer (Zero-copy)"),e=new Uint8Array(t.data)):(console.log("[Webview] Converting base64 to blob (Fallback)"),e=function(e){const t=window.atob(e),n=t.length,o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t.charCodeAt(e);return o.buffer}(t.data));const o=new Blob([e],{type:"application/pdf"});n=URL.createObjectURL(o)}n?(console.log("[Webview] Setting pdfSrc"),tt(s,n,!0),tt(c,!1)):(console.warn("[Webview] No source resolved for PDF"),tt(u,"Failed to resolve PDF source"),tt(c,!1)),a&&a.setState({pdfUri:t.pdfUri,data:t.data,wasmUri:t.wasmUri,workerUri:t.workerUri,viewState:a.getState()?.viewState||null,config:t.config});break;case"error":console.error("[Webview] Error message from extension:",t.error),tt(u,t.error,!0),tt(c,!1);break;default:console.log("[Webview] Unhandled command:",t.command)}}xt(()=>{pn(d)&&(console.log("[Webview] Syncing theme preference:",pn(i)),pn(d).setTheme({preference:pn(i)}))}),qn(()=>{console.log("[Webview] App mounted");const e=new MutationObserver(g);if(e.observe(document.body,{attributes:!0,attributeFilter:["class"]}),window.addEventListener("message",P),g(),a&&(console.log("[Webview] Sending ready signal to host"),a.postMessage({command:"ready"})),a){const e=a.getState();e&&(e.pdfUri||e.data)&&(console.log("[Webview] Restoring state"),P({data:{command:"preview",...e}}))}return()=>{e.disconnect(),window.removeEventListener("message",P)}});var b=to(),_=bt(b),v=e=>{En(e,Qn())};Gn(_,e=>{pn(c)&&!pn(u)&&e(v)});var y=_t(_,2),D=e=>{var t=Jn(),n=_t(bt(t),2),o=bt(n,!0);K(n),K(t),Et(()=>function(e,t){var n=null==t?"":"object"==typeof t?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}(o,pn(u))),En(e,t)};Gn(y,e=>{pn(u)&&e(D)});var x=_t(y,2),A=e=>{var t=eo(),n=bt(t);{let e=function(){const e=Ue(()=>({src:pn(s),wasmUrl:pn(l),theme:{preference:pn(i)},spread:{defaultSpreadMode:pn(p)?.spreadMode||Kn.O.Odd},zoom:{defaultZoomLevel:pn(p)?.zoomLevel||Kn.Q.FitWidth}}));return Zt(e),e}();Zn(n,{oninit:f,onready:F,get config(){return pn(e)},style:"width: 100%; height: 100%;"})}K(t),En(e,t)};Gn(x,e=>{pn(s)&&e(A)}),K(b),En(e,b),me()},{target:document.body})})();